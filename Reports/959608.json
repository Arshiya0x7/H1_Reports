{
  "id": 959608,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTk2MDg=",
  "url": "https://hackerone.com/reports/959608",
  "title": "Local Privilege Escalation via DLL Search-Order Hijacking with Cyber Protection Agent - systeminfo.exe utility",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-08-15T20:12:54.594Z",
  "submitted_at": "2020-08-15T20:12:54.621Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mmg",
    "url": "/mmg",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/222/119/30b5386d5cc0fd351927b57fa02a7cf7c81a7a2b_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13428,
    "url": "https://hackerone.com/acronis",
    "handle": "acronis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Acronis",
      "twitter_handle": "Acronis",
      "website": "https://www.acronis.com",
      "about": "Complete integrated cybersecurity and data protection for MSPs and IT teams"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-08-27T14:05:57.437Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2021-08-17T10:35:07.046Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Using the latest version of Cyber Protection Agent (Version 12.5.23130) is possible to perform DLL Search-Order Hijacking.\nThe only requirement is to have modify rights to one folder defined in the PATH system variable, due to the order in which the DLL is loaded.\n\n-Impact:\nIf a local attacker has modifying rights to one of the folders defined in the PATH system variable, will be able to load his malicious DLL, when the systeminfo.exe  starts, and execute his code with elevated privileges.\n\n-How to Reproduce:\n1.Download the latest version for the Windows Agent\nURL: https://mc-beta-cloud.acronis.com/download/u/baas/4.0/12.5.23130/Cyber_Protection_Agent_for_Windows_web.exe\n\n2.Start a procmon utility, from Sysinternal, and monitor \"systeminfo.exe\"\nAs part of my PATH system variables, I have the Python's location, which was installed in the C:\\Python27 folder.\n\nAfter the installation is complete, manually start the systeminfo.exe, which in my case is pointing to \"C:\\Program Files\\Common Files\\Acronis\\AdvReport\\systeminfo.exe\" executable.\nBelow is an output of the process is which is looking for snapapi.dll:\n\nsysteminfo.exe\t2132\tCreateFile\tC:\\python27\\snapapi.dll\tNAME NOT FOUND\n\nThe test was perform on my Windows 10 Pro Version 1909 (OS Build 18363.1016).\n\nI have attached a sample DLL, when loaded this will call C:\\attacker\\mmg.bat file.\nYou will need to create the c:\\attcker folder and you can add in the mmg.bat file any command you want.\nFor validation i usually append in the file \"whoami /all >> c:\\attacker\\who.txt\" to confirm the security context in which my code was executed.\n\n## Impact\n\nThe software executable is not verifying the authenticity of the DLL files, or the Search-Order before loading, thus an attacker may leverage this vulnerability to execute arbitrary code on the victim's machine, with the highest privileges.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 950453,
      "file_name": "mmg.bat.txt",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6wEZLx6ywcfEdesTn8vnxu7x?response-content-disposition=attachment%3B%20filename%3D%22mmg.bat.txt%22%3B%20filename%2A%3DUTF-8%27%27mmg.bat.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXUB7NLT6%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T181432Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJHMEUCIEOoCU2uLkgzSill73OnYAPEZ5%2FPJSGNjzdlmGxLJ21%2BAiEA4OK2MABUmQ%2FRuu3WHQARY5JOBbhGDN45%2FB00jxmburoqugUI8v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCE8UvbyKZFpm2hYMyqOBVfHEqxQi4oxeHtgwSkJrz8JhrkeCcC5JiRXAVYaMJMVXl8g96tP8peE%2BdpnHH2uMyBIVUGcNbm7WrhI9Oem6xGPZhvVRqSk%2F40MloZ%2FDcfsF5m85cTZsuFMsmSjscnF7ZNNVkgYIpy5yVH6VkgB0wqCY%2BmbNBO7v5O90o0vwR6cHyhAM4oWTbWT50Pkmf00UnveO0WzhPFWw%2BNWfqli5aUBoPk7k%2Bx9RYxxG6gIqfBpjd21wW9PUxl1x5RygyiHIpP2h5hDrdq0wpXt9k86othGxdO6MQLV2NlRTaWQe1eIAHR0JdV4n2X8sT2dDhDFY42qLKcLMCCFKQmO1ryjp2BVQoJNG%2FKil0q9iQNOG6JdzQHl4cjysK%2FFSUH8DvYwXc6mr1lYULqou9EyhIBfHMTmHpf2dQavX%2FZwvi2Lak9o%2BJz9cw3CYBVfZCbmBrZXCtRU5G5bqy9vMJv5oUulnw0KtqLk0CGqqYOfjFoa0u1iFFA%2FVAmqrfmZSfHeBv1joSV6TtA9Ds7tauxXExrgx1W9q%2FYDv6sKVeLzki69aIGwndWg3rCesxck3v%2F%2Bongb93Lacyp7UZx0crLe8AzMzcLyKOjuUiqg4eT1fWR%2BdW%2FohQmk4p%2BxHJfURas4PlQkgEAaBeEGD7HxhT3svfzWLWeL2XrsdFwC4SQjGHt4Z0zowDcjJ3AjiGnvnaJRIbd%2B7%2Bp1ef1O4LwI1WdEtSciUQoycHCOa6cTR9oEOWAwq5sDmD3QppRTIFOOTZMngrc1p6%2F7xcusJwKD0Go0TWII7i6vOng6WT0WhRCo2nU5El91tDAt%2FjlFzgzu%2BhmV0727zOP3veeGlruFGNVqgmwEjTzjzVtQ0E1QHRi8kSl01jDNs7vGBjqxAW6IdFXglXF7gf6f0%2FjGuRFOa557khKRlFGHwbuX8xfMl1G7RiG1cNlpwiY1dudfyuZ%2BQ5GC6mKlrko2MHZCrFLZN9%2FRBdOrRexUkRzRC%2FKijXgGPPFnB4YBvQD7Q4i07%2BtFclb6FkYzvS4hrLB9eD6bAHWXNjMmsFZoxkBu0fvy%2FEqD57E8%2FXFLnBuNyxVRe0BiOCnd7JIQtfyChuYqq4MgDrlTVQGMGhC0OOyS2SzRcg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7bfa1f995c395ccb22b53779cff4dfccbbda14a48b8061d0ce1b6989f369a09d",
      "file_size": 34,
      "type": "text/plain",
      "moderated": null
    },
    {
      "id": 950454,
      "file_name": "snapapi.dll",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qWDfuFVQmcKnY2bvGdqWPXkt?response-content-disposition=attachment%3B%20filename%3D%22snapapi.dll%22%3B%20filename%2A%3DUTF-8%27%27snapapi.dll&response-content-type=application%2Fx-ms-dos-executable&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXUB7NLT6%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T181432Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJHMEUCIEOoCU2uLkgzSill73OnYAPEZ5%2FPJSGNjzdlmGxLJ21%2BAiEA4OK2MABUmQ%2FRuu3WHQARY5JOBbhGDN45%2FB00jxmburoqugUI8v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCE8UvbyKZFpm2hYMyqOBVfHEqxQi4oxeHtgwSkJrz8JhrkeCcC5JiRXAVYaMJMVXl8g96tP8peE%2BdpnHH2uMyBIVUGcNbm7WrhI9Oem6xGPZhvVRqSk%2F40MloZ%2FDcfsF5m85cTZsuFMsmSjscnF7ZNNVkgYIpy5yVH6VkgB0wqCY%2BmbNBO7v5O90o0vwR6cHyhAM4oWTbWT50Pkmf00UnveO0WzhPFWw%2BNWfqli5aUBoPk7k%2Bx9RYxxG6gIqfBpjd21wW9PUxl1x5RygyiHIpP2h5hDrdq0wpXt9k86othGxdO6MQLV2NlRTaWQe1eIAHR0JdV4n2X8sT2dDhDFY42qLKcLMCCFKQmO1ryjp2BVQoJNG%2FKil0q9iQNOG6JdzQHl4cjysK%2FFSUH8DvYwXc6mr1lYULqou9EyhIBfHMTmHpf2dQavX%2FZwvi2Lak9o%2BJz9cw3CYBVfZCbmBrZXCtRU5G5bqy9vMJv5oUulnw0KtqLk0CGqqYOfjFoa0u1iFFA%2FVAmqrfmZSfHeBv1joSV6TtA9Ds7tauxXExrgx1W9q%2FYDv6sKVeLzki69aIGwndWg3rCesxck3v%2F%2Bongb93Lacyp7UZx0crLe8AzMzcLyKOjuUiqg4eT1fWR%2BdW%2FohQmk4p%2BxHJfURas4PlQkgEAaBeEGD7HxhT3svfzWLWeL2XrsdFwC4SQjGHt4Z0zowDcjJ3AjiGnvnaJRIbd%2B7%2Bp1ef1O4LwI1WdEtSciUQoycHCOa6cTR9oEOWAwq5sDmD3QppRTIFOOTZMngrc1p6%2F7xcusJwKD0Go0TWII7i6vOng6WT0WhRCo2nU5El91tDAt%2FjlFzgzu%2BhmV0727zOP3veeGlruFGNVqgmwEjTzjzVtQ0E1QHRi8kSl01jDNs7vGBjqxAW6IdFXglXF7gf6f0%2FjGuRFOa557khKRlFGHwbuX8xfMl1G7RiG1cNlpwiY1dudfyuZ%2BQ5GC6mKlrko2MHZCrFLZN9%2FRBdOrRexUkRzRC%2FKijXgGPPFnB4YBvQD7Q4i07%2BtFclb6FkYzvS4hrLB9eD6bAHWXNjMmsFZoxkBu0fvy%2FEqD57E8%2FXFLnBuNyxVRe0BiOCnd7JIQtfyChuYqq4MgDrlTVQGMGhC0OOyS2SzRcg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fe684aee7a1e949322a5faee50c252d7805c43767dfa0a75e57cf913799583b",
      "file_size": 113152,
      "type": "application/x-ms-dos-executable",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 25,
  "voters": [
    "orange303",
    "zy9ard3",
    "shreyaschavhan",
    "ali",
    "ayoub0x1",
    "thalaivar304",
    "mohaned0101",
    "ahmed_xyz",
    "pr0f0x01",
    "011alsanosi",
    "and 15 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 49696,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "Acronis Agent",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
