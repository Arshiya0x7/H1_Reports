{
  "id": 2298922,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjk4OTIy",
  "url": "https://hackerone.com/reports/2298922",
  "title": "CVE-2024-0853: OCSP verification bypass with TLS session reuse",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-12-29T02:22:16.531Z",
  "submitted_at": "2023-12-29T02:22:16.728Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kurohiro",
    "url": "/kurohiro",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2024-0853"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-01-31T13:11:46.953Z",
  "bug_reporter_agreed_on_going_public_at": "2024-01-31T13:11:46.857Z",
  "team_member_agreed_on_going_public_at": "2024-01-31T07:20:48.752Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nIn version 8.5.0, cURL has inadvertently established a pathway for accepting revoked certificates.\nAs a result of [this correction](https://github.com/curl/curl/pull/12418/commits/7cf0391bbc3b5b2e4402ce675124cd73dbe0187e), during TLS session reuse, OCSP stapling verification will be skipped. \nHowever, the TLS session will be preserved regardless of OCSP verification results. \nAs a result, even for revoked certificates, verification is skipped during TLS session reuse.\n\n## Steps To Reproduce:\n  1.Identify sites with revoked certificates.\n  2. `curl (1.URL) (1.URL)--cert-status`\n\nI have prepared an environment for testing. Please use as necessary.\nhttps://ocsptest.ddns.net/\n`curl https://ocsptest.ddns.net/ https://ocsptest.ddns.net/ --cert-status`\nThis website returns only the string \"test.\"\n\n* I have used [this](https://curl.se/windows/dl-8.5.0_3/curl-8.5.0_3-win64-mingw.zip) for testing. \n* To avoid complications with timing dependencies in verification, I have configured the web server to use TLS 1.2.\n     In the case of TLS 1.3, the timing of session preservation is delayed, which appeared to prevent session reuse with the above command line.\n\nHere are the execution results.\n```\nC:\\curl-8.5.0_3-win64-mingw\\bin>curl https://ocsptest.ddns.net/ https://ocsptest.ddns.net/ --cert-status\ncurl: (91) SSL certificate revocation reason: (UNKNOWN) (-1)\ntest\n```\nThe first request becomes error, but the second one unjustly passes through the normal case.\n\n## Impact\n\nBypassing OCSP verification.",
  "weakness": {
    "id": 557,
    "name": "Improper Check for Certificate Revocation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-03-01T07:20:48.856Z",
  "allow_singular_disclosure_after": -49118760.43871153,
  "singular_disclosure_allowed": true,
  "vote_count": 23,
  "voters": [
    "exec_iq",
    "roland_hack",
    "thruster",
    "zy9ard3",
    "dhakal_bibek",
    "cnpg",
    "nitsec7",
    "pr0f0x01",
    "shivammusic",
    "sushankb76",
    "and 13 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
