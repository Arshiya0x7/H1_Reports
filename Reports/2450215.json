{
  "id": 2450215,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDUwMjE1",
  "url": "https://hackerone.com/reports/2450215",
  "title": "Any user could upload attachments to pentest scoping form they don't have access to",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2024-04-06T06:41:55.635Z",
  "submitted_at": "2024-04-06T06:41:56.181Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hillybot_",
    "url": "/hillybot_",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzYwOTgzNSwicHVyIjoiYmxvYl9pZCJ9fQ==--36243f8d16c46c73ed16ee423ec4403fb9475b0a/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/perfil.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-05-15T16:36:35.956Z",
  "bug_reporter_agreed_on_going_public_at": "2024-05-03T16:22:11.775Z",
  "team_member_agreed_on_going_public_at": "2024-05-15T16:36:35.429Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "hello team\nin my recent testing i found that any users could upload attachments to any users pentest scoping form without having access to it as long as they have the scope id.\nnote: before you start you will require two account to test for this bug.\nsteps to reproduce:\n1. create a sandbox\n2. go to pentest an start an pentest form\n3.copy the pentest form id from the url\n4. log in to your second account\n5. send the following request\n==================================================================================================================\nPOST /attachments HTTP/2\nHost: hackerone.com\nCookie: your cookies\n-----------------------------22121373215470710503552942440\nContent-Disposition: form-data; name=\"tracer\"\n\n989953fa-5635-43c9-b584-48736d224b15\n-----------------------------22121373215470710503552942440\nContent-Disposition: form-data; name=\"context_type\"\n\nPentestOpportunity\n-----------------------------22121373215470710503552942440\nContent-Disposition: form-data; name=\"file\"; filename=\"does not have a option to change his own permission.png\"\nContent-Type: image/png\n\n====================================================================================================================\n6.from your previous account reload the scoping form and go to review and submit .\n7. you will notice that the file have been successfully uploaded.\n\n## Impact\n\nbusiness logic error\ncould attach malicious files to anyones scoping form.",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-06-02T16:22:11.979Z",
  "allow_singular_disclosure_after": -41049311.704996295,
  "singular_disclosure_allowed": true,
  "vote_count": 113,
  "voters": [
    "t3l3sc0p3",
    "a_b_d_e_l_r_a_h_m_a_n",
    "the_cyb0rg",
    "dinesh_goud",
    "ezzra",
    "d3xterv",
    "aboalezz",
    "loaymorad",
    "0xtarun",
    "8910jq",
    "and 103 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 449092,
      "category": "team",
      "content": "The root cause of this issue appears to be insufficient access controls implemented in the attachment upload functionality for pentest scoping forms. The endpoint responsible for handling attachment uploads did not properly validate the user's access rights to the specific scoping form, allowing any authenticated user to upload files as long as they had the scoping form ID.\n\nAccording to the engineering team, the scoping form can be \"accessed\" by any signed in account, but they should not be able to access data/send mutations without authorization (the attachment controller logic is separate from the pentest opportunity's mutations). So a non-authorized signed in user would just see an empty scoping form that they cannot autosave/submit. \n\nAs a result of this, a fix has been implemented to prevent attachment uploads for non-org members of the scoping form.",
      "updated_at": "2024-05-15T16:32:59.268Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2316130,
        "username": "derek_rq40p",
        "name": "k m",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2022-04-18T18:58:35.545Z",
        "url": "https://hackerone.com/derek_rq40p",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/gw9nnz8cahouni343cjc79qt7ztt/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gw9nnz8cahouni343cjc79qt7ztt/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTIxNzk3OCwicHVyIjoiYmxvYl9pZCJ9fQ==--c53c639372167d09bcec4627bcca915a7262d45d/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/calvin_and_hobbes.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
