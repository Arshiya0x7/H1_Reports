{
  "id": 3250117,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjUwMTE3",
  "url": "https://hackerone.com/reports/3250117",
  "title": "Uncontrolled File Write/Arbitrary File Creation ",
  "state": "Closed",
  "substate": "not-applicable",
  "severity_rating": "high",
  "readable_substate": "N/A",
  "created_at": "2025-07-13T16:50:47.385Z",
  "submitted_at": "2025-07-13T16:50:47.600Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "freemaz",
    "url": "/freemaz",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/515x9p4juwfif449ulrmwtmsfqao/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-07-13T17:12:26.448Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-07-13T17:06:33.492Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Description\n\nThe dumpeasysrc function in the provided code snippet allows an attacker to specify an arbitrary file path for outputting the generated libcurl source code via the global->libcurl variable. If the global->libcurl value is not properly sanitized or restricted, a malicious user could provide a path to a sensitive system file (e.g., /etc/passwd, /etc/cron.d/malicious_job, user's .bashrc, etc.) or a device file (e.g., /dev/null, /dev/random).\n\nThe core issue is that fopen(o, FOPEN_WRITETEXT) is called directly with o = global->libcurl without any checks on the path provided.\n\n# Vulnerable code \n\n```\nvoid dumpeasysrc(struct GlobalConfig *global)\n{\n  struct curl_slist *ptr;\n  char *o = global->libcurl; // <--- 'o' holds the user-supplied file path\n\n  FILE *out;\n  bool fopened = FALSE;\n  if(strcmp(o, \"-\")) {\n    out = fopen(o, FOPEN_WRITETEXT); // <--- Direct use of user-supplied path in fopen()\n    fopened = TRUE;\n  }\n  else\n    out = stdout;\n  // ... rest of the function writes data to 'out'\n}\n```\n\n# Proof of Concept (POC) to Prove Real Vulnerability and Step-by-Step\nI will demonstrate overwriting a user-created, non-critical file within a standard temporary directory. This is easily reproducible and clearly shows the integrity impact without attempting to directly compromise critical system files, which might be blocked by OS permissions for a regular user.\n\n1. Create a distinctive, dummy file in a temporary location:\n```\necho \"This is the ORIGINAL content of the file.\" > /tmp/curl_test_overwrite.txt\nls -l /tmp/curl_test_overwrite.txt\ncat /tmp/curl_test_overwrite.txt\n```\n\n{F4561625}\n\n2. Execute the vulnerable curl command to overwrite the file:\nAssuming your curl executable (the one you built with the vulnerable code) is accessible in your PATH or you're running it with ./curl.\n\n#Curl Version\n```\n└─# ./curl -V                                                        \nWARNING: this libcurl is Debug-enabled, do not use in production\n\ncurl 8.15.0-DEV (x86_64-pc-linux-gnu) libcurl/8.15.0-DEV zlib/1.3.1 libpsl/0.21.2\nRelease-Date: [unreleased]\nProtocols: dict file ftp gopher http imap ipfs ipns mqtt pop3 rtsp smtp telnet tftp ws\nFeatures: alt-svc AsynchDNS Debug IPv6 Largefile libz PSL threadsafe TrackMemory UnixSockets\n```\n\n```\n./curl --libcurl /tmp/curl_test_overwrite.txt http://example.com\n```\n\n{F4561649}\n\nUsing http://example.com is better than google.com as it avoids potential redirects and makes the curl output simpler, focusing on the --libcurl aspect.\n\n3. Verify the content of the file after the curl execution:\n```\ncat /tmp/curl_test_overwrite.txt\n```\n\nThe content of /tmp/curl_test_overwrite.txt will be replaced by the generated libcurl C code. It will look something like this:\n\n{F4561653}\n\n## Impact\n\nData Corruption/Loss: Arbitrary files can be overwritten with the generated libcurl C source code.",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4561625,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zyqsl188f27stzcnro9j1ib5x6xy?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6SLENE7J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T164744Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIFLzjchYQ1D3DxOiTc3EodcOJJprpmZl0pZ58dzTFxqAAiACygZW4LpnJ7NDO95lny6LXlUTKJ11dPmqir2w1rueHiq6BQju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMfT6Mmkszwa3mqDYyKo4FjTuddmcR6Bvb6C5Fn7HYsdeDu5nAmr%2BhSPXVNd2No4hh6oL75C%2FNS38ABlCUnng3UPFdrZtJWQgI3eVBnypfvOss%2BHboUpeljoK2txGdm6uWOZbcik0OeuuGx6xv8%2Bpa8tetbVfENnhna5JTs8tosCWsPuErVxVjrU%2FxT8m%2F%2B4KktTZ5KoM7s1yZzRuNjUbAIu7rfwrhMwQVj3FOrUrtGxbD97BIKEOeKhpepkCbIoBhX1K4w4snumbm7pEqj5P9xzsOjQ%2Fe5SbhUqkZmR3H%2Fiq%2FfW4oOTJ27YGWVP9TR3qQqnWi3mu5wKfxfiuFio4BORZlVmGObQIfexT5I7xB01aztHhxtU45ODL1sUHSDPwjFBX4cHzXgJqrzcgzG9TYoaTlf0pQunoR8xTDl4SdZovjoYvE2LNCm4gHdDz%2F%2BSMnQffb%2BPi25ASqqBZrpc%2BGU5PsvnIP0a6yJpRpeVRd5ORm65fp55iGEOb%2F3oVe6lz2WQgjssBHzxQ8Q1zj%2FN7Y0sh%2FFD0BzigcmX6tU9Lm0BAnPbIfUDeGFEvOUmB5UpltMJ1cePypFzQqS9hyJhDlvbZCbFyF2m8k1vtWy7Hd%2F58EOZ367t7DQ4rHQ9aIX81NkQgERsehsElxnV5W88EU0aXx7hAE5g11RpMR6c2t8IxfTss%2FT82flZCbldj7xr8zVj0G1sR6mUlja%2FPWo1NlvvHUj5DGuGc5PbEuo5bLjfo8yH0CnAQqfcAFAoczQk3Gf3p221d%2BRCLXex2aneU4KZB%2BTWbvvD2kNQ2oQdQ21AFOxJNe7H5nENkZc6rr%2BUAuwZ%2BkJQV%2FSZreMWjqXtGOSOxYtXN7nPR1oQHaOiC8kpUOxvR5p0lQ%2BhnO4Za1MLjHusYGOrIBQ9Tv0XlbHTWtvbiKQfQ%2F7%2F%2FSg747%2BdF1ddE4xyp7%2F3VcdiuPqKGmjKV4okTQ9MIlDzQsduUVf2B5PaSvuFRo58dvU2osmvuW8sQWtaXHteNFl%2B%2BTqMi1c9wOw6iVTbt59OJfLFKx%2FWwIApAY3ac4raYSjRrcaJdGg3TRWHBLasEXkB4JiAhDOATCTvFFtqhS7%2FvIfSthzt%2BeBpFYn7xkCqdx5LN%2B0cfF6fMTufHFBaG52g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=35f5546866eaabb701f1e1f15225948fe1a8fbfedb832425c1342527c6301d57",
      "file_size": 25812,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4561649,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rjtl7vj3xq6tbsmh2lvlgvvkr38t?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6SLENE7J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T164744Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIFLzjchYQ1D3DxOiTc3EodcOJJprpmZl0pZ58dzTFxqAAiACygZW4LpnJ7NDO95lny6LXlUTKJ11dPmqir2w1rueHiq6BQju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMfT6Mmkszwa3mqDYyKo4FjTuddmcR6Bvb6C5Fn7HYsdeDu5nAmr%2BhSPXVNd2No4hh6oL75C%2FNS38ABlCUnng3UPFdrZtJWQgI3eVBnypfvOss%2BHboUpeljoK2txGdm6uWOZbcik0OeuuGx6xv8%2Bpa8tetbVfENnhna5JTs8tosCWsPuErVxVjrU%2FxT8m%2F%2B4KktTZ5KoM7s1yZzRuNjUbAIu7rfwrhMwQVj3FOrUrtGxbD97BIKEOeKhpepkCbIoBhX1K4w4snumbm7pEqj5P9xzsOjQ%2Fe5SbhUqkZmR3H%2Fiq%2FfW4oOTJ27YGWVP9TR3qQqnWi3mu5wKfxfiuFio4BORZlVmGObQIfexT5I7xB01aztHhxtU45ODL1sUHSDPwjFBX4cHzXgJqrzcgzG9TYoaTlf0pQunoR8xTDl4SdZovjoYvE2LNCm4gHdDz%2F%2BSMnQffb%2BPi25ASqqBZrpc%2BGU5PsvnIP0a6yJpRpeVRd5ORm65fp55iGEOb%2F3oVe6lz2WQgjssBHzxQ8Q1zj%2FN7Y0sh%2FFD0BzigcmX6tU9Lm0BAnPbIfUDeGFEvOUmB5UpltMJ1cePypFzQqS9hyJhDlvbZCbFyF2m8k1vtWy7Hd%2F58EOZ367t7DQ4rHQ9aIX81NkQgERsehsElxnV5W88EU0aXx7hAE5g11RpMR6c2t8IxfTss%2FT82flZCbldj7xr8zVj0G1sR6mUlja%2FPWo1NlvvHUj5DGuGc5PbEuo5bLjfo8yH0CnAQqfcAFAoczQk3Gf3p221d%2BRCLXex2aneU4KZB%2BTWbvvD2kNQ2oQdQ21AFOxJNe7H5nENkZc6rr%2BUAuwZ%2BkJQV%2FSZreMWjqXtGOSOxYtXN7nPR1oQHaOiC8kpUOxvR5p0lQ%2BhnO4Za1MLjHusYGOrIBQ9Tv0XlbHTWtvbiKQfQ%2F7%2F%2FSg747%2BdF1ddE4xyp7%2F3VcdiuPqKGmjKV4okTQ9MIlDzQsduUVf2B5PaSvuFRo58dvU2osmvuW8sQWtaXHteNFl%2B%2BTqMi1c9wOw6iVTbt59OJfLFKx%2FWwIApAY3ac4raYSjRrcaJdGg3TRWHBLasEXkB4JiAhDOATCTvFFtqhS7%2FvIfSthzt%2BeBpFYn7xkCqdx5LN%2B0cfF6fMTufHFBaG52g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c3a1dae45979725136f0d3eb299a13276eca93f7ed058656f8e9d55b36095f00",
      "file_size": 76369,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4561653,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/svqhvmk4zvxc51e5bpxfjb9zadr0?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6SLENE7J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T164744Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIFLzjchYQ1D3DxOiTc3EodcOJJprpmZl0pZ58dzTFxqAAiACygZW4LpnJ7NDO95lny6LXlUTKJ11dPmqir2w1rueHiq6BQju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMfT6Mmkszwa3mqDYyKo4FjTuddmcR6Bvb6C5Fn7HYsdeDu5nAmr%2BhSPXVNd2No4hh6oL75C%2FNS38ABlCUnng3UPFdrZtJWQgI3eVBnypfvOss%2BHboUpeljoK2txGdm6uWOZbcik0OeuuGx6xv8%2Bpa8tetbVfENnhna5JTs8tosCWsPuErVxVjrU%2FxT8m%2F%2B4KktTZ5KoM7s1yZzRuNjUbAIu7rfwrhMwQVj3FOrUrtGxbD97BIKEOeKhpepkCbIoBhX1K4w4snumbm7pEqj5P9xzsOjQ%2Fe5SbhUqkZmR3H%2Fiq%2FfW4oOTJ27YGWVP9TR3qQqnWi3mu5wKfxfiuFio4BORZlVmGObQIfexT5I7xB01aztHhxtU45ODL1sUHSDPwjFBX4cHzXgJqrzcgzG9TYoaTlf0pQunoR8xTDl4SdZovjoYvE2LNCm4gHdDz%2F%2BSMnQffb%2BPi25ASqqBZrpc%2BGU5PsvnIP0a6yJpRpeVRd5ORm65fp55iGEOb%2F3oVe6lz2WQgjssBHzxQ8Q1zj%2FN7Y0sh%2FFD0BzigcmX6tU9Lm0BAnPbIfUDeGFEvOUmB5UpltMJ1cePypFzQqS9hyJhDlvbZCbFyF2m8k1vtWy7Hd%2F58EOZ367t7DQ4rHQ9aIX81NkQgERsehsElxnV5W88EU0aXx7hAE5g11RpMR6c2t8IxfTss%2FT82flZCbldj7xr8zVj0G1sR6mUlja%2FPWo1NlvvHUj5DGuGc5PbEuo5bLjfo8yH0CnAQqfcAFAoczQk3Gf3p221d%2BRCLXex2aneU4KZB%2BTWbvvD2kNQ2oQdQ21AFOxJNe7H5nENkZc6rr%2BUAuwZ%2BkJQV%2FSZreMWjqXtGOSOxYtXN7nPR1oQHaOiC8kpUOxvR5p0lQ%2BhnO4Za1MLjHusYGOrIBQ9Tv0XlbHTWtvbiKQfQ%2F7%2F%2FSg747%2BdF1ddE4xyp7%2F3VcdiuPqKGmjKV4okTQ9MIlDzQsduUVf2B5PaSvuFRo58dvU2osmvuW8sQWtaXHteNFl%2B%2BTqMi1c9wOw6iVTbt59OJfLFKx%2FWwIApAY3ac4raYSjRrcaJdGg3TRWHBLasEXkB4JiAhDOATCTvFFtqhS7%2FvIfSthzt%2BeBpFYn7xkCqdx5LN%2B0cfF6fMTufHFBaG52g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ea018c5335df9af56475192ad08f5d6e83132af4b16145a01c04b51b6c8a265c",
      "file_size": 83872,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 20,
  "voters": [
    "2026",
    "nischalxd",
    "thalaivar304",
    "zephyr31337",
    "capital_m0ney",
    "unique-harvest-80",
    "nexreign",
    "cybflawless",
    "brasil1",
    "richlegit27",
    "and 10 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
