{
  "id": 805013,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDUwMTM=",
  "url": "https://hackerone.com/reports/805013",
  "title": "DirectoryIterator class silently truncates after a null byte",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-02-26T05:07:29.054Z",
  "submitted_at": "2020-02-26T05:07:29.054Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ryat",
    "url": "/ryat",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/wfyfjk9cawbuzqqdx88azrvxmqt6/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67?response-content-disposition=inline%3B%20filename%3D%22chtg.jpeg%22%3B%20filename%2A%3DUTF-8%27%27chtg.jpeg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYGJLCUIC%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T082903Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHDrCN2CiN2Tx12uS%2F0bVNpMFmIANVesbFOJi2n3IlEcAiBIlWwJKWctifVWLod2YkTIOhqiqXK6K0Aigt8rLYPyIiq6BQj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMw6g1dvl6aThDm%2BTuKo4Fg75uWuN3qPFsZGOieLLU0L0I6OfisU01HeY1hC4Fi6ykD8ZQ68E1uF7DYy6Dz6WST8HP7Qs3WzSeyTtrUdQ2eAOqqcCaJk0cnGHgNOJaNht04wNTPXojMaEXcZOMyU6ABFQMdQGbh2dAeViwRQOHK49j05s6VRqhLscLAfVO2khyVYXl%2Bzb3Fef71GYPIjpMicfUbCRF4VSQTWOKsCHec%2B6ux6GCvRPa40tsOQcSaPwGraZdk830sG7JjclbyaPLQWmHiw1I%2BsVLh7WsSLITL9FVwN036b83C0ZvWEiiE4j0b%2BdaUeFDH6r1wnXD7gatrkWraZDB1xe9ZgKn5u80vjN7Q9oFf1hMvj6I4ixHfYEiKT4jJk5acwh5p%2FiYv7Q%2F6I4xTaQF%2Ft0wOKviCzcSRb00Zyq%2FgdZSwYYTkbWdwEju7qA7aMiPNtXEiXa1iBOFPyOvh4TWiM7YXj16Nq1mzBXVxlTEekh9UKLrHuyJkHYhKvvzV%2BWz3uIWe1yWsDcYe2VLlEmeAg8CUxJDX1EcBx%2BvIdTV1To2Y45HkF%2FovRESM7l0M4Mrq7ZAYdzjE%2FrTKg1pY3crPRD7flK4YisvFhxwyIpEveDFkXaOckgLYZyDJUzdrpuBixJPeIreN2md6GjzESUF3Qi7fFEGeS8MR3AguXuZ4FayUBmGNASnjEwlNmblTPdXpTuwxi9AmenxneasBp%2FM64pUQ18t8ST8VoKILKavJALb9Zizuvz53qlMwXq1aQ0LqXmFWmj8A3%2FTh9r9mKu81OcW7%2Fi7xeQIuHAHGWrnnm2VIkkyEunpNmA3lB9KegSzqPx%2BEufHZH4vNu3j0PcBBryZdSkKtCFOrYAkUmxjA5NBX2KEW6vAMN%2BmvsYGOrIBxoxRsMtJOu7WzzAR6pJ28DwFNMhGRqHDtsEPvSDk7njNW9wOvGZ%2BAxF%2F7bk961Z71X8vxqd0ywIKZSS0GZk7hboE8T466bNcuckixP1vX%2FL1RvyO4%2Blj16VlBFWrYXPZNKNWOS0jX%2F7sv7lYYbcXGAQgMrD41ysGpftPFM3dzhSdA8oEycBJQc8D7wnwBmE18gkcrL3Hb5rsCBFm8eAENQa8Vwm4F1AN8CQjFKj%2Bxb2AVg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e6f730eb3ae53ebc8eb28dc6d92f6f2c69fc6d0b05ff1e0671890a14116febaf"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYGJLCUIC%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T082903Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHDrCN2CiN2Tx12uS%2F0bVNpMFmIANVesbFOJi2n3IlEcAiBIlWwJKWctifVWLod2YkTIOhqiqXK6K0Aigt8rLYPyIiq6BQj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMw6g1dvl6aThDm%2BTuKo4Fg75uWuN3qPFsZGOieLLU0L0I6OfisU01HeY1hC4Fi6ykD8ZQ68E1uF7DYy6Dz6WST8HP7Qs3WzSeyTtrUdQ2eAOqqcCaJk0cnGHgNOJaNht04wNTPXojMaEXcZOMyU6ABFQMdQGbh2dAeViwRQOHK49j05s6VRqhLscLAfVO2khyVYXl%2Bzb3Fef71GYPIjpMicfUbCRF4VSQTWOKsCHec%2B6ux6GCvRPa40tsOQcSaPwGraZdk830sG7JjclbyaPLQWmHiw1I%2BsVLh7WsSLITL9FVwN036b83C0ZvWEiiE4j0b%2BdaUeFDH6r1wnXD7gatrkWraZDB1xe9ZgKn5u80vjN7Q9oFf1hMvj6I4ixHfYEiKT4jJk5acwh5p%2FiYv7Q%2F6I4xTaQF%2Ft0wOKviCzcSRb00Zyq%2FgdZSwYYTkbWdwEju7qA7aMiPNtXEiXa1iBOFPyOvh4TWiM7YXj16Nq1mzBXVxlTEekh9UKLrHuyJkHYhKvvzV%2BWz3uIWe1yWsDcYe2VLlEmeAg8CUxJDX1EcBx%2BvIdTV1To2Y45HkF%2FovRESM7l0M4Mrq7ZAYdzjE%2FrTKg1pY3crPRD7flK4YisvFhxwyIpEveDFkXaOckgLYZyDJUzdrpuBixJPeIreN2md6GjzESUF3Qi7fFEGeS8MR3AguXuZ4FayUBmGNASnjEwlNmblTPdXpTuwxi9AmenxneasBp%2FM64pUQ18t8ST8VoKILKavJALb9Zizuvz53qlMwXq1aQ0LqXmFWmj8A3%2FTh9r9mKu81OcW7%2Fi7xeQIuHAHGWrnnm2VIkkyEunpNmA3lB9KegSzqPx%2BEufHZH4vNu3j0PcBBryZdSkKtCFOrYAkUmxjA5NBX2KEW6vAMN%2BmvsYGOrIBxoxRsMtJOu7WzzAR6pJ28DwFNMhGRqHDtsEPvSDk7njNW9wOvGZ%2BAxF%2F7bk961Z71X8vxqd0ywIKZSS0GZk7hboE8T466bNcuckixP1vX%2FL1RvyO4%2Blj16VlBFWrYXPZNKNWOS0jX%2F7sv7lYYbcXGAQgMrD41ysGpftPFM3dzhSdA8oEycBJQc8D7wnwBmE18gkcrL3Hb5rsCBFm8eAENQa8Vwm4F1AN8CQjFKj%2Bxb2AVg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9145a52fcda6a3b57fe0210b2c814148d857e280579077226441964f0916584d",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYGJLCUIC%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T082903Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHDrCN2CiN2Tx12uS%2F0bVNpMFmIANVesbFOJi2n3IlEcAiBIlWwJKWctifVWLod2YkTIOhqiqXK6K0Aigt8rLYPyIiq6BQj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMw6g1dvl6aThDm%2BTuKo4Fg75uWuN3qPFsZGOieLLU0L0I6OfisU01HeY1hC4Fi6ykD8ZQ68E1uF7DYy6Dz6WST8HP7Qs3WzSeyTtrUdQ2eAOqqcCaJk0cnGHgNOJaNht04wNTPXojMaEXcZOMyU6ABFQMdQGbh2dAeViwRQOHK49j05s6VRqhLscLAfVO2khyVYXl%2Bzb3Fef71GYPIjpMicfUbCRF4VSQTWOKsCHec%2B6ux6GCvRPa40tsOQcSaPwGraZdk830sG7JjclbyaPLQWmHiw1I%2BsVLh7WsSLITL9FVwN036b83C0ZvWEiiE4j0b%2BdaUeFDH6r1wnXD7gatrkWraZDB1xe9ZgKn5u80vjN7Q9oFf1hMvj6I4ixHfYEiKT4jJk5acwh5p%2FiYv7Q%2F6I4xTaQF%2Ft0wOKviCzcSRb00Zyq%2FgdZSwYYTkbWdwEju7qA7aMiPNtXEiXa1iBOFPyOvh4TWiM7YXj16Nq1mzBXVxlTEekh9UKLrHuyJkHYhKvvzV%2BWz3uIWe1yWsDcYe2VLlEmeAg8CUxJDX1EcBx%2BvIdTV1To2Y45HkF%2FovRESM7l0M4Mrq7ZAYdzjE%2FrTKg1pY3crPRD7flK4YisvFhxwyIpEveDFkXaOckgLYZyDJUzdrpuBixJPeIreN2md6GjzESUF3Qi7fFEGeS8MR3AguXuZ4FayUBmGNASnjEwlNmblTPdXpTuwxi9AmenxneasBp%2FM64pUQ18t8ST8VoKILKavJALb9Zizuvz53qlMwXq1aQ0LqXmFWmj8A3%2FTh9r9mKu81OcW7%2Fi7xeQIuHAHGWrnnm2VIkkyEunpNmA3lB9KegSzqPx%2BEufHZH4vNu3j0PcBBryZdSkKtCFOrYAkUmxjA5NBX2KEW6vAMN%2BmvsYGOrIBxoxRsMtJOu7WzzAR6pJ28DwFNMhGRqHDtsEPvSDk7njNW9wOvGZ%2BAxF%2F7bk961Z71X8vxqd0ywIKZSS0GZk7hboE8T466bNcuckixP1vX%2FL1RvyO4%2Blj16VlBFWrYXPZNKNWOS0jX%2F7sv7lYYbcXGAQgMrD41ysGpftPFM3dzhSdA8oEycBJQc8D7wnwBmE18gkcrL3Hb5rsCBFm8eAENQa8Vwm4F1AN8CQjFKj%2Bxb2AVg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cb75b137e9d75e8a4079e0c40ff3ea7a26081ff8d54cd4bf6a54e4ab13442c69"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-11045"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-11-09T01:47:49.014Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-10-10T01:47:45.034Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The bug submitted at: https://bugs.php.net/bug.php?id=78863\nThe security advisory at: https://nvd.nist.gov/vuln/detail/CVE-2019-11045\n\nThere's an issue with SPL PHP extension on spl_filesystem_object_construct() function. When creating a new DirectoryIterator() object spl_filesystem_object_construct() function is called and use zend to parse its arguments with the wrong parameter type specifier, this bug leads the zend_parse_parameters() to interprete the parameter as a simple string instead of a filesystem path. An attacker may leverage this by crafting a path name containing NULL bytes which will be badly parsed, allowing the attacker eventually by pass any path-based security validation or listing documents from a unexpected directory.\n\nThis flaw has a high Confidentiality impact as the actor may eventually seen the filesystem tree from the attacked machine but a high complexity as the attacker may need to have previous knowledge of filesystem organization or trick the user to run the malicious script.\n\n## Impact\n\nIn PHP versions 7.2.x below 7.2.26, 7.3.x below 7.3.13 and 7.4.0, PHP DirectoryIterator class accepts filenames with embedded \\0 byte and treats them as terminating at that byte. This could lead to security vulnerabilities, e.g. in applications checking paths that the code is allowed to access.",
  "weakness": {
    "id": 14,
    "name": "Improper Null Termination"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-11-09T01:47:45.125Z",
  "allow_singular_disclosure_after": -153556878.5271616,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "eye_"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 84120,
    "asset_type": "OTHER",
    "asset_identifier": "PHP",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
