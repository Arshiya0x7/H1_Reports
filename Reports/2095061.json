{
  "id": 2095061,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDk1MDYx",
  "url": "https://hackerone.com/reports/2095061",
  "title": "Jitsi: Bridge Message Spoofing due to Improper JSON Handling leads to Prototype Pollution",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-08-03T15:51:03.333Z",
  "submitted_at": "2023-08-03T15:51:03.499Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "afewgoats",
    "url": "/afewgoats",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Wh2oXLjukEvjyT9sbA4nJUai/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 49732,
    "url": "https://hackerone.com/8x8-bounty",
    "handle": "8x8-bounty",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3y22a5r49ryw4d4454msmh3frrgn/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3y22a5r49ryw4d4454msmh3frrgn/74790fe75ac5dbe8a5140a122388d59ebac913dcfa941f0b3a45e6cad161f9ea"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "8x8",
      "twitter_handle": "8x8",
      "website": "https://www.8x8.com",
      "about": "Let's power your CX ambitions."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-08-26T01:39:54.384Z",
  "bug_reporter_agreed_on_going_public_at": "2024-08-24T05:36:21.484Z",
  "team_member_agreed_on_going_public_at": "2024-08-26T01:39:54.169Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-09-23T05:36:21.682Z",
  "allow_singular_disclosure_after": -31322543.990447216,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "g3ksec",
    "0xcyborg",
    "roland_hack",
    "zy9ard3",
    "shreyaschavhan",
    "thalaivar304",
    "sayemrahman",
    "dilmuradd",
    "kvista",
    "failbutwinn",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 50509,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/jitsi",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 515712,
      "category": "team",
      "content": "The Jitsi VideoBridge failed to properly handle JSON messages with duplicate `colibriClass` keys, enabling clients to send messages interpreted differently by the bridge and resulting in unauthorized actions within video conferences.\n\nJitsi Security Advisory has been published:\nhttps://github.com/jitsi/security-advisories/blob/master/advisories/JSA-2023-0001.md\n\nChanges:\n* (lib-jitsi-meet) `fix(misc) use safeJsonParse from js-utils`\n  * https://github.com/jitsi/lib-jitsi-meet/pull/2332\n* (jitsi-meet) `fix(misc) use safeJsonParse from js-utils`\n  * https://github.com/jitsi/jitsi-meet/pull/13673\n* (jitsi-videobridge) `ref: Cleanup BridgeChannelMessage (remove unnecessary type field).`\n  * https://github.com/jitsi/jitsi-videobridge/pull/2039\n\n\n\n\nWe thank @afewgoats for submitting this report to us.",
      "updated_at": "2024-08-26T01:38:21.332Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1396122,
        "username": "42x42",
        "name": "42x42",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://www.8x8.com",
        "location": "ðŸ‡¸ðŸ‡¬",
        "created_at": "2020-11-18T00:49:52.176Z",
        "url": "https://hackerone.com/42x42",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/p5MamdFnZA4rBtyPUnAs8HsG/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/p5MamdFnZA4rBtyPUnAs8HsG/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTIzMTc5NiwicHVyIjoiYmxvYl9pZCJ9fQ==--3c9699ba938d2b401b93e0aafb24106e33b05788/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/Screenshot%202020-11-18%20at%201.25.03%20PM.png"
        }
      }
    },
    {
      "id": 515684,
      "category": "researcher",
      "content": "Video call participants use a WebSocket to send and receive JSON messages via the Jitsi Videobridge. Participants can only send certain message types (endpoint statistics). The other message types (e.g. set video sources and other control messages) can only be sent by the server.\n\nThis vulnerability allowed participants to send any message type by sending JSON containing a duplicate key.\n\n```json\n{\"colibriClass\":\"EndpointStats\",\"colibriClass\":\"ForwardedSources\",...}\n```\n\nVideobridge, using Jackson, determines the message type from the **first** `colibriClass` value. If it is an allowed type, the message is forwarded to participants. Upon receiving the forwarded message, the clients, parsing JSON with JavaScript, determine the message type from the **last** `colibriClass` value and act on it. This may be a server-only message type.\n\nOverall, while it's a fun bug, the impact was mainly limited to DoS against targeted participants and swapping video sources around.",
      "updated_at": "2024-08-26T01:13:36.584Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 243202,
        "username": "afewgoats",
        "name": "afewgoatsÂ°ÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒÍŒ",
        "bio": "breaking computers for tips",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2018-02-19T23:05:01.443Z",
        "url": "https://hackerone.com/afewgoats",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/Wh2oXLjukEvjyT9sbA4nJUai/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/Wh2oXLjukEvjyT9sbA4nJUai/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/Wh2oXLjukEvjyT9sbA4nJUai/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    }
  ]
}
