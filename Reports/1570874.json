{
  "id": 1570874,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTcwODc0",
  "url": "https://hackerone.com/reports/1570874",
  "title": "Arbitrary file read from Cloudflare Pages build environment",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-05-15T12:12:27.611Z",
  "submitted_at": "2022-05-15T12:12:27.620Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ryotak",
    "url": "/ryotak",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 41,
    "url": "https://hackerone.com/cloudflare",
    "handle": "cloudflare",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Cloudflare Public Bug Bounty",
      "twitter_handle": "cloudflare",
      "website": "https://www.cloudflare.com/disclosure",
      "about": "Help us build a better Internet"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-02-23T02:03:32.191Z",
  "bug_reporter_agreed_on_going_public_at": "2024-02-23T02:03:31.897Z",
  "team_member_agreed_on_going_public_at": "2024-02-14T14:10:19.170Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 39,
  "voters": [
    "matured_kazama",
    "thlassche",
    "g0ko",
    "roland_hack",
    "zy9ard3",
    "7odamoo",
    "ronak_9889",
    "shubham_srt",
    "jub0bs",
    "nischalxd",
    "and 29 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 387183,
      "category": "team",
      "content": "Cloudflare Pages provides users a feature to set redirects and headers in their Pages website. Due to a vulnerability in this feature, it was discovered that an attacker could escalate privileges to root during the build process, which would have enabled them to read filesystem files which he would otherwise be unable to. Cloudflare's engineering team resolved the issue by implementing more restrictive input validation on the redirects and headers feature, however it is important to note that the build environment is scoped to each Pages project, so an attacker could not arbitrarily read files of other project or users.",
      "updated_at": "2023-12-22T11:59:41.012Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2481943,
        "username": "ncabete",
        "name": "Nelson Cabete",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2022-10-13T16:59:19.826Z",
        "url": "https://hackerone.com/ncabete",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "id": 387204,
      "category": "researcher",
      "content": "Using this vulnerability, we found two more vulnerabilities, which allowed us to read files of other projects or tamper with other projects.\nFor the details about the chains of vulnerabilities, please refer to the following articles:\n- English: https://ec0.io/post/hacking-cloudflare-pages-part-2/\n- Japanese: https://blog.ryotak.net/post/cloudflare-pages-privesc-and-page-tampering/\n",
      "updated_at": "2023-12-23T01:34:34.340Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 569456,
        "username": "ryotak",
        "name": "RyotaK",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": "https://ryotak.net",
        "location": "",
        "created_at": "2019-04-04T07:16:31.098Z",
        "url": "https://hackerone.com/ryotak",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzM1NzUyLCJwdXIiOiJibG9iX2lkIn19--4a81390f64fe60af2e81fe4aa64c3a4ccad7c709/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/drmYzeQn.jpg"
        }
      }
    }
  ]
}
