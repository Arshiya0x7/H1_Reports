{
  "id": 210188,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTAxODg=",
  "url": "https://hackerone.com/reports/210188",
  "title": "Subdomain takeover on https://cloudfront.ubnt.com/ due to non-used CloudFront DNS entry",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-03-02T20:15:54.196Z",
  "submitted_at": "2017-03-02T20:15:54.196Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "linkks",
    "url": "/linkks",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 800,
    "url": "https://hackerone.com/ui",
    "handle": "ui",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fpqjzgms7de9639u414bw6vid1be/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fpqjzgms7de9639u414bw6vid1be/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ubiquiti Inc.",
      "twitter_handle": "ubiquiti",
      "website": "https://ui.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-05-07T18:18:34.562Z",
  "bug_reporter_agreed_on_going_public_at": "2017-04-07T18:18:31.297Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "So lately I have discovered that CloudFront is not validating which user that connects a CNAME:d domain to a CloudFront Origin. This means that if I could find a domain that is still pointing to CloudFront, without being connected to any Origin as a Custom CNAME, I can actually claim the domain myself and point it to whatever I want.\n\ndig cloudfront.ubnt.com\n\n; <<>> DiG 9.10.3-P4-Debian <<>> cloudfront.ubnt.com\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 52550\n;; flags: qr rd ra; QUERY: 1, ANSWER: 9, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;cloudfront.ubnt.com. IN A\n\n;; ANSWER SECTION:\ncloudfront.ubnt.com. 268 IN CNAME du6drkqe7qw4g.cloudfront.net.\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.58\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.143\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.238\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.216\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.144\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.190\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.55\ndu6drkqe7qw4g.cloudfront.net. 29 IN A 52.222.171.71\n\n;; Query time: 7 msec\n;; SERVER: 192.168.1.1#53(192.168.1.1)\n;; WHEN: Wed Feb 22 03:26:49 MSK 2017\n;; MSG SIZE rcvd: 218\n\n;; ANSWER SECTION:\ncloudfront.ubnt.com. 268 IN CNAME du6drkqe7qw4g.cloudfront.net.\n\nYou should most likely just remove the DNS-entry for this domain, and also make sure you constantly remove DNS records pointing to CloudFront (and other services as well of course) when you stop using them.\n\nAs you might understand, the consequences of this are pretty bad. I now can serve whatever I like on this domain, even fetching httpOnly cookies. I would also be able to issue an SSL for this domain through AlphaSSL or Let's Encrypt (that only needs meta/file verification to issue the certificate) That would end up with the ability to read secure cookies as well.\n\nAlso, there's no way at all for a visitor of this page to validate that the content on this domain is not served by UBNT, making it extremely easy to utilize this for targeting the organization by fake login forms / spear phishing using your own domain to plant the attack.\n\nYou can read about this sort of attacks here : http://labs.detectify.com/post/109964122636/hostile-subdomain-takeover-using",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 165774,
      "file_name": "1ulCdCJc_1_.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/165/774/a1806cbd24dd3af2bd9522f0fc8bb8afb224823a/1ulCdCJc_1_.png?response-content-disposition=attachment%3B%20filename%3D%221ulCdCJc_1_.png%22%3B%20filename%2A%3DUTF-8%27%271ulCdCJc_1_.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQRADLPHK%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T223941Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCMH60KA5c4oFROILJwlX3Ga3MXZ%2FQYQNX3He4P5AJMdgIhAI1hDx7ub27XNNWCp9HinTwvcqA3lEjxIkGOcLj5rQdFKrIFCB8QAxoMMDEzNjE5Mjc0ODQ5IgwzTtfMSrvLyCvpHrQqjwVnNPlGyR9vDw9obrVNS%2BqlNiaOm1yKVdRt9eI2V9ijVIU4hWJbOx4hIxz86ScjOUQlGsiaOs11KHUGfXtmvvAyPDcyRpacF7YO35qUeUn89mDbuvMsMUUqi%2Fg0xt%2BgbrkEfTNE2vyco49KctdEDPRlf7xnUNpINkPfc5CDxO63v6Qsgwz2aGbUVxflVUQzNe%2F383gzFqvOOe%2BOGNhvLk%2BNgrzwEIN3LiP%2FiYekCZ4Qrh%2Fxxuci6dOTgAhLOf6MRUcuvxk6gm0ZS5skBr1i2fiuLtXeIgyFGOz8WZzKDiqqlrYriAqXDaGjQk%2Bin7HJgX5kxvnMGeTbFktcAwaYCgVUxO5Ym2fM8ZRXozh6w9YKEMc3RrSrAi6kWHkkASDlUDtX%2BF5grXWFiI8S7CakKIYBEnIQRPSqg6hyXvWdOSQ4ZerDQ1Y6NQOqTgPFatWsyOkG9ERqS3xzTB9gZgOeF74fTMBENik7tMmqI%2BFFIcSpepc4nQwZI0hz%2FqdlpcOdcOTkqHEWPjh3TnYFNDPbQm0fsUuMn0EWVCLWw%2F%2FI6qF4RHh93vzm5k%2FyOHNxipVwG0%2BNmF3zggUdvVKx1ON5TDQdPEsG5jogYX087LX9LEIasKhqrkeAaXKRrVaNAOV7jchLC9nPF2cIhTy6TbrhE3Yi0Frp07aG5MDXpT50qAyY%2BRiuTxivHLg4YrgoG31j%2B%2BbuzySwasYcrbRBQN0n0fRLi7st4FH7EyWGt7GpqR9D67XF7F%2F0NK1vXMfbdJto0BEH1od2%2F5H7%2FiGGVFGQJp5RwxgDxqR1UKirZ%2B6Fz0PdAbtPDiefAwx4UWektN2H60isdmgT7x0YAj6meGJzRDCNBCoOmk9Pmi5CJvyIlOKCMPLYwcYGOrABt29w%2BchhXAbUvsBJ081b1qwI3Qr3DqIbHu2OwZtqPAzHrJBXZha0Ycdhe59%2Bt8CDw%2FsA%2B38YO5%2B0krzIm9WZ%2FnDtSasuAbtBBfnoyUYehj4EyqQAZI5j6mW6tXDsJVQi%2FXJ8WhIuCrUgy0s1Cnt2ISgPimsuYS8ZPl7NcXHJ%2BaXeh8QEThxgZdkZUMeUu8CmOlqiAiieTQ6lHVUqjskhMyWo0H%2BeogQ1O%2FJWH6WO0TE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=98b96c6649eca487d4748c85efbf8801f6786653183f28a1f702e8b9ac902721",
      "file_size": 16908,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-05-07T18:18:31.340Z",
  "allow_singular_disclosure_after": -264313269.8816694,
  "singular_disclosure_allowed": true,
  "vote_count": 12,
  "voters": [
    "sameerphad72",
    "cuso4",
    "mpz",
    "eveeez",
    "t4ym",
    "exception",
    "tony_tsep",
    "japz",
    "sumit7",
    "spetr0x",
    "and 2 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 3981,
      "category": "researcher",
      "content": "I see LFI via  SQL injection  that the vulnerability was serious and I have limit report.\nBut team UBNT not reward for me.",
      "updated_at": "2017-05-07T18:27:50.848Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 15691,
        "username": "linkks",
        "name": "Link",
        "bio": "hostsbugbounty@mail.ru",
        "cleared": false,
        "verified": true,
        "website": "https://t.me/Bugbountygroup",
        "location": "Russia",
        "created_at": "2014-12-26T18:37:58.056Z",
        "url": "https://hackerone.com/linkks",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    }
  ]
}
