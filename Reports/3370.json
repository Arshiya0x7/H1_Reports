{
  "id": 3370,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzcw",
  "url": "https://hackerone.com/reports/3370",
  "title": "Directory traversal attack in view resolver",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-03-06T11:13:20.634Z",
  "submitted_at": "2014-03-06T11:13:20.634Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "lautis",
    "url": "/lautis",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22,
    "url": "https://hackerone.com/rails",
    "handle": "rails",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ruby on Rails",
      "twitter_handle": "rails",
      "website": "http://rubyonrails.org/security",
      "about": "Web development that doesn't hurt."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2014-0130"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-07-09T19:15:27.083Z",
  "bug_reporter_agreed_on_going_public_at": "2015-07-09T19:15:26.661Z",
  "team_member_agreed_on_going_public_at": "2015-06-16T19:07:55.100Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "There seems to be two cases that allow directory traversal when using wildcard URL segments that allow rendering view outside view paths.\r\n\r\nFor example, let say there is a route\r\n\r\n\tget '/help/(*action)’, controller: ‘help’\r\n\r\nand a matching controller\r\n\r\n\tclass HelpController < ApplicationController\r\n\tend\r\n\r\nThis renders all views that are in 'app/views/help’ (assuming default view paths) even when matching action method is not defined.\r\n\r\nIf an attacker made a request `GET /help/../../../Gemfile`, ActionView::FileSystemResolver returns Gemfile from project root as the matching view. This simple case can be prevented using Rack::Protection::PathTraversal middleware, but it is not enabled by default in Rails. Also, there could be other mechanisms that may result in rendering views that are outside view path. Not sure if that’s the expected behaviour, but this surprised me.\r\n\r\nHowever, Rack::Protection::PathTraversal can be bypassed using backslashes: `GET /help/%5c../%5c../%5c../Gemfile`. The resolver uses Dir.glob, which escapes backslashes unless File::FNM_NOESCAPE flag is used. Rack::Protection::PathTraversal won’t intercept `'\\../'` and the resolver treats `'\\../`' as `'../'`.\r\n\r\nAttached are fixes for the mentioned vulnerabilities with test cases.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4047,
      "file_name": "0001-Do-not-escape-backslashes-in-view-paths.patch",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/004/047/60fee926e77c2f23eeeda55cf16bdba7d7a44a0c/0001-Do-not-escape-backslashes-in-view-paths.patch?response-content-disposition=attachment%3B%20filename%3D%220001-Do-not-escape-backslashes-in-view-paths.patch%22%3B%20filename%2A%3DUTF-8%27%270001-Do-not-escape-backslashes-in-view-paths.patch&response-content-type=text%2Fx-c%2B%2B&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTP3D4BMZ%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T181746Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC5tkz8YUgMOOnbTR5p7%2FgQZmPf%2FYuaGBRbrH%2BI9HMk7QIhAL99C6vRMvTGnJSrJ%2BNKWfoG6pIPpXuHWFhl6eo0LOLxKrIFCDAQAxoMMDEzNjE5Mjc0ODQ5IgzSywCHJKajOLq99esqjwUvTUYotJJ4mygouYM79fIl6BglwCmFl8pZCPQ6D7vP6%2FP%2Foekr346AUeB46Jb9ApDYmd3BreihNo%2FmDe6DoGQVQKQ%2BYI0iIrvtSUssQwJkKKbtuyv6csn0LW7StKXuWbJe32A%2BIsSHylnsA%2FCt9Nf6v0PpXwv6V9vLR%2Fx7VMQUFlROrPDG8wdb0aihNAo2fw%2B3OPsJqKSo%2BPWiW7ddQz0E%2Fzo8QjHNgWZGo%2Fg036nBAlBDCM7tveOOeCmkYFgdwXuM3XZ5c8eng5%2Bf6SI8NCEAOeTNlflf49LY3lZI6822xazY3oS1Ehen0t6R3uGpGLAK1BB4hp6GykSfiEQ3TpsjoIivNjZSSmf8FD5nixvhxTV6aVPDzBzwhqJJ0WM%2B2ID5UuGZDuWzd67CLsIhqNYuwcagvQEikpA%2BPZkSKTLqx51YbeFU3FR7keiBLiZ6gggPKOGh6Ltigy8%2FEr78qqwPLeNlxnnFgOCUyLFNnsfb2NnxETzZ12a9IrUY8DC%2FYGClWtzRrXImaiJxn%2FxHh4Iz3VfvdEr1uaxL3ePCnWW6azczcJmvt1d7xN5t6oE8PWbh8TME1QdW33oOa9520TfUjitME412AcjBQi1rADbVPizoqHFxuDFOF%2B5QDvzZAFR6Yd%2FMir36GpTK39xLqPOXIbDvi6EkZQdqta%2B2blrPsClQseK5ubuO6%2BQBFEsHugvPhCeom6imMiywD%2Fu484AT118tSneQczpv%2FFMafkLhg78Bvp5D47ZhCjwDtvPu5d7%2BFd98bH1I5il9dzA0S5raMphUB0bJMEIhjDMvlqK20JuRTrpO3YmKf6EqFbbETJA609Itnjs8BlXEpZgF%2BO23F0krNElFYETE%2BtYVmd02MIm3xcYGOrABC%2F6RDkduOni2HfGxDpXfKIq73hqlc9yVQJTu5hHlFm2ddtmYM%2BlH6ZTsF6KgM3BEvClGRFloKUUd7zaDgfr9BQVYH90f8d3qR8dNiTKIXoRUM7Yqp0uJQd42mcyzD7Cv%2Be3FzUS9a3hAVwKzIAuXds%2FpxAbYzuNsOgOrGbC5a8D4rm2ZbdOjw7LsAEKGgG4qJlhs%2Fj4CFZfNwg%2FK%2Fyxp5dBYRSTfKEQYqXb7ePgvAOg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d02aa72ac1ef33a4f322f9f79ecbbc412385fc2e57c76eb6dca829e1fd616462",
      "file_size": 1918,
      "type": "text/x-c++",
      "moderated": null
    },
    {
      "id": 4048,
      "file_name": "0002-Ensure-that-templates-are-within-view-paths.patch",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/004/048/98f951bb9438a0a229b807d445c35f950ddc4cdd/0002-Ensure-that-templates-are-within-view-paths.patch?response-content-disposition=attachment%3B%20filename%3D%220002-Ensure-that-templates-are-within-view-paths.patch%22%3B%20filename%2A%3DUTF-8%27%270002-Ensure-that-templates-are-within-view-paths.patch&response-content-type=text%2Fx-c%2B%2B&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTP3D4BMZ%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T181746Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC5tkz8YUgMOOnbTR5p7%2FgQZmPf%2FYuaGBRbrH%2BI9HMk7QIhAL99C6vRMvTGnJSrJ%2BNKWfoG6pIPpXuHWFhl6eo0LOLxKrIFCDAQAxoMMDEzNjE5Mjc0ODQ5IgzSywCHJKajOLq99esqjwUvTUYotJJ4mygouYM79fIl6BglwCmFl8pZCPQ6D7vP6%2FP%2Foekr346AUeB46Jb9ApDYmd3BreihNo%2FmDe6DoGQVQKQ%2BYI0iIrvtSUssQwJkKKbtuyv6csn0LW7StKXuWbJe32A%2BIsSHylnsA%2FCt9Nf6v0PpXwv6V9vLR%2Fx7VMQUFlROrPDG8wdb0aihNAo2fw%2B3OPsJqKSo%2BPWiW7ddQz0E%2Fzo8QjHNgWZGo%2Fg036nBAlBDCM7tveOOeCmkYFgdwXuM3XZ5c8eng5%2Bf6SI8NCEAOeTNlflf49LY3lZI6822xazY3oS1Ehen0t6R3uGpGLAK1BB4hp6GykSfiEQ3TpsjoIivNjZSSmf8FD5nixvhxTV6aVPDzBzwhqJJ0WM%2B2ID5UuGZDuWzd67CLsIhqNYuwcagvQEikpA%2BPZkSKTLqx51YbeFU3FR7keiBLiZ6gggPKOGh6Ltigy8%2FEr78qqwPLeNlxnnFgOCUyLFNnsfb2NnxETzZ12a9IrUY8DC%2FYGClWtzRrXImaiJxn%2FxHh4Iz3VfvdEr1uaxL3ePCnWW6azczcJmvt1d7xN5t6oE8PWbh8TME1QdW33oOa9520TfUjitME412AcjBQi1rADbVPizoqHFxuDFOF%2B5QDvzZAFR6Yd%2FMir36GpTK39xLqPOXIbDvi6EkZQdqta%2B2blrPsClQseK5ubuO6%2BQBFEsHugvPhCeom6imMiywD%2Fu484AT118tSneQczpv%2FFMafkLhg78Bvp5D47ZhCjwDtvPu5d7%2BFd98bH1I5il9dzA0S5raMphUB0bJMEIhjDMvlqK20JuRTrpO3YmKf6EqFbbETJA609Itnjs8BlXEpZgF%2BO23F0krNElFYETE%2BtYVmd02MIm3xcYGOrABC%2F6RDkduOni2HfGxDpXfKIq73hqlc9yVQJTu5hHlFm2ddtmYM%2BlH6ZTsF6KgM3BEvClGRFloKUUd7zaDgfr9BQVYH90f8d3qR8dNiTKIXoRUM7Yqp0uJQd42mcyzD7Cv%2Be3FzUS9a3hAVwKzIAuXds%2FpxAbYzuNsOgOrGbC5a8D4rm2ZbdOjw7LsAEKGgG4qJlhs%2Fj4CFZfNwg%2FK%2Fyxp5dBYRSTfKEQYqXb7ePgvAOg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f51b1622c0552ec703d236763c3a9179407db1c6612d8ddde8f16143809ad33f",
      "file_size": 2424,
      "type": "text/x-c++",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2015-07-16T19:07:55.419Z",
  "allow_singular_disclosure_after": -321491391.12621224,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "trazer",
    "cryptographer",
    "shivammusic",
    "spetr0x",
    "dyabla",
    "4amhunter"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
