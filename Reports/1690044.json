{
  "id": 1690044,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjkwMDQ0",
  "url": "https://hackerone.com/reports/1690044",
  "title": "IDOR leaking PII data via VendorId parameter",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-09-02T20:43:55.296Z",
  "submitted_at": "2022-09-02T20:43:55.324Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "696e746c6f6c",
    "url": "/696e746c6f6c",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-10-14T13:24:18.024Z",
  "bug_reporter_agreed_on_going_public_at": "2022-10-11T11:43:28.190Z",
  "team_member_agreed_on_going_public_at": "2022-10-14T13:24:17.908Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\nDear DoD,\n\nI found one bug on your domain from Hack US program:  █████\nIt's IDOR bug. Make sure to know that I didn't test many funcs here for IDOR. I didn't test for ATO (Account Takeover). But you should fix this.\n Here's the PoC:\n\n██████████\n\nThank you DoD!\n\n## Impact\n\nAn attacker could steal users information via IDOR and use it for phishing and more stuff maybe it can lead to ATOs (Accounts Takeovers).\n\n## System Host(s)\n███\n\n## Affected Product(s) and Version(s)\nUsers  are affected.\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n1. Go to  ███████\n2.  Make two accounts one attacker and one victim account.\n3. Login as attacker account account. \n4. Go to my companies.\n5. Scroll down there and you will see company contacts.\n6. Click edit then turn your foxy proxy on and open your burp suit and save so you can intercept request.\n7. Intercept your request. The request should look like this:\n\n```javascript\nPOST /█████████/Vendor/Company/Contacts/SavePOC HTTP/1.1\nHost: ███████\nCookie: .AspNetCore.Antiforgery.wZhPOrJ1UhI=; TS014b77bb=; .AspNetAuth=; .AspNetCore.Mvc.CookieTempDataProvider=; ASP.NET_SessionId=; TS0144f203=; CSRF-TOKEN=; .AspNetCore.Session=\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0\nAccept: */*\nAccept-Language: hr,hr-HR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 647\nOrigin: https://██████████\nReferer: █████████████/Vendor/Company/Profile/129111\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nTe: trailers\nConnection: close\n\nEditPOCvm.Email=attacker@gmail.com&EditPOCvm.PositionTitleIds=10&EditPOCvm.Title=Pentester&EditPOCvm.FirstName=attacking&EditPOCvm.MiddleName=test&EditPOCvm.LastName=wearehackerone&EditPOCvm.PhoneNumber=13333333333333339&EditPOCvm.LanguageId=&EditPOCvm.Password=&EditPOCvm.ConfirmPassword=&userId=0&passChange=&EditPOCvm.PersonProfileId=&EditPOCvm.CitizenshipId=101&VendorId=<your id>&VendorPersonProfileId=<your id>&__RequestVerificationToken=&IsAdmin=false&X-Requested-With=XMLHttpRequest\n```\n8. Send request in repeater tab ( i will show that request in my PoC video)\n9. Change VendorId parameter to victims VendorId parameter. \n10. You will get victims some information.\n11. Also you need to login as victim too and intercept request if you want victims vendorId or brute force it.\n\n## Suggested Mitigation/Remediation Actions\nWeb-applications should validate all untrusted input received with every HTTP request. Your applications should perform whitelist validation on each input, verifying that the incoming value meets your applications’ expectations pertaining to:\n    Minimum or maximum length\nMinimum or maximum bounds for numeric values\nAcceptable characters\nData Types like string, date, integer, or rational\nSet membership\nPattern such as phone number, social security, or employer ID\nUsing whitelist validation, also called Syntactic Validation, your applications will impose checks, such as the ones above, on each input  that must be satisfied, otherwise it is rejected. Whitelist checks merely certify the content of inputs instead of trying to decipher the meaning behind them.\nYour tech teams can leverage Syntactic Validation with Logical Validation by adding checks to see if the input values make sense. Logical validation takes into account the meaning behind reference value and ensures values are consistent with design intent. For example:\n    An “id” parameter may represent a customer identifier. Using logical validation, it may be checked to ensure authorized access by the user.\nAn “account” parameter may represent a user’s account. Using logical validation, it may be verified that the information displayed is that of the specific user’s.\nUsing Indirect References\nAnother way to combat IDORs is to design resources such as ids, names, and keys to be replaced with cryptographically strong random values. These values will correspond to the original values, and both are housed on the server so an application cannot expose a direct reference. These indirect references provide a more complex counter-attack methodology than logical validation, making it more difficult for hackers to substitute meaningful values for references.\nTherefore, indirect references are the preferred strategy concerning sensitive information like loan and social security numbers. However, indirect references also make your website performance slightly worse since they influence the design of the site.\nAccess Control Checks\nAccess control checks ensure data is provided only to authorized users. Features of access control include:\n    Instance-based security competencies which specify access control lists associated with domain objects.\nResource values in session and on submit are checked at a timed interval with stored values on the server.\nDatabase checks to ensure information is authentic.\nHow To Implement IDOR Safeguards\nThe IDOR designs present vulnerabilities that allow hackers to potentially access personal information via substituted resources. In order to protect against a data breach at your company it’s important to implement syntactic and logical validation, indirect references, and access control checks. These safeguards require deep knowledge of your internal server and will therefore likely need to be executed by internal employees or long-term contractors.\nIn order to make sure your developers has the necessary skills to keep validations, references, and checks up-to-date and secure, your technology professionals need continuous and expert training. Try some of Avatao’s practical and hands-on exercises to help safeguard against IDORs!\nguide\n\n",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 17,
  "voters": [
    "krkeeper",
    "zy9ard3",
    "shuvam321",
    "shreyaschavhan",
    "2026",
    "logic-cracker",
    "5eyavan",
    "shivammusic",
    "0x0days",
    "hijak3r",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 189387,
      "category": "researcher",
      "content": "Twitter: https://twitter.com/0x1int",
      "updated_at": "2022-09-02T20:44:16.753Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2045840,
        "username": "696e746c6f6c",
        "name": "",
        "bio": "formerly unemployed now self unemployed",
        "cleared": false,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2021-10-26T16:54:07.049Z",
        "url": "https://hackerone.com/696e746c6f6c",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzY4MDc5NCwicHVyIjoiYmxvYl9pZCJ9fQ==--452b3b64b16004b04732c3027fe182355d2a8483/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/G0R6-x-X0AE3arC.jpg"
        }
      }
    }
  ]
}
