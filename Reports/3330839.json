{
  "id": 3330839,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzMwODM5",
  "url": "https://hackerone.com/reports/3330839",
  "title": "CVE-2025-10148: predictable WebSocket mask",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2025-09-08T09:52:13.904Z",
  "submitted_at": "2025-09-08T09:52:16.842Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cruocco",
    "url": "/cruocco",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3c1a98c0f7063b87f1b854d7726055dea11380ea4e3e58dafddd3ea40bca0679",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/df848bf230fe1cd5dd26f571b8f1d0ea918f57c041901f0ae53ebe6f36c62f0a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2025-10148"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-09-10T06:05:01.480Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-09-10T05:59:34.694Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "No AI was involved.\n\n## Summary:\nThe curl WebSocket implementation generates a fixed masking key at the beginning of a connection an re-uses it for every frame:\n* Generation of masking key `enc.mask` in `Curl_ws_accept`: https://github.com/curl/curl/blob/455afa1de5182b95a5dcc988f18cdff584b95239/lib/ws.c#L1340\n* Usage in `ws_enc_write_head`: https://github.com/curl/curl/blob/455afa1de5182b95a5dcc988f18cdff584b95239/lib/ws.c#L879\n* Usage in `ws_enc_write_payload`: https://github.com/curl/curl/blob/455afa1de5182b95a5dcc988f18cdff584b95239/lib/ws.c#L930\n\n[RFC-6455 ยง5.3](https://datatracker.ietf.org/doc/html/rfc6455#section-5.3) states:\n> [...] The masking key is a 32-bit value chosen at random by the client. When preparing a masked frame, the client MUST pick a fresh masking key from the set of allowed 32-bit values.  The masking key needs to be unpredictable; thus, the masking key MUST be derived from a strong source of entropy, and the masking key for a given frame MUST NOT  make it simple for a server/proxy to predict the masking key for a  subsequent frame.  The unpredictability of the masking key is  essential to prevent authors of malicious applications from selecting  the bytes that appear on the wire.  [...]\n\nBecause the same masking key is repeatedly used for every frame, it is trivial for an attacker to \"guess\" the masking key of all subsequent frames.\n\n## Affected version\nAll versions since WebSocket support was added.\n\n## Steps To Reproduce:\nNone\n\n## Supporting Material/References:\nNone\n\n## Impact\n\nSee \"Security Considerations > Attacks On Infrastructure (Masking)\" in [RFC-6455 ยง10.3](https://datatracker.ietf.org/doc/html/rfc6455#section-10.3). Here a short excerpt:\n> [...] As this protocol was being developed, an experiment was conducted to demonstrate a class of attacks on proxies that led to the poisoning of caching proxies deployed in the wild [TALKING].  The general form of the attack was to establish a connection to a server under the \"attacker's\" control, perform an UPGRADE on the HTTP connection similar to what the WebSocket Protocol does to establish a connection, and subsequently send data over that UPGRADEd connection that looked like a GET request for a specific known resource (which in an attack would likely be something like a widely deployed script for tracking hits or a resource on an ad-serving network).  The remote server would respond with something that looked like a response to the fake GET request, and this response would be cached by a nonzero percentage of deployed intermediaries, thus poisoning the cache.  The net effect of this attack would be that if a user could be convinced to visit a website the attacker controlled, the attacker could potentially poison the cache for that user and other users behind the same cache and run malicious script on other origins, compromising the web security model. [...]",
  "weakness": {
    "id": 37,
    "name": "Reusing a Nonce, Key Pair in Encryption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2025-10-10T05:59:34.913Z",
  "allow_singular_disclosure_after": 2591051.804189417,
  "singular_disclosure_allowed": false,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
