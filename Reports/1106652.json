{
  "id": 1106652,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA2NjUy",
  "url": "https://hackerone.com/reports/1106652",
  "title": "redirect_to([\"string\"]) remote code execution",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-02-18T16:40:59.146Z",
  "submitted_at": "2021-02-18T16:40:59.177Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "gmcgibbon",
    "url": "/gmcgibbon",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjU5MDkxMywicHVyIjoiYmxvYl9pZCJ9fQ==--e14cf449a375e6f757e23e32a3e2f7da8ef57b2a/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGVnIiwiZ3Jhdml0eSI6IkNlbnRlciIsInJlc2l6ZSI6IjYyeDYyXiIsImNyb3AiOiI2Mng2MiswKzAifSwicHVyIjoidmFyaWF0aW9uIn19--0e8fb5b1a245559716caa2abf00b1571bf3c5040/5162312.jpeg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22,
    "url": "https://hackerone.com/rails",
    "handle": "rails",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ruby on Rails",
      "twitter_handle": "rails",
      "website": "http://rubyonrails.org/security",
      "about": "Web development that doesn't hurt."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-22885"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-05-07T23:01:09.877Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2021-05-07T23:00:58.652Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "For example, `redirect_to(params[:user_input])`  with a URL of `?user_input[]=something` calls the method `something_url` and tries to redirect the return value of the method. If this call is on an unauthenticated route, it would allow an external user to test if a route name exists by determining if the app 500s  (the method does not exist) or successfully redirects.\n\n## Impact\n\nAny public method defined on a controller ending with `_url` could be remotely executed.",
  "weakness": {
    "id": 82,
    "name": "Information Exposure Through an Error Message"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-06-06T23:00:58.755Z",
  "allow_singular_disclosure_after": -135403127.70744845,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "ibring",
    "splint3rsec",
    "smodnix",
    "shivanshmalik2",
    "ralphleo",
    "omsonani",
    "ekgaribadmi",
    "noobaum",
    "rogerho"
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 160,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/rails/rails",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 49607,
      "category": "team",
      "content": "Impact\nThere is a possible information disclosure / unintended method execution\nvulnerability in Action Pack when using the redirect_to or polymorphic_url\nhelper with untrusted user input.\n\nVulnerable code will look like this.\n\nredirect_to(params[:some_param])\nAll users running an affected release should either upgrade or use one of the\nworkarounds immediately.\n\nReleases\nThe FIXED releases are available at the normal locations.\n\nWorkarounds\nTo work around this problem, it is recommended to use an allow list for valid\nparameters passed from the user. For example,\n\nprivate def check(param)\n  case param\n  when \"valid\"\n    param\n  else\n    \"/\"\n  end\nend\n\ndef index\n  redirect_to(check(params[:some_param]))\nend\nOr force the user input to be cast to a string like this,\n\ndef index\n  redirect_to(params[:some_param].to_s)\nend\nPatches\nTo aid users who aren't able to upgrade immediately we have provided patches for\nthe two supported release series. They are in git-am format and consist of a\nsingle changeset.\n\n5-2-information-disclosure.patch - Patch for 5.2 series\n6-0-information-disclosure.patch - Patch for 6.0 series\n6-1-information-disclosure.patch - Patch for 6.1 series\nPlease note that only the 5.2, 6.0, and 6.1 series are supported at present. Users\nof earlier unsupported releases are advised to upgrade as soon as possible as we\ncannot guarantee the continued availability of security fixes for unsupported\nreleases.\n\nCredits\nThanks to Benoit Côté-Jodoin from Shopify for reporting this.\n\nReferences\nhttps://github.com/rails/rails/releases/tag/v5.2.4.6\nhttps://github.com/rails/rails/releases/tag/v5.2.6\nhttps://github.com/rails/rails/releases/tag/v6.0.3.7\nhttps://github.com/rails/rails/releases/tag/v6.1.3.2\nhttps://groups.google.com/g/rubyonrails-security/c/NiQl-48cXYI",
      "updated_at": "2021-05-07T23:03:26.556Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 4981,
        "username": "rafaelfranca",
        "name": "Rafael França",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2014-04-14T22:32:11.816Z",
        "url": "https://hackerone.com/rafaelfranca",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/004/981/dd3b6bb41f9c33e3448ebbc47303f5a135f25105_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjQwNiwicHVyIjoiYmxvYl9pZCJ9fQ==--e88763a901c3f08c1e4352316a32579eb65828bc/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiODJ4ODJeIiwiY3JvcCI6IjgyeDgyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--29ac517e159d5d0770b357ab67c25f2cbc1a5e86/IMG-20140322-WA0009.jpg",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjQwNiwicHVyIjoiYmxvYl9pZCJ9fQ==--e88763a901c3f08c1e4352316a32579eb65828bc/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/IMG-20140322-WA0009.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
