{
  "id": 1172205,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTcyMjA1",
  "url": "https://hackerone.com/reports/1172205",
  "title": "Insufficient session expiration in the **com.shopify.ping** android app",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-04-22T13:18:10.413Z",
  "submitted_at": "2021-04-22T13:18:10.560Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "fr4via",
    "url": "/fr4via",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/qxztx5o3xaawycyjjspk5cexkis3/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-26T06:02:18.709Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-26T06:02:18.612Z",
  "team_member_agreed_on_going_public_at": "2021-11-25T19:54:26.082Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "It was identified that despite a logout action will be taken by the user at the com.shopify.ping application, the authentication token is not invalidated which allows fully recovery of the initially acquired session. More specifically, after the user provides the required credentials, an **access_token** will be fetched from the server at accounts.shopify.com/oauth/token. After establishing a session and by selecting logout from the corresponding control, the application will send the following DELETE request:\n\n```\nDELETE /api/v1/logout HTTP/1.1\nauthorization: Bearer atkn_**********************************\nHost: accounts.shopify.com\nConnection: close\nCookie: __cfduid=***********; _y=***************; _shopify_y=***************; request_method=POST\nUser-Agent: okhttp/3.12.12\n```\n\nThe server will reply as follows:\n\n```\n{\"error\":\"Missing Logout Token Hint\"}\n```\nAnd will cancel the invalidation process, as the token will still be valid on a subsequent request (e.g.):\n\n```\nGET /oauth/userinfo HTTP/1.1\nAccept-Encoding: gzip, deflate\nauthorization: Bearer ***************\n....\n```\nREPLY:\n```\n{\"sub\":\"...\",\"email\":\".....@gmail.com\",\"email_verified\":true,\"family_name\":\"Doe\",\"given_name\":\"....\",\"locale\":\"en\",\"name\":\".... ...\",\"nickname\":\".....\",\"updated_at\":.....,\"zoneinfo\":\"....\",\"tfa_enabled\":false}\n```\n\n## Impact\n\nAn application should always revoke an access token by the time that the end user choses to Log Off from a session. Keeping a token active, while the user is not aware of it imposes a big risk, since by the time that an unauthorised entity fetches it, may recover a fully \"functional\" session.",
  "weakness": {
    "id": 90,
    "name": "Insufficient Session Expiration"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 63,
  "voters": [
    "p0ch4t",
    "aboalezz",
    "m7arm4n",
    "fr4via",
    "drsniper",
    "shreyaschavhan",
    "ali",
    "tess",
    "anupamas01",
    "shubham_srt",
    "and 53 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "physical",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37199,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Mobile Applications",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
