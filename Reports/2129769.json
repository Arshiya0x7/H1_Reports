{
  "id": 2129769,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTI5NzY5",
  "url": "https://hackerone.com/reports/2129769",
  "title": "fetlife.com/signup_step_profile expose access_token of mapbox.com",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "medium",
  "readable_substate": "Informative",
  "created_at": "2023-08-31T04:04:55.616Z",
  "submitted_at": "2023-08-31T04:14:11.695Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "deepblue29",
    "url": "/deepblue29",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTA4MDE3NiwicHVyIjoiYmxvYl9pZCJ9fQ==--0117d53068bdf4519bcda8ebcb0ba4906bd92800/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGVnIiwiZ3Jhdml0eSI6IkNlbnRlciIsInJlc2l6ZSI6IjYyeDYyXiIsImNyb3AiOiI2Mng2MiswKzAifSwicHVyIjoidmFyaWF0aW9uIn19--0e8fb5b1a245559716caa2abf00b1571bf3c5040/7130705.jpeg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 6820,
    "url": "https://hackerone.com/fetlife",
    "handle": "fetlife",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/tq0yvq4dna4jadt83zftx0vx7iz0/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22avatar-white.png%22%3B%20filename%2A%3DUTF-8%27%27avatar-white.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T195537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8b2005800b2d366782c977c7b9a98157e561a9093610bc6a73afc0517a71d38a",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/tq0yvq4dna4jadt83zftx0vx7iz0/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22avatar-white.png%22%3B%20filename%2A%3DUTF-8%27%27avatar-white.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T195537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=400dc570f88ab3695d5338cbd7ef4ef78ec8857807b8502ca87e26f976239110"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "FetLife",
      "twitter_handle": "",
      "website": "https://fetlife.com",
      "about": "FetLife is the Social Network for the BDSM, Fetish & Kinky Community."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-11-01T00:17:26.046Z",
  "bug_reporter_agreed_on_going_public_at": "2023-11-01T00:17:25.837Z",
  "team_member_agreed_on_going_public_at": "2023-10-31T18:26:41.697Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi fetlife, I'm investigate on registration step on your site, in registration step at https://fetlife.com/signup_step_profile\n\nwhen user type in field \"private_location_name\"\n\n{F2652527}\n\nit use frontend call to api.mapbox.com directly thus expose `access_token`, I was able to call it directly via command line:\n\n```\ncurl 'https://api.mapbox.com/geocoding/v5/mapbox.places/ho%20chi.json?limit=10&types=place%2Clocality&autocomplete=true&language=en&access_token=pk.eyJ1IjoiZmV0bGlmZSIsImEiOiJjazhwMjNrajUwN2luM2xwcmxmMDNoajFoIn0.vge5GmfaG4OTyth8uS_N6w' \\\n  -H 'sec-ch-ua: \"Chromium\";v=\"116\", \"Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"116\"' \\\n  -H 'Referer: https://fetlife.com/' \\\n  -H 'sec-ch-ua-mobile: ?0' \\\n  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36' \\\n  -H 'sec-ch-ua-platform: \"Linux\"' \\\n  --compressed\n```\n\nUpon having this access_token, I could freely use your token on my site, even though fetlife have `Referer: https://fetlife.com/`, I could navigate around that easily using direct http call from my server and inject Referer header as `https://fetlife.com/`.\n\n----------------------------------------------------------------------------------------------------------\n\nAnother issue (not security related), this request is for validating attribute unhandle email case yet :\n\n```\ncurl 'https://fetlife.com/users/attributes/email?email=deepblue29@wearehackerone.com' \\\n  -H 'sec-ch-ua: \"Chromium\";v=\"116\", \"Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"116\"' \\\n  -H 'Accept: application/json' \\\n  -H 'Referer: https://fetlife.com/signup_step_profile' \\\n  -H 'X-CSRF-Token: WbVVfdWFF2nIoWJ7yJHpjVMtt1i1_VFMTpDyq4dRI72NG3onq_MOtQmhHXD6nlD-aKAYoqpvAhCAWu8z6zf_qQ' \\\n  -H 'sec-ch-ua-mobile: ?0' \\\n  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36' \\\n  -H 'sec-ch-ua-platform: \"Linux\"' \\\n  --compressed\n```\n\n```\n500 Internal Server Error\nIf you are the administrator of this website, then please read this web application's log file and/or the web server's log file to find out what went wrong.%\n```\n\n----------------------------------------------------------------------------------------------------------\n\nAnother issue I see there is two `authenticity_token` on registration hidden input, I believe this is a mistake (?) \n\n{F2652528}\n\n## Impact\n\nexposing access_token on mapbox give me freely use of your resources (I use, you pay).",
  "weakness": {
    "id": 34,
    "name": "Cleartext Transmission of Sensitive Information"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2652527,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/s1li2moc97bokz7csx97uys0qnsb?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T195537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=703ee4d51e7abbbb6cfeafb8eacbf03876e59cc55a40c71a48eb1816e51b5ba8",
      "file_size": 24387,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 2652528,
      "file_name": "Screenshot_from_2023-08-31_11-07-58.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zqxmzddlfszavylzkwwsqwnjm0ni?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2023-08-31_11-07-58.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2023-08-31_11-07-58.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T195537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=da601cff12480c0f4f4e1c8c20a776708ead7d900119c69d268856f8f8c2d6a4",
      "file_size": 51765,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 85,
  "voters": [
    "ambrane",
    "lones",
    "mrecho",
    "h4x0r_ly",
    "ertugrul",
    "0d_samii",
    "fdeleite",
    "zy9ard3",
    "trieulieuf9",
    "ltidi",
    "and 75 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 32687,
    "asset_type": "URL",
    "asset_identifier": "fetlife.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
