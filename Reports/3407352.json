{
  "id": 3407352,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDA3MzUy",
  "url": "https://hackerone.com/reports/3407352",
  "title": "curl built with GnuTLS backend defaults to weak crypto parameters",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "none",
  "readable_substate": "Informative",
  "created_at": "2025-10-31T21:48:51.835Z",
  "submitted_at": "2025-10-31T21:48:52.189Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "nyymi",
    "url": "/nyymi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-12-08T10:45:24.914Z",
  "bug_reporter_agreed_on_going_public_at": "2025-12-08T10:43:37.480Z",
  "team_member_agreed_on_going_public_at": "2025-12-08T10:45:24.625Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nCurl configured with GnuTLS backend (`--with-gnutls`) defaults using \"NORMAL\" as the base level of the library cryptographic security. From GnuTLS documentation:\n\n```\nThe message authenticity security level is of 64 bits or more, and the certificate verification profile is set to GNUTLS_PROFILE_LOW (80-bits),\n```\n(Source: https://gnutls.org/manual/html_node/Priority-Strings.html)\n\nAs a result the library will allow connections using the weak message authenticity (for example 1024 bit DH group or using DH composite groups).\n\nNote that fortunately it is quite rare to see insecure server configuration that would allow practical exploitation - however it cannot entirely be ruled out, even today.\n\nNo AI slop bullshit was used to find this issue or generate the report. Stop the slop!\n\n## Affected version\n8.16.0\n8.17.0-DEV (current master)\n\n## Steps To Reproduce:\n  1. `./configure --with-gnutls; make`\n  2.  `./src/curl https://dh1024.badssl.com/ https://dh-small-subgroup.badssl.com/ https://dh-composite.badssl.com/`\n\n## Proposed Fix\nThe proposed fix is to default to 192bit security by using `SECURE192` base level:\n```\nMeans all the known to be secure ciphersuites that offer a security level 192-bit or more. The message authenticity security level is of 128 bits or more, and the certificate verification profile is set to GNUTLS_PROFILE_HIGH (128-bits).\n```\n(Source: https://gnutls.org/manual/html_node/Priority-Strings.html)\n\nExample patch implementing the fix:\n```\ndiff --git a/lib/vtls/gtls.c b/lib/vtls/gtls.c\nindex c79f192e8..364af7622 100644\n--- a/lib/vtls/gtls.c\n+++ b/lib/vtls/gtls.c\n@@ -315,14 +315,14 @@ static gnutls_x509_crt_fmt_t gnutls_do_file_type(const char *type)\n   return GNUTLS_X509_FMT_PEM; /* default to PEM */\n }\n \n-#define GNUTLS_CIPHERS \"NORMAL:-ARCFOUR-128:-CTYPE-ALL:+CTYPE-X509\"\n+#define GNUTLS_CIPHERS \"SECURE192:-ARCFOUR-128:-CTYPE-ALL:+CTYPE-X509\"\n /* If GnuTLS was compiled without support for SRP it will error out if SRP is\n    requested in the priority string, so treat it specially\n  */\n #define GNUTLS_SRP \"+SRP\"\n \n #define QUIC_PRIORITY \\\n-  \"NORMAL:-VERS-ALL:+VERS-TLS1.3:-CIPHER-ALL:+AES-128-GCM:+AES-256-GCM:\" \\\n+  \"SECURE192:-VERS-ALL:+VERS-TLS1.3:-CIPHER-ALL:+AES-128-GCM:+AES-256-GCM:\" \\\n   \"+CHACHA20-POLY1305:+AES-128-CCM:-GROUP-ALL:+GROUP-SECP256R1:\" \\\n   \"+GROUP-X25519:+GROUP-SECP384R1:+GROUP-SECP521R1:\" \\\n   \"%DISABLE_TLS13_COMPAT_MODE\"\n```\n\n## Supporting Material/References:\n- https://gnutls.org/manual/html_node/Priority-Strings.html\n- https://weakdh.org/\n\n## Impact\n\n## Summary:\n- Allowing weak cryptography to poorly configured servers and thus potential attackers in the man-in-the-middle position to break the cryptography.",
  "weakness": {
    "id": 40,
    "name": "Inadequate Encryption Strength"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "none",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
