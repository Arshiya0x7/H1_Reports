{
  "id": 891270,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTEyNzA=",
  "url": "https://hackerone.com/reports/891270",
  "title": "[Uppy] Internal Server side request forgery (bypass of #786956)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-06-04T20:42:14.550Z",
  "submitted_at": "2020-06-04T20:42:14.550Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mahmoud0x00",
    "url": "/mahmoud0x00",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/rpc0yyq6ilop7idaa1f9n4oe6k4s/8774a5031fc14b74dc4404da039040c69df8ed41021007c0c2beb9de489fcf66"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-8205"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-06-28T13:50:00.398Z",
  "bug_reporter_agreed_on_going_public_at": "2020-06-28T13:50:00.338Z",
  "team_member_agreed_on_going_public_at": "2020-06-28T13:46:33.914Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report `Internal Server-side request forgery` in Uppy\nIt allows the attacker to easily extract information from internal servers\n\n# Module\n\n**module name:** Uppy\n**version:**1.15.0\n**npm page:** `https://www.npmjs.com/package/uppy`\n\n## Module Description\n\nUppy is a sleek, modular JavaScript file uploader that integrates seamlessly with any application. It’s fast, easy to use and lets you worry about more important problems than building a file uploader.\n\n## Module Stats\n\n[1] weekly downloads: 37,599\n\n# Vulnerability\nServer-Side Request Forgery (SSRF)\n## Vulnerability Description\n\nWhen I checked your fix on #786956, I noticed that you fixed this issue by doing a check on the host 's IP address against a blacklist before passing it to the server to fetch (You can check that [here](https://github.com/transloadit/uppy/blob/7525440229bde28241e34ba3eacf3fad77269c05/packages/%40uppy/companion/src/server/helpers/request.js), But you forgot to stop redirection to these IP addresses, therefore attacker can create a host or file and redirect all requests which are being received to a specific internal host, this will bypass your check, in the first phase, System will check if this host is allowed or no, if it is allowed, Server will pass the request. But it won't be able to verify which host is being redirected to. \n\n## Steps To Reproduce: \n\n+ feel free to set up a custom Uppy version on your server and try these steps on\n\n1. Go to https://uppy.io/\n2. Choose download file via a link \n3. Pass this link to the system `https://tinyurl.com/gqdv39p` (it redirects to `http://169.254.169.254/metadata/v1/`)\n4. Upload fetched file\n5. Download that file\n6. Open that file and you should see a copy of DigitalOcean 's metadata host response\n██████\n\n\n\n## Supporting Material/References:\n███ \n\n# Wrap up\n\n> Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nUnauthorized access to sensitive info on internal hosts/services.",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-07-28T13:46:33.988Z",
  "allow_singular_disclosure_after": -162504851.01289183,
  "singular_disclosure_allowed": true,
  "vote_count": 23,
  "voters": [
    "run_win",
    "mik317",
    "0xelkomy",
    "brahim_boufakri01",
    "dhakal_bibek",
    "term1nal",
    "khizer47",
    "m16",
    "marwan",
    "exception",
    "and 13 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
