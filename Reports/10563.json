{
  "id": 10563,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDU2Mw==",
  "url": "https://hackerone.com/reports/10563",
  "title": "CSRF on \"Set as primary\" option on the accounts page",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-05-02T01:24:48.948Z",
  "submitted_at": "2014-05-02T01:24:48.948Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "anshuman_bh",
    "url": "/anshuman_bh",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/274/e61ac38cffc356f9d4531f8581e62fd4b6603c67_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 104,
    "url": "https://hackerone.com/coinbase",
    "handle": "coinbase",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/fwfizd37a3tsttb1ff4539buzmdw/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22Coinbase.png%22%3B%20filename%2A%3DUTF-8%27%27Coinbase.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUYHHKKV6%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T122200Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCLaJN%2BrXIQ%2FX1r3iBZVDGL5Dg%2BLDdK%2BEonSoMwTkzjTQIhAJrMIEWPSzGloehJSyU1pix1AejmGEwAR6eMrtSULAi5KrIFCC0QAxoMMDEzNjE5Mjc0ODQ5Igx0JILmdbZxrfar0zEqjwWuHOQyyk2a9omQHagruQTMrQYdUDdIoKTQxi87H1AhQHEKXDDc%2B0ZaDtXvGGg27NDxkVN8P%2FHuhZxj8NfhR1MAlq1lh6gLnXPbhQiiVyS6B%2BxLt5Pen4j3mMYWnAaWweja%2BWNm%2Fx70Z35YOGYHdvwntAk4CC6vEJuIKKfVezVZKMANkSVjUCsUOP3WvockPfsnBCI%2F3lO89FEoWjGW86X%2FB8iq0DjJCj%2BUBkAE7M76A2BhYTDLlxjGhT5yzpl%2FLlepQ9uy5fixcO5TbEfk5KxcFFgwZ%2FBa6RGnUzmd5I%2BOtGbt4mCCNsmec58wQg2%2Be4%2Bfn2F%2F1lioBnM1dou3%2FNJJHZyZzFgM%2FwRLjqvhVAJ7IaR3UZ7aVHk1LQs86iV66OPV7%2FcSZOXzvNn0wOMfwe0exWYpERL1YgIsI2y7YiADtAPYGj0vzCxl43gDYwxO1u1kKgJEXvSilCwCmQ8sqkmhbjee%2BZkPRxXCbQDwFtRZOm2Ax8bGui%2FAI4NqlBAsVcOtKD9%2B4zDlKdM81QoiqdCeC7MSksctXlKIOZa1F2rB6a0yZ13A9pR71CLcOtqwp218QpsS8Bd76l0nqqMiVgFnG6R0FkuhISubskWSSXkQuDF2IpG2CyZxsKcX8DPp%2Fl%2FLO3vOvcHjRyCvK3DmOd8XQ42TvQs6UFMJK6n%2BmVLBizBTenkIXtn%2FQvGf%2FqOHUF1PznPVO0mq9u0aVTVlea%2FBJ1krCeYTKY%2F%2FBX65yErPzd7OWruDsz0aWvDjTygnqcdZl8GEsyQ2icpGHorJzB4kVBG1busuR4DKFtzTKhprEDKtTTXfINVf7D4pz6kxBQsRK1lmkhfC%2BXGiJMNEi6b0M372df1fJ7SQ2KA%2FX%2FyAMKbmxMYGOrABWVYIlpeKCG7DKYBzIkq8%2FF2KjtoYYo%2Bh8ml7D2w4HKfbLN90T%2BoeAJGXcLw67o4vwvn0BEVE%2BslBGHEV4RlJh4lCThTzsD5O3Xhjf26BGTXrYFVh8xJhzQx7kO8CptfyStjCNa33sfGBsm%2FJiQnv%2FfWHKubr8SXkf2Bi3lRV9K1wS%2BSQi%2B4MZo0DK6U5IElZALFkB83q1523HRvjGax%2BPww9u7P6LfmnAB0IvyjbRi0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e73f67d94f5a2e8d5b835d51e08aa752e4207d7651bd68d6a00f35aa63028620",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/fwfizd37a3tsttb1ff4539buzmdw/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22Coinbase.png%22%3B%20filename%2A%3DUTF-8%27%27Coinbase.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUYHHKKV6%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T122200Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCLaJN%2BrXIQ%2FX1r3iBZVDGL5Dg%2BLDdK%2BEonSoMwTkzjTQIhAJrMIEWPSzGloehJSyU1pix1AejmGEwAR6eMrtSULAi5KrIFCC0QAxoMMDEzNjE5Mjc0ODQ5Igx0JILmdbZxrfar0zEqjwWuHOQyyk2a9omQHagruQTMrQYdUDdIoKTQxi87H1AhQHEKXDDc%2B0ZaDtXvGGg27NDxkVN8P%2FHuhZxj8NfhR1MAlq1lh6gLnXPbhQiiVyS6B%2BxLt5Pen4j3mMYWnAaWweja%2BWNm%2Fx70Z35YOGYHdvwntAk4CC6vEJuIKKfVezVZKMANkSVjUCsUOP3WvockPfsnBCI%2F3lO89FEoWjGW86X%2FB8iq0DjJCj%2BUBkAE7M76A2BhYTDLlxjGhT5yzpl%2FLlepQ9uy5fixcO5TbEfk5KxcFFgwZ%2FBa6RGnUzmd5I%2BOtGbt4mCCNsmec58wQg2%2Be4%2Bfn2F%2F1lioBnM1dou3%2FNJJHZyZzFgM%2FwRLjqvhVAJ7IaR3UZ7aVHk1LQs86iV66OPV7%2FcSZOXzvNn0wOMfwe0exWYpERL1YgIsI2y7YiADtAPYGj0vzCxl43gDYwxO1u1kKgJEXvSilCwCmQ8sqkmhbjee%2BZkPRxXCbQDwFtRZOm2Ax8bGui%2FAI4NqlBAsVcOtKD9%2B4zDlKdM81QoiqdCeC7MSksctXlKIOZa1F2rB6a0yZ13A9pR71CLcOtqwp218QpsS8Bd76l0nqqMiVgFnG6R0FkuhISubskWSSXkQuDF2IpG2CyZxsKcX8DPp%2Fl%2FLO3vOvcHjRyCvK3DmOd8XQ42TvQs6UFMJK6n%2BmVLBizBTenkIXtn%2FQvGf%2FqOHUF1PznPVO0mq9u0aVTVlea%2FBJ1krCeYTKY%2F%2FBX65yErPzd7OWruDsz0aWvDjTygnqcdZl8GEsyQ2icpGHorJzB4kVBG1busuR4DKFtzTKhprEDKtTTXfINVf7D4pz6kxBQsRK1lmkhfC%2BXGiJMNEi6b0M372df1fJ7SQ2KA%2FX%2FyAMKbmxMYGOrABWVYIlpeKCG7DKYBzIkq8%2FF2KjtoYYo%2Bh8ml7D2w4HKfbLN90T%2BoeAJGXcLw67o4vwvn0BEVE%2BslBGHEV4RlJh4lCThTzsD5O3Xhjf26BGTXrYFVh8xJhzQx7kO8CptfyStjCNa33sfGBsm%2FJiQnv%2FfWHKubr8SXkf2Bi3lRV9K1wS%2BSQi%2B4MZo0DK6U5IElZALFkB83q1523HRvjGax%2BPww9u7P6LfmnAB0IvyjbRi0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e392d9bb16444699e94ce73fec928dc1e01623332fd6ad869bbfc25f11627eaf"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Coinbase",
      "twitter_handle": "",
      "website": "https://coinbase.com/security",
      "about": "Creating an open financial system for the world"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2014-07-26T00:27:57.634Z",
  "bug_reporter_agreed_on_going_public_at": "2014-06-26T00:27:56.376Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "On navigating to the Accounts page, a Coinbase user can create multiple accounts.\r\nThe user can then make any of these accounts as their primary account.\r\nThere are also other options of renaming and deleting these accounts.\r\n\r\nAlthough there is a CSRF token being sent as a POST parameter for the delete operation, there is no such CSRF token for the \"set as primary\" operation. Infact, this request is a GET request. Similar CSRF controls should be implemented for the \"Set as primary\" operation as well.\r\n\r\nAlso, the account number/id is not something that is trivial for an attacker to predict. But, since it is sent as a GET request, it gets cached in the browser history, proxies, logs, etc. So, once the attacker gets hold of such an account number of a legitimate coinbase user, he can exploit a CSRF attack by framing a URL which looks as simple as this:\r\n\r\nhttps://coinbase.com/accounts/<account_number>/set_as_primary\r\n\r\nThe attacker can then trick the legitimate user to switch his primary account without the user's intention.\r\n\r\nPlease see the screenshot attached which shows that a GET request was sent requesting to switch the primary account. All that is required for it to be successfully processed is the session cookie.",
  "bounty_amount": "100.0",
  "formatted_bounty": "$100",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 8102,
      "file_name": "Screen_Shot_2014-05-01_at_9.23.19_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/008/102/f35246636142aac9ebc96229b94d791050f7af21/Screen_Shot_2014-05-01_at_9.23.19_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2014-05-01_at_9.23.19_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2014-05-01_at_9.23.19_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUYHHKKV6%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T122200Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCLaJN%2BrXIQ%2FX1r3iBZVDGL5Dg%2BLDdK%2BEonSoMwTkzjTQIhAJrMIEWPSzGloehJSyU1pix1AejmGEwAR6eMrtSULAi5KrIFCC0QAxoMMDEzNjE5Mjc0ODQ5Igx0JILmdbZxrfar0zEqjwWuHOQyyk2a9omQHagruQTMrQYdUDdIoKTQxi87H1AhQHEKXDDc%2B0ZaDtXvGGg27NDxkVN8P%2FHuhZxj8NfhR1MAlq1lh6gLnXPbhQiiVyS6B%2BxLt5Pen4j3mMYWnAaWweja%2BWNm%2Fx70Z35YOGYHdvwntAk4CC6vEJuIKKfVezVZKMANkSVjUCsUOP3WvockPfsnBCI%2F3lO89FEoWjGW86X%2FB8iq0DjJCj%2BUBkAE7M76A2BhYTDLlxjGhT5yzpl%2FLlepQ9uy5fixcO5TbEfk5KxcFFgwZ%2FBa6RGnUzmd5I%2BOtGbt4mCCNsmec58wQg2%2Be4%2Bfn2F%2F1lioBnM1dou3%2FNJJHZyZzFgM%2FwRLjqvhVAJ7IaR3UZ7aVHk1LQs86iV66OPV7%2FcSZOXzvNn0wOMfwe0exWYpERL1YgIsI2y7YiADtAPYGj0vzCxl43gDYwxO1u1kKgJEXvSilCwCmQ8sqkmhbjee%2BZkPRxXCbQDwFtRZOm2Ax8bGui%2FAI4NqlBAsVcOtKD9%2B4zDlKdM81QoiqdCeC7MSksctXlKIOZa1F2rB6a0yZ13A9pR71CLcOtqwp218QpsS8Bd76l0nqqMiVgFnG6R0FkuhISubskWSSXkQuDF2IpG2CyZxsKcX8DPp%2Fl%2FLO3vOvcHjRyCvK3DmOd8XQ42TvQs6UFMJK6n%2BmVLBizBTenkIXtn%2FQvGf%2FqOHUF1PznPVO0mq9u0aVTVlea%2FBJ1krCeYTKY%2F%2FBX65yErPzd7OWruDsz0aWvDjTygnqcdZl8GEsyQ2icpGHorJzB4kVBG1busuR4DKFtzTKhprEDKtTTXfINVf7D4pz6kxBQsRK1lmkhfC%2BXGiJMNEi6b0M372df1fJ7SQ2KA%2FX%2FyAMKbmxMYGOrABWVYIlpeKCG7DKYBzIkq8%2FF2KjtoYYo%2Bh8ml7D2w4HKfbLN90T%2BoeAJGXcLw67o4vwvn0BEVE%2BslBGHEV4RlJh4lCThTzsD5O3Xhjf26BGTXrYFVh8xJhzQx7kO8CptfyStjCNa33sfGBsm%2FJiQnv%2FfWHKubr8SXkf2Bi3lRV9K1wS%2BSQi%2B4MZo0DK6U5IElZALFkB83q1523HRvjGax%2BPww9u7P6LfmnAB0IvyjbRi0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e36086824ddae1844e143d8cbf0351dbe0b1d13e18e0affca8faf938940f34a8",
      "file_size": 76670,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2014-07-26T00:27:56.726Z",
  "allow_singular_disclosure_after": -352209243.5399437,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "sw33tlie",
    "shivammusic",
    "spetr0x"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
