{
  "id": 2188240,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTg4MjQw",
  "url": "https://hackerone.com/reports/2188240",
  "title": "Subdomain Takeover via Host Header Injection on www.█████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2023-09-30T22:47:16.654Z",
  "submitted_at": "2023-10-01T20:01:57.349Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ezequielpuig",
    "url": "/ezequielpuig",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/87l9os2gq57oziojdlc56wlo5d7h/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-06-18T16:57:53.269Z",
  "bug_reporter_agreed_on_going_public_at": "2024-05-20T09:28:34.469Z",
  "team_member_agreed_on_going_public_at": "2024-06-18T16:57:53.150Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Vulnerability Overview\n\n**_Reported By_**: Ezequiel \\[@ezequielpuig\\]\n**_Reported Date_**: 01/October/2023\n**_Reported To_**: U.S. Department Of Defense\n**_Vulnerability Type_**: Subdomain Takeover\n**_Affected URL_**: www\\.███████\n\nHello U.S. Department Of Defense Security Team, I hope this report finds you well. \n\nI want to bring to your attention a serious security issue that poses a significant risk to www\\.████████. This is related to a subdomain takeover vulnerability, which could allow malicious individuals to gain control over the subdomain and potentially misuse it for malicious purposes.\n\n_Overview:\nThe affected subdomain is www\\.███, which currently points to an unclaimed CNAME record on the ████████.netlify.app. This situation allows anyone to potentially take ownership of the subdomain and manipulate its content. Since www\\.█████████ has a CNAME record pointing to ██████████.netlify.app, by changing the Host header to www\\.██████████, it is possible to visualize the malicious content hosted on █████████.netlify.app.\n\nHere are a few scenarios where the Host header can be modified:\n\nProxy Servers: If you control a proxy server, you can intercept incoming requests and modify the Host header before forwarding the request to the intended destination. This is often done for load balancing, content caching, or security purposes.\n\nDNS Spoofing: In a malicious context, an attacker might attempt DNS spoofing to redirect requests to a different server with a modified Host header.\n\nServer-Side Scripting: If you have control over the server-side code that processes incoming requests, you can modify the Host header as part of your application logic.\n\nBrowser Extensions: Malicious browser extensions installed can modify the Host header for all outgoing requests.\n\n_Proof of Concept (PoC):\nThis vulnerability materializes when an HTTP request is sent to www\\.██████████ with a manipulated Host header.\n\nPoC via curl:\n`curl -skS https://www.███████ --header \"Host: ███.netlify.app\"`\n\nPoC via Burp Suite:\n█████████\n\n_Impact:\nSubdomain takeover can be exploited for various malicious purposes, including:\n\nMalware distribution\nPhishing / Spear phishing attacks\nCross-Site Scripting (XSS) attacks\nAuthentication bypass\nAnd more.\n\n_Mitigation:\nTo address this issue and prevent potential abuse, I recommend taking the following steps:\n\nRemove the CNAME record from the DNS zone for www\\.█████████.\nReclaim and register the affected subdomain (███.netlify.app) in the Netlify portal to prevent takeover by unauthorized entities.\nI urge you to take swift action to remediate this vulnerability to safeguard the security and reputation of U.S. Department Of Defense.\n\n//\n\nPlease feel free to reach out to me if you need any further information or assistance in resolving this matter.\n\nBest regards,\nEzequiel Puig\n\nHackerOne: https://hackerone.com/ezequielpuig\nLinkedIn: https://linkedin.com/in/ezequielpuig\nMail: puigezequiel@gmail.com\n\n## Impact\n\nImpact detailed above.\n\n## System Host(s)\nwww.██████████\n\n## Affected Product(s) and Version(s)\n\n\n## CVE Numbers\n\n\n## Steps to Reproduce\nSteps to reproduce detailed above.\n\n## Suggested Mitigation/Remediation Actions\n\n\n",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 34,
  "voters": [
    "magn4",
    "g3ksec",
    "hacker_441",
    "ezequielpuig",
    "loaymorad",
    "orange303",
    "almuntadhar",
    "shubham_srt",
    "gohanckz",
    "pr0f0x01",
    "and 24 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
