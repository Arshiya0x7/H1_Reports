{
  "id": 2930811,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTMwODEx",
  "url": "https://hackerone.com/reports/2930811",
  "title": "Attacker can use any non-enabled capability",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2025-01-10T12:59:36.002Z",
  "submitted_at": "2025-01-10T12:59:36.282Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "julianor",
    "url": "/julianor",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 24626,
    "url": "https://hackerone.com/cosmos",
    "handle": "cosmos",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/l8innmct0qu74b6xv2jzvh5lk5ap/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/l8innmct0qu74b6xv2jzvh5lk5ap/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Cosmos",
      "twitter_handle": "cosmos",
      "website": "https://interchain.io/",
      "about": "The Internet of Blockchains."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-01-15T20:33:51.232Z",
  "bug_reporter_agreed_on_going_public_at": "2025-01-13T21:59:08.065Z",
  "team_member_agreed_on_going_public_at": "2025-01-15T20:33:50.617Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "An attacker can deploy a `cosmwasm` contract  on a chain and execute _any_ action on that chain,  even when the executing chain does not allow  that capability. This issue stems from a naive implementation  of capabilities and misleading documentation.\n\nThis goes against the `Capabilites` description \nin `CAPABILITIES.md` (https://github.com/CosmWasm/cosmwasm/blob/main/docs/CAPABILITIES.md):\n\n```\nThe contract defines required capabilities. The environment defines its capabilities. If the required capabilities are all available, the contract can be used. \n```\n\nWe show that even if the required capabilities are not available, the capability can be used.\n\n### Steps to reproduce \n\n * Assume a chain that announced no capabilities to disallow contracts from executing certain paths.  \n* The chain does allow users to execute those paths via regular non-wasm messages. \n\n1. The attacker comments out the generation of the capabilities-string in the [cosmwasm compiler](https://github.com/CosmWasm/cosmwasm//blob/3a6093936520e9a1559423b50aa911ed9b836b3c/packages/std/src/exports.rs#L40). \n2. The attacker deploys the contract to the chain \n3. The chain will allow the upload as the `requires_*` string is **not** present. \n4. The attacker can execute any action on the chain.\n\n### Workarounds \n\nNone known. `capabilities`  should be checked at runtime too. In particular, the `DefaultMessageHandler` should  check for a capability before dispatching a message.\n\n## Impact\n\nA blockchain that leverages `Capabilities` restrictions to prevent contracts from executing specific actions is open to attacks. The severity of the impact on Integrity and Availability depends on the particular features of the blockchain's implementation, and this impact can potentially be **critical.**",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2025-02-12T21:59:08.219Z",
  "allow_singular_disclosure_after": -18992422.696843747,
  "singular_disclosure_allowed": true,
  "vote_count": 78,
  "voters": [
    "plynatwara",
    "k0ns0l",
    "julianor",
    "4drez",
    "orange303",
    "n1m0",
    "rocky1696",
    "starlox",
    "zy9ard3",
    "never_die",
    "and 68 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 548694,
    "asset_type": "OTHER",
    "asset_identifier": "CosmWasm",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
