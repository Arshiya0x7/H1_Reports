{
  "id": 1848940,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODQ4OTQw",
  "url": "https://hackerone.com/reports/1848940",
  "title": "URL Path Manipulation Enables Cache Poisoning of Amazon Affiliate Products in Shopify Linkpop",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-01-27T17:18:32.277Z",
  "submitted_at": "2023-01-27T17:18:32.312Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "saltymermaid",
    "url": "/saltymermaid",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/dn43gxssekzodutj70ovfe3vusis/14ae53c837ac793ca8f2b2aa550cbe58a3b423009bcfa000afbd45f64bade27d"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/727634197f209244e4307a490cdcd36c76d6e37fef1b0c164bd35ac010105f99",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/91b2506fe54e617e9b2199fff02f67a626ec348f74368200b42055b3004dd8a8"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-08-14T15:14:43.486Z",
  "bug_reporter_agreed_on_going_public_at": "2025-06-25T16:13:04.293Z",
  "team_member_agreed_on_going_public_at": "2025-08-14T15:14:42.952Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Summary\nThe fix in report ████████ seems to prevent correctly an attacker from redirecting the request to another domain which was the main issue, however, there is still a way for that attacker to \"poison\" the cache usin the Amazon domain. I believe the regex used to parse the url is the cause.\n\n# Description\nIf an attacker uses a crafted link such as https://amazon.ca/dp/[VICTIM-PRODUCT-ID]/../[ATTACKER-PRODUCT-ID], anyone who will then try to use the \"victim\" product link https://amazon.ca/dp/[VICTIM-PRODUCT-ID] will be shown the attacker controlled product. This way works even better because when you click the link button on the victim's page, it will even redirect to the attacker's product.\n\n# Steps to Reproduce\n1. Have two Amazon products ID in hands (which haven't been cached yet)\n 1.1. Attacker Product ID: `██████` (https://www.amazon.ca/dp/███)\n 1.2. Victim Product ID: `████` (https://www.amazon.ca/dp/███████)\n\n2. In your attacker's Linkpop account, add a new Amazon product using the following crafted link `https://amazon.ca/dp/[VICTIM-PRODUCT-ID]/../[ATTACKER-PRODUCT-ID]` and make sure to replace the placholders\n 2.1. Based on the ID's in step \\#1, you could use the following link `https://amazon.ca/dp/███/../████████`\t\n\n3. Now, in the victim's Linkpop account, try to add the following product https://www.amazon.ca/dp/█████████, which is the \"victim\" product ID from step \\#1. At that point you should be faced with the attacker's product (███) instead of the victim's product (███s).\n\n# Notes\nYou can test the POC with the IDs I've provided. I haven't used them and luckily they won't be in the cache yet. If they are, you should notice it when adding the product as it will resolve very quickly (< 1s). If it doesn't work you you will have to find new product IDs.\n\n## Impact\n\nAn attacker is able to manipulate the caching system to its avantage by sending a crafted link which can trick victims to unintentionally link a spoofed Amazon product to their Linkpop accounts.",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 175,
    "name": "Cache Poisoning"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 1,
  "voters": [
    "0xkenzo"
  ],
  "severity": {
    "rating": "low",
    "score": 3.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 741625,
      "category": "team",
      "content": "A cache poisoning vulnerability in Shopify's Linkpop allowed attackers to manipulate Amazon affiliate product displays through specially crafted URLs. When victims added legitimate Amazon products, they would unknowingly display the attacker's products instead. In the end, this low severity issue was not fixed as the Linkpop service was scheduled for decommissioning on July 7, 2025.",
      "updated_at": "2025-08-14T15:13:41.339Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 3168200,
        "username": "lando_shopify",
        "name": "Lando ",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2024-04-01T13:17:42.464Z",
        "url": "https://hackerone.com/lando_shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
