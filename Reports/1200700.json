{
  "id": 1200700,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjAwNzAw",
  "url": "https://hackerone.com/reports/1200700",
  "title": "User deletion is not handled properly everywhere",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-05-18T09:00:54.288Z",
  "submitted_at": "2021-05-18T09:00:54.327Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rtod",
    "url": "/rtod",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-07-15T19:12:16.497Z",
  "bug_reporter_agreed_on_going_public_at": "2021-06-15T19:12:11.258Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "So I came across this when going over https://nextcloud.com/compare/\n\nAnd noticed the section: \"BUILT IN DATA-REQUEST/ACCOUNT DELETION\"\n\nHowever looking at this it seems this is not handled properly everywhere in Nextcloud. I understand that the GDPR etc do consider shared data differently. For example a conversation two people have is shared data often and does not always have to be deleted.\n\nIn anycase let me describe what I found.\n\n1. userA has an account on server\n2. userB has an account on server\n3. userA and userB do a lot of chatting via talk\n4. At some point userB leaves the server and their account is deleted\n5. Now a new user comes along that gets assigned the id userB (or registers it or whatever)\n6. If the new userB now opens the chat to userA they will see all the messages exchanged between userA and the old userB\n\n## Impact\n\nNew users might get access to data of other users that left the system. This should not happen.\n\nI would suggest (to make your own life easier) to keep a blocklist of ids for users. So that these things can't happen.\nYou still have to make sure all required data is removed. But of you miss something at least it won't possibly get leaked to new users.",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-07-15T19:12:11.308Z",
  "allow_singular_disclosure_after": -132044698.74072865,
  "singular_disclosure_allowed": true,
  "vote_count": 77,
  "voters": [
    "monkelife",
    "theranger",
    "osman1337",
    "zy9ard3",
    "fqdn",
    "shreyaschavhan",
    "ali",
    "run_win",
    "iamrjarpan",
    "cafecito",
    "and 67 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 13,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
