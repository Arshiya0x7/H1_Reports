{
  "id": 1115139,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTE1MTM5",
  "url": "https://hackerone.com/reports/1115139",
  "title": "Bypassing HTML filter in \"Packing Slip Template\" Lead to SSRF to Internal Kubernetes Endpoints",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-03-02T22:30:04.491Z",
  "submitted_at": "2021-03-02T22:30:04.585Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cthulhufhtagn",
    "url": "/cthulhufhtagn",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/yft7r2tc0pd4vu86dmviebxdi17p/20fc426031f09e5347054871ae4e3af2478fd2b3d5e8a321468ecf6f2da5ac20"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-12-02T20:38:55.344Z",
  "bug_reporter_agreed_on_going_public_at": "2021-12-02T20:38:55.280Z",
  "team_member_agreed_on_going_public_at": "2021-12-02T20:04:37.143Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary**\n\nShopify has a feature called `Print Packing Slip`, with this tool, users can easily print a packing slip after customers make an order. The generated packing slip can be downloaded as a PDF file.\n\nUsers can edit an `Edit packing slip template` to adjust with a shop design. \n\nHowever, there's have a filter in the PDF Generator like `<iframe>` tag is filtered or sanitize, but we can bypassing HTML filter inject malicious HTML code, and accessing the Internal Kubernetes Endpoints.\n\nThe initial test that I do is trying to add an `Iframe` to the `Packing Slip` template and expecting those `Iframe` will generate in the PDF file.\n\nThis tag was filtered so the HTML will not added to the PDF:\n\n```\n<iframe src=\"https://evil.com/\" width=1001 height=1001>\n```\n\nBut it can be bypassed by adding `<svg><style><h1/>` in the beginning of tag:\n\n```\n<svg><style><h1/><iframe src=\"https://evil.com/\" width=1001 height=1001>\n```\n\nThe Iframe was successfully loaded:\n\n{F1215141}\n\nSince this only accepting HTTPS protocol, I was unable to extract the Google Cloud Metadata. But I can hit the Kubernetes API which is using HTTPS protocol.\n\n**Step to Reproduce**\n\n1) Log in to the Shopify account\n2) Navigate to `https://mystore.myshopify.com/admin/settings/packing_slip_template`\n3) Add this HTML tag\n\n```\n<svg><style><h1/><iframe src=\"https://kubernetes.default.svc/info\" width=1001 height=1001>\n```\n\n4) Preview Template and PDF will generated\n\n{F1215151}\n\n```\n<svg><style><h1/><iframe src=\"https://kubernetes.default.svc/livez?verbose\" width=1001 height=1001>\n```\n\n{F1215154}\n\n## Impact\n\nThe attacker can perform an SSRF attack on the internal network.",
  "weakness": {
    "id": 1520,
    "name": "Server Side Request Forgery"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1215141,
      "file_name": "Screen_Shot_2021-03-03_at_05.23.53.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ga9yt9y9uydl5bi2r6me03phx4j6?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-03-03_at_05.23.53.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-03-03_at_05.23.53.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQE4JZRCQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJIMEYCIQDSLpHZDwYSQUlhEZduF%2BgJQ%2FDgzxeTdmcE7mUKQCq0SgIhAK0qECPacwaIDFLm28%2BOn8mh2%2BLOh65d7%2BcdGlRrCQilKrsFCPj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwRjFf50Bw1PL1Xx34qjwXw0RFWAiOl5Q%2BM7toQH7GvAnoBKLXYXOsURPkG6oAY%2FdN8zbOgAknuNa%2FB8tzzAAjKIyRe0eq13erLzUVrDYCFoo6oL%2FbhnDf%2BDuQqyHaH34Ef6aCY80qg%2BtID3pC2hNFlZ1lOh2ASYpXGL7aiHP3hlppJfc4M1%2FgJSjxYTD1pI8gPv5PoTmK5EpZG0xH41Etgr01ZWAYR87yPiuzrExw%2F0mIczKSuGI55yl7MMmC7wpaPqrtk1BClLDGHQTANVbStx0TMpxhOwWsLvVsPuCXykdfyxNuNMb7GIJxRwD%2B4Gm%2FD6QwIJmM7c%2Bei0QFGoWcd7XRrWjX2VevHS5OIPbfW0ijWlnWzhe%2FVj51%2FGn2fYi3VDazpu0xHkiVPNFcPd4ODC0Pvjc6ktyMod3GMWGtOvmp7WjIO8v6KBM2MQiDOjhUj%2FuNaPw0jRRGXfTP9gtroVVELeC117DeRJb4BwUgcx6AbYnK%2FF%2B6ImGaBqHNKOwXRTiYEdRANIJoo7ymcfetv4WP5GZj6GcqhfF9Ipl%2B70lXz71ladf452PVo0XYIrjJ6KuDgcWHOc7pmqY4zkSlSAqUtzkTLDaHgcDE0%2FTigST61U1B5AqNcG8963leDWlZRwpoO8x9VwXD0vw2LM3%2FKRQZHF3v%2FyCyQzKgpD9Pp%2FL2a7MeNEJOM%2FhmRvLQM0zXuGesoyRUy4nz%2B4n1nmAbFnxDvKp63RRJ1urQ2LM2tgJFYvoHq%2BeyCZA5Kk2CjOf2nfMSLL2p0wxn0gkwa5%2BqpPlE5DY8PjqGqvmieUt%2BE6mdaYRCPstURSrBN3koLJo4NQvuYIdgMG5c8I%2F3H1iqhUZnYlPi07O1WSVq%2FZAEz%2FIzRT4nqd813st1PZKcMMILavMYGOrABmb2oLHJSH79C9SHp3PB6ZNqBvxhb2jC4R71ugFffQNSOAs5INNSftXFj1YNgbFWFih8kDbdlv37Xt0aziaCiuvxjtelVnU3El1zxUnpqDAJPmwFV3v5S2HVjLVtVA5rZdsvaFZaf5zhGzNO6AKPQMhCfrlCzrnoqHvHKgtOc07zprWOj3xKp1rRW6Da1wcYuHJFysBpEQtfsIt1O%2BCTu2Nxh0oECQMnixEFxFvtbq%2Bs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4ea5aea445b47450c08a314d4c521292cf1ae9764fee9aba431b2a36237fc3d6",
      "file_size": 64245,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1215151,
      "file_name": "Screen_Shot_2021-03-03_at_05.27.34.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o0kuyzwz8n3xks1n07bdf5eytjvu?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-03-03_at_05.27.34.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-03-03_at_05.27.34.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQE4JZRCQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJIMEYCIQDSLpHZDwYSQUlhEZduF%2BgJQ%2FDgzxeTdmcE7mUKQCq0SgIhAK0qECPacwaIDFLm28%2BOn8mh2%2BLOh65d7%2BcdGlRrCQilKrsFCPj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwRjFf50Bw1PL1Xx34qjwXw0RFWAiOl5Q%2BM7toQH7GvAnoBKLXYXOsURPkG6oAY%2FdN8zbOgAknuNa%2FB8tzzAAjKIyRe0eq13erLzUVrDYCFoo6oL%2FbhnDf%2BDuQqyHaH34Ef6aCY80qg%2BtID3pC2hNFlZ1lOh2ASYpXGL7aiHP3hlppJfc4M1%2FgJSjxYTD1pI8gPv5PoTmK5EpZG0xH41Etgr01ZWAYR87yPiuzrExw%2F0mIczKSuGI55yl7MMmC7wpaPqrtk1BClLDGHQTANVbStx0TMpxhOwWsLvVsPuCXykdfyxNuNMb7GIJxRwD%2B4Gm%2FD6QwIJmM7c%2Bei0QFGoWcd7XRrWjX2VevHS5OIPbfW0ijWlnWzhe%2FVj51%2FGn2fYi3VDazpu0xHkiVPNFcPd4ODC0Pvjc6ktyMod3GMWGtOvmp7WjIO8v6KBM2MQiDOjhUj%2FuNaPw0jRRGXfTP9gtroVVELeC117DeRJb4BwUgcx6AbYnK%2FF%2B6ImGaBqHNKOwXRTiYEdRANIJoo7ymcfetv4WP5GZj6GcqhfF9Ipl%2B70lXz71ladf452PVo0XYIrjJ6KuDgcWHOc7pmqY4zkSlSAqUtzkTLDaHgcDE0%2FTigST61U1B5AqNcG8963leDWlZRwpoO8x9VwXD0vw2LM3%2FKRQZHF3v%2FyCyQzKgpD9Pp%2FL2a7MeNEJOM%2FhmRvLQM0zXuGesoyRUy4nz%2B4n1nmAbFnxDvKp63RRJ1urQ2LM2tgJFYvoHq%2BeyCZA5Kk2CjOf2nfMSLL2p0wxn0gkwa5%2BqpPlE5DY8PjqGqvmieUt%2BE6mdaYRCPstURSrBN3koLJo4NQvuYIdgMG5c8I%2F3H1iqhUZnYlPi07O1WSVq%2FZAEz%2FIzRT4nqd813st1PZKcMMILavMYGOrABmb2oLHJSH79C9SHp3PB6ZNqBvxhb2jC4R71ugFffQNSOAs5INNSftXFj1YNgbFWFih8kDbdlv37Xt0aziaCiuvxjtelVnU3El1zxUnpqDAJPmwFV3v5S2HVjLVtVA5rZdsvaFZaf5zhGzNO6AKPQMhCfrlCzrnoqHvHKgtOc07zprWOj3xKp1rRW6Da1wcYuHJFysBpEQtfsIt1O%2BCTu2Nxh0oECQMnixEFxFvtbq%2Bs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9ee3f2a7f216ed6ceed1fd20781074ebdbb018dfe1e43cdfe43b6fd39c81f9a3",
      "file_size": 61066,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1215154,
      "file_name": "Screen_Shot_2021-03-03_at_05.28.56.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/igt5d2937klw6t1ixa3ea63cxc0s?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-03-03_at_05.28.56.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-03-03_at_05.28.56.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQE4JZRCQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJIMEYCIQDSLpHZDwYSQUlhEZduF%2BgJQ%2FDgzxeTdmcE7mUKQCq0SgIhAK0qECPacwaIDFLm28%2BOn8mh2%2BLOh65d7%2BcdGlRrCQilKrsFCPj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwRjFf50Bw1PL1Xx34qjwXw0RFWAiOl5Q%2BM7toQH7GvAnoBKLXYXOsURPkG6oAY%2FdN8zbOgAknuNa%2FB8tzzAAjKIyRe0eq13erLzUVrDYCFoo6oL%2FbhnDf%2BDuQqyHaH34Ef6aCY80qg%2BtID3pC2hNFlZ1lOh2ASYpXGL7aiHP3hlppJfc4M1%2FgJSjxYTD1pI8gPv5PoTmK5EpZG0xH41Etgr01ZWAYR87yPiuzrExw%2F0mIczKSuGI55yl7MMmC7wpaPqrtk1BClLDGHQTANVbStx0TMpxhOwWsLvVsPuCXykdfyxNuNMb7GIJxRwD%2B4Gm%2FD6QwIJmM7c%2Bei0QFGoWcd7XRrWjX2VevHS5OIPbfW0ijWlnWzhe%2FVj51%2FGn2fYi3VDazpu0xHkiVPNFcPd4ODC0Pvjc6ktyMod3GMWGtOvmp7WjIO8v6KBM2MQiDOjhUj%2FuNaPw0jRRGXfTP9gtroVVELeC117DeRJb4BwUgcx6AbYnK%2FF%2B6ImGaBqHNKOwXRTiYEdRANIJoo7ymcfetv4WP5GZj6GcqhfF9Ipl%2B70lXz71ladf452PVo0XYIrjJ6KuDgcWHOc7pmqY4zkSlSAqUtzkTLDaHgcDE0%2FTigST61U1B5AqNcG8963leDWlZRwpoO8x9VwXD0vw2LM3%2FKRQZHF3v%2FyCyQzKgpD9Pp%2FL2a7MeNEJOM%2FhmRvLQM0zXuGesoyRUy4nz%2B4n1nmAbFnxDvKp63RRJ1urQ2LM2tgJFYvoHq%2BeyCZA5Kk2CjOf2nfMSLL2p0wxn0gkwa5%2BqpPlE5DY8PjqGqvmieUt%2BE6mdaYRCPstURSrBN3koLJo4NQvuYIdgMG5c8I%2F3H1iqhUZnYlPi07O1WSVq%2FZAEz%2FIzRT4nqd813st1PZKcMMILavMYGOrABmb2oLHJSH79C9SHp3PB6ZNqBvxhb2jC4R71ugFffQNSOAs5INNSftXFj1YNgbFWFih8kDbdlv37Xt0aziaCiuvxjtelVnU3El1zxUnpqDAJPmwFV3v5S2HVjLVtVA5rZdsvaFZaf5zhGzNO6AKPQMhCfrlCzrnoqHvHKgtOc07zprWOj3xKp1rRW6Da1wcYuHJFysBpEQtfsIt1O%2BCTu2Nxh0oECQMnixEFxFvtbq%2Bs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f94bea5c5617b9d474e8217f524aae9896ccdc0bbaa82381dea918273e71351d",
      "file_size": 128120,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 20,
  "voters": [
    "drsniper",
    "cthulhufhtagn",
    "shreyaschavhan",
    "ali",
    "dmc3",
    "akashhamal0x01",
    "h4x0r_dz",
    "xsstestov",
    "apapedulimu",
    "dastan_9408",
    "and 10 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 112882,
      "category": "team",
      "content": "@cthulhufhtagn reported a bypass for Packing Slip HTML sanitization checks, which under certain circumstances could disclose order information to staff members without orders permission. We are no longer accepting this type of sanitization bypass, so please consult our program page before digging into this functionality.",
      "updated_at": "2021-12-02T21:43:08.354Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 166726,
        "username": "duke-fleed",
        "name": "Daisuke",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2017-05-11T17:57:27.993Z",
        "url": "https://hackerone.com/duke-fleed",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/80zqkpwugrtpg7z7997pts1k6i8n/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/80zqkpwugrtpg7z7997pts1k6i8n/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjEzNjQ1NSwicHVyIjoiYmxvYl9pZCJ9fQ==--aa35465015ae1b3f0450af813c91df770900d4d9/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/1349129-duke_fleed.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
