{
  "id": 3058919,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDU4OTE5",
  "url": "https://hackerone.com/reports/3058919",
  "title": "Application Level DoS - Large Markdown Payload in Reply Section Leading to Resource Exhaustion",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2025-03-25T15:57:42.656Z",
  "submitted_at": "2025-03-25T15:57:43.111Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "theteatoast",
    "url": "/theteatoast",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tx1q69a9e9o0hu5066adn7mul0oc/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16893,
    "url": "https://hackerone.com/discourse",
    "handle": "discourse",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Discourse",
      "twitter_handle": "discourse",
      "website": "https://discourse.org",
      "about": "Discourse is JavaScript (ember.js) and Ruby on Rails based 100% open source discussion software -- https://github.com/discourse/discourse"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-10-18T16:47:02.928Z",
  "bug_reporter_agreed_on_going_public_at": "2025-09-18T16:46:59.858Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nAn application level Denial of Service (DoS) vulnerability was identified in the reply section on https://try.discourse.org\n\nBy submitting an excessively large markup payload (~800,000 characters), the server takes 30 seconds to respond before returning an HTTP/2 502 Bad Gateway error. This indicates potential resource exhaustion or backend service failure, which could be exploited to degrade or disrupt website availability.\n\n## Attack Scenario:\n\nIf an attacker automates this request using multiple parallel requests (e.g., via Burp Intruder, Python scripts, or a botnet), it can cause severe resource exhaustion.\n\nThe backend service will be overwhelmed, leading to widespread downtime, preventing legitimate users from accessing the forum.\n\n## Steps To Reproduce:\n1. Login with valid credentials on `https://try.discourse.org`\n\n2. Navigate to the default discobot grettings message.\n{F4182648}\n\n3. Reply the message with the following paylod while intercepting the request: `https://github.com/theteatoast/theteatoast.github.io/blob/main/payload.txt`\n{F4182646}\n\n4. Repeat the request and observe that the server takes ~30 seconds before responding with 502.\n{F4182647}\n\n##Video POC:\n{F4182629}\n\n##Suggested Mitigation:\n\n1. Implement input length restrictions on replies to prevent excessive payload sizes.\n\n2. Introduce rate-limiting and request throttling to mitigate automated abuse.\n\n3. Optimize backend request handling to reject large payloads early before processing.\n\n##Note:\n\nThis Proof of Concept (PoC) was performed solely for demonstration purposes, with no intent to harm the system. I ensured minimal impact while testing.\n\n## Impact\n\n1. Attackers can exploit this to cause severe delays and temporary or prolonged service disruption.\n\n2. The lack of input validation allows attackers to send multiple large requests in parallel, leading to backend resource exhaustion.\n\n3. If automated, this attack could render the forum completely inaccessible.",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4182629,
      "file_name": "dis_dos.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/phebqpiojqxmka8jvn7nhsohoe7h?response-content-disposition=attachment%3B%20filename%3D%22dis_dos.mp4%22%3B%20filename%2A%3DUTF-8%27%27dis_dos.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTHA2OA5Y%2F20251018%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251018T171508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBcaCXVzLXdlc3QtMiJHMEUCIGumxqg49gvQdTf%2Blei3F2YyTCZEGe7MFnASC90wN5mLAiEA5H%2Fo7Lko%2FufSW8p1s%2B4MUKExYyHQLwZXLM7ihWrKLEsquwUIwP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJrlreC5j1OQi32hFCqPBWpRRq9coDY8Xv091ELyqvH0rbqJ7x4ZnRqnQAXxihzsbBXhlAXqf%2BBWhKwdLHOtu%2FGdSV%2F10wQqB4kw9IhfVh57uYhi%2FgKeTnSdGQ7IKDxwQnxmmxK5In890Hlfw4mIED9OlXNn8Fyj%2BI64LHAZ0Y4UqX75wPHIzlBL%2FCJQcOjaaeQ1SRAxavEVLt3yJOz7yVcJBqCrA5w25iQWOjP6SgxgyzUZoxZwg%2BJV14z1%2FKw94d%2FmFUE2Fl1tX5VRmxplTYTrMugAvN9Zw17l6eQJTxOB0v%2Bw58BDi7kHoszec50zkp%2FCwzVVWkKT9K3ISJa18LhzFEUg8EhBGi3nSFdcecrenlF7VrjldNqhvGDkF%2BbxTvCBq5CZP6BCPe7piuOxt2HLJXHyndw5zSJpT6e8H2BFbEeXpgwez1jszL0%2F76x7zRYNGTx6SNBm5ezoNmxDCp7vTuU9KyS2%2FQUbVzkQuljeTv8Q2syoZRMWhOuxGRHsXuobaC39XnIaZPrnZrxQnBuhXQw%2FOOSTdPAtypIIF24NA0Qdo2ImkxNYTsaMuSwITQUoCL1d1Uhre68roTF6lqXLDahXUAT52qu22kbJog1dGJgt5dgW8qUtQyEDWtwsk7jQFSIzFv1cXZRaAEX5VVc8%2BEQnvqr8HycA6qY6ONY%2FNZmcF2XT0k%2BzNbEsT%2FieE2CfOn0sF3p01jqCNUGUOtog%2F5ZxHCqBef8i22CLJoQsoRbpPYd7ZayIdV5HfnVtsFSMZqdsDwydNFPaCRBSTdeuINWmcTz8VZJ57iNx5UAJKjRRKoTbY5LuGwys3lMe9h1Xe%2BULIdEKCvMq56HV3BUEWl4RBOuCaSjyBjjjZDeVkCFTEUxyeKNTZrNmALwwgdTOxwY6sQFWjq3SoEQrFImUZXIJid5h%2FZlMrvGiS%2FZU8C4YPc%2B0LCwN39%2FMETsgsNeVidC2Nykpyu%2BbvCdCmPtk3cPkL8Dz6pognOI3%2F3CuoL3CMW42Oc3OG6nsdPVl4bOFzQnAjZ2sSV5NPq3cDqoKz6RJBa%2BmWhdIEeYaj32N3fETmCaqBvgQkICS8lD%2BOEVqy%2B43Q4bjICihMS9dfKkym428SIyuDj66GoG%2FGyinfZWKYw8u%2Fsc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d7574b76e3cf892990db2d35a020f6c616ce79170f10762727cd086c7a0d713b",
      "file_size": 78785354,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 4182646,
      "file_name": "dis_2.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5dhf776pb769lwp94ky8g4c2t1pz?response-content-disposition=attachment%3B%20filename%3D%22dis_2.png%22%3B%20filename%2A%3DUTF-8%27%27dis_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTHA2OA5Y%2F20251018%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251018T171508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBcaCXVzLXdlc3QtMiJHMEUCIGumxqg49gvQdTf%2Blei3F2YyTCZEGe7MFnASC90wN5mLAiEA5H%2Fo7Lko%2FufSW8p1s%2B4MUKExYyHQLwZXLM7ihWrKLEsquwUIwP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJrlreC5j1OQi32hFCqPBWpRRq9coDY8Xv091ELyqvH0rbqJ7x4ZnRqnQAXxihzsbBXhlAXqf%2BBWhKwdLHOtu%2FGdSV%2F10wQqB4kw9IhfVh57uYhi%2FgKeTnSdGQ7IKDxwQnxmmxK5In890Hlfw4mIED9OlXNn8Fyj%2BI64LHAZ0Y4UqX75wPHIzlBL%2FCJQcOjaaeQ1SRAxavEVLt3yJOz7yVcJBqCrA5w25iQWOjP6SgxgyzUZoxZwg%2BJV14z1%2FKw94d%2FmFUE2Fl1tX5VRmxplTYTrMugAvN9Zw17l6eQJTxOB0v%2Bw58BDi7kHoszec50zkp%2FCwzVVWkKT9K3ISJa18LhzFEUg8EhBGi3nSFdcecrenlF7VrjldNqhvGDkF%2BbxTvCBq5CZP6BCPe7piuOxt2HLJXHyndw5zSJpT6e8H2BFbEeXpgwez1jszL0%2F76x7zRYNGTx6SNBm5ezoNmxDCp7vTuU9KyS2%2FQUbVzkQuljeTv8Q2syoZRMWhOuxGRHsXuobaC39XnIaZPrnZrxQnBuhXQw%2FOOSTdPAtypIIF24NA0Qdo2ImkxNYTsaMuSwITQUoCL1d1Uhre68roTF6lqXLDahXUAT52qu22kbJog1dGJgt5dgW8qUtQyEDWtwsk7jQFSIzFv1cXZRaAEX5VVc8%2BEQnvqr8HycA6qY6ONY%2FNZmcF2XT0k%2BzNbEsT%2FieE2CfOn0sF3p01jqCNUGUOtog%2F5ZxHCqBef8i22CLJoQsoRbpPYd7ZayIdV5HfnVtsFSMZqdsDwydNFPaCRBSTdeuINWmcTz8VZJ57iNx5UAJKjRRKoTbY5LuGwys3lMe9h1Xe%2BULIdEKCvMq56HV3BUEWl4RBOuCaSjyBjjjZDeVkCFTEUxyeKNTZrNmALwwgdTOxwY6sQFWjq3SoEQrFImUZXIJid5h%2FZlMrvGiS%2FZU8C4YPc%2B0LCwN39%2FMETsgsNeVidC2Nykpyu%2BbvCdCmPtk3cPkL8Dz6pognOI3%2F3CuoL3CMW42Oc3OG6nsdPVl4bOFzQnAjZ2sSV5NPq3cDqoKz6RJBa%2BmWhdIEeYaj32N3fETmCaqBvgQkICS8lD%2BOEVqy%2B43Q4bjICihMS9dfKkym428SIyuDj66GoG%2FGyinfZWKYw8u%2Fsc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ae934a9f988e504222a28a9529ac0c4d930c0099eed0fc4ffe2352dc84dc3a60",
      "file_size": 605097,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4182647,
      "file_name": "dis_3.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9wtk1inedcvfc876y26vho4jy4re?response-content-disposition=attachment%3B%20filename%3D%22dis_3.png%22%3B%20filename%2A%3DUTF-8%27%27dis_3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTHA2OA5Y%2F20251018%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251018T171508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBcaCXVzLXdlc3QtMiJHMEUCIGumxqg49gvQdTf%2Blei3F2YyTCZEGe7MFnASC90wN5mLAiEA5H%2Fo7Lko%2FufSW8p1s%2B4MUKExYyHQLwZXLM7ihWrKLEsquwUIwP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJrlreC5j1OQi32hFCqPBWpRRq9coDY8Xv091ELyqvH0rbqJ7x4ZnRqnQAXxihzsbBXhlAXqf%2BBWhKwdLHOtu%2FGdSV%2F10wQqB4kw9IhfVh57uYhi%2FgKeTnSdGQ7IKDxwQnxmmxK5In890Hlfw4mIED9OlXNn8Fyj%2BI64LHAZ0Y4UqX75wPHIzlBL%2FCJQcOjaaeQ1SRAxavEVLt3yJOz7yVcJBqCrA5w25iQWOjP6SgxgyzUZoxZwg%2BJV14z1%2FKw94d%2FmFUE2Fl1tX5VRmxplTYTrMugAvN9Zw17l6eQJTxOB0v%2Bw58BDi7kHoszec50zkp%2FCwzVVWkKT9K3ISJa18LhzFEUg8EhBGi3nSFdcecrenlF7VrjldNqhvGDkF%2BbxTvCBq5CZP6BCPe7piuOxt2HLJXHyndw5zSJpT6e8H2BFbEeXpgwez1jszL0%2F76x7zRYNGTx6SNBm5ezoNmxDCp7vTuU9KyS2%2FQUbVzkQuljeTv8Q2syoZRMWhOuxGRHsXuobaC39XnIaZPrnZrxQnBuhXQw%2FOOSTdPAtypIIF24NA0Qdo2ImkxNYTsaMuSwITQUoCL1d1Uhre68roTF6lqXLDahXUAT52qu22kbJog1dGJgt5dgW8qUtQyEDWtwsk7jQFSIzFv1cXZRaAEX5VVc8%2BEQnvqr8HycA6qY6ONY%2FNZmcF2XT0k%2BzNbEsT%2FieE2CfOn0sF3p01jqCNUGUOtog%2F5ZxHCqBef8i22CLJoQsoRbpPYd7ZayIdV5HfnVtsFSMZqdsDwydNFPaCRBSTdeuINWmcTz8VZJ57iNx5UAJKjRRKoTbY5LuGwys3lMe9h1Xe%2BULIdEKCvMq56HV3BUEWl4RBOuCaSjyBjjjZDeVkCFTEUxyeKNTZrNmALwwgdTOxwY6sQFWjq3SoEQrFImUZXIJid5h%2FZlMrvGiS%2FZU8C4YPc%2B0LCwN39%2FMETsgsNeVidC2Nykpyu%2BbvCdCmPtk3cPkL8Dz6pognOI3%2F3CuoL3CMW42Oc3OG6nsdPVl4bOFzQnAjZ2sSV5NPq3cDqoKz6RJBa%2BmWhdIEeYaj32N3fETmCaqBvgQkICS8lD%2BOEVqy%2B43Q4bjICihMS9dfKkym428SIyuDj66GoG%2FGyinfZWKYw8u%2Fsc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fcc7ef95941986c60031e67a21670c4561b925421992051469c51c4c6a562acb",
      "file_size": 1423788,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4182648,
      "file_name": "dis_1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hl6suhkedx4nva891nbvhy1s0ngr?response-content-disposition=attachment%3B%20filename%3D%22dis_1.png%22%3B%20filename%2A%3DUTF-8%27%27dis_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTHA2OA5Y%2F20251018%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251018T171508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBcaCXVzLXdlc3QtMiJHMEUCIGumxqg49gvQdTf%2Blei3F2YyTCZEGe7MFnASC90wN5mLAiEA5H%2Fo7Lko%2FufSW8p1s%2B4MUKExYyHQLwZXLM7ihWrKLEsquwUIwP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJrlreC5j1OQi32hFCqPBWpRRq9coDY8Xv091ELyqvH0rbqJ7x4ZnRqnQAXxihzsbBXhlAXqf%2BBWhKwdLHOtu%2FGdSV%2F10wQqB4kw9IhfVh57uYhi%2FgKeTnSdGQ7IKDxwQnxmmxK5In890Hlfw4mIED9OlXNn8Fyj%2BI64LHAZ0Y4UqX75wPHIzlBL%2FCJQcOjaaeQ1SRAxavEVLt3yJOz7yVcJBqCrA5w25iQWOjP6SgxgyzUZoxZwg%2BJV14z1%2FKw94d%2FmFUE2Fl1tX5VRmxplTYTrMugAvN9Zw17l6eQJTxOB0v%2Bw58BDi7kHoszec50zkp%2FCwzVVWkKT9K3ISJa18LhzFEUg8EhBGi3nSFdcecrenlF7VrjldNqhvGDkF%2BbxTvCBq5CZP6BCPe7piuOxt2HLJXHyndw5zSJpT6e8H2BFbEeXpgwez1jszL0%2F76x7zRYNGTx6SNBm5ezoNmxDCp7vTuU9KyS2%2FQUbVzkQuljeTv8Q2syoZRMWhOuxGRHsXuobaC39XnIaZPrnZrxQnBuhXQw%2FOOSTdPAtypIIF24NA0Qdo2ImkxNYTsaMuSwITQUoCL1d1Uhre68roTF6lqXLDahXUAT52qu22kbJog1dGJgt5dgW8qUtQyEDWtwsk7jQFSIzFv1cXZRaAEX5VVc8%2BEQnvqr8HycA6qY6ONY%2FNZmcF2XT0k%2BzNbEsT%2FieE2CfOn0sF3p01jqCNUGUOtog%2F5ZxHCqBef8i22CLJoQsoRbpPYd7ZayIdV5HfnVtsFSMZqdsDwydNFPaCRBSTdeuINWmcTz8VZJ57iNx5UAJKjRRKoTbY5LuGwys3lMe9h1Xe%2BULIdEKCvMq56HV3BUEWl4RBOuCaSjyBjjjZDeVkCFTEUxyeKNTZrNmALwwgdTOxwY6sQFWjq3SoEQrFImUZXIJid5h%2FZlMrvGiS%2FZU8C4YPc%2B0LCwN39%2FMETsgsNeVidC2Nykpyu%2BbvCdCmPtk3cPkL8Dz6pognOI3%2F3CuoL3CMW42Oc3OG6nsdPVl4bOFzQnAjZ2sSV5NPq3cDqoKz6RJBa%2BmWhdIEeYaj32N3fETmCaqBvgQkICS8lD%2BOEVqy%2B43Q4bjICihMS9dfKkym428SIyuDj66GoG%2FGyinfZWKYw8u%2Fsc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=19d25e088518a17332ade9dda34097180f0fd20c7f90bc97bb709cb6750107af",
      "file_size": 147772,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2025-10-18T16:47:00.012Z",
  "allow_singular_disclosure_after": -1688.96329062,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "theteatoast"
  ],
  "severity": {
    "rating": "high",
    "score": 7.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 63654,
    "asset_type": "URL",
    "asset_identifier": "try.discourse.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
