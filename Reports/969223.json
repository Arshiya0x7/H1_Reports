{
  "id": 969223,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjkyMjM=",
  "url": "https://hackerone.com/reports/969223",
  "title": "IDOR to Account Takeover on https://████/index.html",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-08-27T19:24:05.440Z",
  "submitted_at": "2020-08-27T19:24:05.465Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nagli",
    "url": "/nagli",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/lt7o04x81mv0oaajg30e8xmlz74t/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-09-29T20:30:56.276Z",
  "bug_reporter_agreed_on_going_public_at": "2020-09-25T10:57:37.311Z",
  "team_member_agreed_on_going_public_at": "2020-09-29T20:30:56.172Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello Team!\n\n**Summary:**\n\nI found when you wish to update your profile on https://███████/ after your login through https://██████████/signIn/signIn.html website due to an IDOR.\n\nThis IDOR gives you the opportunity to change the origin email for the registered account by changing the ID parameter on the following request, i assume that if i would do it on the id=1 i would takeover the admin account, this is due to not requiring the OLD password to make an email change, aswell as no restriction to make POST actions on different account IDS.\n\n\n**Description:**\n\nIDOR chained to full Account Takeover on ██████ domain.\n\nAccount\n## Step-by-step Reproduction Instructions\n\n1. Register an account at https://█████████/signIn/CreateAccount.html (Attacker)\n2. Login to your account and go the https://███████/signIn/account page\n3. Click on the \"update\" button located at thetop middle, and capture the request on BURP\n4. Now change the ID parameter on the request to the victims, change the email, and you successfully have managed to switch his email.\n\nRequest:\n\n███\n\n\nVideo PoC:\n\n█████\n\n## Suggested Mitigation/Remediation Actions\n\n1. Implementing email request change based on OLD password input\n2. Returning 403/401 when user account attempts to change another user ID settings.\n\n## Disclaimer\n\nas you might notice the domain is https://██████/signIn/signIn.html when you sign in (.mil site), and it redirects you afterwards to https://██████████/ with the Compromised account, therefore i considered this In Scope.\n\nBest Regards,\nNagli\n\n## Impact\n\nIssuing the malicious request on the victim account ID will lead to account takeover by replacing the email of the victim with the email of the attacker, and requesting a new password using the Forgot password option.",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 24,
  "voters": [
    "johnberzi",
    "njmulsqb",
    "loaymorad",
    "nagli",
    "xnutronex",
    "shubham_srt",
    "raywando",
    "dastan_9408",
    "what_web",
    "rashedul_css",
    "and 14 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 25470,
      "category": "team",
      "content": "More details about the report could be found at my blogpost:\nhttps://naglinagli.github.io/DoD_IDOR/ \n\nI would like to thank the DoD for a quick triage and resolution regarding the issue.",
      "updated_at": "2020-11-17T19:49:32.162Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 214795,
        "username": "ag3nt-j1",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2017-11-06T15:24:53.182Z",
        "url": "https://hackerone.com/ag3nt-j1",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/h2qk55pqyzyg0w59mrpu8ldc5e1k/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/h2qk55pqyzyg0w59mrpu8ldc5e1k/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTkxMzk5MiwicHVyIjoiYmxvYl9pZCJ9fQ==--11aa16292ce419c1b79e0765832f3b560ab3f6c1/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/FOIi7ykWUAAnLRx.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
