{
  "id": 880099,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODAwOTk=",
  "url": "https://hackerone.com/reports/880099",
  "title": "Unrestricted file upload leads to Stored XSS",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-05-21T22:44:05.566Z",
  "submitted_at": "2020-05-21T22:44:05.566Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "semsem123",
    "url": "/semsem123",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Xh2KQ1oCovYMnsUG6nQGt9bJ/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-08-03T12:26:14.686Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-03T12:26:14.565Z",
  "team_member_agreed_on_going_public_at": "2020-08-03T11:43:40.418Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\n\ni found that i can upload png file with JavaScript code and execute it in wiki page.\n\n### Steps to reproduce\n\n(Step-by-step guide to reproduce the issue, including:)\n\n1-login to gitlab account\n2-open  your project\n3-open Wiki page.\n4-Click \"New page\" button.\n5-attach png file which contain below code\n `<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg onload=\"alert(1)\" xmlns=\"http://www.w3.org/2000/svg\">\n<polygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"#004400\"/>\n</svg>`\n6-Click \"Create page\" button.\n7-Click on green triangle \n8-if The alert dialog not appears from first time just click on it one more time \n\n\n\n### Impact\n\nIf wiki pages created by using this vulnerability are visible to everyone (Wiki Visibility setting is set to \"Everyone With Access\") in \"Public\" project, there is a possibility that a considerable number of GitLab users and visitors click a malicious link.\n\n### Examples\ngitlab.com\n\ntested on Google Chrome\n\nhttps://gitlab.com/semsemhacker123/semsemtest/-/wikis/ssaa-home\nhttps://gitlab.com/semsemhacker123/semsemtest/-/wikis/uploads/1308853a75502f77b3e22a2f9b0cc88a/1111111.png\n\n### What is the current *bug* behavior?\n\nThe alert dialog appears after clicking \"green triangle \" in created page.\n\n### What is the expected *correct* behavior?\n\nthe png file it must be not executed as  `image/svg+xml`\n\n## Impact\n\nAn attacker can use XSS to send a malicious script to an unsuspecting user. The end userâ€™s browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 838084,
      "file_name": "1111111.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WyXV7fRahydfSDQMNBhzdtFs?response-content-disposition=attachment%3B%20filename%3D%221111111.png%22%3B%20filename%2A%3DUTF-8%27%271111111.png&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWU6W3YR5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T093431Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICT0En%2BDp3YvkU5SZTMMxyrxZ7Ft1kjGs0IfO0I0AURKAiBzPKfBO1C%2B2pCTovANeKuAfSdy4RsfE1ELoIif4DmyFSqyBQgQEAMaDDAxMzYxOTI3NDg0OSIMMMUD2e96ZEe%2FBdbRKo8FIlyj3ImbR9P06VhgB6i5aYNVl6QUpN%2BFF7fdK3GXoPBqBe3RTAQT41ylUVef1%2B0Ull7xXvkcKxmySy5oHwtsW1W0C%2BryYu%2FkH0g7bnnrui%2B37bTv9q3NirU5lM1ouACBHYCXgh5cLxBZSzNZyz2uLBpkGvQOoKMt7nCSzfoogUx5KioZ0dCruLtwe6F08e8zDbtosxk9yBLWSnNd7CPWHfhgmB45eh0S1yTOY11mPDb1r%2FjlVEeJldaQx5hc439Ci9k1oQFbcGeM3mmRtheuudScCDfn1Tly8PE9TZLyKebcSjqSjReoxWyPxLvTaUCiX%2FicbsD3E%2BHE5xmVdPnPvPvLmUMUbVKbwMG2bHYGHi1HHpsz9Qxc5Ktat8vqwLEm53cQSFHducawN5aCs7Dona4hV5xmg5NeJ1Enco0X9RF0dRSLPhbyEaLZ%2B62tXVfi4zuGZaOVf416yhstpqu5PD3yxDpm%2ByMpNcpYXzvix519V%2BMrddrq6O%2BM1plTpZHvuqubpZ5CxNomzEIXXzswlsrDPYdqIacYQzjx76XObIQVjaReOIqFnsTOo1r3sTrBekl08DjWetk8bamlsWj9p9ppv9UWnMLwq7dfPspIBZFAKO6R1PtixRYbPD%2Ft4shblVUHq9BFfKWbTNq6b%2Bm%2BLhXQJZHI6EvvdbQhCurcb5VJlUt8KpPNdMeCsSGkmhEb3yIpqmZDxGs0FKfwyKK%2FeaMWoPlsVhHQBzTbncbZ5slJ7WUXC%2BjUaeqvPzpzfJmyNbQgYN5%2BJNPBldEoHyEDich4kebgeZEAjP7l4pY6CrqPzIJr5YJA3evbU8Yy4kOBrIzX6AQSk8%2FV%2BTkIH3j%2F5tXsfWwhAubCp%2FhLiIWVaDCpyr7GBjqyATq3IYcvNvIRPYX18R6%2BpLLs6exiiEC17bSLS95ViceA9Jj1Iuq4V5pxaCDvppKuMPH0olISPV7QXjgviGlfbNmpQh2jq32bnftPRkKD2Q3dVqJ8lDtIXP4Oz176Je1gOTGaC3TJJVi8%2BO2AS3GMhyJi1zbnAP0IvjuOu6%2F30CYDqkUDk%2Ff3y1XLjr8jyjdsUPthzw317AhVZSSN%2Fb5xXtI4%2BJLd6oxzZ1MpEy6coOiq2CA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7dacc6c7b8fa0754c64164a1708e63e90bb48f22d2abda9e129ba30a39f3dff4",
      "file_size": 282,
      "type": "image/svg+xml",
      "moderated": null
    },
    {
      "id": 838086,
      "file_name": "gitlab_poc.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jDSubisuiC76dz4RmiULGPnk?response-content-disposition=attachment%3B%20filename%3D%22gitlab_poc.png%22%3B%20filename%2A%3DUTF-8%27%27gitlab_poc.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWU6W3YR5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T093431Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICT0En%2BDp3YvkU5SZTMMxyrxZ7Ft1kjGs0IfO0I0AURKAiBzPKfBO1C%2B2pCTovANeKuAfSdy4RsfE1ELoIif4DmyFSqyBQgQEAMaDDAxMzYxOTI3NDg0OSIMMMUD2e96ZEe%2FBdbRKo8FIlyj3ImbR9P06VhgB6i5aYNVl6QUpN%2BFF7fdK3GXoPBqBe3RTAQT41ylUVef1%2B0Ull7xXvkcKxmySy5oHwtsW1W0C%2BryYu%2FkH0g7bnnrui%2B37bTv9q3NirU5lM1ouACBHYCXgh5cLxBZSzNZyz2uLBpkGvQOoKMt7nCSzfoogUx5KioZ0dCruLtwe6F08e8zDbtosxk9yBLWSnNd7CPWHfhgmB45eh0S1yTOY11mPDb1r%2FjlVEeJldaQx5hc439Ci9k1oQFbcGeM3mmRtheuudScCDfn1Tly8PE9TZLyKebcSjqSjReoxWyPxLvTaUCiX%2FicbsD3E%2BHE5xmVdPnPvPvLmUMUbVKbwMG2bHYGHi1HHpsz9Qxc5Ktat8vqwLEm53cQSFHducawN5aCs7Dona4hV5xmg5NeJ1Enco0X9RF0dRSLPhbyEaLZ%2B62tXVfi4zuGZaOVf416yhstpqu5PD3yxDpm%2ByMpNcpYXzvix519V%2BMrddrq6O%2BM1plTpZHvuqubpZ5CxNomzEIXXzswlsrDPYdqIacYQzjx76XObIQVjaReOIqFnsTOo1r3sTrBekl08DjWetk8bamlsWj9p9ppv9UWnMLwq7dfPspIBZFAKO6R1PtixRYbPD%2Ft4shblVUHq9BFfKWbTNq6b%2Bm%2BLhXQJZHI6EvvdbQhCurcb5VJlUt8KpPNdMeCsSGkmhEb3yIpqmZDxGs0FKfwyKK%2FeaMWoPlsVhHQBzTbncbZ5slJ7WUXC%2BjUaeqvPzpzfJmyNbQgYN5%2BJNPBldEoHyEDich4kebgeZEAjP7l4pY6CrqPzIJr5YJA3evbU8Yy4kOBrIzX6AQSk8%2FV%2BTkIH3j%2F5tXsfWwhAubCp%2FhLiIWVaDCpyr7GBjqyATq3IYcvNvIRPYX18R6%2BpLLs6exiiEC17bSLS95ViceA9Jj1Iuq4V5pxaCDvppKuMPH0olISPV7QXjgviGlfbNmpQh2jq32bnftPRkKD2Q3dVqJ8lDtIXP4Oz176Je1gOTGaC3TJJVi8%2BO2AS3GMhyJi1zbnAP0IvjuOu6%2F30CYDqkUDk%2Ff3y1XLjr8jyjdsUPthzw317AhVZSSN%2Fb5xXtI4%2BJLd6oxzZ1MpEy6coOiq2CA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2182789597452645bda6a8a89e88db1200b1c6fc9fb33f04dd06519df0ce0bc4",
      "file_size": 24332,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 85,
  "voters": [
    "sky003",
    "he4am",
    "m0chan",
    "mattberg",
    "ali",
    "sameerphad72",
    "ivreznap",
    "spam404",
    "leonishan",
    "m0x01",
    "and 75 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
