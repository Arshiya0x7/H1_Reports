{
  "id": 1167916,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY3OTE2",
  "url": "https://hackerone.com/reports/1167916",
  "title": "Default Nextcloud Server and Android Client leak sharee searches to Nextcloud",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-04-18T18:12:19.132Z",
  "submitted_at": "2021-04-18T18:12:19.193Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rtod",
    "url": "/rtod",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-22905"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-06-15T19:11:31.101Z",
  "bug_reporter_agreed_on_going_public_at": "2021-06-15T19:11:31.053Z",
  "team_member_agreed_on_going_public_at": "2021-06-01T18:04:38.330Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "On a clean Nextcloud setup the functionality \"Search global and public address book for users\" is enabled.\n\nNow when searching for a sharee to share with. The lookup parameter is not passed to the server. Resulting in\nhttps://github.com/nextcloud/server/blob/master/apps/files_sharing/lib/Controller/ShareesAPIController.php#L144\n\nthe lookup being true. So the lookup server of Nextcloud will be searched by default.\nIt seems that the lookup server is down now. But this seems to be an error I assume?\n\n## Impact\n\nAnybody sharing trough the android app. Leaks their sharee searches to the Nextcloud lookup server.\nNow the server can can only see the origin Nextcloud server (or rather the IP of that). Still. This should not be leaked by default.\n\nOn the web and desktop there is first a local search. And only if the user explicitly presses the search globally the lookup server is queried. (to be fair this could also be more clear that it actually sends data to other systems)",
  "bounty_amount": "750.0",
  "formatted_bounty": "$750",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-07-01T18:04:38.463Z",
  "allow_singular_disclosure_after": -133259554.93183076,
  "singular_disclosure_allowed": true,
  "vote_count": 57,
  "voters": [
    "osman1337",
    "wi11",
    "aagat_sh",
    "alp",
    "0x3f",
    "shreyaschavhan",
    "ali",
    "run_win",
    "tess",
    "akashhamal0x01",
    "and 47 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 1,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.nextcloud.client",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
