{
  "id": 1656380,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjU2Mzgw",
  "url": "https://hackerone.com/reports/1656380",
  "title": "Reddit talk promotion offers don't expire, allowing users to accept them after being demoted",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-08-01T15:44:16.502Z",
  "submitted_at": "2022-08-01T15:44:16.672Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ahacker1",
    "url": "/ahacker1",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vllgks9w6232xyo136ujj5cbt47w/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35710,
    "url": "https://hackerone.com/reddit",
    "handle": "reddit",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/osci5oey0q0wkiom39bk5onv8p7q/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/osci5oey0q0wkiom39bk5onv8p7q/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Reddit",
      "twitter_handle": "reddit",
      "website": "https://www.reddit.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-10-03T15:25:08.187Z",
  "bug_reporter_agreed_on_going_public_at": "2022-10-01T19:55:54.124Z",
  "team_member_agreed_on_going_public_at": "2022-10-03T15:25:08.012Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Description: \n\nWhen promoting a user to a speaker/host, an offerId is created which can be accepted by the user. However, after accepting them the offerIds don't expire. This means that after the user is demoted back to a listener, they can still use the offerIds to go back to their previous promoted role.\n\n## Steps To Reproduce:\n\n1. Have 2 accounts ready UserAVictim and UserBAttacker.\n2. Create a new reddit talk as UserAVictim.\n3. As UserB join the talk.\n4. As UserA promote UserB to the speaker (works as well with host). This can be done by clicking their avatar and choosing invite to speak (to promote to speaker) or add as host (to promote to host).\n5. As UserB notice that a pop up appears saying \"USER has invited you to speak\". Monitor and save the request used when clicking accept.\nThe request should be to https://gql.reddit.com \nThe body should be similar to \n{\"variables\":{\"platformUserId\":\"PLATFORM_USER_ID\",\"offerId\":\"UUID_OFFER_ID\"},\"id\":\"475c91dd4480\"}\n6. As UserA demote UserB to listener. (Click UserB's avatar and click Move to Audience)\n7. As UserB repeat/re-send the request used in step 5. Notice that you will be promoted back to speaker/host.\nThis works even after you are demoted again.\n\n## Impact\n\nThis allows speakers/hosts of a talk to re-become a speaker/host at any time after being demoted. This could lead to interruptions to the reddit talk.",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 65,
  "voters": [
    "8910jq",
    "tinmo",
    "jumpydata",
    "n1m0",
    "ahacker1",
    "thruster",
    "proper-lay",
    "zy9ard3",
    "shreyaschavhan",
    "7odamoo",
    "and 55 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 18825,
    "asset_type": "URL",
    "asset_identifier": "www.reddit.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
