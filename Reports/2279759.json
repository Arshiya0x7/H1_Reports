{
  "id": 2279759,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjc5NzU5",
  "url": "https://hackerone.com/reports/2279759",
  "title": "curl HSTS long file name clears contents ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-12-10T13:40:42.322Z",
  "submitted_at": "2023-12-10T13:40:42.485Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cxshakal",
    "url": "/cxshakal",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ewptesqsck4sgonbahylt19o68vi/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22shakal.jpg%22%3B%20filename%2A%3DUTF-8%27%27shakal.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSKB2FQVG%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T193035Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJIMEYCIQD7MAK8tbcUewbApwJe3CJ6yN7fT9PV3MY4F9JXNU1K5AIhAK7ASYtwmIBZ60ySZI3bSJzYTbIU3OrzA0fJLPV8aoyoKrsFCPL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwUsPDJHp3H0KpDoqcqjwWbVKzMpetPCLAbcRQLGtHLwDevjWPYj0SAWzAsfXULr6ggeLDwpEN5gtdbXTiumxqkcord59Xwt5y1b4hc5sx%2Fo9T1tXwZRk2LD6qLUxCs3vkYjnm9Xhn3YUs2O48L8my3T4GbV9sQOl9qXfy99jO6TUCjN6%2Fo9kf6LAGkW2H7BO%2FLWluI8cyAppBEj%2B%2FK%2BXyffAhvNFvrFuKs%2F0jPi6qZCeRTsaGnhB3%2FH29VMlUJWPDToNkVg%2FWQ2lLSIEjo5WHhxG9EJ49F%2FIvpfUOUR%2BDgXNEyVYGTvcumnVKhWckIQHMqewt19CYvjr%2BH3UGNvu8%2FDWxrKI8wweEVPmtCiVN0%2FWIekTqf2vAviO70QHjiZAwshlkqq4qrFkenaWkjvqAZGZhybQ53MVqqceC0bWdjZAcGfnaGBKKDAcye9wC94mLcY2AlHVtsoA2LR7wJ%2BUcZQysXVikJ58vTniOcJFGfqFhaC2bJGvhX%2F22RSW40Jd%2FzcmYrD1sAVkP8FTH3ysPc6N15m0iBboRZ0i2g3edxAzN9GS2UvF2NX2aDqM864RH1vvs%2BZbSylsqLn2GW%2BWD1LjEObBQV%2F8PVhhgT8zKOOBnDUwXnYJb8DZ9SbnHkvUqsKL4GjFgyehcUCJ3LRYnCpoN%2FzXwAK8Fkns3uBOUtq0FetkG9K8mk7GBPg%2Fu3SSQAu6hAj0ZJxpqsaKipVM%2FO8Dax4NzXtgjYvaE84XZLP05WkGyFIIQI9DZcRxwrWko7FOs7qalJsmNGzxAt22RowFPrX9PmfT93eVxaECfiqzrv%2BywekNX57eI7ZZx8249coRA%2BaS4Tk67SK%2BYLAQCJOu2D%2Fz%2ByJ8Bf1T8BDUC3ASTaFqFRX0LxRjdj9NrWMM%2B%2Fu8YGOrABF%2FC8bMq8eP9v6YreMtbSLQExVZBQECAsI6C5J69iZ9LA8GIDwCSPnqTBLnLEtc42l%2FEquIlBiX9q9zivb2lmOb1gP0OyBQHlojjYz%2FLoLltcMQI8iT2E5skFjBBdACiEBqnCkCkK18ssiGwuuq6HBNLWpZVdVVDzziLoOi%2F93A24YKGa63MUsbh8vLBeINjls0ZaiOS%2B8nw1enqEz%2BL3euYvLg3NVDgvfA8ybv%2FC%2FE8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=17e90f61b47da36fe2942379a52828fe185cb536cc73d8ae2420cb3b0388ea9b"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSKB2FQVG%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T193035Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJIMEYCIQD7MAK8tbcUewbApwJe3CJ6yN7fT9PV3MY4F9JXNU1K5AIhAK7ASYtwmIBZ60ySZI3bSJzYTbIU3OrzA0fJLPV8aoyoKrsFCPL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwUsPDJHp3H0KpDoqcqjwWbVKzMpetPCLAbcRQLGtHLwDevjWPYj0SAWzAsfXULr6ggeLDwpEN5gtdbXTiumxqkcord59Xwt5y1b4hc5sx%2Fo9T1tXwZRk2LD6qLUxCs3vkYjnm9Xhn3YUs2O48L8my3T4GbV9sQOl9qXfy99jO6TUCjN6%2Fo9kf6LAGkW2H7BO%2FLWluI8cyAppBEj%2B%2FK%2BXyffAhvNFvrFuKs%2F0jPi6qZCeRTsaGnhB3%2FH29VMlUJWPDToNkVg%2FWQ2lLSIEjo5WHhxG9EJ49F%2FIvpfUOUR%2BDgXNEyVYGTvcumnVKhWckIQHMqewt19CYvjr%2BH3UGNvu8%2FDWxrKI8wweEVPmtCiVN0%2FWIekTqf2vAviO70QHjiZAwshlkqq4qrFkenaWkjvqAZGZhybQ53MVqqceC0bWdjZAcGfnaGBKKDAcye9wC94mLcY2AlHVtsoA2LR7wJ%2BUcZQysXVikJ58vTniOcJFGfqFhaC2bJGvhX%2F22RSW40Jd%2FzcmYrD1sAVkP8FTH3ysPc6N15m0iBboRZ0i2g3edxAzN9GS2UvF2NX2aDqM864RH1vvs%2BZbSylsqLn2GW%2BWD1LjEObBQV%2F8PVhhgT8zKOOBnDUwXnYJb8DZ9SbnHkvUqsKL4GjFgyehcUCJ3LRYnCpoN%2FzXwAK8Fkns3uBOUtq0FetkG9K8mk7GBPg%2Fu3SSQAu6hAj0ZJxpqsaKipVM%2FO8Dax4NzXtgjYvaE84XZLP05WkGyFIIQI9DZcRxwrWko7FOs7qalJsmNGzxAt22RowFPrX9PmfT93eVxaECfiqzrv%2BywekNX57eI7ZZx8249coRA%2BaS4Tk67SK%2BYLAQCJOu2D%2Fz%2ByJ8Bf1T8BDUC3ASTaFqFRX0LxRjdj9NrWMM%2B%2Fu8YGOrABF%2FC8bMq8eP9v6YreMtbSLQExVZBQECAsI6C5J69iZ9LA8GIDwCSPnqTBLnLEtc42l%2FEquIlBiX9q9zivb2lmOb1gP0OyBQHlojjYz%2FLoLltcMQI8iT2E5skFjBBdACiEBqnCkCkK18ssiGwuuq6HBNLWpZVdVVDzziLoOi%2F93A24YKGa63MUsbh8vLBeINjls0ZaiOS%2B8nw1enqEz%2BL3euYvLg3NVDgvfA8ybv%2FC%2FE8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=db97add732a92529af8f8ec063ac76e2f27387dc8204c6a42d0178a35cb11cfa",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSKB2FQVG%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T193035Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJIMEYCIQD7MAK8tbcUewbApwJe3CJ6yN7fT9PV3MY4F9JXNU1K5AIhAK7ASYtwmIBZ60ySZI3bSJzYTbIU3OrzA0fJLPV8aoyoKrsFCPL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwUsPDJHp3H0KpDoqcqjwWbVKzMpetPCLAbcRQLGtHLwDevjWPYj0SAWzAsfXULr6ggeLDwpEN5gtdbXTiumxqkcord59Xwt5y1b4hc5sx%2Fo9T1tXwZRk2LD6qLUxCs3vkYjnm9Xhn3YUs2O48L8my3T4GbV9sQOl9qXfy99jO6TUCjN6%2Fo9kf6LAGkW2H7BO%2FLWluI8cyAppBEj%2B%2FK%2BXyffAhvNFvrFuKs%2F0jPi6qZCeRTsaGnhB3%2FH29VMlUJWPDToNkVg%2FWQ2lLSIEjo5WHhxG9EJ49F%2FIvpfUOUR%2BDgXNEyVYGTvcumnVKhWckIQHMqewt19CYvjr%2BH3UGNvu8%2FDWxrKI8wweEVPmtCiVN0%2FWIekTqf2vAviO70QHjiZAwshlkqq4qrFkenaWkjvqAZGZhybQ53MVqqceC0bWdjZAcGfnaGBKKDAcye9wC94mLcY2AlHVtsoA2LR7wJ%2BUcZQysXVikJ58vTniOcJFGfqFhaC2bJGvhX%2F22RSW40Jd%2FzcmYrD1sAVkP8FTH3ysPc6N15m0iBboRZ0i2g3edxAzN9GS2UvF2NX2aDqM864RH1vvs%2BZbSylsqLn2GW%2BWD1LjEObBQV%2F8PVhhgT8zKOOBnDUwXnYJb8DZ9SbnHkvUqsKL4GjFgyehcUCJ3LRYnCpoN%2FzXwAK8Fkns3uBOUtq0FetkG9K8mk7GBPg%2Fu3SSQAu6hAj0ZJxpqsaKipVM%2FO8Dax4NzXtgjYvaE84XZLP05WkGyFIIQI9DZcRxwrWko7FOs7qalJsmNGzxAt22RowFPrX9PmfT93eVxaECfiqzrv%2BywekNX57eI7ZZx8249coRA%2BaS4Tk67SK%2BYLAQCJOu2D%2Fz%2ByJ8Bf1T8BDUC3ASTaFqFRX0LxRjdj9NrWMM%2B%2Fu8YGOrABF%2FC8bMq8eP9v6YreMtbSLQExVZBQECAsI6C5J69iZ9LA8GIDwCSPnqTBLnLEtc42l%2FEquIlBiX9q9zivb2lmOb1gP0OyBQHlojjYz%2FLoLltcMQI8iT2E5skFjBBdACiEBqnCkCkK18ssiGwuuq6HBNLWpZVdVVDzziLoOi%2F93A24YKGa63MUsbh8vLBeINjls0ZaiOS%2B8nw1enqEz%2BL3euYvLg3NVDgvfA8ybv%2FC%2FE8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=39090908db1d45e5ddf22f569981b9b07ef133a3dbd49ae338fdbddfa332a935"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-01-20T17:17:39.985Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-12-21T17:17:27.627Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## VULNERABILITY\nWhen saving HSTS data to an excessively long file name, curl could end up removing all contents, making subsequent requests using that file unaware of the HSTS status they should otherwise use.\n\n## INFO\nThe reason for this bug is that save function appended a suffix to the file name, created a temporary file and then in the last step renamed that to the final name. When the file name length was close to the limit of what is allowed on the file system, adding the extension would make it too long and then trigger this bug.\n\n## Hackerone ticket #2236133\n\n## Impact\n\nHSTS bypass",
  "weakness": {
    "id": 84,
    "name": "Missing Encryption of Sensitive Data"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-01-20T17:17:27.731Z",
  "allow_singular_disclosure_after": -52625587.67446562,
  "singular_disclosure_allowed": true,
  "vote_count": 57,
  "voters": [
    "matusalem",
    "prathap_ilango",
    "8910jq",
    "exec_iq",
    "zy9ard3",
    "pwrspl0it",
    "neilx",
    "saurabhb",
    "011alsanosi",
    "oxf4h1m",
    "and 47 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 80985,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 387000,
      "category": "team",
      "content": "HSTS long file name clears contents\n\nVULNERABILITY\nWhen saving HSTS data to an excessively long file name, curl could end up removing all contents, making subsequent requests using that file unaware of the HSTS status they should otherwise use.\n\nINFO\nThe reason for this bug is that save function appended a suffix to the file name, created a temporary file and then in the last step renamed that to the final name. When the file name length was close to the limit of what is allowed on the file system, adding the extension would make it too long and then trigger this bug.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2023-46219 to this issue.\n\nCWE-311: Missing Encryption of Sensitive Data\n\nSeverity: Low\n\nLink to Security Advisory: https://curl.se/docs/CVE-2023-46219.html",
      "updated_at": "2023-12-21T17:14:47.543Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
