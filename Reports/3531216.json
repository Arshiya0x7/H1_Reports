{
  "id": 3531216,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTMxMjE2",
  "url": "https://hackerone.com/reports/3531216",
  "title": "MQTT Protocol Packet Injection via Unchecked CONNACK Remaining Length",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "low",
  "readable_substate": "Informative",
  "created_at": "2026-01-30T07:05:07.856Z",
  "submitted_at": "2026-01-30T07:05:08.336Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "pajarori",
    "url": "/pajarori",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/k56pge05ygu2rq3rc79wrr6ubrhe/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2026-02-05T04:28:32.060Z",
  "bug_reporter_agreed_on_going_public_at": "2026-02-05T04:28:31.771Z",
  "team_member_agreed_on_going_public_at": "2026-02-04T21:56:19.421Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I'm not sure if this is a vulnerability or intended behavior, but I noticed that curl MQTT implementation accepts CONNACK packets with Remaining Length values greater than 2, which appears to violate the MQTT v3.1.1 specification.\n\nAccording to the MQTT spec, CONNACK packets should have a Remaining Length of exactly 2 bytes, but curl seems to process packets with larger values and treats the extra bytes as new MQTT messages.\n\n- https://docs.oasis-open.org/mqtt/mqtt/v3.1.1/csprd01/mqtt-v3.1.1-csprd01.html#_Toc376954333\n\n## Affected version\n```\nÂ» curl -V\ncurl 8.18.0 (x86_64-pc-linux-gnu) libcurl/8.18.0 OpenSSL/3.6.1 zlib/1.3.1 brotli/1.2.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5 libssh2/1.11.1 nghttp2/1.68.0 ngtcp2/1.20.0 nghttp3/1.15.0 mit-krb5/1.21.3\nRelease-Date: 2026-01-07\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp ws wss\nFeatures: alt-svc AsynchDNS brotli GSS-API HSTS HTTP2 HTTP3 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM PSL SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd\n```\n\n## Steps To Reproduce:\n  1. So in [mqtt_verify_connack](https://github.com/curl/curl/blob/master/lib/mqtt.c#L402) its reads the entire CONNACK packet,but  only validates and consumes the first 2 bytes of the payload.\n ```\nstatic CURLcode mqtt_verify_connack(struct Curl_easy *data)\n{\n  ...\n  result = mqtt_recv_atleast(data, MQTT_CONNACK_LEN);\n  if(result)\n    goto fail;\n  ...\n  if(ptr[0] != 0x00 || ptr[1] != 0x00) {   // only checks first 2 bytes:\n     ...\n  }\n  mqtt_recv_consume(data, MQTT_CONNACK_LEN);\n  ...\n}\n ```\n  1. And in [mqtt_doing](https://github.com/curl/curl/blob/1acf0c45f4ede462a553353d774395b68614a42a/lib/mqtt.c#L901) its reads from the buffer for the next MQTT message, but the leftover bytes are still in the buffer.\n ```\ncase MQTT_CONNACK:\n  result = mqtt_verify_connack(data);\n  ...\n  mqtt->nextstate = MQTT_FIRST; \n ```\n  1. I made a simple python poc script that will mimic MQTT, run this and try with curl to the server and its works to do inject a PUBLISH command.\n\n {F5294478}\n\n\nSo bytes embedded inside CONNACK are reinterpreted as a separate MQTT message, and from this attacker can inject arbitrary MQTT messages.\n\n## Supporting Material/References:\nI attached the poc.py script and screenshoot bellow.\n\n## Impact\n\nAn attacker could potentially inject other control packets.",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 5294478,
      "file_name": "Screenshot_20260130_135040.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/v2gn0q8jus1m0mx3ytsodrnixxaq?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_20260130_135040.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20260130_135040.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRZ5FI3RB%2F20260209%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260209T150525Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHqKD7CqJoTVw%2BcVx8Bg9QnZP8p4X4oo2JY5gedkDnI5AiBZARKei8wzt5R97Q03wbrwSQ4rh9X0dRJz49U2fVVLuyq6BQiQ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMpmCOszK03ZW2UOs4Ko4FIRDH%2Bwbinw0i4mx7jS6I7cMHNaMueI5Og5yaHfhyISMslsaDTyZmAKy9GHTtL4H9asDDNTTuVoKJgk4C9YGnJRurWryYRtXfKwtXyDauTwsUpznz71%2BgiCXn%2FmnJDsDPFM78cy1%2FtVw5rmG3OuWJ0pJcbLzfIJk%2FpZif1IJwHmFw2agff1s084842slBstmwEa91N%2FiJ%2FAKXAq77DU09mlj67PSHfT8ccn7BjZjKo2Y%2BIe148YZ7BkL1Wa9iWaFW3LqGbuU09XKnnYfyFqfFBKev%2F9vHI8lc5P7AbHHG3jK3KpioNJG9mDysHNwc8k6V%2Fm07P2AlUnfGcbIYS%2FqMDbvp7fCpWLxwIsTZ2WAJa%2BGtekq%2BXrXHDLBKLuSvAteqBhy9rm3zXUgjJGeDeacZ4Vg4DXZw0f1U%2FH30ec8UoNLkS31psC1nPdkGg%2BKos3WOsKFxX9Sw51HsLLf4kPBBuCbXpHJru8ORDZ5WVcHWmVL78m6wZeP%2BjGcmuen6z6qwl35GD2J6Mtw7knG6BtIPzVy8hencVT9sxf%2FsmfT%2FqKqtFFwjgnZi5QCTGrkohr9%2BskMpXcDoDLl3DZobzO4mdfp%2FgHmTdkg2yyuYNPy%2FoF3hN47sg7n3c%2FF%2FmkJrCjOz85bTLIcOGsnFkWzZLN%2BoETezxeDslAWEY6nurCDpCTGIVCy7Zz1EPkLJnoXwLtgYYIFkzMs7XHZa7aNAKjHs%2B11jihpcDfdN5J3xyWDAuLiVs%2FI%2Bkr5UOT9%2FBWBQyIne2zEgbRuTS3wdsOjt94iFEoaZDk5w9LMUzwIdkUbEbuiYQU%2BB1JVivSoTN9odqBFhQ4xF5hvDDYxEAYogp9YZJPK%2FpdW2%2BgkN%2BOmz0hW4MKrhp8wGOrIB2JdzvOzQUwLppAXyq1%2B7T%2FLpQUqK485sWuXIlMnnPxBExOxyicm%2B19hkzx2cafD2YiBRy9DMlDyP40qf63%2Fur%2Bs2VxGsOwoAbhB2MU%2FWuQVyALXqSlokuJ15dP%2BhFrVOW504tLZ1rxeWH3%2FHe6azBYdy4E5mv4cyYNi72RuZO96GOlFFh2YcFexvGb8gF%2FnSgiMIKMw6hVI%2Bb%2F4HU6t%2FKoqI2PossI1od%2FgkOHQogPGIIA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c95d68867b198b4ec553254360efd750f06b33c341c86b2f8cae6e42fbef08fd",
      "file_size": 68945,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 5294504,
      "file_name": "poc.py",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/c4ebibrh24f4t4ce5bwmphmd3a24?response-content-disposition=attachment%3B%20filename%3D%22poc.py%22%3B%20filename%2A%3DUTF-8%27%27poc.py&response-content-type=text%2Fx-python&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRZ5FI3RB%2F20260209%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260209T150525Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHqKD7CqJoTVw%2BcVx8Bg9QnZP8p4X4oo2JY5gedkDnI5AiBZARKei8wzt5R97Q03wbrwSQ4rh9X0dRJz49U2fVVLuyq6BQiQ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMpmCOszK03ZW2UOs4Ko4FIRDH%2Bwbinw0i4mx7jS6I7cMHNaMueI5Og5yaHfhyISMslsaDTyZmAKy9GHTtL4H9asDDNTTuVoKJgk4C9YGnJRurWryYRtXfKwtXyDauTwsUpznz71%2BgiCXn%2FmnJDsDPFM78cy1%2FtVw5rmG3OuWJ0pJcbLzfIJk%2FpZif1IJwHmFw2agff1s084842slBstmwEa91N%2FiJ%2FAKXAq77DU09mlj67PSHfT8ccn7BjZjKo2Y%2BIe148YZ7BkL1Wa9iWaFW3LqGbuU09XKnnYfyFqfFBKev%2F9vHI8lc5P7AbHHG3jK3KpioNJG9mDysHNwc8k6V%2Fm07P2AlUnfGcbIYS%2FqMDbvp7fCpWLxwIsTZ2WAJa%2BGtekq%2BXrXHDLBKLuSvAteqBhy9rm3zXUgjJGeDeacZ4Vg4DXZw0f1U%2FH30ec8UoNLkS31psC1nPdkGg%2BKos3WOsKFxX9Sw51HsLLf4kPBBuCbXpHJru8ORDZ5WVcHWmVL78m6wZeP%2BjGcmuen6z6qwl35GD2J6Mtw7knG6BtIPzVy8hencVT9sxf%2FsmfT%2FqKqtFFwjgnZi5QCTGrkohr9%2BskMpXcDoDLl3DZobzO4mdfp%2FgHmTdkg2yyuYNPy%2FoF3hN47sg7n3c%2FF%2FmkJrCjOz85bTLIcOGsnFkWzZLN%2BoETezxeDslAWEY6nurCDpCTGIVCy7Zz1EPkLJnoXwLtgYYIFkzMs7XHZa7aNAKjHs%2B11jihpcDfdN5J3xyWDAuLiVs%2FI%2Bkr5UOT9%2FBWBQyIne2zEgbRuTS3wdsOjt94iFEoaZDk5w9LMUzwIdkUbEbuiYQU%2BB1JVivSoTN9odqBFhQ4xF5hvDDYxEAYogp9YZJPK%2FpdW2%2BgkN%2BOmz0hW4MKrhp8wGOrIB2JdzvOzQUwLppAXyq1%2B7T%2FLpQUqK485sWuXIlMnnPxBExOxyicm%2B19hkzx2cafD2YiBRy9DMlDyP40qf63%2Fur%2Bs2VxGsOwoAbhB2MU%2FWuQVyALXqSlokuJ15dP%2BhFrVOW504tLZ1rxeWH3%2FHe6azBYdy4E5mv4cyYNi72RuZO96GOlFFh2YcFexvGb8gF%2FnSgiMIKMw6hVI%2Bb%2F4HU6t%2FKoqI2PossI1od%2FgkOHQogPGIIA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=68b0776ad9674ebc45c015f67a6bf01b2f2eaaefebaea805df1f47dda3153afb",
      "file_size": 766,
      "type": "text/x-python",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 25,
  "voters": [
    "2026",
    "xklepxn",
    "officialdeadman",
    "abhinash120",
    "naksh18",
    "offbyzen",
    "iamq",
    "knpetry",
    "aar072",
    "developer009",
    "and 15 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "is_exploit_agent_supported?": false,
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
