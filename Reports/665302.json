{
  "id": 665302,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjUzMDI=",
  "url": "https://hackerone.com/reports/665302",
  "title": "[seeftl] Stored XSS when directory listing via filename.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-08-01T03:37:27.780Z",
  "submitted_at": "2019-08-01T03:37:27.780Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "luizviana",
    "url": "/luizviana",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/mpbpcg2ql2mxrtqu3yytick4ojxr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-15603"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-12-31T14:05:17.695Z",
  "bug_reporter_agreed_on_going_public_at": "2019-12-31T14:05:17.654Z",
  "team_member_agreed_on_going_public_at": "2019-12-31T13:59:32.317Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report Stored XSS via filename in directory listing in seeftl\nIt allows to inject malicious input in a filename that leads to stored XSS when directories listing.\n\n# Module\n\n**module name:** seeftl\n**version:** 0.1.1\n**npm page:** `https://www.npmjs.com/package/seeftl`\n\n## Module Description\n\nseeftl -- 一个简单的预览ftl文件的静态服务器（在anywhere基础上改的）\n\n仅仅是通过在ftl同级目录写一个config文件，替换ftl里的变量和宏 达到实时预览的功能：\n\n## Module Stats\n\n[8] downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe XSS occurs due the module does not sanitize de representation of filename when directories listing.\n\n## Steps To Reproduce:\n\ninstall seeftl:\n`$ npm install seeftl -g`\n\nCreate a file with the following name:\n`\" onmouseover=alert('xss') \"`\n\n{F544502}\n\nrun seeftl server in the path that you created the file with the malicious filename:\n```\n$ seeftl\nRunning at http://127.0.0.1:8000/\n```\n\nOpen `http://localhost:8000/` in your browser.\n\n{F544503}\n\nPut the mouse over the filename and the event will be triggered and pop up the alert.\n\n{F544504}\n\n## Patch\n\nUsers input should be sanitized and dangerous characters should be HTML encoded before printing them on screen.\n\n## Supporting Material/References:\n\n- Kali Linux 2019.2 amd64\n- v10.15.2\n- 5.8.0\n- Firefox ESR 60.7.2esr (64-bit)\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nIt allows to inject malicious scripts in filenames and execute them in the browser via a XSS.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 544502,
      "file_name": "img1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/544/502/2fb4bf8e9eec24b6ddee829314c9f2b9e2fd5631/img1.png?response-content-disposition=attachment%3B%20filename%3D%22img1.png%22%3B%20filename%2A%3DUTF-8%27%27img1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQACXHSS4%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T125356Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDXRxo5zHpRt3ZYoenJ1wd5JkJ1NBujQ%2BLJAzF85PgA4gIgG8P8%2BYTN%2B6LK3LM2x%2BQsJbsbKJ3XlF%2BgWjt8CO7wqw0qsgUIFRADGgwwMTM2MTkyNzQ4NDkiDPMRaLfxVYuzcejcByqPBYsP1GpgsQNCDwEj7s2ooDqZfTFIhmfXHzhnkAKYMZ6JKsMj%2FyCHRggO9kolqojogIgII2B%2Fpzw7htnWmV2d%2FFbHE9WmkbkKSW9tmwKM8V2SwcWeT42e2sPftwmfmuIRnT88rlN2UxIf2%2Bye%2F6PXyq94y0rCVHdZ00hmGUcHuxLSx7Hky%2FYBvUPB3PBQ12gIcvx7s2bdvavvHSI9E2cp7t3ANfDQwt%2Fg1UeszKImi0NFvr8y201sI%2FoKXbv49qIpkA1A%2F%2F99HZE%2B0OQEbRRSAMqhuxfG32PyQUHAhhZs2hcl6XWz%2F3MM%2F%2FscnTPIXpEU3QEtqMN4XwsuqdR%2FigvbraW1MuAGufP3vBd5AGTCtp49hb8Bx0FV6kVQdZVzV0L4M2pqqwlOTfeLRwdx5%2FUhexV59JeWHlO%2BTVCof2IcMLMwN6jys3Mnk5L0VeTKiqO820qFc8UdL3JcUT0tG%2F4S7ip1wQvG5xZ1dmtVJt6N2m5daSpmCer2TCkou8LlZ0qRSYTKQ6SiXQTs0q9WpDBJmhdHkP1A4zqfGZ3BLlO0mhF7cx79e2934UNro8M5irr9s5xtgij6DQUFDPvDLXbAXaTVjYd1ylrOByBT2vvWfcxLONeP17kQ5FLhpdm3E%2BpvMewO9BJi2tA7dZwgFolH98Cvwvu9fixFNLmOVo3dJV8ZOMr%2FnBXH70Ndj7KbjgsemH05aAaA86qVPKxRXgV%2FTFlx5OHox%2FKxUCRbyORTNnURe7JdSM16fHIGTYZdAdpcd4xdP4k7kzdobMK8KrWIH5UrimidhxmZ9bu9DNFt%2FyMpzAEXCoYSUY1til%2FkewRpbxDTmKiz7uB%2Biou1Aauv6qEgjsu7%2Fgb7SWEGE5ufSnUw6sK%2FxgY6sQF5Kk5TmB2V6LdEC6pSpNvzOH1fucPURtQpsz5uxo6Iq4nJ4584p%2F0o%2BtJYLUdylV93CoJ9tEMUF8bqMBeEKLaEkRfyctibov9LR64Zox6VOfJOfvfCTmktsfATzhP527cPTYxwvAK2OxeuHmsPTXWcoNbnSBxv27j54e9IDm8edP0S4frvZlDWwxQTp0TgQBgZvX7ZRClpIzfszIfPtAR9Us8IBiXbZ9d4EdmHUDKKXTQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0a310afe968ed6acd03b418ecb4bd58fc03e9263baf6779e05aafad059d65ba3",
      "file_size": 26636,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 544503,
      "file_name": "img2.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/544/503/c60a4c221f669d76deb41ed0177d14a2560efecb/img2.png?response-content-disposition=attachment%3B%20filename%3D%22img2.png%22%3B%20filename%2A%3DUTF-8%27%27img2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQACXHSS4%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T125356Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDXRxo5zHpRt3ZYoenJ1wd5JkJ1NBujQ%2BLJAzF85PgA4gIgG8P8%2BYTN%2B6LK3LM2x%2BQsJbsbKJ3XlF%2BgWjt8CO7wqw0qsgUIFRADGgwwMTM2MTkyNzQ4NDkiDPMRaLfxVYuzcejcByqPBYsP1GpgsQNCDwEj7s2ooDqZfTFIhmfXHzhnkAKYMZ6JKsMj%2FyCHRggO9kolqojogIgII2B%2Fpzw7htnWmV2d%2FFbHE9WmkbkKSW9tmwKM8V2SwcWeT42e2sPftwmfmuIRnT88rlN2UxIf2%2Bye%2F6PXyq94y0rCVHdZ00hmGUcHuxLSx7Hky%2FYBvUPB3PBQ12gIcvx7s2bdvavvHSI9E2cp7t3ANfDQwt%2Fg1UeszKImi0NFvr8y201sI%2FoKXbv49qIpkA1A%2F%2F99HZE%2B0OQEbRRSAMqhuxfG32PyQUHAhhZs2hcl6XWz%2F3MM%2F%2FscnTPIXpEU3QEtqMN4XwsuqdR%2FigvbraW1MuAGufP3vBd5AGTCtp49hb8Bx0FV6kVQdZVzV0L4M2pqqwlOTfeLRwdx5%2FUhexV59JeWHlO%2BTVCof2IcMLMwN6jys3Mnk5L0VeTKiqO820qFc8UdL3JcUT0tG%2F4S7ip1wQvG5xZ1dmtVJt6N2m5daSpmCer2TCkou8LlZ0qRSYTKQ6SiXQTs0q9WpDBJmhdHkP1A4zqfGZ3BLlO0mhF7cx79e2934UNro8M5irr9s5xtgij6DQUFDPvDLXbAXaTVjYd1ylrOByBT2vvWfcxLONeP17kQ5FLhpdm3E%2BpvMewO9BJi2tA7dZwgFolH98Cvwvu9fixFNLmOVo3dJV8ZOMr%2FnBXH70Ndj7KbjgsemH05aAaA86qVPKxRXgV%2FTFlx5OHox%2FKxUCRbyORTNnURe7JdSM16fHIGTYZdAdpcd4xdP4k7kzdobMK8KrWIH5UrimidhxmZ9bu9DNFt%2FyMpzAEXCoYSUY1til%2FkewRpbxDTmKiz7uB%2Biou1Aauv6qEgjsu7%2Fgb7SWEGE5ufSnUw6sK%2FxgY6sQF5Kk5TmB2V6LdEC6pSpNvzOH1fucPURtQpsz5uxo6Iq4nJ4584p%2F0o%2BtJYLUdylV93CoJ9tEMUF8bqMBeEKLaEkRfyctibov9LR64Zox6VOfJOfvfCTmktsfATzhP527cPTYxwvAK2OxeuHmsPTXWcoNbnSBxv27j54e9IDm8edP0S4frvZlDWwxQTp0TgQBgZvX7ZRClpIzfszIfPtAR9Us8IBiXbZ9d4EdmHUDKKXTQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c393bfd83409ee6eb0573989c1b23d6975fc06d5a6fb3755610916a8d402b94e",
      "file_size": 56675,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 544504,
      "file_name": "img3.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/544/504/cc28a351e56779fde7c0136142e5387b9f2edfc8/img3.png?response-content-disposition=attachment%3B%20filename%3D%22img3.png%22%3B%20filename%2A%3DUTF-8%27%27img3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQACXHSS4%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T125356Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDXRxo5zHpRt3ZYoenJ1wd5JkJ1NBujQ%2BLJAzF85PgA4gIgG8P8%2BYTN%2B6LK3LM2x%2BQsJbsbKJ3XlF%2BgWjt8CO7wqw0qsgUIFRADGgwwMTM2MTkyNzQ4NDkiDPMRaLfxVYuzcejcByqPBYsP1GpgsQNCDwEj7s2ooDqZfTFIhmfXHzhnkAKYMZ6JKsMj%2FyCHRggO9kolqojogIgII2B%2Fpzw7htnWmV2d%2FFbHE9WmkbkKSW9tmwKM8V2SwcWeT42e2sPftwmfmuIRnT88rlN2UxIf2%2Bye%2F6PXyq94y0rCVHdZ00hmGUcHuxLSx7Hky%2FYBvUPB3PBQ12gIcvx7s2bdvavvHSI9E2cp7t3ANfDQwt%2Fg1UeszKImi0NFvr8y201sI%2FoKXbv49qIpkA1A%2F%2F99HZE%2B0OQEbRRSAMqhuxfG32PyQUHAhhZs2hcl6XWz%2F3MM%2F%2FscnTPIXpEU3QEtqMN4XwsuqdR%2FigvbraW1MuAGufP3vBd5AGTCtp49hb8Bx0FV6kVQdZVzV0L4M2pqqwlOTfeLRwdx5%2FUhexV59JeWHlO%2BTVCof2IcMLMwN6jys3Mnk5L0VeTKiqO820qFc8UdL3JcUT0tG%2F4S7ip1wQvG5xZ1dmtVJt6N2m5daSpmCer2TCkou8LlZ0qRSYTKQ6SiXQTs0q9WpDBJmhdHkP1A4zqfGZ3BLlO0mhF7cx79e2934UNro8M5irr9s5xtgij6DQUFDPvDLXbAXaTVjYd1ylrOByBT2vvWfcxLONeP17kQ5FLhpdm3E%2BpvMewO9BJi2tA7dZwgFolH98Cvwvu9fixFNLmOVo3dJV8ZOMr%2FnBXH70Ndj7KbjgsemH05aAaA86qVPKxRXgV%2FTFlx5OHox%2FKxUCRbyORTNnURe7JdSM16fHIGTYZdAdpcd4xdP4k7kzdobMK8KrWIH5UrimidhxmZ9bu9DNFt%2FyMpzAEXCoYSUY1til%2FkewRpbxDTmKiz7uB%2Biou1Aauv6qEgjsu7%2Fgb7SWEGE5ufSnUw6sK%2FxgY6sQF5Kk5TmB2V6LdEC6pSpNvzOH1fucPURtQpsz5uxo6Iq4nJ4584p%2F0o%2BtJYLUdylV93CoJ9tEMUF8bqMBeEKLaEkRfyctibov9LR64Zox6VOfJOfvfCTmktsfATzhP527cPTYxwvAK2OxeuHmsPTXWcoNbnSBxv27j54e9IDm8edP0S4frvZlDWwxQTp0TgQBgZvX7ZRClpIzfszIfPtAR9Us8IBiXbZ9d4EdmHUDKKXTQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2dce72e2d9e639716f301f8e5b427e30c05fcdd3b011e5a6b0d3bc1ab005af31",
      "file_size": 56152,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-01-30T13:59:32.404Z",
  "allow_singular_disclosure_after": -178066464.075568,
  "singular_disclosure_allowed": true,
  "vote_count": 20,
  "voters": [
    "k0ns0l",
    "ali",
    "sameerphad72",
    "tess",
    "luizviana",
    "null_rhythm",
    "whitehatmat",
    "hassanjawaid",
    "tadbit",
    "akshaysharma1997",
    "and 10 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 41932,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "seeftl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
