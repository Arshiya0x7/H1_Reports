{
  "id": 373932,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzM5MzI=",
  "url": "https://hackerone.com/reports/373932",
  "title": "Open redirect in Serendipity (exit.php)",
  "state": "Closed",
  "substate": "duplicate",
  "severity_rating": "none",
  "readable_substate": "Duplicate",
  "created_at": "2018-06-29T14:17:49.624Z",
  "submitted_at": "2018-06-29T14:17:49.624Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "bb9866f3f743d6bf69b6836",
    "url": "/bb9866f3f743d6bf69b6836",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 30278,
    "url": "https://hackerone.com/hannob",
    "handle": "hannob",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzQyNTgsInB1ciI6ImJsb2JfaWQifX0=--17551179046e358db89580820048674d0f970df4/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/open-uri20180625-9169-fahww2",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Hanno's projects",
      "twitter_handle": "hanno",
      "website": "https://hboeck.de/",
      "about": "Personal web projects from Hanno Böck."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-11-09T14:53:43.894Z",
  "bug_reporter_agreed_on_going_public_at": "2018-11-09T14:45:34.205Z",
  "team_member_agreed_on_going_public_at": "2018-11-09T14:53:43.846Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\n\nSerendipity contains a script named `exit.php` that can be directly accessed. When crafting an hyperlink pointing to this page with the parameter `url` containing a base64-encoded  URL, it will redirect the user to this URL.\n\n## Description\n\nThe file `exit.php` contains the following code:\n\n```php\n<?php\n// [...]\nif (isset($_GET['url_id']) && !empty($_GET['url_id']) && isset($_GET['entry_id']) && !empty($_GET['entry_id'])) {\n// [...]\n} elseif (isset($_GET['url']) && !empty($_GET['url'])) {\n    // No entry-link ID was submitted. Possibly a spammer tried to mis-use the script to get into the top-list.\n    $url = strip_tags(str_replace('&amp;', '&', base64_decode($_GET['url'])));\n}\n\nif (serendipity_isResponseClean($url)) {\n    header('HTTP/1.0 301 Moved Permanently');\n    header('Status: 301 Moved Permanently');\n    header('Location: ' . $url);\n}\n```\n\nThe interesting part is the handling of `$_GET['url']`. The function `serendipity_isResponseClean()` tries to prevent response splitting issues but does not validate the hostname of the URL where the user is redirected to. \n\n## Steps To Reproduce\n\n1. Access https://blog.fuzzing-project.org/exit.php?url=aHR0cHM6Ly9nb29nbGUuY29t with a browser;\n1. Notice that the `Location` header of the response contains an arbitrary URL (here, https://google.com).\n\n## Impact\n\nAn attacker can craft an hyperlink pointing to https://blog.fuzzing-project.org that, once accessed, will redirect the victim to an arbitrary URL.",
  "weakness": {
    "id": 53,
    "name": "Open Redirect"
  },
  "original_report_id": 373916,
  "original_report_url": "https://hackerone.com/reports/373916",
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 2,
  "voters": [
    "eveeez",
    "moonless"
  ],
  "severity": {
    "rating": "none",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 11140,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.fuzzing-project.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
