{
  "id": 94336,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NDMzNg==",
  "url": "https://hackerone.com/reports/94336",
  "title": "Minimum bounty of a private program is visible for users that were removed from the program",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-10-17T04:45:49.979Z",
  "submitted_at": "2015-10-17T04:45:49.979Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "coolboss",
    "url": "/coolboss",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/o9xuztxxejbmnyjt6pvwh0yojogs/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2015-10-21T12:48:38.020Z",
  "bug_reporter_agreed_on_going_public_at": "2015-10-21T12:48:37.536Z",
  "team_member_agreed_on_going_public_at": "2015-10-20T19:26:34.517Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\n\nPrivileged information is getting leaked to an unauthorized user in the json response of `https://hackerone.com/reports/<report id>.json`.\n\nIn a team there can be many members, also roles are defined. But an x-member of the team is getting information which should not be visible to him. (As I tested it on sandboxed team but it i believe it is also affecting other private programs )\n\nProof Of Concept :\n================\n1. UserA is part of TeamA.\n2. UserA creates a test report.\n3. Now, UserA can access the report via `Reports` tab.\n4. Admin now removes the UserA from the team.\n5. Now, UserA becomes X-user of the team.\n6. UserA canNOT access the team.\n7. But can access the test report which he/she created.\n\nWhen UserA accesses the report then a request is made to `https://hackerone.com/reports/<report id>.json`. Note the response for my test report.\n\n``\n{id: 94333, url: \"https://hackerone.com/reports/94333\", title: \"asdf\", state: \"Open\", substate: \"new\",…}\nabilities: {can_manage?: false, can_export?: false, can_add_comment?: true, can_change_state?: false,…}\nactivities: []\nbug_reporter_agreed_on_going_public_at: null\ncan_view_team: true\ncreated_at: \"2015-10-17T04:29:44.364Z\"\ncve_ids: []\ndisclosed_at: null\nexternal_advisory_url: null\nhas_bounty?: false\nid: 94333\nis_external_bug: false\nis_member_of_team?: false\nis_participant: true\nminimum_bounty: 1000\npublic: false\nreadable_substate: \"New\"\n....\n``\n\nHere, some fields like `minimum_bounty: 1000` and relevant team details are leaked. These fields are meant for only to people to whom the team is visible.\n\nAttack Scenario :\n==============\nI tested this bug on sandboxed team. But I believe this bug will affect the on going programs. Consider the scenario ...\nPrivate Program invites a User. User submits a bug. This bug will be visible to the user via `Reports` tab. Now, team decides to remove the User and removes him/her. Now, User can still get updates of the programs via the json response. The `team information` and `bounty details` are meant for only researchers who are invited to the program and people who are part of the team. \n\nLet me know if you have any questions.\n\nThanks,\nPranav",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-11-19T19:26:34.957Z",
  "allow_singular_disclosure_after": -310622746.5413945,
  "singular_disclosure_allowed": true,
  "vote_count": 5,
  "voters": [
    "jensec",
    "shubham_srt",
    "japz",
    "shivammusic",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 950,
      "category": "team",
      "content": "In the response to a request on `/reports/<id>.json`, as the user that submitted the report, the minimum bounty of a team was returned. \n\nThis leads to a very minor information disclosure in the case a user submitted a report to an invite-only team. If the user is then removed from the program, they will still be able to access the report, and therefore be able to see the minimum bounty amount of the team.\n\nThis was mitigated by removing the minimum bounty from the response.",
      "updated_at": "2015-10-26T08:21:25.967Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 13067,
        "username": "dirk",
        "name": "Dirk",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://www.foo.com",
        "location": "",
        "created_at": "2014-10-15T13:50:22.541Z",
        "url": "https://hackerone.com/dirk",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/iwmxb0engle6ocn8h8tw1w2t1fks/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/iwmxb0engle6ocn8h8tw1w2t1fks/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjMwNjc5NCwicHVyIjoiYmxvYl9pZCJ9fQ==--83fd365e6ce12f978220b2b8123f94177e6966e7/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/hackerone-icon-2048x2048-ctdo8ks8.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
