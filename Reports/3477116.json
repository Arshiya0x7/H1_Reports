{
  "id": 3477116,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDc3MTE2",
  "url": "https://hackerone.com/reports/3477116",
  "title": "CVE-2025-15079: libssh global knownhost override ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2025-12-24T04:45:21.545Z",
  "submitted_at": "2025-12-24T04:45:21.665Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "nyymi",
    "url": "/nyymi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2025-15079"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2026-01-07T08:04:01.126Z",
  "bug_reporter_agreed_on_going_public_at": "2026-01-07T08:04:00.797Z",
  "team_member_agreed_on_going_public_at": "2026-01-07T07:31:21.905Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nlibssh has `SSH_OPTIONS_GLOBAL_KNOWNHOSTS` that specifies a global known_hosts file that will be used if the host is not found from the file specified in `SSH_OPTIONS_KNOWNHOSTS` file. libcurl `CURLOPT_SSH_KNOWNHOSTS` doesn't specify an invalid (or `/dev/null`) path to `SSH_OPTIONS_GLOBAL_KNOWNHOSTS` resulting in libcurl accepting any host identities that might be specified in the default file. This is significant when user tries to limit the known hosts to ones specified in their own file, as the global file will be checked if no match is found from the user specified file.\n\nBy default this file is `/etc/ssh/ssh_known_hosts`, and thus not modifiable by non-privileged user (at least on major platforms). Thus in most situations this issue cannot be exploited by actively modifying the file. This limits the impact of this flaw.\n\n## Affected version\n8.17.0\n\n## Steps To Reproduce:\n\n  1. Configure and compile curl with `--with-libssh`\n  2. Add valid host entry for `host.example` to `/etc/ssh/ssh_known_hosts`\n  3. `echo \"\" > knownhosts`\n  4. `curl --knownhosts knownhosts user@host.example`\n\nThe host identity validation succeeds even though it should not.\n\n## Remediation\n- Make `CURLOPT_SSH_KNOWNHOSTS` set `SSH_OPTIONS_GLOBAL_KNOWNHOSTS` to `/dev/null` (or some non-existing path?).\n\n## Supporting Material/References:\n  * https://github.com/libssh/libssh-mirror/blob/ac6d2fad4a8bf07277127736367e90387646363f/src/options.c#L304\n  * https://github.com/libssh/libssh-mirror/blob/ac6d2fad4a8bf07277127736367e90387646363f/src/knownhosts.c#L1176\n\n## Impact\n\n## Summary:\nHost validation unexpectedly succeeding.",
  "weakness": {
    "id": 555,
    "name": "Improper Validation of Certificate with Host Mismatch"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2026-02-06T07:31:22.430Z",
  "allow_singular_disclosure_after": 2589973.702528824,
  "singular_disclosure_allowed": false,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
