{
  "id": 2334401,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzM0NDAx",
  "url": "https://hackerone.com/reports/2334401",
  "title": "Denial of Service caused by HTTP/2 CONTINUATION Flood",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2024-01-25T12:51:50.932Z",
  "submitted_at": "2024-01-25T12:51:51.084Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bart",
    "url": "/bart",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/154/65b70bcb5b2ee4ae9ac8c6f518590c3cb9c08550_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ75B57S52%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T190434Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIE%2BgchX9JTqHlw5doTQtHfduNiCY02NVh%2FTpcyFH31dkAiATLfZb4I2jyzsPqzC%2Bn9wqWIYfiIjbjIkQdhwfOQ4XlSq7BQjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMEWCgTedrfEPc6GXSKo8FhzmZ7I87jx37A1z2z10yPATcLxx1Oj0f1M0S8WPvD183VGqg4W66MD5upXU%2FssuJ2sQZ1lUAggDL5iM%2B44nFndv9N%2FCI2HfJIf5QB2a9vq5Nk0CKgFRHlpVvE9p7e%2BUw99iIWxq6VcYP5FRNdZ9DStIjdo6vd0nv0Ql8ge2NADkPOs90o9SzR6eENt8b7B1lkQcY90bFYtfiYWKHK8Nnf1QA8ugMbRglhqzS9GkZ94Npv5LTgYvTPVUzsu1YbG4WdjAYMY%2FRseyaicTSfSHARvYt%2B5F6bCDQX%2F1%2BCUaGoX2WKfEME3W0ggG613lVGPFSx0LhH%2BaVmhvDjJL%2B1pSsKApq3EgZl4OnLcE3rduJbU1qrXbsHGB8BhwrQqccXLmTDQSPuGXjYWbYakpOMi0iDyXYQdTZbC2VwwPPU74a0xyf0gjpmUqf%2FHUcCXL71szV85IbWIgo2ElM4%2BxyzSJ7T3J7TaGJMIOY74m8AGiyWpiwBLLGTALXoJ6rQu%2FblohbeRwT%2FdfcxKN1pv2KZDzQhybSOReIyqyC2Qe9JCM%2F3xgP1IvPHsu9MnEI4e4%2F%2FALfThV1a3tX3fTLXtysfl5UnRc6XyU7gwHu4qc2PxKm3eSdHZjKDO1o9j2RoIHLF%2FmxItQ2XG0I7IYEnZ%2B14iuyKLJ7FwAeGgWdoGYW%2FzFCXlJRPzIEBzzkfFupzpubkYyeoJPHhR1rm2utUyBJiZKSYBxA3CYb61k6rN7hwf9%2FAEyVe8eYNVniCJIjDMFjmXNWLFXDnQSQGc%2Fb4kBbj4kgBOpMVIJzcm%2BQLGnzzZwm%2FQqaiQoM2sgGdQesRuav4fPZ1pgcUfQcxN0MXYgpHEjSe%2BviKgg%2BDGSkIF%2F8wub3cjCe%2FbrGBjqyARYWynJYwOjfynDPhjVK%2FH9eye8krLCnrmCRs42QdJsFYTbUuTG9QXvo8uVY%2BWKujV5rZ38tCPfxYDigPDZIm5HwzhVyN6fDKpHwHFLqPoXdGl0m6K7zsnyBd7nOaKX5dXVjsQcC8DseurEd4HkVd1WLiGbV9ADtyhKGQVof5WWTwr49E6NiUGsD97oZmq6kpn0Qy5BcdmxgEnT6%2FIFlxfJkbm93L59dItI6f3clT%2FrzMaQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d6c355e495142f17b5282625cf1f7a5d8f65ae4b4139873f751a638952fd2f66",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ75B57S52%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T190434Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIE%2BgchX9JTqHlw5doTQtHfduNiCY02NVh%2FTpcyFH31dkAiATLfZb4I2jyzsPqzC%2Bn9wqWIYfiIjbjIkQdhwfOQ4XlSq7BQjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMEWCgTedrfEPc6GXSKo8FhzmZ7I87jx37A1z2z10yPATcLxx1Oj0f1M0S8WPvD183VGqg4W66MD5upXU%2FssuJ2sQZ1lUAggDL5iM%2B44nFndv9N%2FCI2HfJIf5QB2a9vq5Nk0CKgFRHlpVvE9p7e%2BUw99iIWxq6VcYP5FRNdZ9DStIjdo6vd0nv0Ql8ge2NADkPOs90o9SzR6eENt8b7B1lkQcY90bFYtfiYWKHK8Nnf1QA8ugMbRglhqzS9GkZ94Npv5LTgYvTPVUzsu1YbG4WdjAYMY%2FRseyaicTSfSHARvYt%2B5F6bCDQX%2F1%2BCUaGoX2WKfEME3W0ggG613lVGPFSx0LhH%2BaVmhvDjJL%2B1pSsKApq3EgZl4OnLcE3rduJbU1qrXbsHGB8BhwrQqccXLmTDQSPuGXjYWbYakpOMi0iDyXYQdTZbC2VwwPPU74a0xyf0gjpmUqf%2FHUcCXL71szV85IbWIgo2ElM4%2BxyzSJ7T3J7TaGJMIOY74m8AGiyWpiwBLLGTALXoJ6rQu%2FblohbeRwT%2FdfcxKN1pv2KZDzQhybSOReIyqyC2Qe9JCM%2F3xgP1IvPHsu9MnEI4e4%2F%2FALfThV1a3tX3fTLXtysfl5UnRc6XyU7gwHu4qc2PxKm3eSdHZjKDO1o9j2RoIHLF%2FmxItQ2XG0I7IYEnZ%2B14iuyKLJ7FwAeGgWdoGYW%2FzFCXlJRPzIEBzzkfFupzpubkYyeoJPHhR1rm2utUyBJiZKSYBxA3CYb61k6rN7hwf9%2FAEyVe8eYNVniCJIjDMFjmXNWLFXDnQSQGc%2Fb4kBbj4kgBOpMVIJzcm%2BQLGnzzZwm%2FQqaiQoM2sgGdQesRuav4fPZ1pgcUfQcxN0MXYgpHEjSe%2BviKgg%2BDGSkIF%2F8wub3cjCe%2FbrGBjqyARYWynJYwOjfynDPhjVK%2FH9eye8krLCnrmCRs42QdJsFYTbUuTG9QXvo8uVY%2BWKujV5rZ38tCPfxYDigPDZIm5HwzhVyN6fDKpHwHFLqPoXdGl0m6K7zsnyBd7nOaKX5dXVjsQcC8DseurEd4HkVd1WLiGbV9ADtyhKGQVof5WWTwr49E6NiUGsD97oZmq6kpn0Qy5BcdmxgEnT6%2FIFlxfJkbm93L59dItI6f3clT%2FrzMaQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5671b362120846914bdc921dde51bac07ae3c40718a1d4e3e132b25d1fea35a7"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2024-24549"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-04-22T19:52:39.534Z",
  "bug_reporter_agreed_on_going_public_at": "2024-04-22T19:52:38.867Z",
  "team_member_agreed_on_going_public_at": "2024-04-22T19:44:31.865Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I sent the following report to Apache Tomcat Security Team. They confirmed the report and assigned CVE-2024-24549. I'd like to ask if this is eligible for a bounty.\n\nI'd like to report a DoS vulnerability in Tomcat. I tested 10.1.18 and 11.0 (tomcat:latest and tomcat:11.0 docker images respectively) and it seems that both are vulnerable.\n\nAn attacker can send headers using HTTP/2 CONTINUATION frames up to the limit of header bytes, header size and connection overhead so that connection is not dropped by a server (GOAWAY/ENHANCE_YOUR_CALM). Once frames are sent a connection is left intact and a new connection starts. After a few connections like these the server crashes with (java.lang.OutOfMemoryError: Java heap space) in the code connected to HPackHuffman decoding.\n\nThe lack of experience with Java does not allow me to debug this properly to give you a definitive answer what is causing the problem however here is my best guess:\n* When sending HEADERS + N * CONTINUATION frames are sent the actual headers are stored in memory.\n* When TCP connection is idle (and possibly when connection is dropped) the headers stay in memory.\n* Because of this even a small number of connections are able to occupy hundreds of MB of server memory.\n\nI'm attaching an exploit (in Golang) with reproduction steps:\n* Start tomcat docker container (-m 800m limits memory to 800MB just to prove the point faster):\n    `docker run -m 800m -d -p 7777:8080 --name tomcat tomcat:latest`\n* SSH into a container to enable HTTP/2 (https://tomcat.apache.org/tomcat-8.5-doc/config/http.html#HTTP/2_Support).\n* Stop and start container to pick up new config:\n    `docker stop tomcat`\n    `docker start tomcat`\n* Run exploit:\n    `go run exploit.go -address \"[ip]:7777\" -connections 50`\n\nTo test it I started a remote EC2 server. After a few seconds after the exploit starts the server becomes unresponsive, CPU goes to 100% and memory usage fills quickly (observe with docker stats). After a few seconds you'll see OOM errors in catalina log (see attachment). While the CPU will drop to 0% soon, no new connections will be processed by the server even when the exploit is not running anymore.\n\nHere's how exploit.go works:\n* It pregenerates 100 headers, each 10 chars long.\n* It starts connections (-connections flag means how many active connections can be running at a time). Each connection:\n    * Sends HEADERS frame.\n    * Sends 8 CONTINUATION frames, each consists of 100 random headers (10 chars name and 10 chars value). These params are almost reaching the header size limits but not exceeding them so connection is not dropped.\n    * Once headers are sent, connection is left intact and new connection starts.\n\nIt seems that finding a reason why the server is crashing can be challenging for the server admin because even a single full HTTP request is not made (note that the last CONTINUATION frame doesn't have END_HEADERS flag) so they won't see HTTP requests in the logs. I'm not aware of any configuration params that can prevent this attack. Thus, it seems the only mitigation is turning off HTTP/2 support (or code fix).\n\n## Impact\n\nIt causes a server crash so complete availability loss.",
  "bounty_amount": "4860.0",
  "formatted_bounty": "$4,860",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-05-22T19:44:33.951Z",
  "allow_singular_disclosure_after": -41988000.834773935,
  "singular_disclosure_allowed": true,
  "vote_count": 42,
  "voters": [
    "muslimfrompk",
    "br0x1337",
    "n1m0",
    "zy9ard3",
    "hackermaneia_",
    "grmx",
    "hundredpercent",
    "neilx",
    "iamunixtz",
    "idealphaseth",
    "and 32 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.5,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 567272,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/apache/tomcat",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 436425,
      "category": "team",
      "content": "CVE-2024-24549 Apache Tomcat - Denial of Service\nSeverity: Important\n\nVendor: The Apache Software Foundation\n\nVersions Affected:\nApache Tomcat 11.0.0-M1 to 11.0.0-M16\nApache Tomcat 10.1.0-M1 to 10.1.18\nApache Tomcat 9.0.0-M1 to 9.0.85\nApache Tomcat 8.5.0 to 8.5.98\n\nDescription:\nWhen processing an HTTP/2 request, if the request exceeded any of the\nconfigured limits for headers, the associated HTTP/2 stream was not\nreset until after all of the headers had been processed.\n\nMitigation:\nUsers of the affected versions should apply one of the following\nmitigations:\n- Upgrade to Apache Tomcat 11.0.0-M17 or later\n- Upgrade to Apache Tomcat 10.1.19 or later\n- Upgrade to Apache Tomcat 9.0.86 or later\n- Upgrade to Apache Tomcat 8.5.99 or later\n\nCredit:\nThis vulnerability was reported responsibly to the Tomcat security team\nby Bartek Nowotarski (https://nowotarski.info/).\n\nFull Security Advisory: https://lists.apache.org/thread/4c50rmomhbbsdgfjsgwlb51xdwfjdcvg",
      "updated_at": "2024-04-22T19:39:58.349Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
