{
  "id": 3306475,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzA2NDc1",
  "url": "https://hackerone.com/reports/3306475",
  "title": "curl leaks destination IP via glibc getaddrinfo() UDP connect, bypassing SOCKS5/Tor",
  "state": "Closed",
  "substate": "not-applicable",
  "readable_substate": "N/A",
  "created_at": "2025-08-20T08:18:43.775Z",
  "submitted_at": "2025-08-20T08:18:43.897Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "robert_min1",
    "url": "/robert_min1",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-08-20T08:37:15.185Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-08-20T08:29:12.386Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nWhen using curl with a SOCKS5 proxy (e.g. Tor on 127.0.0.1:9050), glibc getaddrinfo() performs direct UDP connect() probes to the target’s IP:443. These syscalls bypass the proxy and expose the user’s route to the destination, breaking anonymity expectations.\nThe IPs I got in my case:\n`116.202.120.181:443`\n`[64:ff9b::74ca:78b5]:443`\n\nNo AI was used in the report\n\n## Affected version\nCurl 7.88.1\nDebian 13.0\n\n## Steps To Reproduce:\n1. Run Tor locally on port 9050.\n2. Lauch curl with the tor proxy, with tracing, using strace or sockstrace to monitor the connect syscalls:\n```\nstrace: strace -f -e trace=connect curl --proxy socks5://localhost:9050 https://check.torproject.org\n```\n```\nsockstrace: go run main.go curl --args \"--proxy\" --args \"socks5://localhost:9050\" --args \"https://check.torproject.org/\" --logleaks\n```\nObserve that a connect() syscall is made to:\n```\n116.202.120.181:443\n[64:ff9b::74ca:78b5]:443\n```\n## Supporting Material/References:\nBacktrace shows leak originates in glibc/getaddrinfo.c: try_connect() (attached)\n\n## Impact\n\n## Summary:\nThis issue allows the destination server (or any network observer) to learn the user’s real IP address even when curl is configured to use a SOCKS5 proxy such as Tor. The leak occurs before the proxied TCP connection is established, meaning anonymity is compromised. Any user relying on curl with Tor or other SOCKS5 proxies for privacy or censorship circumvention can be deanonymized.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4696834,
      "file_name": "stacktrace_curl.txt",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/r00c7pt8yorwdwzhnh6i9kzdfbho?response-content-disposition=attachment%3B%20filename%3D%22stacktrace_curl.txt%22%3B%20filename%2A%3DUTF-8%27%27stacktrace_curl.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6SLENE7J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T163746Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIFLzjchYQ1D3DxOiTc3EodcOJJprpmZl0pZ58dzTFxqAAiACygZW4LpnJ7NDO95lny6LXlUTKJ11dPmqir2w1rueHiq6BQju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMfT6Mmkszwa3mqDYyKo4FjTuddmcR6Bvb6C5Fn7HYsdeDu5nAmr%2BhSPXVNd2No4hh6oL75C%2FNS38ABlCUnng3UPFdrZtJWQgI3eVBnypfvOss%2BHboUpeljoK2txGdm6uWOZbcik0OeuuGx6xv8%2Bpa8tetbVfENnhna5JTs8tosCWsPuErVxVjrU%2FxT8m%2F%2B4KktTZ5KoM7s1yZzRuNjUbAIu7rfwrhMwQVj3FOrUrtGxbD97BIKEOeKhpepkCbIoBhX1K4w4snumbm7pEqj5P9xzsOjQ%2Fe5SbhUqkZmR3H%2Fiq%2FfW4oOTJ27YGWVP9TR3qQqnWi3mu5wKfxfiuFio4BORZlVmGObQIfexT5I7xB01aztHhxtU45ODL1sUHSDPwjFBX4cHzXgJqrzcgzG9TYoaTlf0pQunoR8xTDl4SdZovjoYvE2LNCm4gHdDz%2F%2BSMnQffb%2BPi25ASqqBZrpc%2BGU5PsvnIP0a6yJpRpeVRd5ORm65fp55iGEOb%2F3oVe6lz2WQgjssBHzxQ8Q1zj%2FN7Y0sh%2FFD0BzigcmX6tU9Lm0BAnPbIfUDeGFEvOUmB5UpltMJ1cePypFzQqS9hyJhDlvbZCbFyF2m8k1vtWy7Hd%2F58EOZ367t7DQ4rHQ9aIX81NkQgERsehsElxnV5W88EU0aXx7hAE5g11RpMR6c2t8IxfTss%2FT82flZCbldj7xr8zVj0G1sR6mUlja%2FPWo1NlvvHUj5DGuGc5PbEuo5bLjfo8yH0CnAQqfcAFAoczQk3Gf3p221d%2BRCLXex2aneU4KZB%2BTWbvvD2kNQ2oQdQ21AFOxJNe7H5nENkZc6rr%2BUAuwZ%2BkJQV%2FSZreMWjqXtGOSOxYtXN7nPR1oQHaOiC8kpUOxvR5p0lQ%2BhnO4Za1MLjHusYGOrIBQ9Tv0XlbHTWtvbiKQfQ%2F7%2F%2FSg747%2BdF1ddE4xyp7%2F3VcdiuPqKGmjKV4okTQ9MIlDzQsduUVf2B5PaSvuFRo58dvU2osmvuW8sQWtaXHteNFl%2B%2BTqMi1c9wOw6iVTbt59OJfLFKx%2FWwIApAY3ac4raYSjRrcaJdGg3TRWHBLasEXkB4JiAhDOATCTvFFtqhS7%2FvIfSthzt%2BeBpFYn7xkCqdx5LN%2B0cfF6fMTufHFBaG52g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=39491684fe94f0e5d98604b2a07ece6d3381d14d3d7249218959d71574d7492d",
      "file_size": 1311,
      "type": "text/plain",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 28,
  "voters": [
    "corrupted_bytes",
    "k0ns0l",
    "xven1c3",
    "2026",
    "thalaivar304",
    "clearlovefanboi",
    "ek3nk4r",
    "antedeeeguemon",
    "haomerck1",
    "yusuf-linux",
    "and 18 more..."
  ],
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
