{
  "id": 836877,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzY4Nzc=",
  "url": "https://hackerone.com/reports/836877",
  "title": "XXE through injection of a payload in the XMP metadata of a JPEG file",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-04-02T05:09:42.965Z",
  "submitted_at": "2020-04-02T05:09:42.965Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "moebius",
    "url": "/moebius",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 453,
    "url": "https://hackerone.com/informatica",
    "handle": "informatica",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Informatica",
      "twitter_handle": "informatica",
      "website": "https://www.informatica.com/",
      "about": "Informatica Corporation is the world’s number one independent provider of data integration software."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-04-21T09:29:34.893Z",
  "bug_reporter_agreed_on_going_public_at": "2020-04-14T22:33:42.585Z",
  "team_member_agreed_on_going_public_at": "2020-04-21T09:29:34.804Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Users are able to change their avatar picture. The avatar picture upload functionality is prone to a XXE attack when parsing the image file. Specifically, the XXE attack is executed through the injection of a payload in the \"XMP metadata\" of the uploaded JPEG file.\n\nProof of concept (note the \"Burp Collaborator Payload pointing to an External DTD\"):\n```\nPOST /edit-profile-avatar!uploadImage.jspa HTTP/1.1\nHost: ███████informatica.com\n\n  [...REDACTED...PLEASE.SEE.SCREENSHOTS.FOR.FULL.PAYLOAD]\n```\n\nAnd I received the following calls (note the User-Agent \"Java██████\" confirming the vulnerability):\n\n```\nInteraction 0 \nType: HTTP \nClient IP: ███████ \nTimestamp: 2020-Apr-02 01:44:27 UTC  \nProtocol: HTTP  \n\nRAW HTTP request: \n\nGET /x.dtd HTTP/1.1 \nCache-Control: no-cache \nPragma: no-cache \nUser-Agent: Java██████ \nHost: N.syuj65rfsb27o1u78jcinsinnet6ky8n.burpcollaborator.net \nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive\n```\n\nSimilar calls were received from another IP address: 146.112.138.73\n\nFurthermore, the affected host should not be allowed to start a new connection to the Internet.\n\n## Impact\n\nThis issue can be abused to read arbitrary files and list directory contents from the filesystem of the XML processor application. I didn't try any reading, but JAVA (JSPA is a JAVA Servlet File) is calling my external service, so the vulnerability is confirmed.",
  "weakness": {
    "id": 54,
    "name": "XML External Entities (XXE)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 769845,
      "file_name": "Screen_Shot_2020-04-02_at_2.04.53_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qiRepvWB73guarDWbBBwWvht?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.04.53_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.04.53_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQOS66S2J%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T114650Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFyCNIIOlsQ8QQkmrSS8Y1PaLCB4uC66eE9OhsYKBzzYAiAYgGTmrppEI8a1VbSwK3tjJ%2BqBltJWjaN5JoyAHDv3uiqxBQgREAMaDDAxMzYxOTI3NDg0OSIMpRfkA99lOye9CBHqKo4FCmevMYUoOVdqFqkrBdaoOVi8RxgJUMPghmhZUP6qPT%2FikA9XtCUgrOceg3WQvTWvMMRYEewv8JnYfCTfVxLkdJ8HboLMqOB77Fe1lRNOt9X2sSDFi7JuA628ie5UP%2BSwXyAfvA7M4TZ7x3E9GDqStnB8a0ofuOpTY6AhGEUfpg6hxgkbZvNkwV3GdmVgMlE21OTMskrQ0WpxNAgrsj89WHVc6%2F7Bn%2BYRqE67YNzXcRXIPLDwv%2FYr7XP1rGz6etO41RxizD2fHRrI6OAAYHmzMxX4OOrLIjcBy%2FrvQF3Ak3h2tqE3wK%2BKEGDlZJgenPjbSVj01HDGs9tzKWQsuZ2Nuc%2FXu09MlWZc%2FEMxY3KUYM0b7n2yi0T9ZOLS6tXg87Hh0Sp3%2ByJJkj0tEmzDvt%2FCy1rSSlC13Z%2Bbo0eb%2Bbgb%2Ffdn4BBq4TGub1ftI1UDGg%2BlMN7bql7r3d55KzhS3i%2B%2Fi50pjhrgTrHApUht27zYvpVk61wbml8XxzlBTIkAsEv%2ByGRUJsRhhetk317DudAyMMvOkHnBP%2B7tJ17njven9AzfGTwyjkIMrD8YnusdLmz%2B%2BG21BNuqAINVBWHLHaeFlJA3xk%2FddJCGWBDxGwkFmegTRV57FdsG0dH%2FVystH0XOHRa%2BZrHZnmmI3ZkHloD7%2FL9ZCaU5xfBVytc69dFzWYtZZ4hIrvGsfEdSw%2BPLjaQeNmVbwJhJgAkkp6lXYbDB46GrZnpP5JNJw1PdTwbsYdO%2FZOWjkuN0X%2FZ9FJvqCycONhHlySfL6UAStucoLrl6kBOfLQVSMyL9ME%2BO9iQF2fAMqJeTEl8HeAWiqUv1k2ek7VZZQ5VUXmJrlmlDrywN5jCY6N0JTG%2FbTwrOknyXMIXdvsYGOrIBaTtS0VWhB%2FiyDQRz%2FbgRgPv8J1HuWiMzKJhYUu4kW%2FbsZujVIK3DdIsCG8vl%2BsSHnA3uZNfp39vnq8xj%2FkkxljE8%2BU83SGVMPPhtXoXMb5Iy8pZwMGmdLXaueY%2FnXrwRxwFhHSbzxxCl1tCesGC0CeeL52VmTz6G%2B6nHsmPDjnc6xehw%2BSdh7gcP3U5l1gSLD0e2yGEeku7WBUT7vaedoWWCBMDuVzoFz5OjzbtFAHxeMw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c42fe3603270939a31e303cc8b7a863cc695808d45afd25eb47904c42e72ed31",
      "file_size": 82931,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 769846,
      "file_name": "Screen_Shot_2020-04-02_at_2.05.10_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zEBjnN2xvdkj1iNi1NeNeVVz?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.05.10_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.05.10_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQOS66S2J%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T114650Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFyCNIIOlsQ8QQkmrSS8Y1PaLCB4uC66eE9OhsYKBzzYAiAYgGTmrppEI8a1VbSwK3tjJ%2BqBltJWjaN5JoyAHDv3uiqxBQgREAMaDDAxMzYxOTI3NDg0OSIMpRfkA99lOye9CBHqKo4FCmevMYUoOVdqFqkrBdaoOVi8RxgJUMPghmhZUP6qPT%2FikA9XtCUgrOceg3WQvTWvMMRYEewv8JnYfCTfVxLkdJ8HboLMqOB77Fe1lRNOt9X2sSDFi7JuA628ie5UP%2BSwXyAfvA7M4TZ7x3E9GDqStnB8a0ofuOpTY6AhGEUfpg6hxgkbZvNkwV3GdmVgMlE21OTMskrQ0WpxNAgrsj89WHVc6%2F7Bn%2BYRqE67YNzXcRXIPLDwv%2FYr7XP1rGz6etO41RxizD2fHRrI6OAAYHmzMxX4OOrLIjcBy%2FrvQF3Ak3h2tqE3wK%2BKEGDlZJgenPjbSVj01HDGs9tzKWQsuZ2Nuc%2FXu09MlWZc%2FEMxY3KUYM0b7n2yi0T9ZOLS6tXg87Hh0Sp3%2ByJJkj0tEmzDvt%2FCy1rSSlC13Z%2Bbo0eb%2Bbgb%2Ffdn4BBq4TGub1ftI1UDGg%2BlMN7bql7r3d55KzhS3i%2B%2Fi50pjhrgTrHApUht27zYvpVk61wbml8XxzlBTIkAsEv%2ByGRUJsRhhetk317DudAyMMvOkHnBP%2B7tJ17njven9AzfGTwyjkIMrD8YnusdLmz%2B%2BG21BNuqAINVBWHLHaeFlJA3xk%2FddJCGWBDxGwkFmegTRV57FdsG0dH%2FVystH0XOHRa%2BZrHZnmmI3ZkHloD7%2FL9ZCaU5xfBVytc69dFzWYtZZ4hIrvGsfEdSw%2BPLjaQeNmVbwJhJgAkkp6lXYbDB46GrZnpP5JNJw1PdTwbsYdO%2FZOWjkuN0X%2FZ9FJvqCycONhHlySfL6UAStucoLrl6kBOfLQVSMyL9ME%2BO9iQF2fAMqJeTEl8HeAWiqUv1k2ek7VZZQ5VUXmJrlmlDrywN5jCY6N0JTG%2FbTwrOknyXMIXdvsYGOrIBaTtS0VWhB%2FiyDQRz%2FbgRgPv8J1HuWiMzKJhYUu4kW%2FbsZujVIK3DdIsCG8vl%2BsSHnA3uZNfp39vnq8xj%2FkkxljE8%2BU83SGVMPPhtXoXMb5Iy8pZwMGmdLXaueY%2FnXrwRxwFhHSbzxxCl1tCesGC0CeeL52VmTz6G%2B6nHsmPDjnc6xehw%2BSdh7gcP3U5l1gSLD0e2yGEeku7WBUT7vaedoWWCBMDuVzoFz5OjzbtFAHxeMw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9650ca69ce104609df156b483e16452ed8c1bfdccfd16b8bac983a61ef98348f",
      "file_size": 37671,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 769847,
      "file_name": "Screen_Shot_2020-04-02_at_2.05.44_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iWJy8aA2T86Q3CvvrrG3MNNY?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.05.44_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.05.44_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQOS66S2J%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T114650Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFyCNIIOlsQ8QQkmrSS8Y1PaLCB4uC66eE9OhsYKBzzYAiAYgGTmrppEI8a1VbSwK3tjJ%2BqBltJWjaN5JoyAHDv3uiqxBQgREAMaDDAxMzYxOTI3NDg0OSIMpRfkA99lOye9CBHqKo4FCmevMYUoOVdqFqkrBdaoOVi8RxgJUMPghmhZUP6qPT%2FikA9XtCUgrOceg3WQvTWvMMRYEewv8JnYfCTfVxLkdJ8HboLMqOB77Fe1lRNOt9X2sSDFi7JuA628ie5UP%2BSwXyAfvA7M4TZ7x3E9GDqStnB8a0ofuOpTY6AhGEUfpg6hxgkbZvNkwV3GdmVgMlE21OTMskrQ0WpxNAgrsj89WHVc6%2F7Bn%2BYRqE67YNzXcRXIPLDwv%2FYr7XP1rGz6etO41RxizD2fHRrI6OAAYHmzMxX4OOrLIjcBy%2FrvQF3Ak3h2tqE3wK%2BKEGDlZJgenPjbSVj01HDGs9tzKWQsuZ2Nuc%2FXu09MlWZc%2FEMxY3KUYM0b7n2yi0T9ZOLS6tXg87Hh0Sp3%2ByJJkj0tEmzDvt%2FCy1rSSlC13Z%2Bbo0eb%2Bbgb%2Ffdn4BBq4TGub1ftI1UDGg%2BlMN7bql7r3d55KzhS3i%2B%2Fi50pjhrgTrHApUht27zYvpVk61wbml8XxzlBTIkAsEv%2ByGRUJsRhhetk317DudAyMMvOkHnBP%2B7tJ17njven9AzfGTwyjkIMrD8YnusdLmz%2B%2BG21BNuqAINVBWHLHaeFlJA3xk%2FddJCGWBDxGwkFmegTRV57FdsG0dH%2FVystH0XOHRa%2BZrHZnmmI3ZkHloD7%2FL9ZCaU5xfBVytc69dFzWYtZZ4hIrvGsfEdSw%2BPLjaQeNmVbwJhJgAkkp6lXYbDB46GrZnpP5JNJw1PdTwbsYdO%2FZOWjkuN0X%2FZ9FJvqCycONhHlySfL6UAStucoLrl6kBOfLQVSMyL9ME%2BO9iQF2fAMqJeTEl8HeAWiqUv1k2ek7VZZQ5VUXmJrlmlDrywN5jCY6N0JTG%2FbTwrOknyXMIXdvsYGOrIBaTtS0VWhB%2FiyDQRz%2FbgRgPv8J1HuWiMzKJhYUu4kW%2FbsZujVIK3DdIsCG8vl%2BsSHnA3uZNfp39vnq8xj%2FkkxljE8%2BU83SGVMPPhtXoXMb5Iy8pZwMGmdLXaueY%2FnXrwRxwFhHSbzxxCl1tCesGC0CeeL52VmTz6G%2B6nHsmPDjnc6xehw%2BSdh7gcP3U5l1gSLD0e2yGEeku7WBUT7vaedoWWCBMDuVzoFz5OjzbtFAHxeMw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c8572620b6e2132c638a4b705e855cd92ce86c4f202704e076b4ce3bf0e23645",
      "file_size": 16718,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-05-14T22:33:42.628Z",
  "allow_singular_disclosure_after": -168959588.00425088,
  "singular_disclosure_allowed": true,
  "vote_count": 135,
  "voters": [
    "totz_sec",
    "agrippathemagus",
    "a_d_a_m",
    "checkm50",
    "hackerontwowheels",
    "thepath",
    "holyfield",
    "mashoud1122",
    "elmago",
    "bogdantc",
    "and 125 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 21381,
      "category": "team",
      "content": "Researcher identified an XXE issue via a JPEG file upload. Researcher worked with us to validate the vulnerability, managed to escalate to return the contents of /etc/passwd and confirmed the issue was then fixed. Informatica responded by initially disabling the feature and then further blocking access to the vulnerable endpoint. Our thanks to moebius for the report, and the detailed writeup associated with it. Some technical details have been redacted in the below. \n\nShould there be any queries, please contact us via security@informatica.com ",
      "updated_at": "2020-04-21T09:29:08.756Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 582228,
        "username": "nheffernan",
        "name": "Niall Heffernan",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2019-04-15T10:34:20.268Z",
        "url": "https://hackerone.com/nheffernan",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
