{
  "id": 420459,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjA0NTk=",
  "url": "https://hackerone.com/reports/420459",
  "title": "H1514 Stored XSS in Return Magic App portal content",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-10-07T23:37:26.921Z",
  "submitted_at": "2018-10-07T23:37:26.921Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zombiehelp54",
    "url": "/zombiehelp54",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/mevfgipw1pc7n4wy86swdq1yaeuq/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-11-08T11:03:14.937Z",
  "bug_reporter_agreed_on_going_public_at": "2019-11-08T11:03:14.876Z",
  "team_member_agreed_on_going_public_at": "2019-10-31T18:38:08.575Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** \nStored XSS vulnerability was found in return magic app portal content which executes in the application domain in `https://services.alveo.io/dashboard-shopify/settings/portal/content` \n\n**Description:** \nIt's been found that Return Magic app allows users to add HTML content to their return portal without sanitizing the HTML which makes it possible to inject malicious tags that can be used to execute arbitrary JavaScript through other users' sessions.\n\n## Steps To Reproduce:\n1. Install Return Magic app\n2. Navigate to `https://<shop>.myshopify.com/admin/apps/returnmagic`\n3. Open **Settings** tab from the top menu and then open **Portal** --> **Content** from the left menu \n4. For the textarea where you enter your portal content, click the **Code** icon and enter `Test <img src=x onerror=alert(2)>` then click **Save** \n5. Now each time a user opens the portal settings page, `alert(2)` will be executed.\n6. XSS also triggers in `https://services.alveo.io/portal/search?shop=<shop>.myshopify.com` \n{F356974}\n\n## Impact\n\nThrough this vulnerability a malicious user will be able to execute JavaScript through other user's sessions' which allows him to do malicious actions such as stealing sensitive information, submitting requests that bypass csrf protection ..etc",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 356974,
      "file_name": "Screen_Shot_2018-10-08_at_1.36.21_AM.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/974/5b05952d45dbd6f3e06a9fab756a707661d9e9eb/Screen_Shot_2018-10-08_at_1.36.21_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-08_at_1.36.21_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-08_at_1.36.21_AM.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6EZXH3ZQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T135237Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEdAxoz4Y8fFbVkyPQZuAz%2FTO7g0O5hk%2BWPV4HhoCnfWAiA%2B%2BdvO4JgFOHorEo%2By8dOyVXQ5nzV8aWyrTcHJ99txlSqyBQgUEAMaDDAxMzYxOTI3NDg0OSIMdkXL0YE4tR8%2BK7cLKo8FPejJmIYKFdTKz0rimiR5%2FAddCd92%2F4x5A9kE1tZo1%2B19mQdkBA9WOdmH%2BbmTUpnVtu%2FfGVVVDf2%2BZEa%2F8wRwwDwu%2FzOIffONBQqkd%2BoaBEz5L1jfe59Sm6iQ7RqjNa5k2DLQQilDa%2FM64aFf5dowbgLmFhQUnS6vvKYZ4o5wN20uTXzq7wPWhRpVr5kqLzsyVTaD7DfGZ5RD2kzHEJWXW62F7wKyHDi%2FqscLwZvMO6YfufGCemRvK6iwvSoeLWvnOW5bXxuUXlVeW2mWz9GrE0aptxi3%2BteK2MWMx3EwBYaez8wuW5FFnwsK6uPCWr8rPypsYnprTWrCpwEiKCGNEcszn8Gng77mMXuKuwsQK2Zue8XbnMLW1e%2BUYvexsi9BBxKNLSWhFWRsTN2unqyrlRYoFUsHk6zKE64uxbOQ7vl2QiWKbnrqYmh3e3jprv8GSyTFSHLiyliSHbw19mUIGG3Zo%2Bh48K8Jl1010C3m%2BlHMTDrOj9RsZcRpqqQHcsQiE4wqYBuJP7GfkmTZrRdSywoejJogNVmYR8WTGe42yN0rIXEt77fDR9qgIGAZZ6exyz%2Fj7VFuaXvio2eQEKmi8IF8q0wFXaBjOR6hXw0UA5zdTZjC1cDhluKmL6wwlIX%2BKobxDpn2uzlmLMpMva%2BEQX2a7eZUHv4mYjLaNO03Gj8WDqqfr7StbbOpQTH7yDUPBKHvaRh60A3vziaux5AMzjBOypcbQWgoZw%2BacKyB0iCl%2FDtlKNK7w2H6NwwMiHRBQIzxw9DFkjxfTKXG2Q4mIxT5VUPJebnnLxa0J%2FFJhR74H8kaDwICWPmppVPElp8yzDzvCFPUqjEZ9MSb%2F5ONKqX8Dvl0oSU6YkD6H9ElyTDkvL%2FGBjqyAXdUlI0kdmwuGQTL1VbDHfXRoAYXbOGuAZIjBhv7%2BFZaLSBFziHhnfcsXdplMdW%2F1vD1%2FjviUqubFnog8fP%2FnKBJNpg2GMAab2CjXGAwogD%2FqSAz8NLKYNd726CkJGpsxA3aBIFANXZlODp4iYrpbA6elQOLToustaBCGZ1WTFK1dUqA3oA7KpTqjxp8R515fj9KjV50VXDPDr2oYqkVeEIbcMJSltlmXcyLDUz55uvuILU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a4ff7d288785af1b79aae781c0cf9b41248d54054d47132f2a9347daf8914b3f",
      "file_size": 490896,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 21,
  "voters": [
    "nohats",
    "drsniper",
    "ali",
    "sameerphad72",
    "bl4de",
    "term1nal",
    "sa1tama0",
    "cr4xerbik4sh",
    "whitehacker18",
    "cryptographer",
    "and 11 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 18807,
      "category": "team",
      "content": "*Note: This report was submitted during our [H1-514 live hacking event](https://www.hackerone.com/blog/Shopify-Awards-116000-Hackers-Canada-h1-514-Recap), which had an expanded scope compared to our public bug bounty program. The app mentioned in this report is not currently in scope for our public program.*",
      "updated_at": "2019-11-08T16:19:27.199Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 19166,
        "username": "clayton",
        "name": "Clayton Smith",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2015-03-19T21:02:17.272Z",
        "url": "https://hackerone.com/clayton",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTEzOTIwMCwicHVyIjoiYmxvYl9pZCJ9fQ==--305067878f80100c42531d0fe7e980e5a345e62c/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/5254e0ad-2f9c-4a01-8941-9bd5ca2e75db_edited.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
