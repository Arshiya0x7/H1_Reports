{
  "id": 962604,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjI2MDQ=",
  "url": "https://hackerone.com/reports/962604",
  "title": "Revoked User can still view  the Merge Request  created by him via API",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-08-19T17:56:38.818Z",
  "submitted_at": "2020-08-19T17:56:38.867Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "muthu_prakash",
    "url": "/muthu_prakash",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MzY2MTYwOCwicHVyIjoiYmxvYl9pZCJ9fQ==--50385d8a3002094c02ed2a883e62b31191337863/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/john-wick-1668095706.jpg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-03-15T21:37:30.946Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-12T10:48:52.070Z",
  "team_member_agreed_on_going_public_at": "2021-03-15T21:37:30.796Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\n\nIn Gitlab when a user is demoted to Guest role, the Guest user will not be able to view and edit the Merge requests in a project even if the merge request is created by him. But this check is not implemented in API so the Guest user will be able to the following actions for the Merge request which he don't have a permission.\n\nAllowed Actions in API \n\n- Able to view the title and Description of the Merge Request via   /projects/:id/merge_requests/:merge_request_iid endpoint\n- Get a list of merge request participants via /projects/:id/merge_requests/:merge_request_iid/participants\n- Get a list of merge request commits via /projects/:id/merge_requests/:merge_request_iid/commits \n- Get  information about the merge request including its files and changes via /projects/:id/merge_requests/:merge_request_iid/changes\n- Get a list of merge request pipelines via /projects/:id/merge_requests/:merge_request_iid/pipelines\n- Create a TODO for that Merge Request via POST /projects/:id/merge_requests/:merge_request_iid/todo\n- Get a list of merge request diff versions via /projects/:id/merge_requests/:merge_request_iid/versions\n- Get Merge Request approvals status via /projects/:id/merge_requests/:merge_request_iid/approvals\n\n### Steps to reproduce\n\n1. Add a user a to a project with developer role.\n2. From the Added user account create a Merge Request \n3. From Admin account demote to the user to Guest Role\n4. From the Guest user account try to access the Merge request created by that user. (Merge Request tab will not be available for that user)\n5. Now Create an access token from the Guest user account and try to access the Merge Request created by the user  by the above mentioned any one of the endpoints  (Notice you will be able to view  the Merge Request)\n\n### Impact\n\nGuest Role users have access to Merge Request data that he's not authorised to view and Edit\n\n### What is the current *bug* behavior?\n\nGuest Roles users have access to Merge Request data that he's not authorised to view and Edit via API\n\n### What is the expected *correct* behavior?\n\nGuest Roles users should be restricted  access to Merge Request  to view and Edit via API\n\n### Output of checks\n\n This bug happens on GitLab.com\n\n## Impact\n\nGuest Role users have access to Merge Request data that he's not authorised to view and Edit",
  "bounty_amount": "1500.0",
  "formatted_bounty": "$1,500",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "wi11",
    "shreyaschavhan",
    "ali",
    "fle_xxx",
    "risinghunter",
    "melwinalm",
    "bs7fg",
    "henryhenry",
    "destinedtohack"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
