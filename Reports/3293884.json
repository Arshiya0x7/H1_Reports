{
  "id": 3293884,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjkzODg0",
  "url": "https://hackerone.com/reports/3293884",
  "title": "Vulnerability Report: Local File Disclosure via file:// Protocol in cURL",
  "state": "Closed",
  "substate": "not-applicable",
  "severity_rating": "medium",
  "readable_substate": "N/A",
  "created_at": "2025-08-10T20:24:50.847Z",
  "submitted_at": "2025-08-10T20:24:51.218Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ahmedqc1",
    "url": "/ahmedqc1",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-08-10T21:37:42.483Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-08-10T20:30:56.355Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Summary\nA security vulnerability has been identified that allows unauthorized local file system access via the file:// protocol in cURL, particularly when executed with elevated privileges (e.g., sudo). This could lead to sensitive data exposure, including password hashes stored in /etc/shadow.\n\nSteps to Reproduce\nLocating Protocol Handlers\nFirst, I searched for protocol registration in cURL's source:\n// Found in lib/url.c\nstatic const struct Curl_handler * const protocols[] = {\n  &Curl_handler_dict,\n  &Curl_handler_file,  // ← This is what we're interested in\n  &Curl_handler_ftp,\n  ...\n};\nKey Insight:\nThe file handler is enabled by default in the protocols array.\n\nExamining the File Protocol Handler\nI traced the file handler implementation:\n\n// lib/file.c\nstatic CURLcode file_do(struct Curl_easy *data, bool *done)\n{\n  char *path = data->state.up.path; // ← Raw path from URL\n  FILE *file = fopen(path, \"rb\");   // ← Direct filesystem access\n  ...\n}\nVulnerability Found:\nNo validation of:\n\nPath traversal sequences (../)\nSymbolic links\nFilesystem permissions\n\n\n1. Basic Local File Read\ncurl \"file:///etc/passwd\"  # Reads system user info\n2. Privileged File Access (with sudo)\nsudo curl \"file:///etc/shadow\"  # Exposes password hashes\n\n\necho \"test\" > /tmp/test_file\ncurl \"file:///tmp/test_file\" \nsudo curl \"file:///etc/shadow\"  #\nExpected Output:\nroot:*:\nkali:$\n[...]\n\nReferences\ncURL Security Documentation - Official security considerations for cURL\nCURLOPT_PROTOCOLS man page - Protocol restriction options\n\n## Impact\nConfidentiality Breach: Read access to sensitive system files\nPrivilege Escalation: Potential root access via hash cracking\nBusiness Impact:\nCritical for systems processing sensitive data\nOften missed in containerized environments",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4664084,
      "file_name": "Screenshot_2025-08-10_230246.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bzysxh6ezey77fy6nusfi5fjr5pk?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2025-08-10_230246.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2025-08-10_230246.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQKT27YE7%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T164126Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCol514S6H6N74sS333H88P0VOEwSJ5ZTfhMDY8aZnfyQIgYEz3uNKfKr%2BFnxLwaNlW1zaVKhxcJU9atJNjIeminA8qugUI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDMYzAr3oZXS4Nb3nXCqOBZ%2BrvrNTpyZNe7uI8iesSXO2NggEsysUBZ8qmUIBkmmWB4%2FBpBBU2j%2FxJKJgfNrJfl18B1tUEJ86v9cIB4BIVb7R9r10gavyNY8wU2maNJ1lY%2Fx1v1vghiGgvgrJEQ4APajvm91bHe3nmlGr6BOQy3uVpIaPe2rHMvssft8WzYE%2BWOgnQI%2BJf4BJcfS5HH3gbhnMJKBYTUQfWTOdldt8XbXAFtxEfTa3tWQSzEVTHUf48nH4dmQPvWVStrvX5SGuo6GVN5R8mJC9bAGOnHamAS7ejCop1%2BWdesrYcBhZfzkyLRuc%2BGbxWNi7Ya4zWqJ8x6ZHw%2BSdrnngfehNwj9qJOyOvQASdKhhONmuYi5I4DKCjUkXC%2FygolGQpUuTcsEqAtQfH3k5OQo8OebDuNiEcT7wGrhnFfT2qqLRV6MEiN52tmTKNPquguzMcjEcVgSPu4%2BYuibYQXypoK2q%2FiQ3YM7lx0ICfQ3REdydqo%2Bl7wzu8rxyCSC5gjaBFV0p4UZDHdiCavQYUUHZoH0VmHC62ncGxrfqh4WHjBRgKt%2Fk1vNPbShpFpi8vxHDdi%2BOadgy0UGwgSro6cjPRDSe9M7mfDm4koB2qe5DifXnALcyWU5aH4JrRIowdyMlimb69ICFtoDL9ZEneICXpdRq42%2BZfoLEJhmllsTVze%2F%2FpCD2VXTxFfawV6mUx1xZCeJkQnMDY0ZFIIMDmuAa6VVRgNGNITKmcy3lCNFTYY8CoO%2FMbGEnHbAHoACwpu%2FrCWkEN5Kn4GeAfsfaUXkJ73VIsBsSlAa%2FcXTW%2BpieiqwO%2F%2BDxp5Ub1aPkJ08xeyaGhEMCg5Eia5l%2F5EteeSpj5WmHDu8c5EcTDoQ3TUUQ3zKtl2YW%2FTDR6brGBjqxAVQGF6ztHeY0xrhTjNvpNdDJ0QuVff1zQyq6ejiqUupgwRha80yIWHtyBAfA8LAHlF8Apwq04r%2BrcY%2FPyqzePm9WBePn3nhBoNDRvCP7iHQWSbwbfoAlEJUQBTYT1rh9u2TFHrprObAGhJAOEFyshv8rFYbFVBxoLSfWYYSM0LV4WUUm54xq8LWKwANUGzxpyeBQfxIuDv3VTWefl014TMWi0Ix7%2FOU9rm%2BmH0816qlN5w%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=eb81ff4020c51c51f666fa62325cb267c0059718c9348b6d770d190a839214c4",
      "file_size": 89544,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4664086,
      "file_name": "Screenshot_2025-08-10_230435.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2a04kdohhc599rznuwfe4fwimzq6?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2025-08-10_230435.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2025-08-10_230435.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQKT27YE7%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T164126Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCol514S6H6N74sS333H88P0VOEwSJ5ZTfhMDY8aZnfyQIgYEz3uNKfKr%2BFnxLwaNlW1zaVKhxcJU9atJNjIeminA8qugUI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDMYzAr3oZXS4Nb3nXCqOBZ%2BrvrNTpyZNe7uI8iesSXO2NggEsysUBZ8qmUIBkmmWB4%2FBpBBU2j%2FxJKJgfNrJfl18B1tUEJ86v9cIB4BIVb7R9r10gavyNY8wU2maNJ1lY%2Fx1v1vghiGgvgrJEQ4APajvm91bHe3nmlGr6BOQy3uVpIaPe2rHMvssft8WzYE%2BWOgnQI%2BJf4BJcfS5HH3gbhnMJKBYTUQfWTOdldt8XbXAFtxEfTa3tWQSzEVTHUf48nH4dmQPvWVStrvX5SGuo6GVN5R8mJC9bAGOnHamAS7ejCop1%2BWdesrYcBhZfzkyLRuc%2BGbxWNi7Ya4zWqJ8x6ZHw%2BSdrnngfehNwj9qJOyOvQASdKhhONmuYi5I4DKCjUkXC%2FygolGQpUuTcsEqAtQfH3k5OQo8OebDuNiEcT7wGrhnFfT2qqLRV6MEiN52tmTKNPquguzMcjEcVgSPu4%2BYuibYQXypoK2q%2FiQ3YM7lx0ICfQ3REdydqo%2Bl7wzu8rxyCSC5gjaBFV0p4UZDHdiCavQYUUHZoH0VmHC62ncGxrfqh4WHjBRgKt%2Fk1vNPbShpFpi8vxHDdi%2BOadgy0UGwgSro6cjPRDSe9M7mfDm4koB2qe5DifXnALcyWU5aH4JrRIowdyMlimb69ICFtoDL9ZEneICXpdRq42%2BZfoLEJhmllsTVze%2F%2FpCD2VXTxFfawV6mUx1xZCeJkQnMDY0ZFIIMDmuAa6VVRgNGNITKmcy3lCNFTYY8CoO%2FMbGEnHbAHoACwpu%2FrCWkEN5Kn4GeAfsfaUXkJ73VIsBsSlAa%2FcXTW%2BpieiqwO%2F%2BDxp5Ub1aPkJ08xeyaGhEMCg5Eia5l%2F5EteeSpj5WmHDu8c5EcTDoQ3TUUQ3zKtl2YW%2FTDR6brGBjqxAVQGF6ztHeY0xrhTjNvpNdDJ0QuVff1zQyq6ejiqUupgwRha80yIWHtyBAfA8LAHlF8Apwq04r%2BrcY%2FPyqzePm9WBePn3nhBoNDRvCP7iHQWSbwbfoAlEJUQBTYT1rh9u2TFHrprObAGhJAOEFyshv8rFYbFVBxoLSfWYYSM0LV4WUUm54xq8LWKwANUGzxpyeBQfxIuDv3VTWefl014TMWi0Ix7%2FOU9rm%2BmH0816qlN5w%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d964d82b8d06267400d6ab2eaec0ae8a12431c959e1aea211c7a97128e1b46d9",
      "file_size": 109527,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "2026",
    "thalaivar304",
    "stoic127",
    "mai91",
    "ahmedqc1",
    "0xs3iif",
    "xx_z",
    "heikohepp85",
    "johnnywatters"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
