{
  "id": 819863,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MTk4NjM=",
  "url": "https://hackerone.com/reports/819863",
  "title": "XSS in PDF Viewer",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2020-03-16T02:01:22.673Z",
  "submitted_at": "2020-03-16T02:01:22.673Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "skewbed",
    "url": "/skewbed",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/BSD7UaPxH6cJqZ5ddcJurigm/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-8155",
    "CVE-2018-5158"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-05-23T22:54:24.794Z",
  "bug_reporter_agreed_on_going_public_at": "2020-04-23T22:54:23.804Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "An outdated version of PDF.js in use allows for the CVE-2018-5158 vulnerability.\n\nWhen the payload PDF is shown in the supplied PDF viewer, it can execute arbitrary JavaScript.\n\nI have tested the payload PDF, and it is working in the Safari 13.0.5 (the latest version) and Firefox 74.0 (the latest version). Although, it does not work in the latest version of Chrome.\n\nI could not find a way to test it on the desktop client. I assume that it would use the system PDF viewer.\n\nModifying the payload to fetch other code was luckily blocked because of a CORS policy.\n\nThe payload is from [https://bugzilla.mozilla.org/show_bug.cgi?id=1452075](https://bugzilla.mozilla.org/show_bug.cgi?id=1452075).\nI have also included the PDF in the attachments.\n\nThe payload can be seen in action by checking the JavaScript console. It says \"Hello, this is code running in\" followed by the path to file where the vulnerability is.\n\n## Impact\n\nAn attacker could execute arbitrary JavaScript code on a web browser when a PDF containing an exploit is opened.",
  "bounty_amount": "100.0",
  "formatted_bounty": "$100",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 749016,
      "file_name": "payload.pdf",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/q2hLgdxL2HnfJE7snRfCdijV?response-content-disposition=attachment%3B%20filename%3D%22payload.pdf%22%3B%20filename%2A%3DUTF-8%27%27payload.pdf&response-content-type=application%2Fpdf&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQROZBLAGE%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T103233Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDcxIVdbf73l0UyPkhytCXQuCCZ556ldY9O9DVrDiiPYwIhAIQi89OzhXnxt4VmuD1AN%2FfISqOKKmGLYb43uu1bSJU4KrIFCBEQAxoMMDEzNjE5Mjc0ODQ5IgwKLrxR4GYcq%2Bxh%2FtYqjwXb0wGjLYDmzBSV87fTvkjusJovIAcpV9gf9KaGvzuZcMiisMIH3KYi%2BGmLj23misc5me3umAQh4Guku3amOrVZyxY0PggelkuoXxyYv5b012zS4bmenjfX8c%2Fu9o76jh4P5fOuqAzBzyiUbcrVedNsjD7KdZoS9ROGFmBY6tmf5CF8cTWD7SFJcNykQO37Cwe%2FrG4g%2BKPqfzNsd4xTKOCuxlB%2BRZ2dFnAG%2FMKtL86b9koEzi3EGOYvEb2MKTVs6HBLB33aPSvU9s8aLAYwv3asj7XhRInf10DA55VlGf00p%2FOKpS3nfn1WhgEWRNo9EVCJyMnubFqm1P%2FJwb6Rfc5lxXokWUrr0hVFInSS8Wm%2FxsJ%2FmFfVAURyyst1QSYoldugv2tOOggirqtv64lSWb6DbWfX93tIMrc3le7z1iWJaR0Gu09M5RZOrs1Eq2Snq%2BULBLJ6pzK9qwHMCGsVDvk35Y%2B9eACDwmLIoj3paRE4qpUED%2F2IO9AjcVHptQsJiaUlIYqRrBaYDOlLdkhoCOTjJiqXl5Q9ryXzEYlApYkiTAAeIqjOhdBNRs7P7HEhqxeTMr0kekdGKPvMntI7xK%2BXiSl6Q4%2BglVMUe9J%2FTcD1Kf4hKqqsVNCZUQa1fjxVV8FbVvBU2S9vHqf6B6%2BWzRzJc97%2BLmyecbEoVc80f8D5R3Kl7Px0gXSrpaHyz94GDfYlXH8c1uKzveeZA4ikSzpger9xrAglXII04feceK99wm5albNk9TBg0pykmzs1L%2BN2eWa7RbDGqv1H1Z6lvZdNCa8ajv%2FLP4zwx1m8OVHvhhT8g4LQUKLEG8D8C0wrWdy5EOlCOgHGtN7RP17tUSqdMZIg9IKKPwUTtCMXI2dCMJvRvsYGOrABZc6b2GZTpoTKOK4VNmEH87TVe%2BoM4DDT4YC641Rbhe0tziYV%2B%2BNnXEwwncFCUCNv2Og9fJf7cc1IA4jS3fmE982c2yoWKABwqrxW%2BZXwnYzr59fh72L%2FHFeGvXFSaRyS5QbBVvQ8Vr7%2BPl7yUNP4m%2BHDkBqhW5V8RAYqdRTZAOxAoolx3ZxS8gs18Pd1EqKKhqR78i%2BICPbWI01GNvDF17a0gKGlfaB6X5eDyMrezd8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=04040da4d89ecdac8da42d2a361f53d9d53eced43f6d74e7fde0d89f4c6a9981",
      "file_size": 896,
      "type": "application/pdf",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-05-23T22:54:23.887Z",
  "allow_singular_disclosure_after": -168176289.82957932,
  "singular_disclosure_allowed": true,
  "vote_count": 25,
  "voters": [
    "muslimfrompk",
    "he4am",
    "osman1337",
    "ali",
    "mik317",
    "2026",
    "shristisen20",
    "f1ras",
    "sa1tama0",
    "supun_halangoda",
    "and 15 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 62,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/files_pdfviewer",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 21818,
      "category": "researcher",
      "content": "You can find my full write-up at https://tripplyons.com/blog/nextcloud-bug-bounty",
      "updated_at": "2022-12-12T01:22:09.027Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 195560,
        "username": "skewbed",
        "name": "Tripp Lyons",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://tripplyons.com",
        "location": "",
        "created_at": "2017-08-28T20:27:49.800Z",
        "url": "https://hackerone.com/skewbed",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/BSD7UaPxH6cJqZ5ddcJurigm/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/BSD7UaPxH6cJqZ5ddcJurigm/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6ODU1MjY0LCJwdXIiOiJibG9iX2lkIn19--a1e35c02ad650ca501e21ad1e39bc8e6d514fe2f/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/skewb.png"
        }
      }
    }
  ]
}
