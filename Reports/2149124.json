{
  "id": 2149124,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ5MTI0",
  "url": "https://hackerone.com/reports/2149124",
  "title": "PATCH method manipulation allowing the users to escalate their functionalities and edit (upgrade/downgrade) API Keys settings which is not allowed",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-09-15T05:35:17.464Z",
  "submitted_at": "2023-09-15T05:35:17.570Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bugsv2",
    "url": "/bugsv2",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/paceng1rmjlan5wd6rhtbp7vipii/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 58820,
    "url": "https://hackerone.com/frontegg",
    "handle": "frontegg",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/03bevawp68pp38m1zvkqtpdpsf6j/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/03bevawp68pp38m1zvkqtpdpsf6j/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Frontegg",
      "twitter_handle": "fronteggforsaas",
      "website": "http://www.frontegg.com",
      "about": "Frontegg is an end-to-end user management platform for B2B SaaS, powering strategies from PLG to enterprise readiness. Easy migration, no credit card "
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-03-20T13:13:36.011Z",
  "bug_reporter_agreed_on_going_public_at": "2024-02-19T13:13:32.599Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nHey sup, Hope you are doing well today Inshaallah <3\n\nI found a misonfiguration today would allow the users to edit the API Keys `Info`, `description`, `createdAT`, `roleIds` and manipulate all of them\n\nLet me show you something first ..\n\nIt’s only allowed for all the users, Owners or Admins → Just to create new API Key and remove API Key\n\n██████\n\nLike this screen, There’s no area to edit your API Key, But the users actually still has the access to edit it, By using `PATCH` method\n\nWhat the PATCH method means?\n\nAfter some searching .. I found out that the delete request is: `DELETE /frontegg/identity/resources/tenants/api-tokens/v1/<API_KEY_ID>`\n\nand here is the Idea !! The group actually can be edited by sending `PATCH` and can be deleted with `DELETE`, So could the API be the same?\n\nI tried actually and It worked with me !!\n\n█████\n\n## Steps to reproduce:\n\n1. Create Account A and Account B\n2. Invite Account B with role `Admin` to ⇒ Account’s A Panel\n3. Now From Account A, “██████████████The owner”.█████████ Create an API Key with role `Owner`\n    \n    ████\n    \n4. Now go the Account B (█████████████The Admin████████████████) and try to delete the Key, But don’t delete it !! Just ███████████Intercept████████████ and move it to repeater, and ███████████████drop it█████████████████ !!\n5. Now change `DELETE` to `PATCH` as method ..\n6. Now You have those fields to control, \n7. Let’s send something like: `{\"description\":\"desc111111\",\"roleIds\":[\"c22321ba-8ece-426d-b418-ece2a6d72009\"]}`\nand `c22321ba-8ece-426d-b418-ece2a6d72009` refers to role: `Impersonator`\n8. Now It’s successfully changed ^_^\n    \n    ███\n    \n9. Thank You <3\n\n## Possible Scenarios:\n\n- Let’s say the Owner has 2 admins with him, and he created some API Keys with the “`Owner`” Permission, Which he would use by himself, The Admins now can edit this API key with our bug and downgrade the API token permissions or remove it at all, Now the API Key is bad one, The admin would have to remove it and create new one and configure his settings again and again and again\n██████████████████and who did this? ::█████████████ No body knows man !! It’s not even allowed !!\n- Admins can too downgrade and upgrade the API key which is “under the admin”\n\n## Applying a Fix:\n\n- remove the PATCH method from endpoint: `/frontegg/identity/resources/tenants/api-tokens/v1/<API_KEY_ID>`\n\n## Impact\n\n- PATCH method manipulation allowing the users to escalate their functionalities and edit (upgrade/downgrade) API Keys settings which is not allowed\n- broken access control to not allowed functionalities\n- Users can edit the API Key’s info which is not allowed",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-03-20T13:13:32.693Z",
  "allow_singular_disclosure_after": -47455145.689538114,
  "singular_disclosure_allowed": true,
  "vote_count": 43,
  "voters": [
    "achabi7",
    "3thm4n",
    "aboalezz",
    "bugsv2",
    "zy9ard3",
    "bxrowski0x",
    "captn0sharky1",
    "shubham_srt",
    "thalaivar304",
    "mohaned0101",
    "and 33 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 191996,
    "asset_type": "URL",
    "asset_identifier": "portal.frontegg.com",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
