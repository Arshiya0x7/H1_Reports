{
  "id": 1408782,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDA4Nzgy",
  "url": "https://hackerone.com/reports/1408782",
  "title": "Add upto 10K rupees to a wallet by paying an arbitrary amount",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-11-24T05:54:59.528Z",
  "submitted_at": "2021-11-24T05:54:59.599Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ashoka_rao",
    "url": "/ashoka_rao",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/cfkto6qaiyh8vsapld9mdytabhj3/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22ert.jpg%22%3B%20filename%2A%3DUTF-8%27%27ert.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5NFJOVAF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T002140Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEID%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCYoKrB%2B5OAtMEvTgI1XSN2%2BKvLv%2FCStZ28UmgWI5ObKwIhALGCZDa0Bq2L38Z%2Fa7dYv4m2VMjCdwsGoNrRzMjVp2KLKrsFCPn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgxKteL6N%2B7t%2BhCTQkMqjwXJeRXjJ4O0ufVhiNeAdWoTAeaS3K9z5%2B%2FSJHMf2WAtLZx4kgetOSeeHRtMugsPWBC%2Bug6jjsy76pybkL1EYFZ%2BHurdTOiA10xtB%2BEu%2Bo0zHXt4s6wJlbTsOBpzJcycP0%2Bj9fSWmQlKTPvdqmHcHAIeH4D6hmNRS%2FyYtefuzRd9jc6xfeHyrsGV8mo4d6uZ2A0fg2hy1%2F1qb1XadZ1paLPyCZfgzQtVXH%2Bvhky1YB1dckNPacNmZA7mSLSZNoy4lgr39%2FuP02mR%2Bx08coW0djJuPXpBNPpQ5GuIsA1ev%2Bg%2FkxzkNFg8Iurb8xrHQlMBno3ZmujhXMO6mQmjclRB7stxh1Exi4ToRyAj9ys2n5n9DI2lu82NXIEx2c8u5M17em7dBXmFeS8XKoIjEq0vX1h%2B2SWji6fyrSN0Y3zSkqVo2SFA7SnmS9bAwBB7VHIslHZoHC7TDp%2BpUyuXMg4WJmQd07kGmm%2Fb9xxb562ODFeVFV%2Bw3uVJ840nT%2BzgJR84a%2F4tGuGqocZ8Cy4E0zkK9MZ3Hsd6x3IXOyrX%2Fh%2F8u%2F2fjtBFTcmxdfiXSNNx2jj%2FZ9iE4xZCEeVw0nyPWvTfkJTjiSjA2LbQgCK9BI0K%2FNrgP5FhiR8VL%2F1JNnDuXT1ae36m90n%2B4kaOygNNiVrLZDXu11ZidM%2B8L0ZnsA53ktL9bcmVTKWElcsa7vHZkwD7vj%2FDoZkQKpgj5fwgbOF2X0LcBNcSHRHyaln9fxl9ibEusC6ISslQ1JW0EAgzGKuPJIk7cemZi6RtrNjcT87VZIttNPNsH45zqIA%2B8njei2FQScCK744SPZQhZNEVgBwTKUMjHeg3OMfzHwRHi%2FGjpyemyKwKX93dJ5FxqEuMhtCeMKXzvMYGOrABS%2F7GpsZUawWuSZ4%2BGnTjwxHQ%2B2HPFUulGEIalHAL2LHhOVp3YYjZj90cWKPb83oDioKgtRsR%2Fn%2BfBauIB8qIbDmxt1s42h5r8Lzd66%2BpoizioEqa8kvLNvzoBvDaNu1Zvp50qJjqpcCfaXUg%2FrcpMV4530V1SIlrwEmkUCmLSOvc8n8%2FBSC5ML1W5ET5l8wee8Q1UP1EVxOOQddUIyli3p6tfFbhXY222hPpGECFxgM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f008b48d9e17a1940005cc90b0f7122fe229f9fe54a1c0ddd613d5bbe4d0f9cb"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2943,
    "url": "https://hackerone.com/eternal",
    "handle": "eternal",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/9525xdsq4bz7ubnoie172ssjv8ul/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/9525xdsq4bz7ubnoie172ssjv8ul/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Eternal",
      "twitter_handle": "Zomato",
      "website": "https://www.eternal.com",
      "about": "Eternal is India’s largest new-age tech company by market cap, comprising of 4 businesses (as of now) – Zomato, Blinkit, District, & Hyperpure."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-02-23T12:19:17.891Z",
  "bug_reporter_agreed_on_going_public_at": "2022-02-22T07:03:22.730Z",
  "team_member_agreed_on_going_public_at": "2022-02-23T12:19:17.791Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 120,
  "voters": [
    "demhack1456",
    "antoniusblock",
    "pinkmeimei",
    "ezzra",
    "henry1601",
    "ganeshbagaria",
    "alp",
    "thruster",
    "rodolfomarianocy",
    "discodamone",
    "and 110 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 387,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.application.zomato",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 130569,
      "category": "team",
      "content": "| TimeStamp   |      Action      |\n|----------|:-------------:|\n| Wed, 24 Nov 2021, 11:24 IST | Received the report |\n| Wed, 24 Nov 2021, 11:25 IST | Validation and analysis of issue initiated |\n| Wed, 24 Nov 2021, 11:28 IST | Vulnerability reported to the respective Internal Team |\n| Wed, 24 Nov 2021, 11:36 IST | The authenticity of the issue is verified by the Security Team |\n| Wed, 24 Nov 2021, 11:41 IST | Report Triaged |\n| Wed, 24 Nov 2021, 14:47 IST | Fix Deployed on Production |\n| Wed, 24 Nov 2021, 14:48 IST | Severity adjusted to High (7.5 CVSS) by Security Team |\n| Wed, 24 Nov 2021, 15:47 IST | Fix verified by the Security Team |\n| Wed, 24 Nov 2021, 16:00 IST | Fix acknowledged by the respective Internal Team |\n| Wed, 24 Nov 2021, 16:09 IST | Minimum Bounty awarded to the researcher |\n| Wed, 24 Nov 2021, 16:28 IST | The researcher confirmed the fix |\n| Wed, 24 Nov 2021, 23:15 IST | Full bounty + bonus awarded to the researcher |\n\n## Summary:\n\nThanks to @ashoka_rao  for reporting the issue. The researcher demonstrated a way to add any amount (upto 10k) to Zomato wallet without paying the amount in full and by paying an arbitrary amount.\n\nOther Payment methods and consumers including online ordering were not vulnerable to this.\n\n\n## POC:\nThe addition to the Zomato wallet happens in a two-step process.\n\n1. Generate the Order Request for Addition:\n```bash\nPOST /gw/payments/zomato_money/order\n\n{\"country_id\":\"1\",\"service_type\":\"ZM_RECHARGE\",\"cart\":\"null\",\"amount\":\"1000.0\"}\n```\nResponse:\n```bash\n{\"order_id\": \"XXXX\"}\n```\n2. Complete the Payment against the order request:\n```bash\nPOST /v2/sdk/make_payment\n\namount=XX&order_id=XXX&order_type=ZM_RECHARGE\n```\n\nThe amount requested to generate the `order_id - XXXX` was `1000` but while paying one could have passed an arbitrary amount instead of `1000` against the `order_id`, which was not cross-checked.\n\nSo one could have generated an order for the amount of `1000` while paying an arbitrary amount against the order and still get the entire amount defined in order added to your wallet (limited to 10K INR).\n\n",
      "updated_at": "2022-02-23T12:18:46.065Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1939096,
        "username": "cholepuri",
        "name": "CholePuri",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2021-09-02T14:24:32.249Z",
        "url": "https://hackerone.com/cholepuri",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
