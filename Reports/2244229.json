{
  "id": 2244229,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQ0MjI5",
  "url": "https://hackerone.com/reports/2244229",
  "title": "Cross-Domain Leakage of X Username / UserID due to  Dynamically Generated JS File",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-11-08T02:03:08.454Z",
  "submitted_at": "2023-11-08T02:03:08.861Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "th0h0",
    "url": "/th0h0",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/8idbf0bhn2nkkhm9zj05bqjamfuv/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61,
    "url": "https://hackerone.com/x",
    "handle": "x",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "X / xAI",
      "twitter_handle": "XSecurity",
      "website": "https://x.com",
      "about": "X helps you create and share ideas and information instantly, without barriers."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-05-10T22:40:32.373Z",
  "bug_reporter_agreed_on_going_public_at": "2024-04-16T09:52:55.514Z",
  "team_member_agreed_on_going_public_at": "2024-05-10T22:40:31.890Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** \n\nIt was found that twitter.com hosts a specific javascript file whose content is partly dynamically generated, depending on the requestor's user authentication cookie. This dynamic part actually reveals the X's User ID of the requestor. Since the Same-Origin-Policy doesn't apply to javascript file imports, an attacker can force a victim X user to import it from a malicious cross-domain application, then extract the User-ID, leading to the retrieval of the associated X username (via X API).\n\n**Description:** \n\nThe leaky JS file is the following: `https://twitter.com/sw.js`\n\nWhen requested with the cookie 'auth_token', the attribute '__INITIAL_STATE__ ' is populated in the following way:\n\n```javascript\nself.__INITIAL_STATE__ = {\"userId\":\"█████\"};\n```\n\n## Steps To Reproduce:\n\n  1. Log in to your X account\n  2. Visit the following malicious website: `███████`\n  3. Your X User ID has been retrieved\n\n## Impact\n\nX users become precisely identifiable from any remote website.\n\nThis implies the following:\n\n- Privacy / Confidentiality issue\n- Facilitation of X users tracking\n- Facilitation of phishing attacks at scale via better targeting \n- Facilitation of potential CSRF attacks at scale, for request depending on userId / username or any other public attribute that would initially be unknown to an attacker willing to target a maximum number of users.",
  "bounty_amount": "1500.0",
  "formatted_bounty": "$1,500",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 101,
  "voters": [
    "s0liman",
    "bugbountywithmarco",
    "mr-medi",
    "colonel007",
    "0xcyborg",
    "tinmo",
    "world_h",
    "faav",
    "lones",
    "n1m0",
    "and 91 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.7,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 1062,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.twitter.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 446477,
      "category": "team",
      "content": "Because the Same-Origin Policy does not apply to JavaScript imports, a malicious website could deanonymize users by retrieving their user ID from https://twitter.com/sw.js.",
      "updated_at": "2024-05-10T22:09:38.165Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2207595,
        "username": "x_brian",
        "name": "Brian",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2022-02-03T21:26:30.720Z",
        "url": "https://hackerone.com/x_brian",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/gshodqik2fei8011vwoouve3wmme/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/gshodqik2fei8011vwoouve3wmme/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjM0MTk3NiwicHVyIjoiYmxvYl9pZCJ9fQ==--3c96af16d59ad65caa8c02c829aec207b13b8ca4/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/FNF.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
