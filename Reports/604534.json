{
  "id": 604534,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MDQ1MzQ=",
  "url": "https://hackerone.com/reports/604534",
  "title": "Race Condition leads to undeletable group member",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2019-06-09T10:26:15.621Z",
  "submitted_at": "2019-06-09T10:26:15.621Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "yashrs",
    "url": "/yashrs",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-03-20T17:17:47.781Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-20T17:17:47.678Z",
  "team_member_agreed_on_going_public_at": "2020-03-20T17:00:13.865Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\n**Summary:**\nThere exists a Race Condition in which the user can add themselves twice to a group which will make them unremovable from group. They themselves cannot remove themselves from the group as well as the group leader cannot remove that user from the group. Ofcourse this is a low severity as that malicious user first needs to have a valid invitation link, but nevertheless this leads to permanent membeship of group so this needs to be fixed in my opinion.\n\n\n### Steps To Reproduce\n\nWe need two accounts to reproduce this.\n\n- First account will be leader account\n- Second account will be a normal account.\n\n- Create a group from the first account and create an invitation link.\n- Join using the invitation link on the second account and intercept the request:\n\n```\nPOST /group/post_join HTTP/1.1\nHost: ctf.hacker101.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://ctf.hacker101.com/group/join?invite=bb5c42ab578b12c63e5d868b3e03816c8c45597262aaf095ca2be19116b8fd0a\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\nConnection: close\nCookie: COOKIES\nUpgrade-Insecure-Requests: 1\n\ncsrf=391aecf0c3125e90c437d04c18204ab6&invite=bb5c42ab578b12c63e5d868b3e03816c8c45597262aaf095ca2be19116b8fd0a\n```\n\nRepeat the above requests in parallel. I did it for 5 parallel requests and I was able to add myself 2 times to that group:\n{F505223}\n\n- Now try deleting the user from first account(group leader). No matter how much you try, you won't be able to delete it.\n\nThis would lead to a state where the group leader will have to delete the group and create a new group if he wants the malicious user to get removed. \n\nThanks,\nYash\n\n## Impact\n\nIrremovable/permanent member of the group. Even the group leader cannot remove that user.",
  "weakness": {
    "id": 105,
    "name": "Time-of-check Time-of-use (TOCTOU) Race Condition"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 505223,
      "file_name": "Capture.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/505/223/73af2cbbb72cac409252def9adacbce16026bea9/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYAI44UUZ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T120537Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFnznGupH6e54NvfcNpXG1fTkfeS%2F%2B4teUauLzxrIq4YAiBshmGMJ%2Bo8WM%2FFrf7MR%2FU21KtXRONpl5NElLsIaMUQfSqyBQgREAMaDDAxMzYxOTI3NDg0OSIMXPiWQtj6xSi2cjIbKo8FRWivxOLh01wA%2Fz1AtWdUT%2FDuDfnITDsEc0h0ZC0yraEvha7LjG4t3v5I908iN5vTo4EaDTLjvXl1rCGzdWevtLl1NeJX1RdkL5C1gAMVdLGx%2B5fJIz0U2TaOwlZLZGTfLXuvz0TYTIoXCv%2BTJ%2BCuCXfmsxzWLgOvtpQ6Fe1pfGxTxavuuP%2FwaohZmOInE1ToPHFI6BuB1gHpgt1uFStw%2FpNPckkPR3sr2uBWze4ANd4ON2wrZhY8Pxk3top00Ve%2F1XDJHx3M%2BKqmealPl9nvCzCZvijQCF8o8SXOenErrcgnr6Tneilwgd%2FgvKcxCJgGGNacER%2BA%2FCfExC%2B6gZOmWZxGPP1xzmOpCcMjRXNaxId%2F%2BItvDudmYkq8n%2FGslstAKUNQHYaVy4kBXgRB1RH7nN5GMxBXuAo626lO2XresQRQOaAJfgPdvOYIfo8XLeU13MEkHusR1%2FSRrQNiNMwre3akw%2F2m2Xljv8qpi4O%2F90xehyveSyKABniDZV4eWd%2BywLj4NDd2va5YysIZcfQOpTreBAgND6t8bL9QZ2bIj5DivhAVk8KMBWQ14ckYbgi7wx6IscTukzq6EP1mP6duppBXSs39lKprZ95RmIBRAUBLkVZyh5yzGHc9GTZJRjrvnhmPEQ9ejo7e%2Fhr3gEeJiJA4HVa69pHf3L%2BNYw81XYIZOFXVfxclkLuWNXGN858R7xtCjnmLq1namZIoDbKkwgmaL8tQEDF48pcE%2BkZcdA%2F%2Be%2FMRc9m3BdEtpaHhAYuuzK017Eg54rq56nJYOIiT1vYw4xD1A4%2FE6ijPE8b5Gyy8JtlpcwWayVgyBsIv0SSUH04KVu555J%2FU81sKKwdB%2BUmwDm3WwiJ9Zbuqyp9VSDCo4b7GBjqyATX09D9cMLHStjYE4l3%2Boe0gkIYCsy%2BdDoZ80qsOhDrtYMQU%2B92NOTmY2k8LmyQa6%2BwNOBgXXTzI3Uy3rHXq78Nnli8tiTQXLW2QhF1Kb9jIQeSh6%2BxyPQCbIabbisZgl3httI9UOrVsuH8tXmJsD0LIT2Eyjy96wQh52riOwwuGzSDGbcjkRlcFBXY5YAVSxsgcno3ZE3%2FPbJmyqXIyf2yH6TqnjaPl6oiSTv0vQpO8rk0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1365591ca4e324c8393b696adb0c277bd9fe569132296f5645ed6aa42eba10da",
      "file_size": 63501,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-04-19T17:00:13.956Z",
  "allow_singular_disclosure_after": -171140723.40810835,
  "singular_disclosure_allowed": true,
  "vote_count": 142,
  "voters": [
    "he4am",
    "corrupted_bytes",
    "canarinho_pistola",
    "loaymorad",
    "a_d_a_m",
    "thaivu",
    "p1stachios",
    "base_64",
    "mattberg",
    "rook1337",
    "and 132 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 14424,
    "asset_type": "URL",
    "asset_identifier": "https://ctf.hacker101.com",
    "max_severity": "low"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 20805,
      "category": "researcher",
      "content": "It was a small race condition bug in which a group user couldn't be removed from the group even by the admin after they join. This was kinda a fun bug(though low severity) to find when I was learning about race conditions way back in June last year. I thought about trying this after seeing another disclosed report on RC on ctf.hacker101.com itself",
      "updated_at": "2020-03-21T09:00:29.371Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 388246,
        "username": "yashrs",
        "name": "Yash Sodha",
        "bio": " Hacker and Developer. Passionate about keeping the cyber world secure :) ",
        "cleared": true,
        "verified": true,
        "website": "https://wittysec.com",
        "location": "",
        "created_at": "2018-10-27T02:09:57.665Z",
        "url": "https://hackerone.com/yashrs",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzY4MDQ1LCJwdXIiOiJibG9iX2lkIn19--191a102e0d85441d2f932e7dd994bb9e5b8a8e9e/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/cf1e4b5d44005cb61fab358dd6968415f20545de5f055ba4ed33ca4387948cdc.png"
        }
      }
    }
  ]
}
