{
  "id": 2079103,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDc5MTAz",
  "url": "https://hackerone.com/reports/2079103",
  "title": "Permission model improperly processes UNC paths",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-07-21T16:34:42.985Z",
  "submitted_at": "2023-07-21T16:34:43.134Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "tniessen",
    "url": "/tniessen",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22984,
    "url": "https://hackerone.com/nodejs",
    "handle": "nodejs",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js",
      "twitter_handle": "nodejs",
      "website": "https://nodejs.org",
      "about": "The Node.js JavaScript Runtime"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": true,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2024-37372"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-07-15T09:12:44.019Z",
  "bug_reporter_agreed_on_going_public_at": "2024-07-15T09:12:43.794Z",
  "team_member_agreed_on_going_public_at": "2024-07-08T20:54:00.580Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The `is_tree_granted` function in `fs_permission.cc` assumes that any path starting with two backslashes `\\\\` has a four-character prefix that can be ignored, which is not always true. This subtle bug leads to vulnerable edge cases.\n\n## Steps To Reproduce:\n\nWith a recent version of Node.js 20, run a command such as:\n\n```\nnode --experimental-permission --allow-fs-read=C:\\* -p \"fs.readdirSync(Buffer.from('\\\\\\\\A\\\\C:\\\\Users'))\"\n```\n\nThe expected behavior is an `ERR_ACCESS_DENIED` error, but it does not occur. Instead, Node.js calls `scandir` on `\\\\A\\C:\\Users`.\n\n## Supporting Material/References:\n\n* [Implementation of `is_tree_granted`](https://github.com/nodejs/node/blob/b68fa599607f69f2ce3b1a3104e0d5984f6bc0d8/src/permission/fs_permission.cc#L53-L68)\n* [File path formats on Windows systems: UNC paths](https://learn.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths)\n\n## Impact\n\nAn attacker can potentially gain unintended access to UNC resources. In the above example, an attacker gains file system access to the UNC path `\\\\A\\C:\\`, even though no access beyond the local `C:\\` drive has been granted.\n\nIt is difficult to fully and accurately comprehend the impact. The bug is subtle, and Windows uses notoriously complex file path formats. Overall, I consider the severity of the issue to be low.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-08-07T20:54:00.883Z",
  "allow_singular_disclosure_after": -35329263.31126129,
  "singular_disclosure_allowed": true,
  "vote_count": 35,
  "voters": [
    "jobert_krohnen",
    "zy9ard3",
    "2026",
    "mohaned0101",
    "iwasday",
    "pr0f0x01",
    "hun73r",
    "iamunixtz",
    "wbd-",
    "aecherli",
    "and 25 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 666,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/nodejs/node",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 466104,
      "category": "team",
      "content": "The Permission Model assumes that any path starting with two backslashes \\\\ has a four-character prefix that can be ignored, which is not always true. This subtle bug leads to vulnerable edge cases.\n\nThis vulnerability affects Windows users of the Node.js Permission Model in version v20.x and v22.x",
      "updated_at": "2024-06-17T18:22:37.364Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2195374,
        "username": "rafaelgss",
        "name": "Rafael Gonzaga",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://rafaelgss.dev",
        "location": "",
        "created_at": "2022-01-27T23:52:59.861Z",
        "url": "https://hackerone.com/rafaelgss",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/03cmza9kg8sgdwaepi579m4hvctl/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/03cmza9kg8sgdwaepi579m4hvctl/74790fe75ac5dbe8a5140a122388d59ebac913dcfa941f0b3a45e6cad161f9ea",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzE2ODAwOSwicHVyIjoiYmxvYl9pZCJ9fQ==--4075f631a6a269c11c2124ec493b9d0b8258f47b/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGVnIiwicmVzaXplIjoiMjYweDI2MFx1MDAzZSJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--cea846659d6dfdc215f3c0fb14f7ed8ebc9f95ef/26234614%20(1).jpeg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
