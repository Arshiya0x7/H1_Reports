{
  "id": 1167530,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY3NTMw",
  "url": "https://hackerone.com/reports/1167530",
  "title": "RCE in 'Copy as Node Request' BApp via code injection",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "none",
  "readable_substate": "Resolved",
  "created_at": "2021-04-18T03:45:36.252Z",
  "submitted_at": "2021-04-18T03:45:36.318Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ryotak",
    "url": "/ryotak",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15252,
    "url": "https://hackerone.com/portswigger",
    "handle": "portswigger",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "PortSwigger Web Security",
      "twitter_handle": "Burp_Suite",
      "website": "https://portswigger.net",
      "about": "Burp Suite is the leading software for web security testing"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-04-22T00:35:37.097Z",
  "bug_reporter_agreed_on_going_public_at": "2021-04-22T00:35:37.004Z",
  "team_member_agreed_on_going_public_at": "2021-04-21T14:47:50.890Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Description\n`Copy as Node Request` is a burp suite extension that allows users to copy requests as Node.js code.\nDue to improper sanitization of cookie,  it's possible to inject arbitrary Node.js code in copied text, which may lead remote code execution with a significant amount of user interaction.\n\n## Root cause\nThis extension has a function named `escapeQuotes`.\nWhile this function escapes double quotes, it doesn't escape single quotes.\nhttps://github.com/PortSwigger/copy-as-node-request/blob/b34456463310836e93365541189626909adc70bb/src/burp/BurpExtender.java#L165-L167\nAs the cookie field of generated codes use single quote, it's possible to escape string literal and inject arbitrary Node.js codes.\nhttps://github.com/PortSwigger/copy-as-node-request/blob/b34456463310836e93365541189626909adc70bb/src/burp/BurpExtender.java#L123-L125\n\n## Step to reproduce\n1. Install [Copy as Node Request extension](https://portswigger.net/bappstore/e170472f83ef4da1bca5897203b6b33d).\n2. Open https://example.com\n3. Open DevTools and type `document.cookie = \"test='/require('child_process').exec('calc.exe')//\"`\n4. Enable intercept and reload the browser tab.\n5. Right click on intercepted request and click `Copy as Node.js Request`.\n6. Execute copied text in Node.js.\n7. `calc.exe` will be popped up.\n\n{F1269399}\n\n## Impact\n\nRemote code execution via Node.js code injection with user interaction.",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1269399,
      "file_name": "2021-04-18_12-36-32.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nu19nj57hjxs9uvh6i59jx3gscns?response-content-disposition=attachment%3B%20filename%3D%222021-04-18_12-36-32.mp4%22%3B%20filename%2A%3DUTF-8%27%272021-04-18_12-36-32.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ35T6K4IF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T031011Z&X-Amz-Expires=1665&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDPEAvaZ%2FvLeuRoaLfLXdA6mmt8NeE4EcHMdEnKiQYxBAIgQAcR7QaOvsWqFUoty3eI9NBYZ9edyOn035ycgCkKuWwqugUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJbxesrBYe2kzIoHRyqOBcinJjA8aAlm%2Bnvs4nWgO3kcLGwKWP5isvckwVvjix03%2B1XZ3O1hBseTxJ5o79VmQtVbCVHNop1oSaebb0Y%2FIBB31Zt%2FJ3tqNSSpoaADaLyP06r8cJJcf%2B6O9gf6Tfz5o%2BxsVcCm10hyrLmxoEjB7JcIJbJkNbTdPOMRXTv6GNta22Qh%2FhCA8HfxLnJohYN1tHs06Fw84zZxZgFfoi%2F%2BpF1YBf%2BigqM9iRmLbRalo4ueuaA1Oclt9ovcTPq5L8e3qmDekZwQOuQVgSJvMc%2BQWFyC14JJRA%2Fx4uRc9MdCBwEwBVwZOLh5PldpQl2jUhs5ST7UkCNpFfGqxKITQg1xsyKbpu6JmKWcXV951x%2BIjsfvGQkMBL13OQYbo%2FDBY%2Fy5zVsZZ0WpTojg5bVdppmVn%2FjTtzOrpf%2B%2BVYHD7EGdVb5HkeiRpN43gCHJ4snOdrd7UinO5O6gKWEqcOVn%2FZjiCo8IVqrZ6asbJkPD5vtbcfdZPwv4abHGyC651WavF1cOEnyJqxd0gz6IqleLZrSz2kntoisyN40PCMqYBIQ8RYxntGtqvxATlSIEslv4EkgyrkGkL9bcNePvbTccSxUP%2Bo8%2FyHOVtKWpXu%2FphJhIcdO1XzB4kZcd4x%2BGi2FADPz32SmIatRtdDC6vE%2FjMCScFaMvUeKfU5wHSffSk6TDyGCLlQzf5VyyhTzlDRIJeZOJFE7h%2Biuqf1SFkp%2FUbA7TLcJ5shBQJr2QKU6q%2Fnjdlnn%2B95PGhqbrTYmL4TtK0ZtXaka76ZaWo0sWdAg6IoPzcHyy9l3DiveHaLsZTefPenK2stD%2B5QpgpfTzbKf%2FvDd0Hyc3nAWvIkQrJUT6FoBwJ%2B%2FyNjSp21H%2FvxuMMOCwyDCss7zGBjqxAfNFlg7BnOWu2lX%2Fx3HSk3PERI%2FQdO2VFtK4FpK06GICCytDslgE9kzLlsEfs1kcNEO447iWMAjBsJPvUcGfEvmEWMYacCxlNw2SmfUP9%2FEwlQ2uofGYc5klI2uwBY7ykPvx0kA6fh1kOMY1h%2Btv%2Blrshwzi78hWKf83FJn4T2%2Fd%2FFsGrE5EhqR96Vtccl%2BXucm67xB81IRw4ruJmKA1muxa5hWLQryQ0MY3%2B%2FRPbsaiIg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=722209773cc2e634183bf077b1da06edd943644968ed1e664e95486bcaffe383",
      "file_size": 2052687,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2021-05-21T14:47:50.968Z",
  "allow_singular_disclosure_after": -136815740.7859314,
  "singular_disclosure_allowed": true,
  "vote_count": 50,
  "voters": [
    "arthuraires",
    "battle_angel",
    "nagli",
    "amazeng",
    "akichia",
    "badcracker",
    "mattberg",
    "rzx007x",
    "yassinek3ch",
    "ali",
    "and 40 more..."
  ],
  "severity": {
    "rating": "none",
    "score": 0.0,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 170,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "Burp Suite Extension (BApps)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
