{
  "id": 322661,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjI2NjE=",
  "url": "https://hackerone.com/reports/322661",
  "title": "Replace other user files in Inbox messages ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-03-05T21:31:42.132Z",
  "submitted_at": "2018-03-05T21:31:42.132Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rijalrojan",
    "url": "/rijalrojan",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-05-01T21:35:32.882Z",
  "bug_reporter_agreed_on_going_public_at": "2018-05-01T21:35:32.755Z",
  "team_member_agreed_on_going_public_at": "2018-05-01T21:30:50.615Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Summary\nWhen a store publishes their listing, a user can message them if they are interested. Company can reply to this query and also add a file. When a file is uploaded, the link looks like this: \nhttps://shopify-exchange-private.s3.amazonaws.com/attachments/<filename>. This file can be replaced if the attacker knows the filename. \n\n# Description\nAfter submitting the store validation bypass, I played around with the application and noticed that when I submit a query it lands on my inbox: \n{F269678}\n\nInside the inbox there is an option to attach files. When I replied to the query with a file attached, I noticed that it uploaded the file. For this test, I created a file with the name `dudeuranium238.pdf`. This was an empty PDF I made with `touch dudeuranium238.pdf` in my computer. Once I uploaded the file, I visited to https://shopify-exchange-private.s3.amazonaws.com/attachments/dudeuranium238.pdf and saw this: \n\n{F269679}\n\nNow thinking as a malicious hacker, I decided to make another store and publish that as well. I did the same process all over again and replied again with the file `dudeuranium238.pdf` but this time, this file actually had content. It contained a PDF with `Scanner report for Uber` that I keep when hacking. So, once uploaded I went back to https://shopify-exchange-private.s3.amazonaws.com/attachments/dudeuranium238.pdf and the file was replaced: \n\n{F269682}\n\n# Reproduction\n1. Make sure you have 2 published store. \n2. Start a query in one store and send an attachment through inbox. \n3. In the second store do the same thing as number 2 but make sure you replace the file ***content** not the name\n\n## Impact\n\nReplacing content of someone else's file.",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 269678,
      "file_name": "Screen_Shot_2018-03-05_at_1.26.43_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/678/9b39b9aa4e87c8771445389577327d82d162e7c7/Screen_Shot_2018-03-05_at_1.26.43_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-03-05_at_1.26.43_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-03-05_at_1.26.43_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ4SNDBVNL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T181623Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDNaFfxZiD0VhPFPFBuyUHxo8%2Fq04PI773avKh6zG5kfAIgIwS5GjJkkgR6myRscTOmdOiQqzQ66XYw%2FXzcSbw645sqsgUIGhADGgwwMTM2MTkyNzQ4NDkiDHGZRDtM%2BvoLyoOxPCqPBffwMk1UpfHkoVwzJ1NXQehQYNxrJFhr3gzWeUJbjTkFTTS%2FCyfmiv2G6qVkHqSBBui5Cbbcgpm%2Bsnd7J%2FGMgTj16d8hZDqFnhGFh58zEIlnIn6WFaSW0A0wqUU8gZPNqVXrqZ6Bpx6IfGeMLo1MsXbpwcQmODRu7yOI7OUn3yfCJecU%2BdA6dIkAWFOW7bOuLErvNJiBZ17AlippQAw4LbJSUvTU7fW6Lr6laxUL%2FJ%2F7E4MomWmJ9Lw5w8IH8%2FNqjAKAaXASPsMxYKjs1hIq8g5IyfNDj1PGcuGrDWLex4N4%2FXQ1n2ayh0V0uZbqimjyHHOQ8ZLmGLdV005pwXEntk%2BOIp2mTWuPntnMydz%2Fwc0nKwe4RysWfxwAKjXo52z3ySSWAW3Zxl0DDoazX3VLshV34fyx%2FRT%2FyYqHyvC3i5qinnZXbM84%2B%2FuaYJc3KDSNtU3QA%2BqGwUstvNkHLixtEhnhYKaWSPmLErEKxUhJQzCd63Pm1RISDtcNzk7T6RR49bpvfyMjlX5U7mcZddpHtXHKFVbi5FsOWQMZqXCrOHY0RbPIOOKxMPPUGh464zb%2BW97C8TGFQBKbp8cToTFlQYb6RFDZtYN4veD%2FG5phFL84RRsB5skgzb2DzkoZBSX%2BpLxnLvUU%2F7eS5aZQPnXyZj1k0IgFxdE2weskOW7IGyyRSHpWK8t8eAtgDmXcY8j4VvSIKmGiU1bByHBgMFSbWIvUBS6e5wSQIyk0X6XqKavfIzAU27d5%2BN8wKp1SVT3r4zoVFEOsWkxs8pPPTCiIMZSQUA7IyYLmLnlgw0AOC2NnAcdI3rT9jr8d%2B0MuTJoF0jNotKexN8lShrrdR7jrQxisXVHlr4eWNNnIMh3t4vEwzt3AxgY6sQHHBtAExi70wkpDDZ%2FyOZystEPBHU%2Fko1%2FLkObjBVYkt8iAJs28Czx1rtmu1hkD84SGR62cUZGqdUx28yIYUnt99NCzavfcgiyno1800PRvyKY59GGc8%2BSaPhvcIR3DvoaUUZqFPD3ehsbsAueJWBS4aAbXUEbhHcPEefdEeOgI%2B3QoQWHYMKJwDe%2Bdfqps%2B3fLP7z5xgEzL96zYsgRBtfNOMf1Z7PgXEcJVytugP%2Bwluo%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=065fd6e9cbbacecf48a257c9389e6afc74cdf2c154f8f5c1438bf7c467eaafd3",
      "file_size": 103247,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 269679,
      "file_name": "Screen_Shot_2018-03-05_at_1.28.27_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/679/73426b55c0502b58c467d087649831ee50067a03/Screen_Shot_2018-03-05_at_1.28.27_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-03-05_at_1.28.27_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-03-05_at_1.28.27_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ4SNDBVNL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T181623Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDNaFfxZiD0VhPFPFBuyUHxo8%2Fq04PI773avKh6zG5kfAIgIwS5GjJkkgR6myRscTOmdOiQqzQ66XYw%2FXzcSbw645sqsgUIGhADGgwwMTM2MTkyNzQ4NDkiDHGZRDtM%2BvoLyoOxPCqPBffwMk1UpfHkoVwzJ1NXQehQYNxrJFhr3gzWeUJbjTkFTTS%2FCyfmiv2G6qVkHqSBBui5Cbbcgpm%2Bsnd7J%2FGMgTj16d8hZDqFnhGFh58zEIlnIn6WFaSW0A0wqUU8gZPNqVXrqZ6Bpx6IfGeMLo1MsXbpwcQmODRu7yOI7OUn3yfCJecU%2BdA6dIkAWFOW7bOuLErvNJiBZ17AlippQAw4LbJSUvTU7fW6Lr6laxUL%2FJ%2F7E4MomWmJ9Lw5w8IH8%2FNqjAKAaXASPsMxYKjs1hIq8g5IyfNDj1PGcuGrDWLex4N4%2FXQ1n2ayh0V0uZbqimjyHHOQ8ZLmGLdV005pwXEntk%2BOIp2mTWuPntnMydz%2Fwc0nKwe4RysWfxwAKjXo52z3ySSWAW3Zxl0DDoazX3VLshV34fyx%2FRT%2FyYqHyvC3i5qinnZXbM84%2B%2FuaYJc3KDSNtU3QA%2BqGwUstvNkHLixtEhnhYKaWSPmLErEKxUhJQzCd63Pm1RISDtcNzk7T6RR49bpvfyMjlX5U7mcZddpHtXHKFVbi5FsOWQMZqXCrOHY0RbPIOOKxMPPUGh464zb%2BW97C8TGFQBKbp8cToTFlQYb6RFDZtYN4veD%2FG5phFL84RRsB5skgzb2DzkoZBSX%2BpLxnLvUU%2F7eS5aZQPnXyZj1k0IgFxdE2weskOW7IGyyRSHpWK8t8eAtgDmXcY8j4VvSIKmGiU1bByHBgMFSbWIvUBS6e5wSQIyk0X6XqKavfIzAU27d5%2BN8wKp1SVT3r4zoVFEOsWkxs8pPPTCiIMZSQUA7IyYLmLnlgw0AOC2NnAcdI3rT9jr8d%2B0MuTJoF0jNotKexN8lShrrdR7jrQxisXVHlr4eWNNnIMh3t4vEwzt3AxgY6sQHHBtAExi70wkpDDZ%2FyOZystEPBHU%2Fko1%2FLkObjBVYkt8iAJs28Czx1rtmu1hkD84SGR62cUZGqdUx28yIYUnt99NCzavfcgiyno1800PRvyKY59GGc8%2BSaPhvcIR3DvoaUUZqFPD3ehsbsAueJWBS4aAbXUEbhHcPEefdEeOgI%2B3QoQWHYMKJwDe%2Bdfqps%2B3fLP7z5xgEzL96zYsgRBtfNOMf1Z7PgXEcJVytugP%2Bwluo%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b3e1314b4d0f70fdf1aaa8033dd189e8a1a4db7935e8f1bc91af41941a534872",
      "file_size": 150121,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 269682,
      "file_name": "Screen_Shot_2018-03-05_at_1.30.17_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/682/632b9dc6fabddf2334742d091107a34db4c7de39/Screen_Shot_2018-03-05_at_1.30.17_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-03-05_at_1.30.17_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-03-05_at_1.30.17_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ4SNDBVNL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T181623Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDNaFfxZiD0VhPFPFBuyUHxo8%2Fq04PI773avKh6zG5kfAIgIwS5GjJkkgR6myRscTOmdOiQqzQ66XYw%2FXzcSbw645sqsgUIGhADGgwwMTM2MTkyNzQ4NDkiDHGZRDtM%2BvoLyoOxPCqPBffwMk1UpfHkoVwzJ1NXQehQYNxrJFhr3gzWeUJbjTkFTTS%2FCyfmiv2G6qVkHqSBBui5Cbbcgpm%2Bsnd7J%2FGMgTj16d8hZDqFnhGFh58zEIlnIn6WFaSW0A0wqUU8gZPNqVXrqZ6Bpx6IfGeMLo1MsXbpwcQmODRu7yOI7OUn3yfCJecU%2BdA6dIkAWFOW7bOuLErvNJiBZ17AlippQAw4LbJSUvTU7fW6Lr6laxUL%2FJ%2F7E4MomWmJ9Lw5w8IH8%2FNqjAKAaXASPsMxYKjs1hIq8g5IyfNDj1PGcuGrDWLex4N4%2FXQ1n2ayh0V0uZbqimjyHHOQ8ZLmGLdV005pwXEntk%2BOIp2mTWuPntnMydz%2Fwc0nKwe4RysWfxwAKjXo52z3ySSWAW3Zxl0DDoazX3VLshV34fyx%2FRT%2FyYqHyvC3i5qinnZXbM84%2B%2FuaYJc3KDSNtU3QA%2BqGwUstvNkHLixtEhnhYKaWSPmLErEKxUhJQzCd63Pm1RISDtcNzk7T6RR49bpvfyMjlX5U7mcZddpHtXHKFVbi5FsOWQMZqXCrOHY0RbPIOOKxMPPUGh464zb%2BW97C8TGFQBKbp8cToTFlQYb6RFDZtYN4veD%2FG5phFL84RRsB5skgzb2DzkoZBSX%2BpLxnLvUU%2F7eS5aZQPnXyZj1k0IgFxdE2weskOW7IGyyRSHpWK8t8eAtgDmXcY8j4VvSIKmGiU1bByHBgMFSbWIvUBS6e5wSQIyk0X6XqKavfIzAU27d5%2BN8wKp1SVT3r4zoVFEOsWkxs8pPPTCiIMZSQUA7IyYLmLnlgw0AOC2NnAcdI3rT9jr8d%2B0MuTJoF0jNotKexN8lShrrdR7jrQxisXVHlr4eWNNnIMh3t4vEwzt3AxgY6sQHHBtAExi70wkpDDZ%2FyOZystEPBHU%2Fko1%2FLkObjBVYkt8iAJs28Czx1rtmu1hkD84SGR62cUZGqdUx28yIYUnt99NCzavfcgiyno1800PRvyKY59GGc8%2BSaPhvcIR3DvoaUUZqFPD3ehsbsAueJWBS4aAbXUEbhHcPEefdEeOgI%2B3QoQWHYMKJwDe%2Bdfqps%2B3fLP7z5xgEzL96zYsgRBtfNOMf1Z7PgXEcJVytugP%2Bwluo%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b09f989d91ee415385f9ea532a9dd32426e44353e5c2bfc426a2fd11eb0a7521",
      "file_size": 385535,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 36,
  "voters": [
    "wargsec",
    "jensec",
    "drsniper",
    "sameerphad72",
    "tess",
    "bozx",
    "teknogeek",
    "shazadsadiq",
    "its_afolic",
    "apapedulimu",
    "and 26 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.7,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 37450,
    "asset_type": "URL",
    "asset_identifier": "exchangemarketplace.com",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
