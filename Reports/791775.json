{
  "id": 791775,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTE3NzU=",
  "url": "https://hackerone.com/reports/791775",
  "title": "Email Confirmation Bypass in myshop.myshopify.com that Leads to Full Privilege Escalation to Any Shop Owner by Taking Advantage of the Shopify SSO",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-02-09T23:25:28.933Z",
  "submitted_at": "2020-02-09T23:25:28.933Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ngalog",
    "url": "/ngalog",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-04-01T21:01:33.551Z",
  "bug_reporter_agreed_on_going_public_at": "2020-04-01T21:01:33.506Z",
  "team_member_agreed_on_going_public_at": "2020-04-01T16:14:31.223Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I told Pete I would take a look at Spotify, hi Pete.\n\n## Summary\nIt's possible to take over any store account through bypassing the email confirmation step in *.myshopify.com. I found a way to confirm arbitrary emails, and after confirming arbitrary email in *.myshopify.com, user is able to **integrate** with other Shopify store that shares the same email address by setting a master password for all of the stores(if the owner hasn't integrated before), effectively taking over every Shopify stores by knowing just the owner's email address.\n\nAfter signing up a new Shopify instance in https://www.shopify.com/pricing and start the free trial, user can change their email address to a new email address before confirming the one they used to sign up.\n\nThe bug is that Shopify email system mistakenly send the confirmation link of the new email address, to the one that is used to signed up.\n\nAnd the result is user can confirm arbitrary email address. And the next step is taking over other user's Shopify instance by taking advantage of the SSO.\n\n## Quick check\nIf you check https://h31ngalog.myshopify.com/ and see the email address of the owner, it is ngalog@hackerone.com, which I obviously would never be able to validate otherwise\n{F711349}\n\n## steps to reproduce\n- Visit https://www.shopify.com/pricing and signup a free trial with an email address, say attacker@gmail.com that you can receive emails\n- after entering the fields to enter the store, on top right corner, click your name and go to **Your Profile**\n- change your email to someone that you want to takeover, for example yaworsk@hackerone.com and click save\n- All done now, grab a coffee, sit back and relax, watch some YouTube videos and wait for an email to go to your email attacker@gmail.com\n- The email that you are waiting for is from mailer@shopify.com, and the format should look like this {F711348}\n- Click the link and you should see your email has been updated to yaworsk@hackerone.com\n\n## Reason?\nEmail system mistakenly send the confirmation link of yaworsk@hackerone.com to attacker@gmail.com because attacker@gmail.com is the one that is saved on system, and the email system didn't notice the confirmation link has been updated to yaworsk@gmail.com, and should not be sent to attacker@gmail.com\n\n## SSO account takeover\n- now we have the ability to confirm arbitrary email, then we can takeover other stores\n- On top right corner of you-shop.myshopify.com click your name then click profile, you should see a box that says, you have other two accounts in Shopify, want to integrate them together\n- click yes, then just follow the instructions then you will be able to takeover all other stores by changing the master password for all of the stores under that email address.\n\n## Impact\n\nAbility to confirm arbitrary email on *.myshopify.com and leverage SSO to set master password for all other stores under the same password",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 711348,
      "file_name": "Screenshot_2020-02-10_at_12.18.01_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GcJtApv2Pd1q8Y3mCoFzmh7h?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-10_at_12.18.01_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-10_at_12.18.01_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6EJLMIN6%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T074422Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCQ2gSH8TbMUb2X2Z7WUNKfVmbOkDp93wiCfKogEmnP2AIgNq8cWMCOjcza5RBZdMyaVb623nAoVvCSSmDoeBoshlkquwUI%2Ff%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNnvCV8V5zgSWYqsUCqPBUG26pgXGlGUUuTkO2kr%2FgtDDXwYJfERf09eT9x%2FJQ2FHshcU5LruI2kIVYdmB2R16OLLDsBNte7YrEtBMm9156sno%2Bpv5GE39IPlLhZSglsDe9GhDdD%2BBARx4URgB%2FCNfq5ohGBgHMRqr2rXeXNALZgkF6GTtj6CDONDHRzCEKGvur85MLg2E2q9ZJdaOS5ii2XpQID%2FLbYjb5iMr7zI%2FppFUo1r8a1LiAT1ILmPtYJ%2Fyzrm3rSw0qUN6CvuK5KXhbVNZv2%2BFq5LdHd99DrGuFrZycauo%2BVyNdPsERNJcujYeGLl0YGCD4srGERrUvkm8BRzDOHQdO0%2BgEXa1rh%2FfL7mKAQxXuPbV6wkIkuDE%2B7OhSvcH19i5yXCBlxl7Olw4JCdT3vcS6Wagdb2opQjV9aPnLKuNeTbaIkdmW1OoGcWJWJPl6bD16Ov0zz40wOdX%2FkYRJQGnMUPaoApVfdNLMwCiJridZvAEgXaJRTZy0hKf%2Fzi7LQ7UWeMXXyeiKIogqM4dv%2BOIwOdma1cBnt792hJUI3bdgEbLqvjM7fILta79n9ELCDZOX8iYiezm9iFdji67bTpzMVlmbt8bhRAPz2Acbid5mOnunFrTIIe01%2B9B7Ap%2FwEMwd0i0xa3naPKzPE7TSjKCyFarWuxfFauISrrYwVkcTWwHt%2BFC0ktL%2BCmmeeqqPG2UU3g9FLfQRwiFeSsg5FqlG%2FAs0iCPkb%2BDNfeOluWjQQJD6ep73pcvS7nh8y3SqF6USCWhaIp322UANuh7ij07TLl8iLVu%2FPiiCrfrxUEy1ppMPrM1745G9loODC5qL2wfpT34qeB%2FptcMFgSdwAyRpBxoa8nkmIrdpDX70si4upg226kVMEXpowr%2FK9xgY6sQGm%2F5yTt4WLUlwH%2F%2F%2B%2FXBqbUp6K8NutKd89zqvEsnB7Md6VbABet%2FQQLo4CAyvoD71pZWO7X15va1pN23hyfvtsis3XCwGsC4KKK7ywzXlW2OKUPHHUvhMRn2ill9GWhUAvz6E%2F%2F1GMidLj7X%2FC0QVsyaFQKnGmieS8Bb00mlYddeMcp%2BLR9iJev%2BSkwOt6wNbOkprHxKtTmTM4eS%2FQKSwwTUJYbUVjVvgMcC26jxtCKJ0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f3147623c12c8ded3be23579f68a581b96485c14d840d9df3b3b374b0882af3c",
      "file_size": 149151,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 711349,
      "file_name": "Screenshot_2020-02-10_at_12.13.19_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FBqYuWL3zc62Hnzh2pxjBpPD?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-10_at_12.13.19_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-10_at_12.13.19_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6EJLMIN6%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T074422Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCQ2gSH8TbMUb2X2Z7WUNKfVmbOkDp93wiCfKogEmnP2AIgNq8cWMCOjcza5RBZdMyaVb623nAoVvCSSmDoeBoshlkquwUI%2Ff%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNnvCV8V5zgSWYqsUCqPBUG26pgXGlGUUuTkO2kr%2FgtDDXwYJfERf09eT9x%2FJQ2FHshcU5LruI2kIVYdmB2R16OLLDsBNte7YrEtBMm9156sno%2Bpv5GE39IPlLhZSglsDe9GhDdD%2BBARx4URgB%2FCNfq5ohGBgHMRqr2rXeXNALZgkF6GTtj6CDONDHRzCEKGvur85MLg2E2q9ZJdaOS5ii2XpQID%2FLbYjb5iMr7zI%2FppFUo1r8a1LiAT1ILmPtYJ%2Fyzrm3rSw0qUN6CvuK5KXhbVNZv2%2BFq5LdHd99DrGuFrZycauo%2BVyNdPsERNJcujYeGLl0YGCD4srGERrUvkm8BRzDOHQdO0%2BgEXa1rh%2FfL7mKAQxXuPbV6wkIkuDE%2B7OhSvcH19i5yXCBlxl7Olw4JCdT3vcS6Wagdb2opQjV9aPnLKuNeTbaIkdmW1OoGcWJWJPl6bD16Ov0zz40wOdX%2FkYRJQGnMUPaoApVfdNLMwCiJridZvAEgXaJRTZy0hKf%2Fzi7LQ7UWeMXXyeiKIogqM4dv%2BOIwOdma1cBnt792hJUI3bdgEbLqvjM7fILta79n9ELCDZOX8iYiezm9iFdji67bTpzMVlmbt8bhRAPz2Acbid5mOnunFrTIIe01%2B9B7Ap%2FwEMwd0i0xa3naPKzPE7TSjKCyFarWuxfFauISrrYwVkcTWwHt%2BFC0ktL%2BCmmeeqqPG2UU3g9FLfQRwiFeSsg5FqlG%2FAs0iCPkb%2BDNfeOluWjQQJD6ep73pcvS7nh8y3SqF6USCWhaIp322UANuh7ij07TLl8iLVu%2FPiiCrfrxUEy1ppMPrM1745G9loODC5qL2wfpT34qeB%2FptcMFgSdwAyRpBxoa8nkmIrdpDX70si4upg226kVMEXpowr%2FK9xgY6sQGm%2F5yTt4WLUlwH%2F%2F%2B%2FXBqbUp6K8NutKd89zqvEsnB7Md6VbABet%2FQQLo4CAyvoD71pZWO7X15va1pN23hyfvtsis3XCwGsC4KKK7ywzXlW2OKUPHHUvhMRn2ill9GWhUAvz6E%2F%2F1GMidLj7X%2FC0QVsyaFQKnGmieS8Bb00mlYddeMcp%2BLR9iJev%2BSkwOt6wNbOkprHxKtTmTM4eS%2FQKSwwTUJYbUVjVvgMcC26jxtCKJ0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2358ec2f634922bdb50cb6db4cca380f07df481a2c8098b63416b56d8858c3d6",
      "file_size": 211816,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 1897,
  "voters": [
    "an40r1",
    "lvl0x00",
    "jeti",
    "m1tz",
    "fygonzalo",
    "foulenzer",
    "rootxjs",
    "sebd",
    "sky003",
    "sgabe",
    "and 1887 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 413,
    "asset_type": "URL",
    "asset_identifier": "your-store.myshopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 20357,
      "category": "team",
      "content": "On February 9th, @ngalog reported that it was possible to bypass Shopify's email verification for a small subset of Shopify user accounts. Doing so would have allowed a user to access accounts they did not own. Our team immediately disabled the impacted functionality and deployed a permanent fix three hours later. \n\nAfter resolving the report, @ngalog demonstrated being able to bypass the email verification again. We investigated and discovered another bug with a separate root cause. We asked him to submit a [separate report](https://hackerone.com/reports/796808) to be awarded separately. ",
      "updated_at": "2020-02-21T14:04:23.570Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 164342,
        "username": "jack_mccracken",
        "name": "Jack McCracken",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2017-05-01T15:33:44.372Z",
        "url": "https://hackerone.com/jack_mccracken",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/74790fe75ac5dbe8a5140a122388d59ebac913dcfa941f0b3a45e6cad161f9ea",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjUwMjYsInB1ciI6ImJsb2JfaWQifX0=--cdf9af8747d818f0b319722fb8c89bce6a40830c/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGVnIiwicmVzaXplIjoiMjYweDI2MFx1MDAzZSJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--cea846659d6dfdc215f3c0fb14f7ed8ebc9f95ef/avatar.jpeg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
