{
  "id": 196878,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY4Nzg=",
  "url": "https://hackerone.com/reports/196878",
  "title": "bug reporting template encourages users to paste config file with passwords",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-01-09T12:40:38.155Z",
  "submitted_at": "2017-01-09T12:40:38.155Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hanno",
    "url": "/hanno",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-04-19T08:10:18.555Z",
  "bug_reporter_agreed_on_going_public_at": "2017-04-19T08:10:18.517Z",
  "team_member_agreed_on_going_public_at": "2017-04-05T09:46:23.350Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The dangerous bug reporting template\n=============================\n\nThe github bug reporting template for nextcloud's server and some apps contains this:\n\n**The content of config/config.php:**\n\n```\nIf you have access to your command line run e.g.:\nsudo -u www-data php occ config:list system\nfrom within your instance's installation folder\n\nor \n\nInsert your config.php content here\n(Without the database password, passwordsalt and secret)\n```\n\nThis is obviously very problematic. From the wording and instructions it is very likely that users will do the wrong thing: Paste the config.php without removing all passwords, for various reasons:\n* It's likely to assume that many users won't read the detailed instructions and will just do the first thing they're told: Insert the content of config/config.php.\n* The instruction with sudo and www-data is specific to certain server configurations and may not work everywhere, thus it will fail for some users who will try the next option, namely inserting config.php directly.\n* The instruction \"Without the database password, passwordsalt and secret\" is incomplete. There can be more sensitive fields in the config file, e.g. \"mail_smtppassword\".\n\nNot surprisingly users misread these instructions and paste sensitive passwords. See e.g.:\nhttps://github.com/nextcloud/calendar/issues/151\nhttps://github.com/nextcloud/calendar/issues/155\n\nProposed remediation\n=================\n\nI think it's necessary that you search all existing bug reports that have been created with this template for sensitive passwords and remove them. It is probably also appropriate to inform the affected users.\n\nI also believe encouraging users to paste a config file with passwords is inherently dangerous and no amount of warnings will prevent all users from making mistakes. In general I think it should always be a guiding principle of software design to make it hard for users to make security mistakes.\n\nThere are various ways the situation could be improved, this is what I could think of:\n* Provide a way in the webinterface to let users view a version of the config file where all sensitive values are removed (like the command line instruction, but more accessible).\n* Change the instruction and avoid all references to pasting the raw config file content. If there's a need to get the config file in rare circumstances a developer could ask a bug reporter for it, ideally via private channels and only post a manually vetted version to the bug report.\n\nLeakage of instanceid\n=================\n\nOne additional observation: The \"occ config:list\" command removes dbpassword, secret and mail_smtppassword, but it leaves instanceid intact. I'm not familiar enough to judge how sensitive this value is, but it seems to be an unique identifier for each owncloud installation. It would probably be wise to remove that, too.\n\nAffects owncloud and nextcloud\n========================\n\nThis issue affects the development of both owncloud and nextcloud in the same way. Thus I will report it to both projects.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-05-05T09:46:23.388Z",
  "allow_singular_disclosure_after": -264517743.11337823,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "geeknik",
    "eveeez",
    "mariuszdeepsec",
    "khizer47",
    "linkks",
    "japz",
    "sumit7",
    "0xm1racle",
    "spetr0x",
    "mrnull1337"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 3817,
      "category": "team",
      "content": "@hanno reported an issue within the Nextcloud bug reporting template on GitHub, the original template asked persons to paste their configuration file and had a notice that sensitive content such as the database password should be removed. The reporter argued that this was not good enough and that he discovered issues containing user credentials.\n\nWe've checked all reported issues and found **a total of 23 occurrences** of passwords within tickets. Those have been redacted. Also, we've adjusted the issue template to make this more clear and are offering an issue template application which automatically fills out and sanitizes sensitive information.\n\nWe want to thank @hanno for reporting this back to us and help protecting our millions of users. We want however to note, that this affected an absolute minimum of users.\n\n----\nPress article (German): https://www.golem.de/news/owncloud-nextcloud-passwoerter-im-bugtracker-1704-127346.html\nPersonal blog (English):  https://blog.hboeck.de/archives/885-Passwords-in-the-Bug-Reports-OwncloudNextcloud.html\nTweet: https://twitter.com/hanno/status/848832642653073412",
      "updated_at": "2017-04-19T08:47:35.606Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 37891,
        "username": "lukasreschke",
        "name": "Lukas Reschke",
        "bio": "",
        "cleared": false,
        "verified": true,
        "website": "https://statuscode.ch",
        "location": "Germany",
        "created_at": "2015-08-05T13:37:40.660Z",
        "url": "https://hackerone.com/lukasreschke",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTY1NCwicHVyIjoiYmxvYl9pZCJ9fQ==--11306782a4496d819cda895ef27d0929850dc8ba/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/878997_(1).png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
