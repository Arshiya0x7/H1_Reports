{
  "id": 378864,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzg4NjQ=",
  "url": "https://hackerone.com/reports/378864",
  "title": "Torrent extension: Cross-origin downloading + \"URL spoofing\" + CSP-blocked XSS",
  "state": "Closed",
  "substate": "duplicate",
  "severity_rating": "medium",
  "readable_substate": "Duplicate",
  "created_at": "2018-07-07T14:50:05.579Z",
  "submitted_at": "2018-07-07T14:50:05.579Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "metnew",
    "url": "/metnew",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/jdthvavflc07lpt5x37qarrub1jt/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15688,
    "url": "https://hackerone.com/brave",
    "handle": "brave",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Brave Software",
      "twitter_handle": "brave",
      "website": "https://brave.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-09-24T23:40:38.734Z",
  "bug_reporter_agreed_on_going_public_at": "2018-09-19T16:20:30.341Z",
  "team_member_agreed_on_going_public_at": "2018-09-24T23:40:38.607Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\n> \\#378809 allows navigating to `chrome-extension://`\n> \\#378805 allows displaying alert windows on `chrome-extension://` origin\n\nAs I said in #378809, navigation to `chrome-extension://` allows attacking dependencies/components of extensions.\n\nBrave has only 3 extensions installed by default (w\\o Metamask):\n- Brave Sync - according to my observations, it doesn't have vulnerable components\n- PDF\n- Torrent\n\n### Torrent\n\n#### \"Save Torrent File...\"\n\nWe need alert modal from #378805 to ask a user to click \"Save Torrent File\" button.\n\"Save Torrent File\" initiates navigation using `a [rel=noopener] [download]` to `location.hash.slice(1)`\n\n#### `http://www.google.com` - \"URL spoofing\"\n\nOmnibox in Torrent extension displays only `location.hash.slice(1)`. Hence, `chrome-extension://fmdpfempfmekjkcfdehndghogpnpjeno/webtorrent.html#https://www.google.com` will be shown in the address bar as `https://www.google.com`. \n> In reality, it's hard to leverage this bug, but that looks like bad behavior. \n\n#### `http://www.google.com` - websites downloading\n\nAs I said, \"Save Torrent File\" initiates downloading. CORS page downloads are forbidden.\nHowever, click on \"Save Torrent File\" in `chrome-extension://fmdpfempfmekjkcfdehndghogpnpjeno/webtorrent.html#https://www.google.com` downloads `www.google.com`.\n \n> Because of Torrent extension privileges\n\n#### `file:///etc/passwd` - local files downloading\n\n**URL:** `chrome-extension://fmdpfempfmekjkcfdehndghogpnpjeno/webtorrent.html#file:///etc/passwd`\n\nClick on \"Save Torrent File\" initiates downloading of local files.\nSame \"useless URL spoofing\". (`file://etc/passwd` in omnibox)\n\n#### `ssh://`\n\nTorrent can't trigger ssh sessions without confirmation (like privileged `about:blank`). Not interesting.\n\n#### `javascript:` - CSP-blocked XSS\n\nThe most interesting case. \n**URL:** `chrome-extension://fmdpfempfmekjkcfdehndghogpnpjeno/webtorrent.html#javascript:alert()`\nAs of `a` element initiates navigation, it's possible navigating to `javascript:` URI to initiate code execution.\nUnfortunately, this XSS is blocked by CSP :(\n\n## Products affected: \n\nBrave: 0.23.31 \nV8: 6.7.288.46 \nrev: 3148acef36dba0fce89108638bb27927c4937f90 \nMuon: 7.1.5 \nOS Release: 17.6.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 67.0.3396.103\n\n## Steps To Reproduce:\n\n1. Start ftp server (sample ftp server attached, `npm i ftpd && node ftp-server.js`)\n2. Open ftp://localhost:7002/exploit.html\n\n## Impact\n\nAn attacker could init an alert modal to trick the user into pressing \"Save Torrent file\" button using #378805.\n\nIt's possible to download local files and files from the web (websites too) using \"Save Torrent file\" in Torrent extension (requires user gesture).\n\nIt's also possible to initiate CSP-blocked XSS by clicking on \"Save Torrent File\".",
  "original_report_id": 378805,
  "original_report_url": "https://hackerone.com/reports/378805",
  "attachments": [
    {
      "id": 316851,
      "file_name": "ftp-server.js",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/316/851/1b57af3bce15953c31b9e9c6d89532c6ee5ac2a4/ftp-server.js?response-content-disposition=attachment%3B%20filename%3D%22ftp-server.js%22%3B%20filename%2A%3DUTF-8%27%27ftp-server.js&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQGVCWO4G%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T171113Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGYhvhkhEdJ5WnzOfSPeb2HGEAhW6QR0k1vOjJdydpm9AiEAjk3vU3hjY%2FoENN%2B%2B8EN4ff4SxFo4uPMoh23%2BHPiMA14qsgUIGRADGgwwMTM2MTkyNzQ4NDkiDCKtwPjDi9kKaGoe%2FSqPBT8V315A28yR%2Fg8sOJrWHWnkhYaHefvJjX8fXDAPHxm1jasmUMRDqOfyVewBJww7lebqbM3c425qOMjaoRjYzYueR362uxLpt%2BZe46LeV%2BXxnCsNRlLrX4mkm0Er49UVIFa82f554dMp0YYAr5mONRXc0d8gHuSMjE2srbYwKOqgXXQOtLUjpzUq%2FGxymTBMS1%2FHOS5RaRjqNt5UAkIbQSYQHLIocV0MkZVBxsJoSIEOYF%2Ba70Vmhj%2BhvZHOtnwwgYtADZkKM17pXQZ%2FWFqE0HZj9famXSAi1UXwFIG2j3JcwXvj4CQOTUWu%2B7ckGCxohRyi33QWNy2oZtXf8BgnWwFqhpHvWHT2h0dRkI%2Bu7N4ObGVVB808jQAE%2BIrCZZQPy8TN6D39gVb9Rft%2FkWpW5c2SuWbbNTES9NP1J8jG9Pehvrm8RlO9VtwbP0tHmS6HGkLcjt16HtUc6PTE0j2ohX9OB6PAzkY2%2B3WEK2exvprZMJK5gB2tKqF4Vn2U%2FjsLqCHXKx5Zg9jt7vGnyGn3jmjXI7yDDBwBH3IvvcdYXPv1jLqKrDVTMBrwmZ278RXQCY3R%2BfI22AaZmvGVy4qx38Nkc9nN99n35hOGtwe7GwaG6SLQDp947xxTB9V75xVjeN5WiVKslP6xxVoEmTdB5xuoeg9iRycq71XAwOLu6InEL3I2Hgc9A4OVuV2YtrBRXhkH1Ht103Fjv%2F3CxmhQ2hgF4IO4LacUdniFOmpVmiADrurPKhb75422tQUHKQcz7RTkeKUxMs0UDFAVWrF8Y3ZVbwE5cbV%2FaNCizYQv%2FpFgcGXDjcjKQVyOIM7MJXdwPE5BSPjV1AJXMfY%2FRzrqqNrCUuKwTuMeU7J2OY490QMw4rLAxgY6sQFAApUlGL%2BslT9DMyTEPMWaBtepRLpEF95nh0XzfOKR9dKXVTKsEpKtxi8DT7jDYQ%2FW%2BPA7wyWvB0RVz20IefQOJV4P2Zm1McUjsHtGEB20eL7%2B6hLLnZHyQXbB5FoukQEvg4ySijEGUo2lXpG805%2B6dTJz1%2F6rbIEwEbwLYh6sWMATKc3314zQHmTgguDKOGX8%2Bq71BnepYoTiJsUTXr%2FPy2%2Fu9NqA2MR18IBwtgQ%2BhhQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7a3a5f19dcd383c26cc3ab3aee930a89df71da6716e1c59772198f44fae55578",
      "file_size": 1321,
      "type": "text/plain",
      "moderated": null
    },
    {
      "id": 316852,
      "file_name": "exploit.html",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/316/852/75dd6a9b63f7aa0c8c196f6eb09a8620d253c151/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQGVCWO4G%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T171113Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGYhvhkhEdJ5WnzOfSPeb2HGEAhW6QR0k1vOjJdydpm9AiEAjk3vU3hjY%2FoENN%2B%2B8EN4ff4SxFo4uPMoh23%2BHPiMA14qsgUIGRADGgwwMTM2MTkyNzQ4NDkiDCKtwPjDi9kKaGoe%2FSqPBT8V315A28yR%2Fg8sOJrWHWnkhYaHefvJjX8fXDAPHxm1jasmUMRDqOfyVewBJww7lebqbM3c425qOMjaoRjYzYueR362uxLpt%2BZe46LeV%2BXxnCsNRlLrX4mkm0Er49UVIFa82f554dMp0YYAr5mONRXc0d8gHuSMjE2srbYwKOqgXXQOtLUjpzUq%2FGxymTBMS1%2FHOS5RaRjqNt5UAkIbQSYQHLIocV0MkZVBxsJoSIEOYF%2Ba70Vmhj%2BhvZHOtnwwgYtADZkKM17pXQZ%2FWFqE0HZj9famXSAi1UXwFIG2j3JcwXvj4CQOTUWu%2B7ckGCxohRyi33QWNy2oZtXf8BgnWwFqhpHvWHT2h0dRkI%2Bu7N4ObGVVB808jQAE%2BIrCZZQPy8TN6D39gVb9Rft%2FkWpW5c2SuWbbNTES9NP1J8jG9Pehvrm8RlO9VtwbP0tHmS6HGkLcjt16HtUc6PTE0j2ohX9OB6PAzkY2%2B3WEK2exvprZMJK5gB2tKqF4Vn2U%2FjsLqCHXKx5Zg9jt7vGnyGn3jmjXI7yDDBwBH3IvvcdYXPv1jLqKrDVTMBrwmZ278RXQCY3R%2BfI22AaZmvGVy4qx38Nkc9nN99n35hOGtwe7GwaG6SLQDp947xxTB9V75xVjeN5WiVKslP6xxVoEmTdB5xuoeg9iRycq71XAwOLu6InEL3I2Hgc9A4OVuV2YtrBRXhkH1Ht103Fjv%2F3CxmhQ2hgF4IO4LacUdniFOmpVmiADrurPKhb75422tQUHKQcz7RTkeKUxMs0UDFAVWrF8Y3ZVbwE5cbV%2FaNCizYQv%2FpFgcGXDjcjKQVyOIM7MJXdwPE5BSPjV1AJXMfY%2FRzrqqNrCUuKwTuMeU7J2OY490QMw4rLAxgY6sQFAApUlGL%2BslT9DMyTEPMWaBtepRLpEF95nh0XzfOKR9dKXVTKsEpKtxi8DT7jDYQ%2FW%2BPA7wyWvB0RVz20IefQOJV4P2Zm1McUjsHtGEB20eL7%2B6hLLnZHyQXbB5FoukQEvg4ySijEGUo2lXpG805%2B6dTJz1%2F6rbIEwEbwLYh6sWMATKc3314zQHmTgguDKOGX8%2Bq71BnepYoTiJsUTXr%2FPy2%2Fu9NqA2MR18IBwtgQ%2BhhQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=91e2d46c98116952396fa3661901de21fd53ccd86e8f34462b8f625ebcd716c6",
      "file_size": 647,
      "type": "text/html",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 12,
  "voters": [
    "foobar7",
    "ali",
    "sameerphad72",
    "dawgyg",
    "bl4de",
    "savitar0x01",
    "eveeez",
    "japz",
    "cryptographer",
    "0x08",
    "and 2 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 7933,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/brave/browser-laptop",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
