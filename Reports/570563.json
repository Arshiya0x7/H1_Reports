{
  "id": 570563,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NzA1NjM=",
  "url": "https://hackerone.com/reports/570563",
  "title": "[http-file-server] Stored XSS in the filename when directories listing",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-05-07T19:53:36.580Z",
  "submitted_at": "2019-05-07T19:53:36.580Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "lightangel1412",
    "url": "/lightangel1412",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/4oZAFX28euZbstNbBZuSRAvH/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-5458"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-07-24T05:50:58.218Z",
  "bug_reporter_agreed_on_going_public_at": "2019-07-24T05:50:58.110Z",
  "team_member_agreed_on_going_public_at": "2019-07-15T10:45:05.947Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report Stored XSS in module \"http-file-server\".\nIt allows to inject malicious scripts in the file name, store them on the server, then execute these scripts in the browser via the XSS vulnerability.\n\n# Module\n\n**module name:** http-file-server\n**version:** 0.2.6\n**npm page:** `https://www.npmjs.com/package/http-file-server\n\n## Module Description\n\nSimple HTTP file server (Node.JS)\n\n## Module Stats\n\n[0] downloads in the last day\n[1] downloads in the last week\n[47] downloads in week 02-08 Apr 2019\n[40] downloads in week 09-15 Apr 2019\n[120+] downloads in the last month\n\n# Vulnerability\n\n## Vulnerability Description\n\nThis XSS vulnerability occurs due to the module represents filename(s) in HTML without any sanitization in listing directory page. In a result, any malicious scripts which are injected and stored on the server, would be executed in the client's browser.\n\n## Steps To Reproduce:\n\n- Install the module\n```\nnpm install -g http-file-server\n```\n\n- In the directory which will be served via http-file-server, create file with following names in directories ~/Desktop/:\n```\n\" onmouseover=alert(1) \"\n```\n{F486137}\n\n- Run 'http-file-server in \"~/Desktop\" directory :\n```\nhttp-file-server\n```\nor \n```\nnodejs /usr/lib/node_modules/http-file-server/http-file-server.js\n```\n\n- Open http://localhost:8080/\n{F486135}\n\n- When mouseover event is trigger, a message will be popup via XSS vulnerability.\n{F486136}\n\n## Patch\n\nUser input should be properly sanitized and filtered both at the client and server side. Dangerous characters such as < > ' \" % ; ) ( & + should either be disallowed or HTML encoded before displaying them on screen. \n\n## Supporting Material/References:\n\n- Linux kali 4.15.0-kali2-amd64\n- node 10.15.3\n- npm 6.9\n- Firefox ESR 52.7.3 (64-bit)\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nIt allows to inject malicious scripts in the file name, store them on the server, then execute these scripts in the browser via the XSS vulnerability.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 486135,
      "file_name": "http-file-server_-_XSS0.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/486/135/32d27bf758c2064c7f0bdc4c9b8de51c669b0e2c/http-file-server_-_XSS0.PNG?response-content-disposition=attachment%3B%20filename%3D%22http-file-server_-_XSS0.PNG%22%3B%20filename%2A%3DUTF-8%27%27http-file-server_-_XSS0.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ63C5JMFQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T150502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFDvRHn9ky1YQHzGuakS4Iz0vDtMnYWimh35oKHC7r%2F2AiAia3verAavWozpj%2BAPj1Qc2tpTLeRgJgInw7s8k0Ms7CqyBQgWEAMaDDAxMzYxOTI3NDg0OSIMRvcecFwXg0wZuwgGKo8FksKPXngK9ceXhWE613mjXnbZdBITFJXG%2B7ytn5mQqEzLPXaN8Dx%2F8nIueq6O5yT55A9X2c24%2FKOSrqpojCWB%2FmHExscAysLYKTPUIlVMYMErXfxTvQFibbmyznBSpJpT6mph1%2FC7m4PzL0Z7s5mDS2e2w0q67hMvtblmSd6z2S5sLLprqEv4nxaO2Z03eCVZed4HflAJpQWGkIN9dxrJmqL0xfNinTwvuGKS%2FtQXpUBCwbAlEPsVf6kFzMuBkc0qEZZXmFUVur2bm0BmaPy5U0SS0%2F0oEWM%2B%2Fd1IyjwDODtmd9pVA%2B1zdR2zU3SBpqjUGbCVyxM%2BCvCJKx2laInTTGrcZXpxB0ZaBPc72qXRyrFiYVUpxGbqbXqPTdJjGm8GxvuwY6dwYyqiDL0L4ZHA8ueYS34pZlSvE5cvZ%2B5L0JHJa9vEJ1W8Pqt1wxWRFxk9rTjKEsTldCLOAaZQArrL09XbORY9RKJymViUcVKXXDZyYrihG24puBP7Q0klt33FfXCOWl8D%2BdEqzwPIv5H2VZGi4m%2FGS4Id8QNSv7KNd72oaaqqBHPe%2BcaQBNdrl5tGj0GLQa5vEwuuFiqiZfYWS1JXRedJdO1231Hq5yU66xdMa6GLuVKIVsSg5Tz7a0KFhpvLGYG28NsHgim3jEPzU0%2FfskoJ43K0M%2FAQW57Qfto%2F4xPT%2Faem36dXOyY929FDEawLfAQW2K1c5SH1oiT%2Bomp7b0v3iKTxB5YbVOX1QIaqPITE64vVve%2FQVHigwZjXn6gm8r3%2B5jIuQXaMTKmt3Z8qZAXuvHXyIhFySvgvVd1HaBdX%2FLAo6wYx%2BaWuJl8Y7Qg7uuXGEMEBkIba7kqCgJ4cUzEvkb5%2BaF0h0rxabTD357%2FGBjqyAfqYzux0u2fIPi%2F%2B5WgXrdOTFF9hswACvH1kqzOXf9i%2FhFaA9reIVKxbcUQk7RHelMKqGaiuR4%2BORktmbLN6VadvA%2BPEkXFVVes%2B7LnvM9NmvFVdF2yG8LnQmcQMm%2Fue0xNqf3zd753V6T9g2UU8jFT%2F5oJbh4z7d9HvcXbDlcr4DTGGjwHTE7klqn8N7UXcU3Q4yrkD3foXSV43foaRVQywlCTelvhv%2FMKxvOToYrdap2M%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e6a3972a2427ed41ba570c66e6f4db08b306440421a40e1cf03237e2637493c",
      "file_size": 26968,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 486136,
      "file_name": "http-file-server_-_XSS.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/486/136/0f0abc2766cb69a98c4f8082f2b82255510fc283/http-file-server_-_XSS.PNG?response-content-disposition=attachment%3B%20filename%3D%22http-file-server_-_XSS.PNG%22%3B%20filename%2A%3DUTF-8%27%27http-file-server_-_XSS.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ63C5JMFQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T150502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFDvRHn9ky1YQHzGuakS4Iz0vDtMnYWimh35oKHC7r%2F2AiAia3verAavWozpj%2BAPj1Qc2tpTLeRgJgInw7s8k0Ms7CqyBQgWEAMaDDAxMzYxOTI3NDg0OSIMRvcecFwXg0wZuwgGKo8FksKPXngK9ceXhWE613mjXnbZdBITFJXG%2B7ytn5mQqEzLPXaN8Dx%2F8nIueq6O5yT55A9X2c24%2FKOSrqpojCWB%2FmHExscAysLYKTPUIlVMYMErXfxTvQFibbmyznBSpJpT6mph1%2FC7m4PzL0Z7s5mDS2e2w0q67hMvtblmSd6z2S5sLLprqEv4nxaO2Z03eCVZed4HflAJpQWGkIN9dxrJmqL0xfNinTwvuGKS%2FtQXpUBCwbAlEPsVf6kFzMuBkc0qEZZXmFUVur2bm0BmaPy5U0SS0%2F0oEWM%2B%2Fd1IyjwDODtmd9pVA%2B1zdR2zU3SBpqjUGbCVyxM%2BCvCJKx2laInTTGrcZXpxB0ZaBPc72qXRyrFiYVUpxGbqbXqPTdJjGm8GxvuwY6dwYyqiDL0L4ZHA8ueYS34pZlSvE5cvZ%2B5L0JHJa9vEJ1W8Pqt1wxWRFxk9rTjKEsTldCLOAaZQArrL09XbORY9RKJymViUcVKXXDZyYrihG24puBP7Q0klt33FfXCOWl8D%2BdEqzwPIv5H2VZGi4m%2FGS4Id8QNSv7KNd72oaaqqBHPe%2BcaQBNdrl5tGj0GLQa5vEwuuFiqiZfYWS1JXRedJdO1231Hq5yU66xdMa6GLuVKIVsSg5Tz7a0KFhpvLGYG28NsHgim3jEPzU0%2FfskoJ43K0M%2FAQW57Qfto%2F4xPT%2Faem36dXOyY929FDEawLfAQW2K1c5SH1oiT%2Bomp7b0v3iKTxB5YbVOX1QIaqPITE64vVve%2FQVHigwZjXn6gm8r3%2B5jIuQXaMTKmt3Z8qZAXuvHXyIhFySvgvVd1HaBdX%2FLAo6wYx%2BaWuJl8Y7Qg7uuXGEMEBkIba7kqCgJ4cUzEvkb5%2BaF0h0rxabTD357%2FGBjqyAfqYzux0u2fIPi%2F%2B5WgXrdOTFF9hswACvH1kqzOXf9i%2FhFaA9reIVKxbcUQk7RHelMKqGaiuR4%2BORktmbLN6VadvA%2BPEkXFVVes%2B7LnvM9NmvFVdF2yG8LnQmcQMm%2Fue0xNqf3zd753V6T9g2UU8jFT%2F5oJbh4z7d9HvcXbDlcr4DTGGjwHTE7klqn8N7UXcU3Q4yrkD3foXSV43foaRVQywlCTelvhv%2FMKxvOToYrdap2M%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=739eba30b89e68b2fad18b938d355a7acee417fba015f23a04149f7d4a396377",
      "file_size": 44685,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 486137,
      "file_name": "http-file-server_-_XSS2.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/486/137/b3a3e8c4d9cd97c66caec1d006fafc9f77c7e800/http-file-server_-_XSS2.PNG?response-content-disposition=attachment%3B%20filename%3D%22http-file-server_-_XSS2.PNG%22%3B%20filename%2A%3DUTF-8%27%27http-file-server_-_XSS2.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ63C5JMFQ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T150502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFDvRHn9ky1YQHzGuakS4Iz0vDtMnYWimh35oKHC7r%2F2AiAia3verAavWozpj%2BAPj1Qc2tpTLeRgJgInw7s8k0Ms7CqyBQgWEAMaDDAxMzYxOTI3NDg0OSIMRvcecFwXg0wZuwgGKo8FksKPXngK9ceXhWE613mjXnbZdBITFJXG%2B7ytn5mQqEzLPXaN8Dx%2F8nIueq6O5yT55A9X2c24%2FKOSrqpojCWB%2FmHExscAysLYKTPUIlVMYMErXfxTvQFibbmyznBSpJpT6mph1%2FC7m4PzL0Z7s5mDS2e2w0q67hMvtblmSd6z2S5sLLprqEv4nxaO2Z03eCVZed4HflAJpQWGkIN9dxrJmqL0xfNinTwvuGKS%2FtQXpUBCwbAlEPsVf6kFzMuBkc0qEZZXmFUVur2bm0BmaPy5U0SS0%2F0oEWM%2B%2Fd1IyjwDODtmd9pVA%2B1zdR2zU3SBpqjUGbCVyxM%2BCvCJKx2laInTTGrcZXpxB0ZaBPc72qXRyrFiYVUpxGbqbXqPTdJjGm8GxvuwY6dwYyqiDL0L4ZHA8ueYS34pZlSvE5cvZ%2B5L0JHJa9vEJ1W8Pqt1wxWRFxk9rTjKEsTldCLOAaZQArrL09XbORY9RKJymViUcVKXXDZyYrihG24puBP7Q0klt33FfXCOWl8D%2BdEqzwPIv5H2VZGi4m%2FGS4Id8QNSv7KNd72oaaqqBHPe%2BcaQBNdrl5tGj0GLQa5vEwuuFiqiZfYWS1JXRedJdO1231Hq5yU66xdMa6GLuVKIVsSg5Tz7a0KFhpvLGYG28NsHgim3jEPzU0%2FfskoJ43K0M%2FAQW57Qfto%2F4xPT%2Faem36dXOyY929FDEawLfAQW2K1c5SH1oiT%2Bomp7b0v3iKTxB5YbVOX1QIaqPITE64vVve%2FQVHigwZjXn6gm8r3%2B5jIuQXaMTKmt3Z8qZAXuvHXyIhFySvgvVd1HaBdX%2FLAo6wYx%2BaWuJl8Y7Qg7uuXGEMEBkIba7kqCgJ4cUzEvkb5%2BaF0h0rxabTD357%2FGBjqyAfqYzux0u2fIPi%2F%2B5WgXrdOTFF9hswACvH1kqzOXf9i%2FhFaA9reIVKxbcUQk7RHelMKqGaiuR4%2BORktmbLN6VadvA%2BPEkXFVVes%2B7LnvM9NmvFVdF2yG8LnQmcQMm%2Fue0xNqf3zd753V6T9g2UU8jFT%2F5oJbh4z7d9HvcXbDlcr4DTGGjwHTE7klqn8N7UXcU3Q4yrkD3foXSV43foaRVQywlCTelvhv%2FMKxvOToYrdap2M%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3c692a12de1c8aed4a57f98ee1b39f23f49c5a7450e358b7fd2513e94cc2f8e3",
      "file_size": 36545,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-08-14T10:45:06.060Z",
  "allow_singular_disclosure_after": -192687596.444862,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "thaivu",
    "lightangel1412",
    "mik317",
    "0619",
    "armansameer",
    "erlei1",
    "cpsteine",
    "sevnebulosa",
    "riad22",
    "ahen_hacker"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 2986,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "Other module",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
