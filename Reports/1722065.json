{
  "id": 1722065,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzIyMDY1",
  "url": "https://hackerone.com/reports/1722065",
  "title": "CVE-2022-42915: HTTP proxy double-free",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-10-04T15:34:57.518Z",
  "submitted_at": "2022-10-04T15:34:57.660Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bagder",
    "url": "/bagder",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZIT4IKNN%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T220859Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJGMEQCIH5S6fYKetpuazFUkaO2jdTENAlJFAEAksVwV6ok0UqoAiBpP%2F9zQRjMN0kBNrdXAtFNCe60y%2B6O%2FVwlXiU8NCMFvyq6BQjy%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMiw6yZQO2gOSkPmi4Ko4FQ1RVd7qu%2FsJ9CtqhsEnVEHrd2f%2BG4UzNDTuTKmpWc%2BZ%2BZXaL6DMei6%2F8FwNAlnFk66Sl7zkaVbrUhgvfqSb9GPSg7BrwakPZmKFRBl1G5RvJR0%2FaTgOAmBP5mQLYW3DEvvWRjboVSCIAXjXh5whPp0DRl%2F%2BTS5eM9kmICHghM1GmUH2KruL1ygmg%2FYxuQ33QjwooMHJDMGbeux67Yl%2FZIfkejSzcBenjHXE%2BvNhSdz56xDzcVHRG7OfXRQrVqBEAB%2BEus%2F3NXXy%2FktaCmyWt2%2BAuW9ST6rgikedOI79vlIKfmKKDzJLwa3aBriDsSYB%2BT5nyLIvpE6hgqxSjeXXdrDcsk8l3Iyorx%2FyR5X1wgZYg9Cp1nB9Z6yRJsa%2BBV96w%2FQC9A%2BY8Lyadfl9fGr2oJv%2BEkROQnKPysa4McSYvqac3OAxKoEZ6fAUPDdPWNIe3AcDv8BasOF0OyRIPpgxU4KKxSuNT5CSWFS1ZF8XVtr5mJoarB9kPPXGmDL%2BgEAiMmymMOMwvzwdziPeK9I3jTY7KrYnyFsTG%2Fnhm3YN9kmneV506%2BN%2BKhep%2BfJpXozK%2BqtaBRfbDCHQ2REwFnYrPEhhGVSQ8M0KNDwb4q4t%2BuWnYmZRF%2BHI%2Fe%2BK%2BEIUvaK1MaQdTpOWyIgFtbtTMxUtaHxE2n6jl83bH1dKQtracHkYcfAr0xYLWjMRZZ4BG5O%2Fvb1Gkvj2VmdOjfaX%2BqJocYV6Y%2FACUioWff5Osbxqs5bDTOK3YaYr9ICgmRGT8%2BBJWzWRmk7El%2BFVXy4ix%2F6FI65kEUqxGie8e3ydyMfgnWy1nt8n6xPXYwfDtGlJ1jknOoTALL0setbTHJOkSVfIMuO%2FVaActMtCnSBdysZc2MIO%2Fu8YGOrIBo0yp15frtEwEkShpqgPEzow4wLy8Bls1kfuUSOdCDpV%2BPsQVrODh8dgBRqTAwAhZ5C%2FdXu0n%2FiyL8ND0wJ82%2Fr1jc%2BC%2FxX5oOaDo%2FrVikhBg5YDdOHcm9LbIiSCCE9Ziwx6ESXbvvOh0F7HEZaViMKOa3%2BS7jVH716lcbcfgaKkziQff9%2BkaL2ku2HQK05vi%2BWOOY3XPoXGdGcz%2BC0anKDkdQvKf2DFEvzrxACT6PgTvtw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fa02a1384ad9a0c8ca71a9a6be10444e5da858c98537030fa39d1e13c5cc92c2"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": true,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-42915"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-11-26T12:04:19.216Z",
  "bug_reporter_agreed_on_going_public_at": "2022-10-27T12:04:15.199Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "This is a finding that Trail of Bits found in their ongoing curl security audit. Reported at a status meeting today.\n\n## Summary:\n\ncurl frees memory twice in some cleanup function related to HTTP proxies.\n\nIt as simple as `curl -x http://localhost:80 dict://127.0.0.1`\n\nUsing valgrind on the current git master, it shows:\n\n==55921== Memcheck, a memory error detector\n==55921== Copyright (C) 2002-2022, and GNU GPL'd, by Julian Seward et al.\n==55921== Using Valgrind-3.19.0 and LibVEX; rerun with -h for copyright info\n==55921== Command: ./src/curl -x http://localhost:80 dict://127.0.0.1\n==55921== Parent PID: 3035\n==55921== \n==55921== Invalid free() / delete / delete[] / realloc()\n==55921==    at 0x484617B: free (vg_replace_malloc.c:872)\n==55921==    by 0x152464: curl_dbg_free (memdebug.c:297)\n==55921==    by 0x17E11C: Curl_free_request_state (url.c:2259)\n==55921==    by 0x179B38: Curl_close (url.c:421)\n==55921==    by 0x1482DD: curl_easy_cleanup (easy.c:799)\n==55921==    by 0x1359F4: post_per_transfer (tool_operate.c:657)\n==55921==    by 0x13D085: serial_transfers (tool_operate.c:2431)\n==55921==    by 0x13D5FC: run_all_transfers (tool_operate.c:2617)\n==55921==    by 0x13D972: operate (tool_operate.c:2729)\n==55921==    by 0x13427C: main (tool_main.c:276)\n==55921==  Address 0x5b1c790 is 0 bytes inside a block of size 984 free'd\n==55921==    at 0x484617B: free (vg_replace_malloc.c:872)\n==55921==    by 0x152464: curl_dbg_free (memdebug.c:297)\n==55921==    by 0x17AE5E: conn_free (url.c:810)\n==55921==    by 0x17B132: Curl_disconnect (url.c:893)\n==55921==    by 0x15D523: multi_runsingle (multi.c:2614)\n==55921==    by 0x15D7B6: curl_multi_perform (multi.c:2683)\n==55921==    by 0x147FFB: easy_transfer (easy.c:663)\n==55921==    by 0x14822C: easy_perform (easy.c:753)\n==55921==    by 0x148276: curl_easy_perform (easy.c:772)\n==55921==    by 0x13D064: serial_transfers (tool_operate.c:2429)\n==55921==    by 0x13D5FC: run_all_transfers (tool_operate.c:2617)\n==55921==    by 0x13D972: operate (tool_operate.c:2729)\n==55921==  Block was alloc'd at\n==55921==    at 0x48485EF: calloc (vg_replace_malloc.c:1328)\n==55921==    by 0x1521A6: curl_dbg_calloc (memdebug.c:175)\n==55921==    by 0x1BEC8F: connect_init (http_proxy.c:174)\n==55921==    by 0x1C02C2: Curl_proxyCONNECT (http_proxy.c:1061)\n==55921==    by 0x1BEA43: Curl_proxy_connect (http_proxy.c:118)\n==55921==    by 0x1B67D4: Curl_http_connect (http.c:1551)\n==55921==    by 0x15C03A: multi_runsingle (multi.c:2027)\n==55921==    by 0x15D7B6: curl_multi_perform (multi.c:2683)\n==55921==    by 0x147FFB: easy_transfer (easy.c:663)\n==55921==    by 0x14822C: easy_perform (easy.c:753)\n==55921==    by 0x148276: curl_easy_perform (easy.c:772)\n==55921==    by 0x13D064: serial_transfers (tool_operate.c:2429)\n==55921== \n==55921== \n==55921== HEAP SUMMARY:\n==55921==     in use at exit: 0 bytes in 0 blocks\n==55921==   total heap usage: 4,712 allocs, 4,713 frees, 893,816 bytes allocated\n==55921== \n==55921== All heap blocks were freed -- no leaks are possible\n==55921== \n==55921== For lists of detected and suppressed errors, rerun with: -s\n==55921== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n\n## Impact\n\nDouble-free is nasty",
  "weakness": {
    "id": 49,
    "name": "Double Free"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-11-26T12:04:15.366Z",
  "allow_singular_disclosure_after": -88941884.47391582,
  "singular_disclosure_allowed": true,
  "vote_count": 7,
  "voters": [
    "zy9ard3",
    "shreyaschavhan",
    "2026",
    "hunterr0x01",
    "shivammusic",
    "atomicintelligence",
    "ryquaza"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
