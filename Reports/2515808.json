{
  "id": 2515808,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTE1ODA4",
  "url": "https://hackerone.com/reports/2515808",
  "title": "[Meetup][World ID][OIDC] Insufficient Filtering of \"state\" Parameter in Response Mode form_post leads to XSS and ATO",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2024-05-22T14:45:33.885Z",
  "submitted_at": "2024-05-22T14:45:34.369Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "lauritz",
    "url": "/lauritz",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 63660,
    "url": "https://hackerone.com/toolsforhumanity",
    "handle": "toolsforhumanity",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/01erx4j2sguq2l5mt2z2wtbw2hy8/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/01erx4j2sguq2l5mt2z2wtbw2hy8/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Tools for Humanity",
      "twitter_handle": "tfh_technology",
      "website": "https://toolsforhumanity.com",
      "about": "Building tools to support the World protocol and accelerate the transition towards a more just economic system."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-06-19T13:31:09.122Z",
  "bug_reporter_agreed_on_going_public_at": "2024-05-28T19:17:44.725Z",
  "team_member_agreed_on_going_public_at": "2024-06-19T13:31:08.815Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 1488,
    "name": "Cross-Site Scripting (XSS)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 100,
  "voters": [
    "ertzeus",
    "defenderwww",
    "oub3ll4",
    "viridian_40826d",
    "mastersplinter",
    "gigamegabit",
    "orange303",
    "8910jq",
    "loaymorad",
    "shopen",
    "and 90 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 421303,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.worldcoin.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 468898,
      "category": "team",
      "content": "A lack of proper validation in the state parameter of the World ID OIDC authentication logic allowed the injection of HTML characters into the response body when using form_post as the OIDC response mode. This vulnerability could enable attackers to obtain access tokens from targeted users with minimal user interaction. Additionally, an XSS vulnerability was identified in the same parameter but was mitigated by our Content Security Policy (CSP).\n\nThe researcher was able to demonstrate this vulnerability by injecting a button that, when clicked, would direct users to an attacker-controlled site. Since the access token is included in the form HTML, clicking the button would include it in the request, exposing the user's access token.\n\nA bounty of $7,000 was awarded as part of a HackerOne event.\n\n",
      "updated_at": "2024-06-19T13:32:34.380Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2862841,
        "username": "juan-tfh",
        "name": "Juan Broullon",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2023-08-22T21:09:50.462Z",
        "url": "https://hackerone.com/juan-tfh",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/1bwzxbdc84fvjddvbjpt7s7za55d/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjU1NjM0MywicHVyIjoiYmxvYl9pZCJ9fQ==--a5be710170231c4423c059ff227d7661567384ac/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiODJ4ODJeIiwiY3JvcCI6IjgyeDgyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--29ac517e159d5d0770b357ab67c25f2cbc1a5e86/GGEUWzuXQAARCho.jpg",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NjU1NjM0MywicHVyIjoiYmxvYl9pZCJ9fQ==--a5be710170231c4423c059ff227d7661567384ac/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/GGEUWzuXQAARCho.jpg"
        }
      }
    },
    {
      "id": 468925,
      "category": "researcher",
      "content": "A blog post about this report including technical details can be found here: https://security.lauritz-holtmann.de/advisories/tfh-form_post-xss-ato/\n\nI would like to especially thank Ian and Juan of Tools for Humanity for their continuous support throughout and after the [meetup](https://h1.community/events/details/hackerone-germany-hackerone-club-presents-hackerone-hacking-meetup-tools-for-humanity-x-hackerone-club-germany/). ðŸ˜Š\n\nJoin your local [H1 Community](https://h1.community/chapters/)!\n",
      "updated_at": "2024-06-19T13:44:34.622Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 225466,
        "username": "lauritz",
        "name": "Lauritz Holtmann",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": "https://security.lauritz-holtmann.de",
        "location": "",
        "created_at": "2017-12-18T00:03:45.133Z",
        "url": "https://hackerone.com/lauritz",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6ODEwODMsInB1ciI6ImJsb2JfaWQifX0=--ce80be957c091a8d7c0d0a4308653c871323edf3/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/smUtY-co_400x400.jpg"
        }
      }
    }
  ]
}
