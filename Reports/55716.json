{
  "id": 55716,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTcxNg==",
  "url": "https://hackerone.com/reports/55716",
  "title": "Force 500 Internal Server Error on any shop (for one user)",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-04-10T14:57:24.777Z",
  "submitted_at": "2015-04-10T14:57:24.777Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "4lemon",
    "url": "/4lemon",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2015-06-09T23:43:40.005Z",
  "bug_reporter_agreed_on_going_public_at": "2015-06-09T23:43:39.548Z",
  "team_member_agreed_on_going_public_at": "2015-06-09T21:26:00.206Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "There is very strange behavior. If user open urls like below:\r\n- https://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n- or https://lmfshp.myshopify.com/?preview_theme_id[]=11290937\r\nHe got redirect to shop (https://whashp.myshopify.com/) and  500 Internal Server Error response, and reload does not help in this issue. Let's look closer. And change https to http:\r\n- http://whashp.myshopify.com/ - works\r\n- or http://lmfshp.myshopify.com/ - works\r\nOk. Let's open payload with http:\r\n- http://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n- or http://lmfshp.myshopify.com/?preview_theme_id[]=11290937\r\nThe same 500 error on shop frontend. And this affected on any url, for example:\r\nhttp://whashp.myshopify.com/blogs/news\r\nI found two urls that not affected to this issue on shop frontend:\r\nhttps://whashp.myshopify.com/opening_soon\r\nhttps://whashp.myshopify.com/admin\r\nBut open of any of it not remove error from frontend\r\n\r\nThere is way to remove error -  delete _secure_session_id (for https) and _session_id cookies on shop's domain name.\r\n\r\nInteresting restriction is in theme id. Before next test we should remove error and test that frontend works (https://whashp.myshopify.com). If all good:\r\n- let's try to open https://whashp.myshopify.com/?preview_theme_id[]=11290937 - we got \"Can't preview theme\" response. So, to proper attack we need some theme id. How can we get it?\r\n- open source of https://whashp.myshopify.com/ (before shops is not active it can be done only after login, but any active shops have no problem to access front page). So, open source code and findline like this:\r\nShopify.theme = {\"name\":\"launchpad-star\",\"id\":11288717,\"theme_store_id\":null,\"role\":\"main\"};\r\n\"id\":11288717 - is proper id which will work in payload - https://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n\r\nAs i said in begin - very strange behavior affected only user whom opened malicios url. But:\r\n- attacker can retrieve proper theme id for any active shop from source code\r\n- this url request is not protected for CSRF\r\n\r\nSo, attack vector is:\r\n1. Open source code of victim.myshopify.com (some famous shop) and find theme id\r\n2. Create malicious urls (both for http and https)  https://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\r\n3.  Place this urls in place where as many as possible users open it. It may be image in shop layout (for example some xss issue) or just buy cheap iframed traffic and so on.\r\nAs a result any users that opened this urls will have problem with work with victim.myshopify.com shop.",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 34235,
      "file_name": "500_2.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/235/42d5c8e886be9801bee15cd2ced955f763feab44/500_2.png?response-content-disposition=attachment%3B%20filename%3D%22500_2.png%22%3B%20filename%2A%3DUTF-8%27%27500_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ35HDDFFV%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T202142Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCmjjcojLdaAzYNh1RY7vo6OMV%2Fa7JrRxXZGvbexKS55AIgBAxPXpRWyQ51jhDRD3OWoDDs4NBS3BtSC98MEBhX2YUqsQUINBADGgwwMTM2MTkyNzQ4NDkiDDumH4vNO68LQFKZ5CqOBcxnAqcc26ojb3WNYXWXvx50HhunDQpQtK9LJcB%2BQGgMTgfKJdllr7akfYrp6hJsFOx68LgmJdosjV28l1dwiPAQfb4AWqMr40xV6NBnAzQX1pVwniLpuHGvW4IDFyEz9tFJ1JAKXWBFry5uNgxzTosujenog9wfv8%2FsIS7%2B1YmXCuTxLqCz55vL%2B66uyYG07HvsJsoVpnahkfG6n4HxrW%2BnwewD6Ea4NSUW1spWpexA0byevQfuMqPbSbm40YWkkg8BCpHjSCERAdB1UgrQ15cMHNRF1OyV3XO1olRRxgAxQWo2IJIb0QwUKqS1w%2Fasgv8SCu3OYr3%2FjuLBaVRgr3T%2BpUL1219BflQryuasL3CAuHOsHo9veQbq%2BNWRmoWQ3vxpdRT%2B1%2FdRWakZjnAPBVP7rMzcQfahdk2rQV8Dq6RMIqWZDF7HWtuaXMkRtiovDduCkwLH92Xy6BolMAvbDw3OTaZ8gGOV3InhsatsLwDr4dzi3k%2FZgQOKyQBR1QH3nVxDFOEJ657MpUDsdb0nx4AOWf3e8ckuiEyv%2Bk6xFBm7PDnKWEBq2M5pHvNzmWVmx%2FAq2X5OR6WN0zOxS937dY9uEG4bxut1eGwt5VZjhaB3a43Lu45lSwPaPqrpWbHeWsH0ncvxsQXg0yej1F1kEMhreNIAuuVSrgMdgdog9uQ2Nf5y5%2BiJwI5K4KieTpQDJrwTvFsm%2BvMrtfLasI3rvtMPrcFapz34jPM5tlRGFNuxOhxU8CGj012i8vN%2BXhyU3t%2BG6mREDwayk3%2BMV9Tztyo%2Fk9CuxrfQX7hbsQTQROgFPMgXsKwRXpF8CoiIBP0m3c7JSZGoV4EOVnMS3X5Rzhz%2FqejHddwNNjdXQs5MGTC5v8bGBjqxAbH22HeufxG5hNyhE2o35sYDJNS5XoFIM%2FcudiwQxjRUerSPMXWcFgOFyMhqXAxSe1pXrV%2FM%2Buge0w2z5AOaARFkhVpwefJVOeuQYNQW%2B%2BypDv2t8lHUK8zgzjj6XmQfVdezVd6z0nuDYF8IK7uPuFGXU0MWpiMtBbdytFMSKsjFz%2BVvVtwJOGhX2CNmlaUhHthvG1%2FB83AXmTeLibvC1hil1PIdbx42Qh7Hbi60%2BAycNQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b10cef62149341218749af5dc139e46a625dbcabdcfb7d43b66743b8c7e0138f",
      "file_size": 22913,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 34236,
      "file_name": "500_1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/236/ea4a52a65f3eb0e7d6b3010be2e47f4c3f0e56cc/500_1.png?response-content-disposition=attachment%3B%20filename%3D%22500_1.png%22%3B%20filename%2A%3DUTF-8%27%27500_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ35HDDFFV%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T202142Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCmjjcojLdaAzYNh1RY7vo6OMV%2Fa7JrRxXZGvbexKS55AIgBAxPXpRWyQ51jhDRD3OWoDDs4NBS3BtSC98MEBhX2YUqsQUINBADGgwwMTM2MTkyNzQ4NDkiDDumH4vNO68LQFKZ5CqOBcxnAqcc26ojb3WNYXWXvx50HhunDQpQtK9LJcB%2BQGgMTgfKJdllr7akfYrp6hJsFOx68LgmJdosjV28l1dwiPAQfb4AWqMr40xV6NBnAzQX1pVwniLpuHGvW4IDFyEz9tFJ1JAKXWBFry5uNgxzTosujenog9wfv8%2FsIS7%2B1YmXCuTxLqCz55vL%2B66uyYG07HvsJsoVpnahkfG6n4HxrW%2BnwewD6Ea4NSUW1spWpexA0byevQfuMqPbSbm40YWkkg8BCpHjSCERAdB1UgrQ15cMHNRF1OyV3XO1olRRxgAxQWo2IJIb0QwUKqS1w%2Fasgv8SCu3OYr3%2FjuLBaVRgr3T%2BpUL1219BflQryuasL3CAuHOsHo9veQbq%2BNWRmoWQ3vxpdRT%2B1%2FdRWakZjnAPBVP7rMzcQfahdk2rQV8Dq6RMIqWZDF7HWtuaXMkRtiovDduCkwLH92Xy6BolMAvbDw3OTaZ8gGOV3InhsatsLwDr4dzi3k%2FZgQOKyQBR1QH3nVxDFOEJ657MpUDsdb0nx4AOWf3e8ckuiEyv%2Bk6xFBm7PDnKWEBq2M5pHvNzmWVmx%2FAq2X5OR6WN0zOxS937dY9uEG4bxut1eGwt5VZjhaB3a43Lu45lSwPaPqrpWbHeWsH0ncvxsQXg0yej1F1kEMhreNIAuuVSrgMdgdog9uQ2Nf5y5%2BiJwI5K4KieTpQDJrwTvFsm%2BvMrtfLasI3rvtMPrcFapz34jPM5tlRGFNuxOhxU8CGj012i8vN%2BXhyU3t%2BG6mREDwayk3%2BMV9Tztyo%2Fk9CuxrfQX7hbsQTQROgFPMgXsKwRXpF8CoiIBP0m3c7JSZGoV4EOVnMS3X5Rzhz%2FqejHddwNNjdXQs5MGTC5v8bGBjqxAbH22HeufxG5hNyhE2o35sYDJNS5XoFIM%2FcudiwQxjRUerSPMXWcFgOFyMhqXAxSe1pXrV%2FM%2Buge0w2z5AOaARFkhVpwefJVOeuQYNQW%2B%2BypDv2t8lHUK8zgzjj6XmQfVdezVd6z0nuDYF8IK7uPuFGXU0MWpiMtBbdytFMSKsjFz%2BVvVtwJOGhX2CNmlaUhHthvG1%2FB83AXmTeLibvC1hil1PIdbx42Qh7Hbi60%2BAycNQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a20f0615a64c28d90db68f2b2e5097a7f103018d440f75c8432c28b051ba8e62",
      "file_size": 84861,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 34237,
      "file_name": "500_3.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/237/6b2138c4ba12cf51679beb6ae3890809e01b6a4f/500_3.png?response-content-disposition=attachment%3B%20filename%3D%22500_3.png%22%3B%20filename%2A%3DUTF-8%27%27500_3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ35HDDFFV%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T202142Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCmjjcojLdaAzYNh1RY7vo6OMV%2Fa7JrRxXZGvbexKS55AIgBAxPXpRWyQ51jhDRD3OWoDDs4NBS3BtSC98MEBhX2YUqsQUINBADGgwwMTM2MTkyNzQ4NDkiDDumH4vNO68LQFKZ5CqOBcxnAqcc26ojb3WNYXWXvx50HhunDQpQtK9LJcB%2BQGgMTgfKJdllr7akfYrp6hJsFOx68LgmJdosjV28l1dwiPAQfb4AWqMr40xV6NBnAzQX1pVwniLpuHGvW4IDFyEz9tFJ1JAKXWBFry5uNgxzTosujenog9wfv8%2FsIS7%2B1YmXCuTxLqCz55vL%2B66uyYG07HvsJsoVpnahkfG6n4HxrW%2BnwewD6Ea4NSUW1spWpexA0byevQfuMqPbSbm40YWkkg8BCpHjSCERAdB1UgrQ15cMHNRF1OyV3XO1olRRxgAxQWo2IJIb0QwUKqS1w%2Fasgv8SCu3OYr3%2FjuLBaVRgr3T%2BpUL1219BflQryuasL3CAuHOsHo9veQbq%2BNWRmoWQ3vxpdRT%2B1%2FdRWakZjnAPBVP7rMzcQfahdk2rQV8Dq6RMIqWZDF7HWtuaXMkRtiovDduCkwLH92Xy6BolMAvbDw3OTaZ8gGOV3InhsatsLwDr4dzi3k%2FZgQOKyQBR1QH3nVxDFOEJ657MpUDsdb0nx4AOWf3e8ckuiEyv%2Bk6xFBm7PDnKWEBq2M5pHvNzmWVmx%2FAq2X5OR6WN0zOxS937dY9uEG4bxut1eGwt5VZjhaB3a43Lu45lSwPaPqrpWbHeWsH0ncvxsQXg0yej1F1kEMhreNIAuuVSrgMdgdog9uQ2Nf5y5%2BiJwI5K4KieTpQDJrwTvFsm%2BvMrtfLasI3rvtMPrcFapz34jPM5tlRGFNuxOhxU8CGj012i8vN%2BXhyU3t%2BG6mREDwayk3%2BMV9Tztyo%2Fk9CuxrfQX7hbsQTQROgFPMgXsKwRXpF8CoiIBP0m3c7JSZGoV4EOVnMS3X5Rzhz%2FqejHddwNNjdXQs5MGTC5v8bGBjqxAbH22HeufxG5hNyhE2o35sYDJNS5XoFIM%2FcudiwQxjRUerSPMXWcFgOFyMhqXAxSe1pXrV%2FM%2Buge0w2z5AOaARFkhVpwefJVOeuQYNQW%2B%2BypDv2t8lHUK8zgzjj6XmQfVdezVd6z0nuDYF8IK7uPuFGXU0MWpiMtBbdytFMSKsjFz%2BVvVtwJOGhX2CNmlaUhHthvG1%2FB83AXmTeLibvC1hil1PIdbx42Qh7Hbi60%2BAycNQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f30636eece8de1f0a8dfc30fbd6b5e6a782b80c1d7bb90c5d45031f567eed7cc",
      "file_size": 99373,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2015-07-09T21:26:00.447Z",
  "allow_singular_disclosure_after": -322095341.9963422,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "sw33tlie",
    "exception",
    "shivammusic",
    "spetr0x",
    "webtrack",
    "crossv3rify"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
