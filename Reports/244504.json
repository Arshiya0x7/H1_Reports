{
  "id": 244504,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ1MDQ=",
  "url": "https://hackerone.com/reports/244504",
  "title": "Possible SOP bypass in www.starbucks.com due to insecure crossdomain.xml",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2017-06-29T20:05:48.533Z",
  "submitted_at": "2017-06-29T20:05:48.533Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jackb898",
    "url": "/jackb898",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1989,
    "url": "https://hackerone.com/starbucks",
    "handle": "starbucks",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Starbucks",
      "twitter_handle": "Starbucks",
      "website": "http://www.starbucks.com",
      "about": "Premier purveyor of the finest coffee in the world, inspiring and nurturing the human spirit — one person, one cup and one neighborhood at a time."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-09-23T20:36:57.779Z",
  "bug_reporter_agreed_on_going_public_at": "2017-08-24T20:36:51.148Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello. I was penetration testing your website, and noticed that your crossdomain.xml file allowed many sites access. I went through and, for all the sites that had *.website.com with them, I scanned them for subdomains.\n\nI found that a subdomain for ███████.com (a site in your crossdomain.xml as *███████), m███████, was vulnerable to takeover. \n\nI'm not going to take it over since they do not have a white hat hacker program, but if someone were to take it over, they could make flash files on it to retrieve sensitive information from starbucks.com, and do it with no issue. Another factor that makes it even worse is that it's possible to use any headers also (<allow-http-request-headers-from domain=\"*\" headers=\"*\"/>).\n\nIt's similar to if your site had this line in the crossdomain.xml: <allow-access-from domain=\"*\" />\n\nSCENARIO:\nThis is a scenario of how it would most likely be exploited\n1. A black hat is trying to hack into Starbucks\n2. He goes to the crossdomain.xml file looking for <allow-access-from domain=\"*\" />, but he notices lots of different websites are allowed access\n3. He decides to check the domains with *. before them for vulnerable subdomains\n4. He finds m██████, and notices *███████ has access\n5. He takes over m██████ and uploads a malicious flash file to send HTTP requests and see their responses. \n\n\nHOW TO FIX THIS\nPretty simple, obvious fix, but you have two routes you can take for it.\nFirst option: You can just remove <allow-access-from domain=\"*████████\" /> from your crossdomain.xml file. (I didn't find any other subdomains vulnerable to takeover that were in there)\n\nSecond option: You can talk to ███████, the company that owns █████.com, and tell them to disconnect the DNS records linking m████████ and m██████.███\n\nMORE INFORMATION\nHere is more information on how it could be exploited: http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/ (read between Abusing CORS via Flash Files down to Bypassing XMLHttpRequest Header Validation)\n\n\n\nThanks,\nJack\n",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-09-23T20:36:51.190Z",
  "allow_singular_disclosure_after": -252287081.64069015,
  "singular_disclosure_allowed": true,
  "vote_count": 29,
  "voters": [
    "achabi7",
    "jon_bottarini",
    "flashdisk",
    "savitar0x01",
    "dilawer",
    "apapedulimu",
    "edoverflow",
    "akaash_pantherdefence",
    "naategh",
    "null_rhythm",
    "and 19 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.1,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 13020,
    "asset_type": "URL",
    "asset_identifier": "www.starbucks.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 20505,
      "category": "researcher",
      "content": "Ah, my early reports. I've come quite a ways from reporting things before I understood exactly what they were. Nonetheless I got pretty creative here and recognized that a problem existed in this configuration, one that turned out to be a high impact problem. For web developers: *always* keep your crossdomain.xml allowed domains up to date if you have something other than wildcard allowed! Thank you to the Starbucks team for an efficient and helpful response.",
      "updated_at": "2020-05-10T13:39:55.143Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 87732,
        "username": "jackb898",
        "name": "Jack Burton",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://www.jackburton.me",
        "location": "Houston, Texas",
        "created_at": "2016-06-25T15:29:25.034Z",
        "url": "https://hackerone.com/jackb898",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/74790fe75ac5dbe8a5140a122388d59ebac913dcfa941f0b3a45e6cad161f9ea",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6ODk5ODE4LCJwdXIiOiJibG9iX2lkIn19--706fc1d8cf99088100aa014521fa0e2c05556bc2/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGVnIiwicmVzaXplIjoiMjYweDI2MFx1MDAzZSJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--cea846659d6dfdc215f3c0fb14f7ed8ebc9f95ef/ED1EBE46-216F-48FC-8CEF-661A6B1CC530.jpeg"
        }
      }
    }
  ]
}
