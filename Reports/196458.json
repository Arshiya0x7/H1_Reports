{
  "id": 196458,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY0NTg=",
  "url": "https://hackerone.com/reports/196458",
  "title": "apps.shopify.com - CSRF token leakage through Google Analytics",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2017-01-07T00:59:41.646Z",
  "submitted_at": "2017-01-07T00:59:41.646Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zombiehelp54",
    "url": "/zombiehelp54",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/mevfgipw1pc7n4wy86swdq1yaeuq/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-02-07T01:32:16.100Z",
  "bug_reporter_agreed_on_going_public_at": "2017-02-07T01:32:16.065Z",
  "team_member_agreed_on_going_public_at": "2017-02-07T01:28:49.978Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "#Description:\nWhen a user tries to send a support a message to an app developer in `apps.shopify.com` , he will be asked to login and once he is logged in , he will be redirected to `apps.shopify.com/[app_id]?authenticity_token=[current_user_authenticity_token]`. \nDevelopers can track their app page view in `apps.shopify.com` by adding a google tracking code while editing their app.\n\nWith that said , here is how now attacker can steal someone's CSRF token and use it to submit requests on behalf of that user:\n- Attacker tricks the victim to visit an HTML page that he has control over it\n- The HTML page opens a new window that redirects to `https://apps.shopify.com/[attacker's_app]/support_interactions/new`\n- The victim will be redirected to `https://apps.shopify.com/#login` once he is logged in , he will be redirected to `https://apps.shopify.com/[attacker's_app]?authenticity_token=[victim's_token]` \n- The attacker can now see the victim's authenticity token by checking Real-Time analytics at his google analytics dashboard\n- The attacker can use the victim's CSRF token to forge HTML requests that edit the victim's app listing by issuing requests to `https://apps.shopify.com/services/shopify_applications/edit` , if the victim has a shopify application or he can use it to submit reviews,support messages ..etc\n\n\n#Steps to reproduce:\n1. Go to `https://app.shopify.com/services/partners/api_clients/new` to create a new application then after creating it click **Edit App Listing** and at **Google analytics code** field enter your google analytics code.\n2. Go to `https://apps.shopify.com/[your_app_id]/support_interactions/new` , you'll be redirected to the login page , enter your shop domain then login.\n3. After logging in you'll be redirected to `https://apps.shopify.com/img-src-x-onerror-prompt2?reveal_support=true?authenticity_token=[Your_CSRF_TOKEN]&utf8=%E2%9C%93` \n4. Now go to your google analytics dashboard `https://analytics.google.com/analytics/web/` -> **Real Time** analytics , and you'll see the whole URL with the authenticity token disclosed.\n\n{F149974}\n\n",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 149974,
      "file_name": "csrf-token-analytics.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/149/974/144643bf2bf7c50d6e0935147fb5fa5f429fcd6d/csrf-token-analytics.png?response-content-disposition=attachment%3B%20filename%3D%22csrf-token-analytics.png%22%3B%20filename%2A%3DUTF-8%27%27csrf-token-analytics.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ4BD7AFDX%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T234532Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIG5Mzr0x%2F39caZ34VvnYZSu%2B4XVkYwA38IEB8ighJcTzAiEArtPm%2B8vaiCvHEmILAu%2BHyPF0pbWp%2BJPZNZdL%2F%2FlyMfcqsgUIHxADGgwwMTM2MTkyNzQ4NDkiDHvDZxI45WO%2FVcWRAyqPBWYJGhwuiVUh%2B0EvK00xvBEIwzRX34v%2BvZthshXDaUWH%2BuPRDBvIPmWGrSH8SD0g5H8HbEwkEfKzKDe5mjTk2awkWVbsSau8hngdZ7IhUGfDffI5lBmweljLTaxh%2BOoaq9Fs%2B8M5cec1GyvvCPKGDkFQeSrSIV6R6%2FDbCSm6i3N0K%2FamMzLzLLkT46OfbAyJP9LRvoa1w4L4sHNp6Yuj1H0KNyNE8TLfQBtH8Dc0ok4B0LKvxLlKMXC0JZJQkZr7HF5Dfn9mHEzR7vSqL18fUO2otCOQ4ERBiMMostU61Zi1UZJmu61vfApA7yhsBzxZ8rqKALxUu%2B1MFtosUYKkYrprYKEzKf9svpXjt%2FrXoBWbjoJkRXuvUZULV64AzqxfEABxHZnNlesMWsKnxcCi6hWoqM%2BMqFpwb%2ByEl%2BjvB7hb%2FpPlVfp%2FUX4hOMtJkN6uDdb1z%2FU9CnMaEdgawe6kTF9Vk%2FVgTwMGVloLq2yHI5vmd0tw8rxZ1I2ULlq%2FF5m8bqMCdif5rp2K7nBOhHTy9INO7J%2B85QgMsIeUZGt3cmPFFRP9kCG0gudhiCfx8O12qKSrP07TVQ%2FXxCbmeeGr1I2r6Bll3tkr8fENBu%2BKJScJy5O9OUl2aVyCndk7FgnFesONiq6cVO8TAz1Xf23OZJaPK%2FTzAFONQwscgKRFL9rZw1rwpoeahrbbC6mw7H7MqlQIM%2F9gmDx1ZWfVPTefT4FVKlpsrfYxrK5MtDBz7tQCiHCA7LfbXAjS%2FlWaAr2rdNKfndK7pdiCihvMKheo8M%2BOhQ27VwQdniEz2xssRvkOX4Wtfo340%2FLCmBv6SFEicozc4Jq4WyPoh3y1DkUJHxhOkdycejqPIVLn9IUshWgw1efBxgY6sQEHGWzuwlsd9fgperU6ktE%2BuXdh1rIZugRbxHX42QKa57gQF8EWQwEbtPI78E68kTrdP9nudx%2FAVHRecrssw0tXONvW6yuQBiE6gGix3Eq2%2BpFtSaKSngamNWxm0IF00P8zn4s2StsLeTzbZ3Nm86Dv4KQlzCnXGXly6KKUBCLHE3ZmKRfAwATv%2B7IcpN5amQZQu%2BTbMe1tmjRfvhIt%2BxuLa8WiyBlHqp5vns3XPmKRtA8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2afa3a17396007fdb22e61d95bc39758b0821507d6b94ad756cb258dcd4f4010",
      "file_size": 131006,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 47,
  "voters": [
    "arneswinnen",
    "drsniper",
    "bogdantc",
    "inhibitor181",
    "michiel",
    "spam404",
    "hph",
    "jon_bottarini",
    "aryan2808",
    "flashdisk",
    "and 37 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
