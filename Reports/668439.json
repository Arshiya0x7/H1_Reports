{
  "id": 668439,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Njg0Mzk=",
  "url": "https://hackerone.com/reports/668439",
  "title": "IDOR leading to downloading of any attachment",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2019-08-06T17:54:04.922Z",
  "submitted_at": "2019-08-06T17:54:04.922Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "naaash",
    "url": "/naaash",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/73j9odd8unsslt78s5919e2qyfcw/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 41881,
    "url": "https://hackerone.com/bcm",
    "handle": "bcm",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6ODAyMzEsInB1ciI6ImJsb2JfaWQifX0=--34b7442d639d4950cf35066f0bbf7a48c59ebf54/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/100_logo_2_copy_38_20x.png",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "BCM Messenger",
      "twitter_handle": "BCM_SOCIAL",
      "website": "https://bcm-im.com",
      "about": "Born for the freedom of communication"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-04-11T09:00:27.154Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-12T09:00:21.841Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Description:\nHey team, \nI came across an endpoint on your android app which could be used to download any attachment which is being uploaded onto your server. All the attacker needs to do is bruteforce the simple **ID** which surprisingly is a randomly generated number( I personally think it's based on the time and it later gets converted using a epoch converter). What makes it worse it that, that particular endpoint doesn't even check for proper implementation of **Authorization Header**.\n\n## Steps to reproduce:\n* On the attacker's device, intercept all the requests using **Burpsuite**.\n* Send an attachment from the victim's account to the attacker's account.\n* In the **Burpsuite's**  log you'll come across a request something similar to this:\n\n```\n\nGET /attachments/938540538 HTTP/1.1\nX-Signal-Agent: OWA\nAccept-Encoding: gzip, deflate\nX-Client-Version: BCM Android/5.1 Model/generic_Google_Nexus_6 Version/1.26.0 Build/1393 Area/200 Lang/en\nHost: ameim.bs2dl.yy.com\nConnection: close\nUser-Agent: okhttp/3.12.0\n\n```\n\n* Over here the ID number `938540538` will be different for each attachment.\n* Put this particular request the repeater tab and change the ID value to `359912920` (which was sent to some other person).\n* This is what it should look like: {F548523}\n* You can even try it out by removing the `Authorization` Header completely and still the attacker will end up getting the attachment.\n\n## PoC:\n\n* Have a look at the video over here: {F548509}\n\n## Impact\n\nGetting access to all the attachments uploaded by any user.",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 548509,
      "file_name": "PoC_attachment.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WYH9c5skDhDLNrajky8A2M1F?response-content-disposition=attachment%3B%20filename%3D%22PoC_attachment.mp4%22%3B%20filename%2A%3DUTF-8%27%27PoC_attachment.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVDKEGTGL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T115003Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB9mNsT84D7ND2huVZPsxnKc2oVoZypFck99J8NBmUlCAiEAoyuDlfzGFVL%2Ft0RQnKKpUGx%2F%2BAkiO41I%2B%2FpfyQfV%2Fj4qsQUIEhADGgwwMTM2MTkyNzQ4NDkiDMG7hZ0YnSH9e9tnHCqOBSeAo%2BRXo6BFs6%2Bxl3vFt9CGHg%2F0n7laPNGGabiQnj0BSp1jZsmcy5QUunKM55nQ2geW37ihvYPW4iYPjsdmdnkEHCEnVCQixP10kob8cB9iJHfVSqc9nOVZ%2FOnIAvV93jTh5MNXSxM1ONLDWvrANbjV0BKbhhs2exR8eCkBJ7qhg%2B2qnujMd0iNrUvzdhVEJfWGmKaSr9eNKTn6M5nxN9joKqJx8UKgDzs4lnLHKlH%2Bitc7uKWK%2FEt6iXekiWRJlg1s4P89%2FQNU0z2ywNJa%2BTRYh9i48mpXl4PG0JKZUJWTW8AWtifD4UIBposw4Fj0BhaaTOadB5lH%2Bd4tj8AEosHyof4eBrW4OPEH41asF%2Fath5OXSpXOL0o9E0%2BQLN18%2ByKB1LxiYaAkhj7RypelueLkLPPHrvFL%2B8eLVd8iJsFxSUWeeWr7xnWgpg3WVLl11svwbzI0K7PVr5gx7UANnxigeSYTawwCDfxQafw3D6wc9yJv0e5OWFKXRLjnAm4FZdx1Hwy3ic8v2SPm8etb79HsUHN%2FqJXcfZNbIMuIRHFsq%2FVn6h3UNsBNf3znamM1RyhjqAvwSM%2FQGLdn4WKRzvtnxO9uW90Zpg0J4YpD3XbBgeVfw%2FodKljtKk3I1jLpAMv2VOfYBDNLYpnN5ocdsCH4WA8Gtuo2el3b58ykLf%2FepqFUxz1%2BB9mV7F%2FvzvvFsENHUndsxAz3luhmmxOwtb1lUAgZXngAahH29VxmVGxBW7RSednAldnVOhIAoHCorS6auEANdT6jqwLuFPQNeDX0EDansnB2tYGNn8Vk8C1W653BDJ%2FUNCmlRJmgpaig9yWe6AUeOzWkZpgyobq3p3t6b2WmdEQnReRlKO13QTDW%2Br7GBjqxAdJ%2Bss3D1d%2B23GcFbI3BKQq3GY1tto7h%2FQUYU983ENF5P2BDchI0UruSGy47nqVx%2FvelioJK5f1RZTOY2sMmXjr1xpFr8HuWdKfz4WFSUWh32rF2xvCEFDGxo%2Bj2jgibuqVSU6VgS21sDZoxRI%2Fp8N%2BAPA6DwpraXqt7vAOHaJ6gQmZ9Z5RwY9WyX5g2ogiucydd8xF5FFF4tITmwfzuH%2BH6aE3kzBIEFVRlnBCrUwwfWw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=209d203887f0e224d3b5382c848487da6c4c4df202127b7aa302afb90f73a58d",
      "file_size": 8636847,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 548523,
      "file_name": "1.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/h17YHXvBcZULTKA1E7bGaTnA?response-content-disposition=attachment%3B%20filename%3D%221.PNG%22%3B%20filename%2A%3DUTF-8%27%271.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVDKEGTGL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T115003Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB9mNsT84D7ND2huVZPsxnKc2oVoZypFck99J8NBmUlCAiEAoyuDlfzGFVL%2Ft0RQnKKpUGx%2F%2BAkiO41I%2B%2FpfyQfV%2Fj4qsQUIEhADGgwwMTM2MTkyNzQ4NDkiDMG7hZ0YnSH9e9tnHCqOBSeAo%2BRXo6BFs6%2Bxl3vFt9CGHg%2F0n7laPNGGabiQnj0BSp1jZsmcy5QUunKM55nQ2geW37ihvYPW4iYPjsdmdnkEHCEnVCQixP10kob8cB9iJHfVSqc9nOVZ%2FOnIAvV93jTh5MNXSxM1ONLDWvrANbjV0BKbhhs2exR8eCkBJ7qhg%2B2qnujMd0iNrUvzdhVEJfWGmKaSr9eNKTn6M5nxN9joKqJx8UKgDzs4lnLHKlH%2Bitc7uKWK%2FEt6iXekiWRJlg1s4P89%2FQNU0z2ywNJa%2BTRYh9i48mpXl4PG0JKZUJWTW8AWtifD4UIBposw4Fj0BhaaTOadB5lH%2Bd4tj8AEosHyof4eBrW4OPEH41asF%2Fath5OXSpXOL0o9E0%2BQLN18%2ByKB1LxiYaAkhj7RypelueLkLPPHrvFL%2B8eLVd8iJsFxSUWeeWr7xnWgpg3WVLl11svwbzI0K7PVr5gx7UANnxigeSYTawwCDfxQafw3D6wc9yJv0e5OWFKXRLjnAm4FZdx1Hwy3ic8v2SPm8etb79HsUHN%2FqJXcfZNbIMuIRHFsq%2FVn6h3UNsBNf3znamM1RyhjqAvwSM%2FQGLdn4WKRzvtnxO9uW90Zpg0J4YpD3XbBgeVfw%2FodKljtKk3I1jLpAMv2VOfYBDNLYpnN5ocdsCH4WA8Gtuo2el3b58ykLf%2FepqFUxz1%2BB9mV7F%2FvzvvFsENHUndsxAz3luhmmxOwtb1lUAgZXngAahH29VxmVGxBW7RSednAldnVOhIAoHCorS6auEANdT6jqwLuFPQNeDX0EDansnB2tYGNn8Vk8C1W653BDJ%2FUNCmlRJmgpaig9yWe6AUeOzWkZpgyobq3p3t6b2WmdEQnReRlKO13QTDW%2Br7GBjqxAdJ%2Bss3D1d%2B23GcFbI3BKQq3GY1tto7h%2FQUYU983ENF5P2BDchI0UruSGy47nqVx%2FvelioJK5f1RZTOY2sMmXjr1xpFr8HuWdKfz4WFSUWh32rF2xvCEFDGxo%2Bj2jgibuqVSU6VgS21sDZoxRI%2Fp8N%2BAPA6DwpraXqt7vAOHaJ6gQmZ9Z5RwY9WyX5g2ogiucydd8xF5FFF4tITmwfzuH%2BH6aE3kzBIEFVRlnBCrUwwfWw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9735c6d645a4168822cff4cde35f67e6fa35b2ae86279510ed4885d088ae3ad4",
      "file_size": 174337,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-04-11T09:00:21.877Z",
  "allow_singular_disclosure_after": -171859781.84743017,
  "singular_disclosure_allowed": true,
  "vote_count": 110,
  "voters": [
    "wargsec",
    "a_d_a_m",
    "ali",
    "n0sandb0x",
    "tess",
    "1trick",
    "th4nu_0x0",
    "nanobyt3",
    "dhakal_ananda",
    "slaxxx",
    "and 100 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 35498,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.bcm.messenger",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
