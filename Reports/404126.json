{
  "id": 404126,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDQxMjY=",
  "url": "https://hackerone.com/reports/404126",
  "title": "[buttle] Unsafe rendering of Markdown files",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-09-02T19:45:30.201Z",
  "submitted_at": "2018-09-02T19:45:30.201Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "skyn3t",
    "url": "/skyn3t",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/224/816/14988b1087907275d769481dc45fe6576ce0d206_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-01-06T00:18:00.020Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-12-07T00:17:57.568Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report Cross Site Scripting vulnerablity in buttle module\nIt allows to execute arbitary javascript due to unsafe rendering of markdown files.\n\n# Module\n\n**module name:** buttle\n**version:** 0.2.0\n**npm page:** `https://www.npmjs.com/package/buttle`\n\n## Module Description\n\nAnother static file server? Why buttle? Well... if you came here looking for a blazing fast server of static files, something with caching and compression options then you're in luck, that does exist! It just isn't buttle.\n\nButtle is tailored for use in development. It has baked in live reloading for html and markdown files. It'll on-the-fly convert your LESS filess to CSS... and cache nothing because it assumes you're actively hacking away. With buttle you can test drive that angular app you just cloned or maybe have your test runner page refresh whenever a source file is changed.\n\n\n## Module Stats\n\n~0 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nbuttle uses `kramed` for parsing and rendering markdown. By default kramed does not sanitize html. An uninformed user may assume the output of markdown to be sanitized and thus become vulnerable to XSS by rendering malicious markdown files.\n \nSee https://github.com/jtrussell/buttle/blob/master/lib/mid-buttle.js\n\n```js\n// line no 8\n  var md = require('kramed');\n  md.setOptions({\n    gfm: true\n  });\n\nreturn function(req, res, next) {\n    var url = req.url;\n    if(/\\.md$/i.test(url) || /\\.markdown/i.test(url)) {\n      fs.exists(j(dir, url), function(exists) {\n        if(exists) {\n          fs.readFile(j(dir, url), {encoding: 'utf8'}, function(err, data) {\n            if(err) { return res.end(err.message); }\n            res.end(wrapInHtml(md(data)));\n          });\n        } else {\n          next();\n        }\n      });\n    } else {\n      next();\n    }\n  };\n```\n\n## Steps To Reproduce:\n\n* install buttle:\n`$ npm i buttle`\n\n* run buttle:\n`./node_modules/buttle/bin/buttle -p 8080`\n\n* add a malicious markdown file in the server directory (`test.md` attached) and open it in browser.\n\n## Patch\n\n`kramed` provides an option `sanitize` which is set to `false` by default.\nEither set the `santize` option to `true` in line no 11 of [mid-buttle.js](https://github.com/jtrussell/buttle/blob/master/lib/mid-buttle.js) or inform the user to safely handle markdown files by displaying an apropriate warning.\n\n## Supporting Material/References:\n\nYandex 18.7.0.2767 beta (64-bit)\nUbuntu 16.04\nnode v10.9.0\nnpm 6.4.1\n\n\n# Wrap up\n\n> Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n\nPS: [`kramed`](https://github.com/GitbookIO/kramed) package is a fork of another library `marked` and is unmaintained since last 2 years.\n\n## Impact\n\nUser is exposed to unsafely rendered markdown files which may lead to execution of arbitrary JS",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 341513,
      "file_name": "test.md",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/513/e5324d81811db2fb164da0c773530666f2278721/test.md?response-content-disposition=attachment%3B%20filename%3D%22test.md%22%3B%20filename%2A%3DUTF-8%27%27test.md&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZX27AZWF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T162101Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHRX0Q0MNSw0vdqJdQpgQjnFxJzvrl3%2FZv1dkmTkztyhAiEAoruevQPHhOJ%2BNKUjxRePB5FDlenQfNR%2Bj5FlKYF9bWAqsQUIFhADGgwwMTM2MTkyNzQ4NDkiDK1W%2BTl4fbwOpdGV%2BCqOBSKw2SEWiUFkS%2FKixfbpNzV5hpXG2UZAtjfIi1d798vnoMF7e4FrYQvNHJFISmcTadGzxfWWb0l30VlzYXvmHXfz5FIEyqaAco05756ND7aH2punq7JeVh%2B%2FCgA3dZ2WEWVO3yBhGjNRs8Crzu6Fj953KWrwhaRbaKX699fX3SZp2yVsoklzDlaTX6XHNAV1CxK4Kbmgt1NI8NOmjncIVMyyWKJvczLNT63q%2B%2BD1k1SKMW1D%2FnEHkg5uAum4Gv76B%2Fd5uNmdxegupDBrg0BWTfX8H1iRVmSJyGNuV15uEKliPO%2BaMicGXnMPF5U%2BY51VZA%2BKtuu549lV0OXIl1kDR9WTATAiKoML6f0M7k1nRcC2ngjl75JrAe3rjuxIkxAVBIm7fqQKRxGnBfPZgX0ukgiA5HkHRXeU7aywq5f13iCJC7%2FEUdBQUGkjElddpY1cYBwrtnWxeQWw2tZWDQh8eascc7VEsnlIHLvXex5ok185nBfd1AP3FAyD2Z6fU5Ew4S9B5D85Gfxf928KGokRoRReaHOcuX1F6Vh2sywHUaNSfW2rWakRLjmj2n2KRYi9JqPu%2B79XXjYI%2BNkD0XZa9f8b9T51LvedWN%2BTRtm37J1MczDzo762xQvMMqPvlomscmay5Bi2POCB%2FMYu7k1rnaOExERX3B%2FtoitQq0zqUBCF4BIyWWwVWPnPwAM3m5J3g5NgyBVdPN0n44KQHU3aXv8%2B5GwQP2lFkCDNFrcmXOi1e3RWZpCGwFP%2Fi0%2FD7LdKg1T9xOx9JeorqTKz64JZb4bTdSgLYP2LJkKD9m4VAMAYxP23yCzABtuw0O6ucYuqEkp90mQS5YSTGThKAEfcoykSnoN4AQuQD2GnMjTmuDDp6b%2FGBjqxAd8LRIrc%2BduVkXSHJd0yPruIgcs2mmWVMiek9kvBvcHISoRH7IAQ60Bpstvmq2%2BXMrbhBdG5VTC%2FKRqcMUAbDKpzfHnYkhJRtvXTxk3i7FzMalhNrtyaGV51qJs0fc0zJMRXiZYNFrwF4fuR2dMedTpRJkTySdxbq0jQpL7RuasS9Y1SV9grO9m6IhB0UIZ%2BlkYfyZS2Ht70HgCvNzKxUzo52c9AUIwNrj%2BFUphQ7cNncw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d4408f29d0c45f4c3ea4f51b1f1adc341b616e663fcc02f974975d01a22606d0",
      "file_size": 98,
      "type": "text/plain",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-01-06T00:17:57.676Z",
  "allow_singular_disclosure_after": -211737783.97638318,
  "singular_disclosure_allowed": true,
  "vote_count": 16,
  "voters": [
    "sameerphad72",
    "bl4de",
    "dhakal_ananda",
    "savitar0x01",
    "skyn3t",
    "khizer47",
    "japz",
    "vaverka",
    "b73772bded7541989b54f6a",
    "akira",
    "and 6 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 8249,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "buttle",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
