{
  "id": 1108874,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA4ODc0",
  "url": "https://hackerone.com/reports/1108874",
  "title": "Password Reset link hijacking via Host Header Poisoning leads to account takeover",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2021-02-22T16:48:13.992Z",
  "submitted_at": "2021-02-22T16:48:14.027Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hemantsolo",
    "url": "/hemantsolo",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/itdf4ik04yvbizf230s8xn7861tu/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-04-02T18:51:48.573Z",
  "bug_reporter_agreed_on_going_public_at": "2021-03-30T13:52:42.284Z",
  "team_member_agreed_on_going_public_at": "2021-04-02T18:51:48.470Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\n████████ uses the Host header when sending out password reset links. This allows an attacker to insert a malicious host header, leading to password reset link / token leakage.\n\n## References\nhttp://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html\nhttps://hackerone.com/reports/226659\n\n## Impact\n\nThe victim will receive the malicious link in their email, and, when clicked, will leak the user's password reset link / token to the attacker, leading to full account takeover.\n\n## System Host(s)\n███\n\n## Affected Product(s) and Version(s)\n\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n1.) Open up Firefox and Burp Suite.\n2.) Visit the forgot password page (http://██████/█████)\n3.) Enter the victim's email address and click on SEND RESET LINK.\n4.) Intercept the HTTP request in Burp Suite & change the Host Header to your malicious site/server ex. ███.\n5.) Forward the request and you'll be redirected to your server.\n\nThe victim will then receive a password reset e-mail with your poisoned link.\nIf the victim clicks the link, the reset token will be leaked and the attacker will be able to find the reset token in the server logs. The attacker can then browse to the reset page with the token and change the password of the victim account!\n\n## Suggested Mitigation/Remediation Actions\nUse $_SERVER['SERVER_NAME'] rather than $_SERVER['HTTP_HOST']\n\n",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 21,
  "voters": [
    "ayoub0x1",
    "hemantsolo",
    "dastan_9408",
    "khizer47",
    "pr0f0x01",
    "sa1tama0",
    "elgazzar",
    "mhohlfeld",
    "bornunique911",
    "nichachar_1202",
    "and 11 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
