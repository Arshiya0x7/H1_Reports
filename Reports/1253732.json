{
  "id": 1253732,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjUzNzMy",
  "url": "https://hackerone.com/reports/1253732",
  "title": "Specially crafted message request crashes the webapp for users who view the message",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-07-07T16:59:31.385Z",
  "submitted_at": "2021-07-07T16:59:31.466Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "thesecuritydev",
    "url": "/thesecuritydev",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/nFP2SbCpJV1ykEGVMhbE5Zbc/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35268,
    "url": "https://hackerone.com/mattermost",
    "handle": "mattermost",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Mattermost",
      "twitter_handle": "Mattermost",
      "website": "https://mattermost.com",
      "about": "Open-source collaboration, self-managed or SaaS"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-37863"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-03-14T05:05:54.711Z",
  "bug_reporter_agreed_on_going_public_at": "2022-02-12T05:05:53.136Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nIf you post a message with a modified `deleted_at` JSON parameter, the webapp will crash for anyone currently viewing the channel, or for anyone viewing a different channel if they switch to that channel afterward.\n\n## Steps To Reproduce:\n\n1. Go to a team channel, with Burp Suite ready.\n2. Send a message, intercepting the request with Burp. The JSON request contains keys like `message`, `channel_id`, and `pending_post_id`.\n3. Add the following key to the JSON request: `deleted_at`, with a value that's greater than 0. For example: `\"deleted_at\": 10`.\n4. Now if you send the request, the webapp will crash with a blank screen and you will have to refresh the page. _Note: If you want to send the request again, you may have to update the `pending_post_id` to some other unique value._\n\nIt affects all users viewing the channel, not just the sender. Also, you don't even have to be in the channel when the message is sent. If you are already on a different channel, and you switch to the affected channel after the message is sent, it still has the same effect.\n\n## Impact\n\nA user could prevent others from accessing a channel by continually making this request so that it's impossible to load the webapp, because a new message would come and crash it even after refreshing the page. And since after refreshing you will still be on the channel, it could prevent the users from having access to the entire webapp, as they may not be able to exit the channel quick enough to prevent the crash.\n\nYou could also send a DM to someone and when they click to view the message the webapp will crash.",
  "bounty_amount": "150.0",
  "formatted_bounty": "$150",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-03-14T05:05:53.214Z",
  "allow_singular_disclosure_after": -111170448.23610613,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "zy9ard3",
    "run_win",
    "shubham_srt",
    "thalaivar304",
    "h4x0r_dz",
    "011alsanosi",
    "kerolesmagdy",
    "shivammusic",
    "jenifrmdablock",
    "og_",
    "and 7 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 17023,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "mattermost/mattermost-webapp",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
