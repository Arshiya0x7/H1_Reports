{
  "id": 908162,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDgxNjI=",
  "url": "https://hackerone.com/reports/908162",
  "title": "Acronis True Image Local Privilege Escalation via insecure folder permissions",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-06-25T17:21:43.095Z",
  "submitted_at": "2020-06-25T17:21:43.095Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "theevilbit",
    "url": "/theevilbit",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTMzMTk0NSwicHVyIjoiYmxvYl9pZCJ9fQ==--498bbc6c8bfd80a1a24b3472943637687f5fecf2/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/5xjfKsYQ_400x400.jpg"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13428,
    "url": "https://hackerone.com/acronis",
    "handle": "acronis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Acronis",
      "twitter_handle": "Acronis",
      "website": "https://www.acronis.com",
      "about": "Complete integrated cybersecurity and data protection for MSPs and IT teams"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-02-23T07:20:06.937Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-03T13:45:58.023Z",
  "team_member_agreed_on_going_public_at": "2021-02-23T07:20:06.775Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Note: This has been submitted via service desk earlier, and I got a call from Acronis customer service that it's up on H1 and I should submit it there as well.\n\n\nAll of the Acronis LaunchDaemons (except the price helper) which can be found here: `/Library/LaunchDaemons/com.acronis.*` start an app / script inside the `/Applications/Acronis True Image.app/` folder. As the installation happened with drag and drop, an admin user can replace any of the executables and achieve trivial privilege escalation to root.\n\nPlease note that on macOS admin to root is a valid privilege escalation scenario, as even if we don't know the user's password, we can get root. \n\nHere are all the insecure LauncDaemon files.\n\n```\n% cat /Library/LaunchDaemons/com.acronis.*\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>KeepAlive</key>\n\t<false/>\n\t<key>Label</key>\n\t<string>com.acronis.acep</string>\n\t<key>ProgramArguments</key>\n\t<array>\n\t\t<string>/Applications/Acronis True Image.app/Contents/MacOS/prl_stat</string>\n\t\t<string>for_scheduler</string>\n\t</array>\n\t<key>StartInterval</key>\n\t<integer>1209600</integer>\n</dict>\n</plist>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>KeepAlive</key>\n\t<dict>\n\t\t<key>SuccessfulExit</key>\n\t\t<false/>\n\t</dict>\n\t<key>Label</key>\n\t<string>com.acronis.mms_mini</string>\n\t<key>ProgramArguments</key>\n\t<array>\n\t\t<string>/Applications/Acronis True Image.app/Contents/MacOS/mms_mini/mms_mini.sh</string>\n\t</array>\n\t<key>RunAtLoad</key>\n\t<true/>\n</dict>\n</plist>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>KeepAlive</key>\n\t<dict>\n\t\t<key>SuccessfulExit</key>\n\t\t<false/>\n\t</dict>\n\t<key>Label</key>\n\t<string>com.acronis.mobile_backup_server</string>\n\t<key>ProgramArguments</key>\n\t<array>\n\t\t<string>/Applications/Acronis True Image.app/Contents/MacOS//mobile_backup_server/mobile_backup_server.sh</string>\n\t</array>\n\t<key>RunAtLoad</key>\n\t<true/>\n</dict>\n</plist>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>KeepAlive</key>\n\t<dict>\n\t\t<key>SuccessfulExit</key>\n\t\t<false/>\n\t</dict>\n\t<key>Label</key>\n\t<string>com.acronis.mobile_backup_status_server</string>\n\t<key>ProgramArguments</key>\n\t<array>\n\t\t<string>/Applications/Acronis True Image.app/Contents/MacOS//mobile_backup_status_server/mobile_backup_status_server.sh</string>\n\t</array>\n\t<key>RunAtLoad</key>\n\t<true/>\n</dict>\n</plist>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>KeepAlive</key>\n\t<dict>\n\t\t<key>SuccessfulExit</key>\n\t\t<false/>\n\t</dict>\n\t<key>Label</key>\n\t<string>com.acronis.scheduler</string>\n\t<key>ProgramArguments</key>\n\t<array>\n\t\t<string>/Applications/Acronis True Image.app/Contents/MacOS/schedul2</string>\n\t</array>\n\t<key>RunAtLoad</key>\n\t<true/>\n\t<key>WorkingDirectory</key>\n\t<string>/Applications/Acronis True Image.app/Contents/MacOS/</string>\n</dict>\n</plist>\n\n```\n\nFix: Install the application with a pkg installer to ensure that the folder permissions are set to `root:wheel` and users can't modify files.\n\n## Impact\n\nLocal privilege escalation",
  "bounty_amount": "300.0",
  "formatted_bounty": "$300",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-03-05T13:45:58.075Z",
  "allow_singular_disclosure_after": -143486222.07086495,
  "singular_disclosure_allowed": true,
  "vote_count": 13,
  "voters": [
    "mr-medi",
    "shreyaschavhan",
    "akashhamal0x01",
    "xsstestov",
    "shamal0x",
    "dreamer_eh",
    "hyenaml",
    "chiharuchan",
    "miladxyz",
    "darkaize",
    "and 3 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 50772,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "Acronis Cyber Protect Home Office (formerly Acronis True Image)",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
