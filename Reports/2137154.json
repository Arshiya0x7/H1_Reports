{
  "id": 2137154,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTM3MTU0",
  "url": "https://hackerone.com/reports/2137154",
  "title": "Mozilla Mastodon Staging Instance Admin API Key Disclosure Through Slack",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2023-09-05T21:31:18.540Z",
  "submitted_at": "2023-09-05T21:31:21.264Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "griffinf",
    "url": "/griffinf",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/l1pj8azaqlm5gjvb9ocru5rfbfj8/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61236,
    "url": "https://hackerone.com/mozilla",
    "handle": "mozilla",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Mozilla",
      "twitter_handle": "",
      "website": "https://www.mozilla.org",
      "about": "Mozilla web bug bounty program specific to encouraging security research in Mozilla's products and web services."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-09-11T16:03:55.015Z",
  "bug_reporter_agreed_on_going_public_at": "2023-09-08T21:46:20.244Z",
  "team_member_agreed_on_going_public_at": "2023-09-11T16:03:54.865Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nI was able to find Admin Maston API Keys disclosed within Mozilla's #trust-and-safety-eng channel which was posted by a staff member of Mozilla.\n\n## Steps To Reproduce:\n\n  1. Authenticate to mozilla.slack.com as an NDA or Mozillla Staff Member (https://wiki.mozilla.org/NDA)\n  2. Search the #trust-and-safety-eng channel for █████████  (Exposed token)\n  3. Validate that the token through the following command:\n\ntok=███\nep=https://stage.moztodon.nonprod.webservices.mozgcp.net\ncurl -H \"Authorization: Bearer $tok\" \"$ep/api/v1/admin/accounts/\" \n\n4. Observe the following output (I've redacted some as it shows the output of all Mastodon accounts):\n\n████████\n\n5. Please note that this was only one API call demonstrated. Maston has the ability to create new accounts, change passwords. delete accounts and delete tweets as referenced within their API documentation here with the  Admin API tokens -  https://docs.joinmastodon.org/methods/accounts/\n\n## Supporting Material/References:\n\nPlease find attached the conversation where the API token was accidentaly leaked.\n\n██████████\n\n## Impact\n\n## Summary:\n\nThe exposure of Admin Mastodon API tokens represents a critical security vulnerability with the potential for severe consequences. These tokens grant unauthorized individuals comprehensive access to the Mastodon server, allowing them to manipulate user data, spread malicious content, and compromise the integrity of the platform. Immediate action is required to mitigate this risk and protect both the system and its users.",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 101,
    "name": "Insecure Storage of Sensitive Information"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-10-08T21:46:20.540Z",
  "allow_singular_disclosure_after": -61597679.70741488,
  "singular_disclosure_allowed": true,
  "vote_count": 22,
  "voters": [
    "zy9ard3",
    "shreyaschavhan",
    "shubham_srt",
    "sudi",
    "h4x0r_dz",
    "f_m",
    "moshakes",
    "saqib98",
    "exception",
    "eminfidan",
    "and 12 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
