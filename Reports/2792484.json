{
  "id": 2792484,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzkyNDg0",
  "url": "https://hackerone.com/reports/2792484",
  "title": "When curl uses Schannel as TLS backend, it fails to enforce TLS 1.3 cipher suite selections correctly",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "medium",
  "readable_substate": "Informative",
  "created_at": "2024-10-18T21:29:31.887Z",
  "submitted_at": "2024-10-18T21:29:32.159Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "newfunction",
    "url": "/newfunction",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/2miia86h6gou58lati8p3usdvhan/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-11-04T22:11:58.739Z",
  "bug_reporter_agreed_on_going_public_at": "2024-11-04T22:11:58.588Z",
  "team_member_agreed_on_going_public_at": "2024-11-04T18:29:24.571Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nThe curl doc page \"SSL Ciphers\" (https://curl.se/docs/ssl-ciphers.html) says: \"Setting TLS 1.3 cipher suites is supported by curl with [...] Schannel (curl 7.85.0+).\" But I find that when curl uses Schannel as its TLS backend, it incorrectly enforces the TLS 1.3 cipher suites selection. For example, if I run `curl.exe --tlsv1.3 --tls13-ciphers TLS_AES_128_GCM_SHA256 -v https://example.com`, curl still accepts cipher suite TLS_AES_256_GCM_SHA384.\n\nI choose \"Medium\" severity because this bug affects the Windows 11 built-in curl (C:\\Windows\\System32\\curl.exe), and thus many batch scripts that invoke curl might be affected. If some TLS 1.3 cipher suites are found to be vulnerable in the future, this bug can give users harder time to disable such insecure TLS 1.3 cipher suites in curl.\n\n## Steps To Reproduce:\n\n  1. Build curl on Windows with Schannel as its TLS backend (I used `nmake /f Makefile.vc mode=static VC=22 ENABLE_SCHANNEL=yes ENABLE_UNICODE=yes` to build curl). You can also repro with Windows 11 built-in curl.exe at `C:\\Windows\\System32\\curl.exe`\n  1. Open WireShark. Capture traffic, and set filter to show traffic to example.com only\n  1. Run `curl.exe --tlsv1.3 --tls13-ciphers TLS_AES_128_GCM_SHA256 -v https://example.com`\n  1. View the TLS handshakes in WireShark. You can see that the Server Hello message shows it uses TLS_AES_256_GCM_SHA384.\n\nReproducible on these curl versions:\n1. The current Windows 11 built-in curl:\n```\nC:\\Windows\\System32>curl.exe -V\ncurl 8.9.1 (Windows) libcurl/8.9.1 Schannel zlib/1.3 WinIDN\nRelease-Date: 2024-07-31\nProtocols: dict file ftp ftps http https imap imaps ipfs ipns mqtt pop3 pop3s smb smbs smtp smtps telnet tftp\nFeatures: alt-svc AsynchDNS HSTS HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTLM SPNEGO SSL SSPI threadsafe Unicode UnixSockets\n```\n\n2. curl built from the source on GitHub. Version 8.11.0-DEV. Commit e29629a402a32e1eb92c0d8af9a3a49712df4cfb\n```\ncurl 8.11.0-DEV (x86_64-pc-win32) libcurl/8.11.0-DEV Schannel WinIDN\nRelease-Date: [unreleased]\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns ldap ldaps mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp ws wss\nFeatures: alt-svc AsynchDNS HSTS HTTPS-proxy IDN IPv6 Kerberos Largefile NTLM SPNEGO SSL SSPI threadsafe UnixSockets\n```\n\n## Supporting Material/References:\n\n  * https://curl.se/docs/ssl-ciphers.html\n\n## Impact\n\nWhen users specify `--tls13-ciphers` parameter, curl silently uses a TLS 1.3 cipher suite that is not selected by users. This can cause TLS connections use weak cipher suites. If in the future `TLS_AES_256_GCM_SHA384` becomes weak or broken, and users want to use `TLS_AES_128_GCM_SHA256` (or vice versa), curl can potentially leak data to man-in-the-middle attackers, because curl uses the wrong cipher.",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 19,
  "voters": [
    "aboalezz",
    "zy9ard3",
    "thalaivar304",
    "spaghettisec",
    "mohaned0101",
    "shuvonsec1",
    "kashmirimunda",
    "oleh_durasov",
    "sudooer",
    "hariharasuthan10",
    "and 9 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
