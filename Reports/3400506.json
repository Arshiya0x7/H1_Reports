{
  "id": 3400506,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDAwNTA2",
  "url": "https://hackerone.com/reports/3400506",
  "title": "Stored XSS in Conversion Statistics via Tracker Name",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2025-10-26T19:51:25.798Z",
  "submitted_at": "2025-10-26T19:51:26.037Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "cyberjoker",
    "url": "/cyberjoker",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/m8QAvis1NEdKwiqa3zKinxSk/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2367,
    "url": "https://hackerone.com/revive_adserver",
    "handle": "revive_adserver",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Revive Adserver",
      "twitter_handle": "",
      "website": "https://www.revive-adserver.com",
      "about": "Revive Adserver is a free open source ad serving system"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2025-52668"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-11-19T09:33:37.769Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-11-19T09:33:23.756Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I found stored XSS on the conversion statistics page. Advertisers can inject malicious JavaScript through tracker names, which executes when admins view conversion reports (`www/admin/stats-conversions.php:356`). I was able to steal admin session cookies using this vulnerability. This is a privilege escalation problem: low-privilege advertiser accounts can compromise high-privilege admin accounts.\n\n--\n\n---\n\n## Affected System\n\n- **Product:** Revive Adserver\n- **Version Tested:** 6.0.1\n- **Component:** Statistics / Conversion Reports\n- **File:** `www/admin/stats-conversions.php:356`\n- **URL:** `http://[host]/www/admin/stats-conversions.php?clientid=[id]`\n\n---\n\n## Vulnerable Code\n\n```php\n// www/admin/stats-conversions.php:356\necho \"<td align='$phpAds_TextAlignLeft' style='padding: 0 4px'>{$conversion['trackername']}</td>\n      <td align='$phpAds_TextAlignLeft' style='padding: 0 4px'>{$conversion['campaignid']}</td>\n      <td align='$phpAds_TextAlignLeft' style='padding: 0 4px'>{$conversion['campaignname']}</td>\";\n```\n\n**The Problem:**\n- Tracker names are output directly without `htmlspecialchars()` escaping\n- The data comes from advertiser-controlled input (tracker creation form)\n- No input validation strips HTML tags at storage time\n- Admins viewing conversion reports execute the payload in their browser context\n\n---\n\n## How I Reproduced It\n\n**Prerequisites:**\n- Advertiser account (low privileges)\n- Admin account to view the report (for testing impact)\n\n**Steps:**\n\n1. **Login as advertiser** and create a malicious tracker:\n   - Navigate to: **Inventory** → **Advertisers** → Click your advertiser name (e.g., \"Test Advertiser\") → **Trackers** tab\n   - Click **Add new tracker**\n   - Set tracker name to:\n     ```html\n     <img src=x onerror=\"alert('XSS: ' + document.cookie)\">\n     ```\n   - Set tracker type to \"Sale\" and status to \"Active\"\n   - Click **Save Changes**\n   - The tracker is now saved (tracker ID 1)\n\n{F4935037}\n\n2. **Create conversion records** (via normal tracking or database):\n   ```sql\n   -- Link conversion to malicious tracker\n   INSERT INTO rv_data_intermediate_ad_connection (\n       tracker_id, ad_id, inside_window, tracker_date_time,\n       connection_date_time, connection_action, connection_status, updated\n   ) VALUES (1, 1, 1, NOW(), NOW(), 1, 4, NOW());\n   ```\n\n3. **Login as admin** and navigate to:\n   ```\n   http://[host]/www/admin/stats-conversions.php?clientid=1\n   ```\n   **Note:** This page may not be accessible via the menu in default/fresh installations. See \"Menu Configuration Note\" in the Notes section below for details.\n\n4. **Result:** JavaScript alert fires immediately:\n   ```\n   XSS: sessionID=abc123; ox_install_session_id=def456\n   ```\n{F4935020}\n\nI confirmed the XSS executes in the admin's browser context with full cookie access. The payload persists - it fires every time any admin views conversion statistics for that advertiser.\n\n---\n\n## Notes\n\n**Additional Findings:**\n\nWhile investigating this issue, I noticed:\n- Lines 357-358 also lack `htmlspecialchars()` on `campaignid` and `campaignname`\n- Campaign names are also user-controlled (by advertisers) and suffer from the same vulnerability\n- Other `stats-*.php` files may have similar issues - I haven't audited them all yet\n\n**Testing Scope:**\n\nI tested this vulnerability in an isolated Docker environment using accounts I created. I did not:\n- Test against production/public Revive Adserver installations\n- Attempt actual exploitation beyond controlled PoC\n- Exfiltrate or access any real user data\n\n**Menu Configuration Note:**\n\n**Important:** The stats-conversions.php page is not included in the default menu system on fresh Revive Adserver installations. During testing, I had to manually enable it by modifying `lib/OA/Admin/Menu/config.php` to add the menu entry:\n\n```php\n$oMenu->addTo(\"2.1\", new OA_Admin_Menu_Section(\"stats-conversions\",\n    'Conversions', \"stats-conversions.php?clientid={clientid}\",\n    false, \"statistics/conversions\"));\n```\n\nThis is likely a configuration issue rather than a security control, as:\n- The code-level permission check (`OA_Permission::enforceAccount`) allows advertiser/manager access\n- Other statistics pages with similar data are accessible\n- The vulnerable code exists regardless of menu visibility\n\n## Impact\n\nAn advertiser (or compromised advertiser account) can inject persistent XSS that executes when admins view conversion statistics. I successfully captured admin session cookies, which enable full account takeover. The attacker can then create admin accounts, modify campaigns, access all advertiser data, or inject code affecting all users. This works because advertisers routinely create trackers, and admins routinely review conversion statistics - no unusual behavior required.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 4935020,
      "file_name": "CleanShot_2025-10-26_at_17.15.02_2x.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hfhwape5zbvo6707qoub7kxjb2up?response-content-disposition=attachment%3B%20filename%3D%22CleanShot_2025-10-26_at_17.15.02_2x.png%22%3B%20filename%2A%3DUTF-8%27%27CleanShot_2025-10-26_at_17.15.02_2x.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRV7I7SFS%2F20251119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251119T101621Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJIMEYCIQD0Wi6qQNr09xId1iXuCvgRD2A7PTXa9IJMXhqXt%2Bb90gIhAM19n%2BbpkKfkV35Oa17DZ0f6KvzqROgXqY1k9htedwOiKroFCNr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgxAqGxKg4thTG9Puw0qjgVoL6zt%2B6qcGBOszAA1JlseTsBptFDlPyy5EE7WApIb5jKdL7%2FQXK%2BIS%2By03CVC5moiKwf16YOyE9FwxE%2B9nyUDSxFfgnTzvTw4unKIDL80MEySM4KmlGrjMXHmuig%2Fnr9BBNEzGCzAj%2FNk73KpVbamOMEZ7JxSIy%2Bv457RXd%2FaHB70sDvjvqD6eNFCFe3BbYIhJ6wJrwZ59LDRaUfhmhJcoIwlIK3SEpgQ%2FS%2Bk%2FdneO6IgokbN6hSwuwLNYChrV%2F7BgcVMQWulxIhv1LjxqhUoC3JApig8bamSr90n%2FjpoOMURr8WCtcBu6iygXI4yHZ6Ir7Gxrn2HBz1iL2ZLLXFNpILKqEygzFIAqrwApaZRGqoZxIpE0AeNas0Vf5iZMMxUC5Pkg0cAel%2BdUxYynE2almdFQIl28emwd2Y8f5nd6yJgk3QiY6JvYeyuQfUwncjKFZC6MO68qhDUQxW0wDXtFPr8eSNEAe1Ja2q3RDbNTh7zkUcW1aInmwysA76vDY0iz8ybK7o%2BBPWM7bVXBqSw7rjNZi3rzvWZVSbZ%2F2MsKSa%2BmOTQ%2BcH2jE7hDu%2FdCXJq2GpimZZOc1dagcSmOOXs61vIQ5FHTxO6e3eBfubf9AJAYoLQdFPienluN%2Fqs5sVZPw1oMoYDt14SoZSz81l6XNj7MysvzoCkmEgvbjs0%2BUCEeLuWUZyK9g1oV6G9tH0WJjsyQCMKIH3x%2FSKyud3cWP%2BD6jiJWQLfK9awofQgW4JXaQeZ1XRntg57YA7sbXtNbUiGe4%2BAHJh6b2G16ViTG7120bGaWOSGZEfVLtv16iGHGl3mPaxhenzx5JX4ufqlvhIfEJC7EtTqcsnP5fqoUkW1EjoyoYPAXa%2B%2F1XUwt5X2yAY6sAE42mhy%2FkPAimPr6oQuJ7IM1RhT0ZCVVB31wC1rOugCDcpuV23qIByp87Hl96VZH0oz9UgaQVFHngR4tKo1lDLvTchuM1vlQUJUbw1fxBfHYY3UKKdZb4xs4G2WPdEflwmtVV%2Bqtn3qUHQoXcbLKJ3%2BR0bbuZ6e%2BoPO9OMEBgEdDwexC5b0Gw5IVEw5D7YuBLOK0cOMa%2Bu%2B3Vpvck1I3vOC94%2BMnDObFWAYORCjgD1vdQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5ba18ab351989e46046c2eb0301be4c3a0a6f128bb7290fc68b3296f506d3122",
      "file_size": 385494,
      "type": "image/png",
      "moderated": false
    },
    {
      "id": 4935037,
      "file_name": "CleanShot_2025-10-26_at_21.44.06_2x.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/f34mjbx6ar9xed9ztxbb4ke6q0r2?response-content-disposition=attachment%3B%20filename%3D%22CleanShot_2025-10-26_at_21.44.06_2x.png%22%3B%20filename%2A%3DUTF-8%27%27CleanShot_2025-10-26_at_21.44.06_2x.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRV7I7SFS%2F20251119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251119T101621Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJIMEYCIQD0Wi6qQNr09xId1iXuCvgRD2A7PTXa9IJMXhqXt%2Bb90gIhAM19n%2BbpkKfkV35Oa17DZ0f6KvzqROgXqY1k9htedwOiKroFCNr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgxAqGxKg4thTG9Puw0qjgVoL6zt%2B6qcGBOszAA1JlseTsBptFDlPyy5EE7WApIb5jKdL7%2FQXK%2BIS%2By03CVC5moiKwf16YOyE9FwxE%2B9nyUDSxFfgnTzvTw4unKIDL80MEySM4KmlGrjMXHmuig%2Fnr9BBNEzGCzAj%2FNk73KpVbamOMEZ7JxSIy%2Bv457RXd%2FaHB70sDvjvqD6eNFCFe3BbYIhJ6wJrwZ59LDRaUfhmhJcoIwlIK3SEpgQ%2FS%2Bk%2FdneO6IgokbN6hSwuwLNYChrV%2F7BgcVMQWulxIhv1LjxqhUoC3JApig8bamSr90n%2FjpoOMURr8WCtcBu6iygXI4yHZ6Ir7Gxrn2HBz1iL2ZLLXFNpILKqEygzFIAqrwApaZRGqoZxIpE0AeNas0Vf5iZMMxUC5Pkg0cAel%2BdUxYynE2almdFQIl28emwd2Y8f5nd6yJgk3QiY6JvYeyuQfUwncjKFZC6MO68qhDUQxW0wDXtFPr8eSNEAe1Ja2q3RDbNTh7zkUcW1aInmwysA76vDY0iz8ybK7o%2BBPWM7bVXBqSw7rjNZi3rzvWZVSbZ%2F2MsKSa%2BmOTQ%2BcH2jE7hDu%2FdCXJq2GpimZZOc1dagcSmOOXs61vIQ5FHTxO6e3eBfubf9AJAYoLQdFPienluN%2Fqs5sVZPw1oMoYDt14SoZSz81l6XNj7MysvzoCkmEgvbjs0%2BUCEeLuWUZyK9g1oV6G9tH0WJjsyQCMKIH3x%2FSKyud3cWP%2BD6jiJWQLfK9awofQgW4JXaQeZ1XRntg57YA7sbXtNbUiGe4%2BAHJh6b2G16ViTG7120bGaWOSGZEfVLtv16iGHGl3mPaxhenzx5JX4ufqlvhIfEJC7EtTqcsnP5fqoUkW1EjoyoYPAXa%2B%2F1XUwt5X2yAY6sAE42mhy%2FkPAimPr6oQuJ7IM1RhT0ZCVVB31wC1rOugCDcpuV23qIByp87Hl96VZH0oz9UgaQVFHngR4tKo1lDLvTchuM1vlQUJUbw1fxBfHYY3UKKdZb4xs4G2WPdEflwmtVV%2Bqtn3qUHQoXcbLKJ3%2BR0bbuZ6e%2BoPO9OMEBgEdDwexC5b0Gw5IVEw5D7YuBLOK0cOMa%2Bu%2B3Vpvck1I3vOC94%2BMnDObFWAYORCjgD1vdQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8eca458d73a1d6d32aa038cd25c673fd0f4788ba81920d82498411658b3a5fc8",
      "file_size": 257650,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2025-12-19T09:33:24.140Z",
  "allow_singular_disclosure_after": 2589422.996803692,
  "singular_disclosure_allowed": false,
  "vote_count": 1,
  "voters": [
    "2026"
  ],
  "severity": {
    "rating": "high",
    "score": 8.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 154,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/revive-adserver/revive-adserver",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
