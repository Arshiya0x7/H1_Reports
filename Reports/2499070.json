{
  "id": 2499070,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDk5MDcw",
  "url": "https://hackerone.com/reports/2499070",
  "title": "DOS: taking down a 1k users Gitlab EE instance or multiple Sidekiq instances by importing a malicious repo from a Github EE self-hosted server",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2024-05-10T10:48:52.664Z",
  "submitted_at": "2024-05-10T10:48:52.830Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "a92847865",
    "url": "/a92847865",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/5ay9qyc41rwqjlfh8t7uyvyk6a9y/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-10-09T17:49:43.372Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2024-10-09T17:49:26.601Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 61,
  "voters": [
    "mirzaaghazadeh",
    "k0ns0l",
    "n1m0",
    "zy9ard3",
    "ali_saadi20",
    "d3f7ult",
    "thebeast99",
    "ronak_9889",
    "thalaivar304",
    "snvm",
    "and 51 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 39022,
    "asset_type": "OTHER",
    "asset_identifier": "Your Own GitLab Instance",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 549777,
      "category": "team",
      "content": "This report described a vulnerability in GitLab where an attacker could cause a server side denial of service by importing a malicious payload via the GitHub importer functionality.\n\nMore details can be found https://gitlab.com/gitlab-org/gitlab/-/issues/463092",
      "updated_at": "2024-10-09T21:50:48.704Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2472179,
        "username": "gmyers",
        "name": "Greg Myers",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2022-09-30T21:36:42.319Z",
        "url": "https://hackerone.com/gmyers",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "id": 541183,
      "category": "researcher",
      "content": "**Any  server side application using Octokit/Sawyer without response size validation could be vulnerable to this type of attack (I don't think there're many though).**\n\nWhen importing a project from Github (dotcom or GHES) server, Gitlab uses Octokit to fetch necessary infos (repo, contributors, pull requests, notes,...).\n\nUnder the hood, Octokit uses [Sawyer](https://github.com/lostisland/sawyer) as its hypermedia agent. Github API requests will return ```Sawyer::Resource``` objects. A  ```Sawyer::Resource``` object is placeholder of around 10 nested Ruby objects (most of them are Ruby Hash objects). **Parsing a 1MB data (response) into ```Sawyer::Resource``` objects results in allocating 250MB memory.** Parsing some responses concurrently would cause OOM-killed to the Puma main process --> knocking down Gitlab web services. It takes around 2 minutes for the Puma main process and all workers to restart.\n\nIt is also possible to take down multiple Sidekiq (batch processing worker) instances by sending only one malicious import request. In some stages of importing process, multiple Sidekiq instances are used to run import-related jobs in parallel. Each of those jobs also use Octokit to fetch resources from our fake Github EE server --> possibly being taken down at the same time.\n\nI've reviewed some hypermedia agents in other languages (for both server side and client side applications), there's none other hypermedia library with such weird response processing as Sawyer. \n\nPS: Because it's my first H1 report,  there're many silly errors and wrong assumptions in it. So thanks @h1_analyst_indy and @gmyers for your patience while handling this report.\nPS1: Thanks @ammar2 for below blog post about an issue that \"allowed anyone to send certain malformed packets and crash a MineCraft server by running it out of memory\". I found this issue just after having read your post.\nhttps://blog.ammaraskar.com/minecraft-vulnerability-advisory/",
      "updated_at": "2024-10-21T09:42:59.283Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 3048659,
        "username": "a92847865",
        "name": "a92847865",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2024-01-11T08:03:48.773Z",
        "url": "https://hackerone.com/a92847865",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/5ay9qyc41rwqjlfh8t7uyvyk6a9y/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/5ay9qyc41rwqjlfh8t7uyvyk6a9y/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6Njc1ODQxMywicHVyIjoiYmxvYl9pZCJ9fQ==--4bece855fe2981c8655906787793ddec45a6b96c/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/472706915_8717299901714223_3563512153978113792_n.jpg"
        }
      }
    }
  ]
}
