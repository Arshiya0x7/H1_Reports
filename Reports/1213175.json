{
  "id": 1213175,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjEzMTc1",
  "url": "https://hackerone.com/reports/1213175",
  "title": "CVE-2021-22922: Wrong content via metalink not discarded",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-05-30T20:49:36.999Z",
  "submitted_at": "2021-05-30T20:49:37.048Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nyymi",
    "url": "/nyymi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-22922"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-07-21T16:28:42.717Z",
  "bug_reporter_agreed_on_going_public_at": "2021-07-21T16:28:42.650Z",
  "team_member_agreed_on_going_public_at": "2021-07-21T16:28:09.664Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nWhen compiled `--with-libmetalink` and used with `--metalink` curl does check the cryptographics hash of the downloaded files. However, the only indication that the hash was incorrect is a message displayed to the user. The files with incorrect hashes are left to the disk as-is.\n\nSince curl implements the hash validation and reports incorrect hashes there might be an expectation that files with incorrect hashes would not be kept either. Since the metalink can be used with insecure protocols such as http and ftp, the hash validation might be used an actual way to verify the download integrity against tampering.\n\n## Steps To Reproduce:\n\n  1.Configure libcurl `--with-libmetalink` and build libcurl\n  2. Have metalinktest.xml with `<file name=\"testfile\">` containing incorrect sha-256 hash for it.\n  3. Execute: `curl --metalink https://testsite/metalinktest.xml`\n\nThe following message will be displayed:\n`Metalink: validating (testfile) [sha-256] FAILED (digest mismatch)`\n\nYet, the downloaded file `testfile` with incorrect hash mismatch is kept.\n\n## Fix\nIt might be more sensible to download the file to a temporary name first, verify the hash and only then store the file to final name if the hash is correct. If hash mismatch is found remove the temporary file.\n\n## Impact\n\nModified or tampered files are kept and possibly incorrectly assumed valid",
  "bounty_amount": "700.0",
  "formatted_bounty": "$700",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-08-20T16:28:09.785Z",
  "allow_singular_disclosure_after": -128944040.03640506,
  "singular_disclosure_allowed": true,
  "vote_count": 5,
  "voters": [
    "neeythann",
    "hg_real",
    "thalaivar304",
    "mohaned0101",
    "ekgaribadmi"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
