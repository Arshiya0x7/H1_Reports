{
  "id": 2038484,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDM4NDg0",
  "url": "https://hackerone.com/reports/2038484",
  "title": "DiffieHellman doesn't generate keys after setting a key",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-06-26T10:18:46.123Z",
  "submitted_at": "2023-06-26T10:18:46.197Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bensmyth",
    "url": "/bensmyth",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjgwMjQ2OCwicHVyIjoiYmxvYl9pZCJ9fQ==--6988c49718822a0071d8b35bbbcec885cdfdfb77/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/Untitled.jpg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3AVXWWVJ%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T204106Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIQDfgy%2F8qvBwVwQeVtAraQuZJJXh7f%2BpoofWWWSYfCiMagIgfWxBN9ZRuZaArCBtPxzNhyUwZ7pDg6BBv0oryhrslH4quwUI9f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNdRNHCW%2B8SMnIzDlCqPBeWv77%2FKW%2FeSBC8ys57GgxwPt%2BPN54Bnxo77RyoRnrXtcwWa94u%2FhPCzPEURQnlmuxQVUwE7SbPWKVvFaV14JnfamLt8tiLXvJI0FhOIHg75dBhW26aSzygYdUnSMNGRocT7VgPMJRu2%2BetFYQDxSgIIcUWn85QprS7HW83bAaMpgJ9B9hJrj1YXBja1RCNQCywBVcMWmxidrXDvuE1f8Phr2kFVnq5etEMxDTPvgz%2FmIynJhksw6F0zkS%2FYVGIvPIKUb4UeEreKuzi2jK222bc5MdRUj%2BqkkJEveZ1uM8Exxegc9eBMg3PyOkPS91%2BX8o01b2yteFMSaWpOJ4pxD0SBiMfT%2B6fcvIOghYVXzZqilZTsehJ%2BGtfqpWYG3%2BqStOgeIkxo0cIUVjkfGnG3z1wfK2sfT6WCsbUDvhe21T15vWTSUDBiXLIZOLhj5XH%2BLstpbC7qdbLPmPJVWtA1funwW6h7%2B85cdo65sQuxWAK2x%2FODo3IdjHYuV2vEv8yfUC05iItqxuQ3WaQW6%2Fr4mTrSQMQm4aCSXO12IuuaL4U0tBi7KhaJt%2FgiDnJB17Av0mc%2BG3a2kff3tdp4SGx3OpeAPV77Xcu%2FbTzCWULR4scHJSzcTtTjLHrXGt5PAQezd9VSwKbm%2FAkUZdHnyxg7OsaBH1dn0rkWkiPlfoB0Oe%2FG3DpUvCcZSGqNC%2BYztrJrbYdX%2FMreBNnwUGK5UY9Y0YbZkuvg%2Bd9wl2b%2B4eD52%2BkFocfM5fyF%2FJ9n0xMrOtSt8so2S0w7yfj2faIu6uBhChJYzuRRMmmqMHLFlElCZHLOsDG6dvphFT2wXIwMmGiu3Jt2HBYUYdaXs2qGF2Yxlh8YSy0hX%2BNbMwZ2u5TZjdww4Za8xgY6sQGDm3y7UmSXR4Rgykodp%2FU4h%2FscUPx%2FMaOermviZqP1IRm%2BtCtDQX7txkOrjEtfU3hWgqIy2OZ%2BJ60a1fvXiH2q6StnkYBXHwlXk56zWOTx4MhJclHBSND0vGeGDIsgd0JlzG%2BHDOW9NWIe%2FNRu1P9gl68bTczwGtecIU1miL0%2Bo6x31p%2BuzNmV1yO5S4BA4i9tcbgg3e1oe4Ketr%2ByLmSna7sZQK%2BRsGlqjij0%2FrEMP%2FY%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ed056a31bb1ec7eae1d1a2fcccbe980f3cd28eb7e14d5206faea10c725a13592",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3AVXWWVJ%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T204106Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIQDfgy%2F8qvBwVwQeVtAraQuZJJXh7f%2BpoofWWWSYfCiMagIgfWxBN9ZRuZaArCBtPxzNhyUwZ7pDg6BBv0oryhrslH4quwUI9f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDNdRNHCW%2B8SMnIzDlCqPBeWv77%2FKW%2FeSBC8ys57GgxwPt%2BPN54Bnxo77RyoRnrXtcwWa94u%2FhPCzPEURQnlmuxQVUwE7SbPWKVvFaV14JnfamLt8tiLXvJI0FhOIHg75dBhW26aSzygYdUnSMNGRocT7VgPMJRu2%2BetFYQDxSgIIcUWn85QprS7HW83bAaMpgJ9B9hJrj1YXBja1RCNQCywBVcMWmxidrXDvuE1f8Phr2kFVnq5etEMxDTPvgz%2FmIynJhksw6F0zkS%2FYVGIvPIKUb4UeEreKuzi2jK222bc5MdRUj%2BqkkJEveZ1uM8Exxegc9eBMg3PyOkPS91%2BX8o01b2yteFMSaWpOJ4pxD0SBiMfT%2B6fcvIOghYVXzZqilZTsehJ%2BGtfqpWYG3%2BqStOgeIkxo0cIUVjkfGnG3z1wfK2sfT6WCsbUDvhe21T15vWTSUDBiXLIZOLhj5XH%2BLstpbC7qdbLPmPJVWtA1funwW6h7%2B85cdo65sQuxWAK2x%2FODo3IdjHYuV2vEv8yfUC05iItqxuQ3WaQW6%2Fr4mTrSQMQm4aCSXO12IuuaL4U0tBi7KhaJt%2FgiDnJB17Av0mc%2BG3a2kff3tdp4SGx3OpeAPV77Xcu%2FbTzCWULR4scHJSzcTtTjLHrXGt5PAQezd9VSwKbm%2FAkUZdHnyxg7OsaBH1dn0rkWkiPlfoB0Oe%2FG3DpUvCcZSGqNC%2BYztrJrbYdX%2FMreBNnwUGK5UY9Y0YbZkuvg%2Bd9wl2b%2B4eD52%2BkFocfM5fyF%2FJ9n0xMrOtSt8so2S0w7yfj2faIu6uBhChJYzuRRMmmqMHLFlElCZHLOsDG6dvphFT2wXIwMmGiu3Jt2HBYUYdaXs2qGF2Yxlh8YSy0hX%2BNbMwZ2u5TZjdww4Za8xgY6sQGDm3y7UmSXR4Rgykodp%2FU4h%2FscUPx%2FMaOermviZqP1IRm%2BtCtDQX7txkOrjEtfU3hWgqIy2OZ%2BJ60a1fvXiH2q6StnkYBXHwlXk56zWOTx4MhJclHBSND0vGeGDIsgd0JlzG%2BHDOW9NWIe%2FNRu1P9gl68bTczwGtecIU1miL0%2Bo6x31p%2BuzNmV1yO5S4BA4i9tcbgg3e1oe4Ketr%2ByLmSna7sZQK%2BRsGlqjij0%2FrEMP%2FY%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5f02e2da7a839c1d40d2b5d79f15cfb6330030960c2c57b6c2d881adb5a984fa"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-30590"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-06-30T14:05:28.179Z",
  "bug_reporter_agreed_on_going_public_at": "2023-06-30T14:05:28.101Z",
  "team_member_agreed_on_going_public_at": "2023-06-29T13:24:36.095Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "DiffieHellman doesn't generate keys after setting a key\n\n## Steps To Reproduce:\n\n  1. Instantiate: `const dh = crypto.createDiffieHellman(1024);`\n  2. Set private key: \n```\n//set private key to 2\ndh.setPrivateKey(Buffer.from(\"02\", 'hex'));        \n//outputs 02 (as expected)\nconsole.log(dh.getPrivateKey().toString('hex'));  \n```\n  3. Generate random private key:\n```\n//generate random private key\ndh.generateKeys();                                 \n//outputs 02: zero day.\nconsole.log(dh.getPrivateKey().toString('hex'));   \n```\n\n## Underlying issue:\n\nOpenSSL (https://github.com/majek/openssl/blob/master/crypto/dh/dh_key.c) doesn't generate keys when they're already instantiated: \n\n```\nif (dh->priv_key == NULL)\n  {\n  priv_key=BN_new();\n  if (priv_key == NULL) goto err;\n  generate_new_key=1;\n  }\nelse\n  priv_key=dh->priv_key;\n\nif (dh->pub_key == NULL)\n  {\n  pub_key=BN_new();\n  if (pub_key == NULL) goto err;\n  }\nelse\n  pub_key=dh->pub_key;\n```\n\nnode:crypto should use OpenSSL correctly. Method `generateKeys()` should re-instantiate OpenSSL before requesting a key, thereby avoiding the above.\n\n## Impact\n\nA nonce must be used just once; using a nonce more than once is a security vulnerability. As concrete examples: Forward secrecy of TLS and IND-CPA of ElGamal would be trivially lost if Node.js's DH were used as a building block. \n\nThis vulnerability is devastating to any developers that have used nodejs in accordance with documentation. Developers have chosen to fix documentation rather than code, unfortunately, nodejs is potentially introducing gaping security holes to anyone using code as original directed.",
  "bounty_amount": "1800.0",
  "formatted_bounty": "$1,800",
  "weakness": {
    "id": 32,
    "name": "Cryptographic Issues - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-07-29T13:24:36.185Z",
  "allow_singular_disclosure_after": -67763789.85961759,
  "singular_disclosure_allowed": true,
  "vote_count": 33,
  "voters": [
    "n1m0",
    "zy9ard3",
    "shreyaschavhan",
    "savitar0x01",
    "f_m",
    "0xnayel",
    "darky_os",
    "ysthas",
    "bensmyth",
    "r-akshay0002",
    "and 23 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 83651,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/nodejs/node",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
