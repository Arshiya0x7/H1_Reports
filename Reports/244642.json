{
  "id": 244642,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ2NDI=",
  "url": "https://hackerone.com/reports/244642",
  "title": "Forgot password link doesn't expire after used, only after some hours",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2017-06-30T05:32:22.026Z",
  "submitted_at": "2017-06-30T05:32:22.026Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mohammad_obaid",
    "url": "/mohammad_obaid",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/131/334/48beb15ae8dbb3cfdf59ca392d153fe7ba8cf1a0_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 21801,
    "url": "https://hackerone.com/wakatime",
    "handle": "wakatime",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "WakaTime",
      "twitter_handle": "wakatime",
      "website": "https://wakatime.com",
      "about": "Automated metrics about your programming from text editor plugins."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-07-03T06:42:58.087Z",
  "bug_reporter_agreed_on_going_public_at": "2017-06-30T10:15:52.449Z",
  "team_member_agreed_on_going_public_at": "2017-07-03T06:42:58.008Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi, Hope you guys are doing great. I want to report couple of issues regarding forgot password mechanism. \n##1st ISSUE:\nOne thing I noticed that when password rest link is requested and user change its password, that reset link should expire immediately but in your case , used reset link can be reused again and again. This will cause an attacker to take over victim account if he somehow gain victim email account access and found password reset token in emails.\n##POC:\n1- Go to https://wakatime.com/reset_password\n2- Enter your email address and you will get one password reset token in your email.\n3- Now change password using that link and you will be successfully log in from your new password.\n4- Now log out and change password again using reset token which is sent in step2.\n5- You will see your password will again changed.\n\n##2nd ISSUE:\nSecond issue I want to report is that when multiple token is requested , previous one should be expired immediately which in your case is not.\nThis will cause an attacker to take over victim account if he somehow gain victim email account access and found unused password reset token in emails.\n\n##POC:\n1- Go to https://wakatime.com/reset_password\n2- Enter your email address and you will get one password reset token in your email. Call this token1.\n3- No repeat step 1 and 2 and you will get another rest token. Call this token2\n3- Now change password using token2 and you will be successfully log in from your new password.\n4- Now log out and change password again using  token1 which is sent in step2.\n5- You will see your password will again changed.\n\n##POSSIBLE FIX:\nAll used password reset link should be expired immediately.\nAll unused password reset token should be expired immediately with the issue of new token .\n\n",
  "weakness": {
    "id": 92,
    "name": "Weak Password Recovery Mechanism for Forgotten Password"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-07-30T10:15:52.496Z",
  "allow_singular_disclosure_after": -257080892.19118562,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "eveeez",
    "pr0f0x01",
    "bb00x",
    "exception",
    "japz",
    "salah_rizki"
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 4668,
      "category": "team",
      "content": "Password reset links expired after 12 hours. Now they also expire when the password has been changed.",
      "updated_at": "2017-07-04T01:02:58.611Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 175849,
        "username": "alanhamlett",
        "name": "Alan Hamlett",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://wakatime.com",
        "location": "San Francisco, CA",
        "created_at": "2017-06-14T16:56:11.718Z",
        "url": "https://hackerone.com/alanhamlett",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/6l6usy1n2wl4kdtln91jre4g2d5n/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/6l6usy1n2wl4kdtln91jre4g2d5n/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NTcyODIyMywicHVyIjoiYmxvYl9pZCJ9fQ==--3b225fa885fa6c2aa59c15f0bc094d1466b24517/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/avatar.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
