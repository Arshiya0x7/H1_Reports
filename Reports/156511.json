{
  "id": 156511,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTY1MTE=",
  "url": "https://hackerone.com/reports/156511",
  "title": "Incorrect logic in MySQL & MariaDB protocol leads to remote SSRF/Remote file read",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-08-04T14:18:37.287Z",
  "submitted_at": "2016-08-04T14:18:37.287Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "squashbroom",
    "url": "/squashbroom",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWLIXK7KK%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132514Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCn9dBDjuRnR6R6gwO7wx1V9VTCorPNrsiHfcpQFucMbgIga98tHzwspPe%2FMy%2FsxRSx9minsZ%2FmvaaRCrdbchOwi8MqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDOfrddDnnKJLEaVlcSqPBfc6dsF029BlI%2Bzcy0u3riyL4%2F%2FT8xwtdkFDq1v%2BQabUqM9VNCUvDv7%2FWtv5itm3mLChE%2FgPaggTV0x1i4M9I96rP1Tdx734GZtatA9caD0YziJznRTFhZdv%2BRpZyqW0x%2BDBWmkbnL3q9Mk2VqWGuv8w0WORhVkr4U%2FwRPgCzLAhLmRIBtlGR3Le2jV5izWW%2FiA%2Bf1VF%2F4NRpjSpghXMCMfWFc%2B%2FoHd6Wx8j5FDXlE5MWsh80fs6d%2BW%2BxlwigGZiMnj1JTbOJkwOMap0zEoscOF4D2%2FoN7V6DeI3J7XqFN9oNB8hnPJdHB6tQpL8WGDV1jlfkfiOZPgJl2YRYT3VR%2F6PiV9ep5i7rm%2BRdQSo8dXy%2BfO573cpC4qYbOku4H0hb8Fphn24zLF7xfIRfvxEkjhvCkj6lS6sLM%2FnLqOxjn%2BLpJ%2FlY%2FL%2BBYIuaVPtIRs5qcp9L9UqnSDMtgkM3Mz0z5SWl5HxDRdxvfCCuyKUUNmTVams1QJBlVA%2BdYMt%2ByxelC%2BwpnG1PPTfmEonQn%2FYp4kODNrhsXvXelOeN7kZobZPGu4%2B7bVbNinz2qD%2Br2yCTjvjFqwAFCo9WlKaheGttma8EXZB61nf28NRE4J%2FEJ9WmT3aOBUvHDxbx6npxblNmsoexiEUKtlU6govA%2ByAMHswQidvdg9KEkEKlH4y7tFfmMeqf6iNRhhDz1FSIY98LQeNqswenjrx9ZR7n7kxipXGpSAPqVBcwDdS9tply%2BdNvqgyt5QNcP%2FIbbVHpppKANGqJVb4FpkajI2KOva%2Bixf1meJEdCm5OjL5pPuuGqyVZRw%2FQ8S8uX38e7ftk%2BLHhMhPAdw1R7UxZzic8TTUrGwzA%2FIVMziQ6bSVobTS8Bsw2d6%2FxgY6sQFM%2B90JI1LEO4gKDDWGfro2TDqdvKNUO%2Fvlb3svsloHnDao94fo%2F%2B3Ol%2FaogxtrDavOPVXuINmcNsIMdhE7eJrmttrpl7ilZclTNPMTu10XV8QWwX19%2F0HFf%2BUEVINni3fExXGHohjy3vo40Ac8cmd3D%2FpVgn%2BLhUVMBm9Y1A7EjU59wdGt49wIk9a387%2FWElmuu5RqXQqqrsQ9uelZBSyRqZFNO0jvoeWtkr%2B5%2BBzLIWg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a7eb312bef46def7016642d8251b7396144ee78bc3a74243ae3da3d85231600d",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWLIXK7KK%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132514Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCn9dBDjuRnR6R6gwO7wx1V9VTCorPNrsiHfcpQFucMbgIga98tHzwspPe%2FMy%2FsxRSx9minsZ%2FmvaaRCrdbchOwi8MqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDOfrddDnnKJLEaVlcSqPBfc6dsF029BlI%2Bzcy0u3riyL4%2F%2FT8xwtdkFDq1v%2BQabUqM9VNCUvDv7%2FWtv5itm3mLChE%2FgPaggTV0x1i4M9I96rP1Tdx734GZtatA9caD0YziJznRTFhZdv%2BRpZyqW0x%2BDBWmkbnL3q9Mk2VqWGuv8w0WORhVkr4U%2FwRPgCzLAhLmRIBtlGR3Le2jV5izWW%2FiA%2Bf1VF%2F4NRpjSpghXMCMfWFc%2B%2FoHd6Wx8j5FDXlE5MWsh80fs6d%2BW%2BxlwigGZiMnj1JTbOJkwOMap0zEoscOF4D2%2FoN7V6DeI3J7XqFN9oNB8hnPJdHB6tQpL8WGDV1jlfkfiOZPgJl2YRYT3VR%2F6PiV9ep5i7rm%2BRdQSo8dXy%2BfO573cpC4qYbOku4H0hb8Fphn24zLF7xfIRfvxEkjhvCkj6lS6sLM%2FnLqOxjn%2BLpJ%2FlY%2FL%2BBYIuaVPtIRs5qcp9L9UqnSDMtgkM3Mz0z5SWl5HxDRdxvfCCuyKUUNmTVams1QJBlVA%2BdYMt%2ByxelC%2BwpnG1PPTfmEonQn%2FYp4kODNrhsXvXelOeN7kZobZPGu4%2B7bVbNinz2qD%2Br2yCTjvjFqwAFCo9WlKaheGttma8EXZB61nf28NRE4J%2FEJ9WmT3aOBUvHDxbx6npxblNmsoexiEUKtlU6govA%2ByAMHswQidvdg9KEkEKlH4y7tFfmMeqf6iNRhhDz1FSIY98LQeNqswenjrx9ZR7n7kxipXGpSAPqVBcwDdS9tply%2BdNvqgyt5QNcP%2FIbbVHpppKANGqJVb4FpkajI2KOva%2Bixf1meJEdCm5OjL5pPuuGqyVZRw%2FQ8S8uX38e7ftk%2BLHhMhPAdw1R7UxZzic8TTUrGwzA%2FIVMziQ6bSVobTS8Bsw2d6%2FxgY6sQFM%2B90JI1LEO4gKDDWGfro2TDqdvKNUO%2Fvlb3svsloHnDao94fo%2F%2B3Ol%2FaogxtrDavOPVXuINmcNsIMdhE7eJrmttrpl7ilZclTNPMTu10XV8QWwX19%2F0HFf%2BUEVINni3fExXGHohjy3vo40Ac8cmd3D%2FpVgn%2BLhUVMBm9Y1A7EjU59wdGt49wIk9a387%2FWElmuu5RqXQqqrsQ9uelZBSyRqZFNO0jvoeWtkr%2B5%2BBzLIWg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6519a2b56630e0dc729d3856bed7b31b2a3c6b83188fd6e462ac6014f36f7cdf"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-11-12T23:49:32.705Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-10-13T23:49:31.946Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Overview\nWrong logic in realization of LOAD DATA LOCAL INFILE function leads to remote attacker can read files from server. Problem exists in many MySQL-drivers and frameworks, on many programming languages, like Python, Java, PHP etc.\n\nFor exploitation this vulnerability we need to connect to our special MySQL server (A) from \"attacking\" remote server (B).\nFor example:\n- I found phpMyAdmin interface with connect to any server ability (AllowArbitraryServer option in config) on server B.\n- Next I'm run special-MySQL server on my A host.\n- Then connect through phpMyAdmin to host A\n- After successful connection I can see content of /etc/passwd file from host B in log file on host A\n\n## Details\nFor testing purposes take latest MySQL server, client and tcpdump\n- Start server on local machine\n- Run tcpdump\n- Connect to local MySQL through native mysql-console client\n- Run LOAD DATA LOCAL INFILE '/etc/passwd' INTO TABLE pwn FIELDS TERMINATED BY '\\n'\n- Bye\n\nLook inside packet dump file for LOCAL DATA INFILE query works:\n- Client connect initialize.\n- Server answers with greeting packet (protocol thread id, version, type of mysql authentication etc.)\n- Next authentication packet (username, password, dbs)\n- Next packet from client with query LOAD DATA LOCAL INFILE...\n- Now here is strange packet from server. Call it `FB`-packet: `0c 00 00 01 fb 2f 65 74 63 2f 70 61 73 73 77 64`\n\n`0c` - size\n`000001` - packet No\n`fb` - packet type\n`2f6574632f706173737764` - filename (/etc/passwd)\n\nThere is problem looks like: server says to client what file he needs to read.\nWe need to create special MySQL server which do authorization with any data and then send FB packet with remote filename as payload. That's it.\n\nIn attach image successfully exploitation another MySQL administration interface - Adminer\n\nExploit: https://github.com/allyshka/Rogue-MySql-Server/blob/master/rogue_mysql_server.py\nSee also: http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/\n",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 109632,
      "file_name": "adminerread.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/109/632/59706950a0eaa959a1073fb3eb511b88964f978d/adminerread.jpg?response-content-disposition=attachment%3B%20filename%3D%22adminerread.jpg%22%3B%20filename%2A%3DUTF-8%27%27adminerread.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWLIXK7KK%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132514Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCn9dBDjuRnR6R6gwO7wx1V9VTCorPNrsiHfcpQFucMbgIga98tHzwspPe%2FMy%2FsxRSx9minsZ%2FmvaaRCrdbchOwi8MqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDOfrddDnnKJLEaVlcSqPBfc6dsF029BlI%2Bzcy0u3riyL4%2F%2FT8xwtdkFDq1v%2BQabUqM9VNCUvDv7%2FWtv5itm3mLChE%2FgPaggTV0x1i4M9I96rP1Tdx734GZtatA9caD0YziJznRTFhZdv%2BRpZyqW0x%2BDBWmkbnL3q9Mk2VqWGuv8w0WORhVkr4U%2FwRPgCzLAhLmRIBtlGR3Le2jV5izWW%2FiA%2Bf1VF%2F4NRpjSpghXMCMfWFc%2B%2FoHd6Wx8j5FDXlE5MWsh80fs6d%2BW%2BxlwigGZiMnj1JTbOJkwOMap0zEoscOF4D2%2FoN7V6DeI3J7XqFN9oNB8hnPJdHB6tQpL8WGDV1jlfkfiOZPgJl2YRYT3VR%2F6PiV9ep5i7rm%2BRdQSo8dXy%2BfO573cpC4qYbOku4H0hb8Fphn24zLF7xfIRfvxEkjhvCkj6lS6sLM%2FnLqOxjn%2BLpJ%2FlY%2FL%2BBYIuaVPtIRs5qcp9L9UqnSDMtgkM3Mz0z5SWl5HxDRdxvfCCuyKUUNmTVams1QJBlVA%2BdYMt%2ByxelC%2BwpnG1PPTfmEonQn%2FYp4kODNrhsXvXelOeN7kZobZPGu4%2B7bVbNinz2qD%2Br2yCTjvjFqwAFCo9WlKaheGttma8EXZB61nf28NRE4J%2FEJ9WmT3aOBUvHDxbx6npxblNmsoexiEUKtlU6govA%2ByAMHswQidvdg9KEkEKlH4y7tFfmMeqf6iNRhhDz1FSIY98LQeNqswenjrx9ZR7n7kxipXGpSAPqVBcwDdS9tply%2BdNvqgyt5QNcP%2FIbbVHpppKANGqJVb4FpkajI2KOva%2Bixf1meJEdCm5OjL5pPuuGqyVZRw%2FQ8S8uX38e7ftk%2BLHhMhPAdw1R7UxZzic8TTUrGwzA%2FIVMziQ6bSVobTS8Bsw2d6%2FxgY6sQFM%2B90JI1LEO4gKDDWGfro2TDqdvKNUO%2Fvlb3svsloHnDao94fo%2F%2B3Ol%2FaogxtrDavOPVXuINmcNsIMdhE7eJrmttrpl7ilZclTNPMTu10XV8QWwX19%2F0HFf%2BUEVINni3fExXGHohjy3vo40Ac8cmd3D%2FpVgn%2BLhUVMBm9Y1A7EjU59wdGt49wIk9a387%2FWElmuu5RqXQqqrsQ9uelZBSyRqZFNO0jvoeWtkr%2B5%2BBzLIWg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ec909023f8a03e1a16343b91bf711fbf39ce35fe2959fc71f6afb3b5b35edd7a",
      "file_size": 113447,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-11-12T23:49:32.026Z",
  "allow_singular_disclosure_after": -184858542.29604882,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "mashoud1122",
    "base_64",
    "spetr0x"
  ],
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
