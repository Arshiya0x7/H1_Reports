{
  "id": 1104874,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA0ODc0",
  "url": "https://hackerone.com/reports/1104874",
  "title": "Insecure Bundler configuration fetching internal Gems (okra) from Rubygems.org",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-02-16T17:13:18.422Z",
  "submitted_at": "2021-02-16T17:13:18.507Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zofrex",
    "url": "/zofrex",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vpuvklosjbi4y01bu3836zh0bpm1/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22zofrex-resized.jpg%22%3B%20filename%2A%3DUTF-8%27%27zofrex-resized.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQURJER4JF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T020309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJHMEUCIQCxCHubCAopuS5sT1c622J7mKsRjnVdN1TDoD9qZ6mC4gIga9rswNKd0tEdR3vF%2BaUY9%2F4iBI2o6amy8bPqGGq0HRAquwUI%2BP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDBV1E3M8E%2FTNNrDtsiqPBRzpIXhojQmU%2BFN0yP83HsenKpA2bf1qN92n8R562AwW0Y6INtXm9SFutk7QWG1pn2DH2l9rrKWGsmHVi7MAWNlsMv%2FKOE73CF2j6ywpIFTZODJ3tFS0NPG2RzY2ePz1FAwCsAW%2B32pyFdIpnawn2FJf6E0nzEdw%2FjqEP1%2FYLBSxVhUyxTWBmV55BjTCQdv%2FQ6fWgvcE3gNzPgyWTTreLm5H5e3uNSW54iiSLvca3HIEAKB9GX%2BSVpcsJaeDT03yc9WTkQ7v4%2BxF9aCQMkjZnQuEVdhOcr4RTQKWJbWd%2FBGfbAwvmuiCR2%2FjNQzN%2FGUyO8Rlz0XmSvLlWmjbakVuYB%2FGsp20Cz%2BjBNOrITj2DZwCl1EQY%2FXqpXNzFfulARmpmFyJGabsni%2BxiG7hnmLX0LVSdUpzH2KZDC8EBfFeKZX29UNnyGpAd0tTVMK2mq%2FjSiXj%2FBjLJSpgpV8EtfsA4zaw6ioNWpg8covYBxrxMS2WHr6NMifoBSqeRLi1Lxj9I2GAEuY%2F6WkO3QQyrl7EpFma2aGP8RN7K4avSM05F3wzDdztP8LSeNtXMCXD4kYdtSv8cCz0xIfXMxf3rhrU95M6Sz1THj%2Fc2DDrtKsYfE3HRrUefmOw0gBVl1LJSkQ3PnPhYDK7nTkWdtn4%2Fv5ZkYY9eGLaYdQ2MQQ0QPrwpiZcVBsI1s9it9lH3ytoEGhUUUHFzrT5zshPAKZeitEsDAAeWgqndG3qvavIo0BNUZhycNsKopaXIas94Fhr%2BKlX%2FwN%2B6a3SbkHkQVfK0723zCh8n%2FVKOUajLzrlgJfFLOfvsM%2BHZiuAW2l9PhWua4DVDRn0x7gk%2BJ2pSvnH6e5NW2Hd%2FQC%2BvAaL4fAuCr4O%2FUow99S8xgY6sQFlLDO%2Byl7F6dSnUhdT%2BvvUwfN1PIJyhdgMSMSt%2Ba8Lc%2FH5bw4ztyomzacDRvhZwdJA18WnmLlXlcCvV4ME7TrhoXAPu7%2BrD7GOwXd5tKxKivbK48g7CO7vXxi8uEaulROEQ0uN31SC3nFIqKLjeAWwhkwORnBJozLu9UekkcrPu9aW9B5on7n%2Ff9Rj%2FGxt7nfBYbmj0MqK8UI5%2Bd6XsaT3jF7wNrelKIF6jIUoLNYFGVM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=97af607eda884d38f8585d6653462331a263d298ca0806e2885e838cd2e04fe6"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 67,
    "url": "https://hackerone.com/basecamp",
    "handle": "basecamp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Basecamp",
      "twitter_handle": "basecamp",
      "website": "https://basecamp.com/about/policies/security/response",
      "about": "Basecamp is the leading online project manager and the birthplace of Ruby on Rails. Creators of the HEY email service."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-08-10T07:12:35.420Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-10T07:12:35.260Z",
  "team_member_agreed_on_going_public_at": "2021-08-09T22:13:53.253Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I believe (most likely) that one of your projects is not set up correctly to only pull internal gems from your internal gem server, and instead will pull gems from Rubygems.org if the version number there is higher.\n\nSpecifically, the \"okra\" gem.\n\nAt around 15:21 today (UTC) the okra gem that I wrote – https://rubygems.org/gems/okra – was installed on the machine with hostname \"oscillatinghost\" under the username \"fernando\" on your network.\n\nThis would be possible if the Gemfile either installs gems from global sources (thus allowing the version on Rubygems to 'trump' the internal version) or if the okra gem is depended on by another internal gem, and your version of Bundler is less than 2.2.10 – see here for details on that: https://bundler.io/blog/2021/02/15/a-more-secure-bundler-we-fixed-our-source-priorities.html\n\nIt is possible this is not correct, and instead, someone typed \"gem install okra\" without specifying where to fetch the Gem from. This would potentially also have fetched it from Rubygems.\n\nPlease note that the Gem I wrote does not do anything malicious, and only fetches the minimum information I need to filter out false positives and correctly identify organisations. You can verify this yourself by looking at the code for the gem \"okra-90002.0\" in your gems folder. I will delete all information relating to your organisation as soon as it is no longer needed.\n\n## Impact\n\nThe impact is that an attacker could achieve arbitrary Remote Code Execution on any machines that will fetch the gem from the Rubygems repository.\n\nNote that to achieve code execution, merely installing the Gem is enough, it does not have to be require'd or run.",
  "bounty_amount": "5000.0",
  "formatted_bounty": "$5,000",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-09-08T22:13:53.380Z",
  "allow_singular_disclosure_after": -127280956.18295231,
  "singular_disclosure_allowed": true,
  "vote_count": 100,
  "voters": [
    "arist0phanes",
    "9oelm",
    "act1on3",
    "davidfegyver",
    "kashsec",
    "alexbirsan",
    "drsniper",
    "mrmax4o4",
    "akshansh",
    "fqdn",
    "and 90 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 4655,
    "asset_type": "URL",
    "asset_identifier": "3.basecamp.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 77326,
      "category": "researcher",
      "content": "I found an internal gem (Ruby library) in use by Basecamp that was not registered on Rubygems (the public Ruby package repository). I registered a gem of my own under the name that would call back when installed, in an attempted \"dependency confusion\" attack.\n\nAlthough this attack was not successful against any production machines or automated builds, as Basecamp had successfully mitigated against the attack in those places, my library was installed on a developer machine when a member of Basecamp attempted to install the gem by hand using \"gem install\" rather than running a \"bundle install\".\n\nThis vulnerability was resolved by using configuration management software to set the default package repository on developer machines to one controlled by Basecamp, where they can control which packages come from which repositories and can prevent internal packages being pulled from Rubygems.",
      "updated_at": "2021-08-10T07:22:06.722Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1340268,
        "username": "zofrex",
        "name": "James Sanderson",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://www.zofrex.com",
        "location": "London",
        "created_at": "2020-09-30T12:55:17.720Z",
        "url": "https://hackerone.com/zofrex",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vpuvklosjbi4y01bu3836zh0bpm1/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22zofrex-resized.jpg%22%3B%20filename%2A%3DUTF-8%27%27zofrex-resized.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQURJER4JF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T020309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJHMEUCIQCxCHubCAopuS5sT1c622J7mKsRjnVdN1TDoD9qZ6mC4gIga9rswNKd0tEdR3vF%2BaUY9%2F4iBI2o6amy8bPqGGq0HRAquwUI%2BP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDBV1E3M8E%2FTNNrDtsiqPBRzpIXhojQmU%2BFN0yP83HsenKpA2bf1qN92n8R562AwW0Y6INtXm9SFutk7QWG1pn2DH2l9rrKWGsmHVi7MAWNlsMv%2FKOE73CF2j6ywpIFTZODJ3tFS0NPG2RzY2ePz1FAwCsAW%2B32pyFdIpnawn2FJf6E0nzEdw%2FjqEP1%2FYLBSxVhUyxTWBmV55BjTCQdv%2FQ6fWgvcE3gNzPgyWTTreLm5H5e3uNSW54iiSLvca3HIEAKB9GX%2BSVpcsJaeDT03yc9WTkQ7v4%2BxF9aCQMkjZnQuEVdhOcr4RTQKWJbWd%2FBGfbAwvmuiCR2%2FjNQzN%2FGUyO8Rlz0XmSvLlWmjbakVuYB%2FGsp20Cz%2BjBNOrITj2DZwCl1EQY%2FXqpXNzFfulARmpmFyJGabsni%2BxiG7hnmLX0LVSdUpzH2KZDC8EBfFeKZX29UNnyGpAd0tTVMK2mq%2FjSiXj%2FBjLJSpgpV8EtfsA4zaw6ioNWpg8covYBxrxMS2WHr6NMifoBSqeRLi1Lxj9I2GAEuY%2F6WkO3QQyrl7EpFma2aGP8RN7K4avSM05F3wzDdztP8LSeNtXMCXD4kYdtSv8cCz0xIfXMxf3rhrU95M6Sz1THj%2Fc2DDrtKsYfE3HRrUefmOw0gBVl1LJSkQ3PnPhYDK7nTkWdtn4%2Fv5ZkYY9eGLaYdQ2MQQ0QPrwpiZcVBsI1s9it9lH3ytoEGhUUUHFzrT5zshPAKZeitEsDAAeWgqndG3qvavIo0BNUZhycNsKopaXIas94Fhr%2BKlX%2FwN%2B6a3SbkHkQVfK0723zCh8n%2FVKOUajLzrlgJfFLOfvsM%2BHZiuAW2l9PhWua4DVDRn0x7gk%2BJ2pSvnH6e5NW2Hd%2FQC%2BvAaL4fAuCr4O%2FUow99S8xgY6sQFlLDO%2Byl7F6dSnUhdT%2BvvUwfN1PIJyhdgMSMSt%2Ba8Lc%2FH5bw4ztyomzacDRvhZwdJA18WnmLlXlcCvV4ME7TrhoXAPu7%2BrD7GOwXd5tKxKivbK48g7CO7vXxi8uEaulROEQ0uN31SC3nFIqKLjeAWwhkwORnBJozLu9UekkcrPu9aW9B5on7n%2Ff9Rj%2FGxt7nfBYbmj0MqK8UI5%2Bd6XsaT3jF7wNrelKIF6jIUoLNYFGVM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=97af607eda884d38f8585d6653462331a263d298ca0806e2885e838cd2e04fe6",
          "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vpuvklosjbi4y01bu3836zh0bpm1/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a?response-content-disposition=inline%3B%20filename%3D%22zofrex-resized.jpg%22%3B%20filename%2A%3DUTF-8%27%27zofrex-resized.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQURJER4JF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T020309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH8aCXVzLXdlc3QtMiJHMEUCIQCxCHubCAopuS5sT1c622J7mKsRjnVdN1TDoD9qZ6mC4gIga9rswNKd0tEdR3vF%2BaUY9%2F4iBI2o6amy8bPqGGq0HRAquwUI%2BP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDBV1E3M8E%2FTNNrDtsiqPBRzpIXhojQmU%2BFN0yP83HsenKpA2bf1qN92n8R562AwW0Y6INtXm9SFutk7QWG1pn2DH2l9rrKWGsmHVi7MAWNlsMv%2FKOE73CF2j6ywpIFTZODJ3tFS0NPG2RzY2ePz1FAwCsAW%2B32pyFdIpnawn2FJf6E0nzEdw%2FjqEP1%2FYLBSxVhUyxTWBmV55BjTCQdv%2FQ6fWgvcE3gNzPgyWTTreLm5H5e3uNSW54iiSLvca3HIEAKB9GX%2BSVpcsJaeDT03yc9WTkQ7v4%2BxF9aCQMkjZnQuEVdhOcr4RTQKWJbWd%2FBGfbAwvmuiCR2%2FjNQzN%2FGUyO8Rlz0XmSvLlWmjbakVuYB%2FGsp20Cz%2BjBNOrITj2DZwCl1EQY%2FXqpXNzFfulARmpmFyJGabsni%2BxiG7hnmLX0LVSdUpzH2KZDC8EBfFeKZX29UNnyGpAd0tTVMK2mq%2FjSiXj%2FBjLJSpgpV8EtfsA4zaw6ioNWpg8covYBxrxMS2WHr6NMifoBSqeRLi1Lxj9I2GAEuY%2F6WkO3QQyrl7EpFma2aGP8RN7K4avSM05F3wzDdztP8LSeNtXMCXD4kYdtSv8cCz0xIfXMxf3rhrU95M6Sz1THj%2Fc2DDrtKsYfE3HRrUefmOw0gBVl1LJSkQ3PnPhYDK7nTkWdtn4%2Fv5ZkYY9eGLaYdQ2MQQ0QPrwpiZcVBsI1s9it9lH3ytoEGhUUUHFzrT5zshPAKZeitEsDAAeWgqndG3qvavIo0BNUZhycNsKopaXIas94Fhr%2BKlX%2FwN%2B6a3SbkHkQVfK0723zCh8n%2FVKOUajLzrlgJfFLOfvsM%2BHZiuAW2l9PhWua4DVDRn0x7gk%2BJ2pSvnH6e5NW2Hd%2FQC%2BvAaL4fAuCr4O%2FUow99S8xgY6sQFlLDO%2Byl7F6dSnUhdT%2BvvUwfN1PIJyhdgMSMSt%2Ba8Lc%2FH5bw4ztyomzacDRvhZwdJA18WnmLlXlcCvV4ME7TrhoXAPu7%2BrD7GOwXd5tKxKivbK48g7CO7vXxi8uEaulROEQ0uN31SC3nFIqKLjeAWwhkwORnBJozLu9UekkcrPu9aW9B5on7n%2Ff9Rj%2FGxt7nfBYbmj0MqK8UI5%2Bd6XsaT3jF7wNrelKIF6jIUoLNYFGVM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e68ff7fc6f7b46d28ab82be2221599674ccaee2d2bfa601cd3f67b23ae5a7a1",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTM0ODY4OSwicHVyIjoiYmxvYl9pZCJ9fQ==--17b9bd1c7048b02d4e7979d4e924e51d2f87da2a/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/zofrex-resized.jpg"
        }
      }
    }
  ]
}
