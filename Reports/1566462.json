{
  "id": 1566462,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTY2NDYy",
  "url": "https://hackerone.com/reports/1566462",
  "title": "error parse uri path in curl",
  "state": "Closed",
  "substate": "not-applicable",
  "severity_rating": "high",
  "readable_substate": "N/A",
  "created_at": "2022-05-12T06:20:27.793Z",
  "submitted_at": "2022-05-12T06:20:27.886Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "iylz",
    "url": "/iylz",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-05-13T20:34:41.536Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2022-05-13T20:34:30.248Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n[add summary of the vulnerability]\n\nThe uri path error could lead to security filter bypasses. \nFor example, \nwe can use  curl  -vv 'f[h-j]le:///etc/passwd' to bypass  file protocol  black list\nwe can use  curl  -vv 'http://1.1.1.1:[80-9000]' to scan the open port in the host\netc ...\n\n## Steps To Reproduce:\n[add details for how we can reproduce the issue]\n\ncurl -vv 'f[h-j]le:///etc/passwd' will  parse 3 request , like  curl -vv 'fhle:///etc/passwd' 、curl -vv 'file:///etc/passwd' 、curl -vv 'fjle:///etc/passwd' \n```\n[root@iz2ze9awqx4bwtc7j5q4hsz bin]# ./curl -Version\ncurl 7.83.1 (x86_64-pc-linux-gnu) libcurl/7.83.1 zlib/1.2.7\nRelease-Date: 2022-05-11\nProtocols: dict file ftp gopher http imap mqtt pop3 rtsp smtp telnet tftp \nFeatures: alt-svc AsynchDNS IPv6 Largefile libz UnixSockets\n[root@iz2ze9awqx4bwtc7j5q4hsz bin]# ./curl -vv 'f[h-j]le:///etc/passwd'\n* Protocol \"fhle\" not supported or disabled in libcurl\n* Closing connection -1\ncurl: (1) Protocol \"fhle\" not supported or disabled in libcurl\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\nsystemd-bus-proxy:x:999:998:systemd Bus Proxy:/:/sbin/nologin\nsystemd-network:x:192:192:systemd Network Management:/:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\npolkitd:x:998:997:User for polkitd:/:/sbin/nologin\ntss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\npostfix:x:89:89::/var/spool/postfix:/sbin/nologin\nchrony:x:997:995::/var/lib/chrony:/sbin/nologin\nntp:x:38:38::/etc/ntp:/sbin/nologin\nnscd:x:28:28:NSCD Daemon:/:/sbin/nologin\ntcpdump:x:72:72::/:/sbin/nologin\nadmin:x:1000:1000::/home/admin:/sbin/nologin\napache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin\npostgres:x:26:26:PostgreSQL Server:/var/lib/pgsql:/sbin/nologin\nsquid:x:23:23::/var/spool/squid:/sbin/nologin\nworkftp:x:1002:1003::/home/work/ftp/:/sbin/nologin\nmysql:x:27:27:MariaDB Server:/var/lib/mysql:/sbin/nologin\n* Closing connection 0\n* Protocol \"fjle\" not supported or disabled in libcurl\n* Closing connection -1\ncurl: (1) Protocol \"fjle\" not supported or disabled in libcurl\n[root@iz2ze9awqx4bwtc7j5q4hsz bin]# wget 'f[h-j]le:///etc/passwd'\nf[h-j]le:///etc/passwd: 地址缺少协议类型.\n[root@iz2ze9awqx4bwtc7j5q4hsz bin]# \n```\n\nSo, I think this is a security questions of  curl, because the wget doesn't have same question. Thinks \n\n## Supporting Material/References:\n[list any additional material (e.g. screenshots, logs, etc.)]\n\n  * [attachment / reference]\n\n## Impact\n\nbypass the security filter like the SSRF/RFL/LFI  etc.",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1726326,
      "file_name": "1.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/0vxeo0a45gx1epm3xvmdof2l2c6a?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ35T6K4IF%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T234238Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEH0aCXVzLXdlc3QtMiJHMEUCIQDPEAvaZ%2FvLeuRoaLfLXdA6mmt8NeE4EcHMdEnKiQYxBAIgQAcR7QaOvsWqFUoty3eI9NBYZ9edyOn035ycgCkKuWwqugUI9v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDJbxesrBYe2kzIoHRyqOBcinJjA8aAlm%2Bnvs4nWgO3kcLGwKWP5isvckwVvjix03%2B1XZ3O1hBseTxJ5o79VmQtVbCVHNop1oSaebb0Y%2FIBB31Zt%2FJ3tqNSSpoaADaLyP06r8cJJcf%2B6O9gf6Tfz5o%2BxsVcCm10hyrLmxoEjB7JcIJbJkNbTdPOMRXTv6GNta22Qh%2FhCA8HfxLnJohYN1tHs06Fw84zZxZgFfoi%2F%2BpF1YBf%2BigqM9iRmLbRalo4ueuaA1Oclt9ovcTPq5L8e3qmDekZwQOuQVgSJvMc%2BQWFyC14JJRA%2Fx4uRc9MdCBwEwBVwZOLh5PldpQl2jUhs5ST7UkCNpFfGqxKITQg1xsyKbpu6JmKWcXV951x%2BIjsfvGQkMBL13OQYbo%2FDBY%2Fy5zVsZZ0WpTojg5bVdppmVn%2FjTtzOrpf%2B%2BVYHD7EGdVb5HkeiRpN43gCHJ4snOdrd7UinO5O6gKWEqcOVn%2FZjiCo8IVqrZ6asbJkPD5vtbcfdZPwv4abHGyC651WavF1cOEnyJqxd0gz6IqleLZrSz2kntoisyN40PCMqYBIQ8RYxntGtqvxATlSIEslv4EkgyrkGkL9bcNePvbTccSxUP%2Bo8%2FyHOVtKWpXu%2FphJhIcdO1XzB4kZcd4x%2BGi2FADPz32SmIatRtdDC6vE%2FjMCScFaMvUeKfU5wHSffSk6TDyGCLlQzf5VyyhTzlDRIJeZOJFE7h%2Biuqf1SFkp%2FUbA7TLcJ5shBQJr2QKU6q%2Fnjdlnn%2B95PGhqbrTYmL4TtK0ZtXaka76ZaWo0sWdAg6IoPzcHyy9l3DiveHaLsZTefPenK2stD%2B5QpgpfTzbKf%2FvDd0Hyc3nAWvIkQrJUT6FoBwJ%2B%2FyNjSp21H%2FvxuMMOCwyDCss7zGBjqxAfNFlg7BnOWu2lX%2Fx3HSk3PERI%2FQdO2VFtK4FpK06GICCytDslgE9kzLlsEfs1kcNEO447iWMAjBsJPvUcGfEvmEWMYacCxlNw2SmfUP9%2FEwlQ2uofGYc5klI2uwBY7ykPvx0kA6fh1kOMY1h%2Btv%2Blrshwzi78hWKf83FJn4T2%2Fd%2FFsGrE5EhqR96Vtccl%2BXucm67xB81IRw4ruJmKA1muxa5hWLQryQ0MY3%2B%2FRPbsaiIg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0b14ee58f965d35c45f1c6bde21098d320b846d4f333ab3c87a77504d12c317e",
      "file_size": 497913,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 4,
  "voters": [
    "shivammusic",
    "destinedtohack",
    "mo97",
    "qweasdzxcvbn"
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
