{
  "id": 1071832,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDcxODMy",
  "url": "https://hackerone.com/reports/1071832",
  "title": "Local privilege escalation via insecure MSI file",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-01-05T10:38:02.909Z",
  "submitted_at": "2021-01-05T10:38:03.082Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "twvyy3vyaw8k",
    "url": "/twvyy3vyaw8k",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/XhmDkdkQhpNmN3jLUxdkos4k/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13428,
    "url": "https://hackerone.com/acronis",
    "handle": "acronis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Acronis",
      "twitter_handle": "Acronis",
      "website": "https://www.acronis.com",
      "about": "Complete integrated cybersecurity and data protection for MSPs and IT teams"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-08-07T19:11:30.813Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-07T19:11:30.709Z",
  "team_member_agreed_on_going_public_at": "2021-08-05T08:23:25.521Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\nI've found a vulnerability which leads to a local privilege escalation starting from a non-admin user.\n\nWhen `True Image` client installs it drops 2 MSI files into `C:\\Windows\\Installer` folder.\nSince this folder (by default) is readable by anyone, a non-admin user can execute commands like `msiexec /fa installer_name.msi`, which forces `installer_name.msi` to \"repair\" the program.\n\nOne of these 2 MSIs (i can't named it because MSI file names are random and unique for every installation) when forced to repair it creates a dll in `%TEMP%\\random_name` and then, after some time, `MsiExec.exe` loads it. Since `MsiExec.exe` auto-escalate privileges when executed and `%TEMP%` is writable by anyone, this behavior could be abused to gain `nt authority\\system` privileges.\n\n## Steps To Reproduce\n  1.  Open `%TEMP%` and `C:\\Windows\\Installer`\n  2.  Locate the MSI file in the installer folder: it's 1.3 GB large and has `Acronis` as author \n  3.  Open `cmd.exe` and execute `msiexec /fa C:\\Windows\\Installer\\installer_name.msi`.  After few seconds a new folder will appear in `%TEMP%`\n  4.  Replace `schedule.dll` inside that folder with the `schedule.dll` attachment  in this report\n  5.  Wait until the process finishes. After some time a UAC should prompt, just select \"no\"\n  6.  A new cmd should pop up. Type `whoami` to confirm the new privileges\n\n\nI've also recorded a PoC video in case something it's not clear.\n\n## Recommendations\nDo not use local `%TEMP%` to create `schedule.dll`, use `C:\\Windows\\TEMP`.\n\n## Impact\n\nLPEs like this one are often used by malwares to evade antivirus engines, install rootkits, spread over the network, etc...\nA malware author could use this exploit to target Acronis end users.",
  "bounty_amount": "250.0",
  "formatted_bounty": "$250",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1145030,
      "file_name": "true_image_LPE_PoC.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1s7zssmfykugjgj52ipzxpxioxnz?response-content-disposition=attachment%3B%20filename%3D%22true_image_LPE_PoC.mp4%22%3B%20filename%2A%3DUTF-8%27%27true_image_LPE_PoC.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5NFJOVAF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T020349Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEID%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCYoKrB%2B5OAtMEvTgI1XSN2%2BKvLv%2FCStZ28UmgWI5ObKwIhALGCZDa0Bq2L38Z%2Fa7dYv4m2VMjCdwsGoNrRzMjVp2KLKrsFCPn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgxKteL6N%2B7t%2BhCTQkMqjwXJeRXjJ4O0ufVhiNeAdWoTAeaS3K9z5%2B%2FSJHMf2WAtLZx4kgetOSeeHRtMugsPWBC%2Bug6jjsy76pybkL1EYFZ%2BHurdTOiA10xtB%2BEu%2Bo0zHXt4s6wJlbTsOBpzJcycP0%2Bj9fSWmQlKTPvdqmHcHAIeH4D6hmNRS%2FyYtefuzRd9jc6xfeHyrsGV8mo4d6uZ2A0fg2hy1%2F1qb1XadZ1paLPyCZfgzQtVXH%2Bvhky1YB1dckNPacNmZA7mSLSZNoy4lgr39%2FuP02mR%2Bx08coW0djJuPXpBNPpQ5GuIsA1ev%2Bg%2FkxzkNFg8Iurb8xrHQlMBno3ZmujhXMO6mQmjclRB7stxh1Exi4ToRyAj9ys2n5n9DI2lu82NXIEx2c8u5M17em7dBXmFeS8XKoIjEq0vX1h%2B2SWji6fyrSN0Y3zSkqVo2SFA7SnmS9bAwBB7VHIslHZoHC7TDp%2BpUyuXMg4WJmQd07kGmm%2Fb9xxb562ODFeVFV%2Bw3uVJ840nT%2BzgJR84a%2F4tGuGqocZ8Cy4E0zkK9MZ3Hsd6x3IXOyrX%2Fh%2F8u%2F2fjtBFTcmxdfiXSNNx2jj%2FZ9iE4xZCEeVw0nyPWvTfkJTjiSjA2LbQgCK9BI0K%2FNrgP5FhiR8VL%2F1JNnDuXT1ae36m90n%2B4kaOygNNiVrLZDXu11ZidM%2B8L0ZnsA53ktL9bcmVTKWElcsa7vHZkwD7vj%2FDoZkQKpgj5fwgbOF2X0LcBNcSHRHyaln9fxl9ibEusC6ISslQ1JW0EAgzGKuPJIk7cemZi6RtrNjcT87VZIttNPNsH45zqIA%2B8njei2FQScCK744SPZQhZNEVgBwTKUMjHeg3OMfzHwRHi%2FGjpyemyKwKX93dJ5FxqEuMhtCeMKXzvMYGOrABS%2F7GpsZUawWuSZ4%2BGnTjwxHQ%2B2HPFUulGEIalHAL2LHhOVp3YYjZj90cWKPb83oDioKgtRsR%2Fn%2BfBauIB8qIbDmxt1s42h5r8Lzd66%2BpoizioEqa8kvLNvzoBvDaNu1Zvp50qJjqpcCfaXUg%2FrcpMV4530V1SIlrwEmkUCmLSOvc8n8%2FBSC5ML1W5ET5l8wee8Q1UP1EVxOOQddUIyli3p6tfFbhXY222hPpGECFxgM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7a8ddd8f32cfccd81f9ce16cf0035bae3fa52fa51058c74e6bee38bdd45d697c",
      "file_size": 3263666,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 1145031,
      "file_name": "schedule.dll",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ym898h1u9dcjaxqa4x8plqd29r4n?response-content-disposition=attachment%3B%20filename%3D%22schedule.dll%22%3B%20filename%2A%3DUTF-8%27%27schedule.dll&response-content-type=application%2Fx-ms-dos-executable&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5NFJOVAF%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T020349Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEID%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCYoKrB%2B5OAtMEvTgI1XSN2%2BKvLv%2FCStZ28UmgWI5ObKwIhALGCZDa0Bq2L38Z%2Fa7dYv4m2VMjCdwsGoNrRzMjVp2KLKrsFCPn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgxKteL6N%2B7t%2BhCTQkMqjwXJeRXjJ4O0ufVhiNeAdWoTAeaS3K9z5%2B%2FSJHMf2WAtLZx4kgetOSeeHRtMugsPWBC%2Bug6jjsy76pybkL1EYFZ%2BHurdTOiA10xtB%2BEu%2Bo0zHXt4s6wJlbTsOBpzJcycP0%2Bj9fSWmQlKTPvdqmHcHAIeH4D6hmNRS%2FyYtefuzRd9jc6xfeHyrsGV8mo4d6uZ2A0fg2hy1%2F1qb1XadZ1paLPyCZfgzQtVXH%2Bvhky1YB1dckNPacNmZA7mSLSZNoy4lgr39%2FuP02mR%2Bx08coW0djJuPXpBNPpQ5GuIsA1ev%2Bg%2FkxzkNFg8Iurb8xrHQlMBno3ZmujhXMO6mQmjclRB7stxh1Exi4ToRyAj9ys2n5n9DI2lu82NXIEx2c8u5M17em7dBXmFeS8XKoIjEq0vX1h%2B2SWji6fyrSN0Y3zSkqVo2SFA7SnmS9bAwBB7VHIslHZoHC7TDp%2BpUyuXMg4WJmQd07kGmm%2Fb9xxb562ODFeVFV%2Bw3uVJ840nT%2BzgJR84a%2F4tGuGqocZ8Cy4E0zkK9MZ3Hsd6x3IXOyrX%2Fh%2F8u%2F2fjtBFTcmxdfiXSNNx2jj%2FZ9iE4xZCEeVw0nyPWvTfkJTjiSjA2LbQgCK9BI0K%2FNrgP5FhiR8VL%2F1JNnDuXT1ae36m90n%2B4kaOygNNiVrLZDXu11ZidM%2B8L0ZnsA53ktL9bcmVTKWElcsa7vHZkwD7vj%2FDoZkQKpgj5fwgbOF2X0LcBNcSHRHyaln9fxl9ibEusC6ISslQ1JW0EAgzGKuPJIk7cemZi6RtrNjcT87VZIttNPNsH45zqIA%2B8njei2FQScCK744SPZQhZNEVgBwTKUMjHeg3OMfzHwRHi%2FGjpyemyKwKX93dJ5FxqEuMhtCeMKXzvMYGOrABS%2F7GpsZUawWuSZ4%2BGnTjwxHQ%2B2HPFUulGEIalHAL2LHhOVp3YYjZj90cWKPb83oDioKgtRsR%2Fn%2BfBauIB8qIbDmxt1s42h5r8Lzd66%2BpoizioEqa8kvLNvzoBvDaNu1Zvp50qJjqpcCfaXUg%2FrcpMV4530V1SIlrwEmkUCmLSOvc8n8%2FBSC5ML1W5ET5l8wee8Q1UP1EVxOOQddUIyli3p6tfFbhXY222hPpGECFxgM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b5b5a16861e4a5964eb2daeb22fbfc5a7b83ed605913ffc153cc732db8ba6b27",
      "file_size": 10240,
      "type": "application/x-ms-dos-executable",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 23,
  "voters": [
    "tcwr",
    "osman1337",
    "arist0phanes",
    "mr-medi",
    "rzx007x",
    "ali",
    "bl4de",
    "akashhamal0x01",
    "h4x0r_dz",
    "0nlymohammed",
    "and 13 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.9,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 50772,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "Acronis Cyber Protect Home Office (formerly Acronis True Image)",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
