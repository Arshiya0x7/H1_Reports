{
  "id": 304378,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQzNzg=",
  "url": "https://hackerone.com/reports/304378",
  "title": "ACME TLS-SNI-01/02 challenge vulnerable when combined with shared hosting providers",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-01-12T21:42:47.027Z",
  "submitted_at": "2018-01-12T21:42:47.027Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "fransrosen",
    "url": "/fransrosen",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3HDO65AT%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T180522Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGpcIsH3eJ7odr9sD9fjHahKKrvGD1B35UCTmIPrMPwSAiBTu%2FIgI2yfHAGSbnVHrCwpI3awKkyVb7KUsT9IzKTfZyqxBQgZEAMaDDAxMzYxOTI3NDg0OSIMwwfLKwQBgoZ8KTeaKo4Fbog1qjOBPuFBD3ffmrznuMzPBKpYUWeYzgzNcXnXWN%2B5uMLTFYcDx%2FRZJ%2F6HyhY7xANHMFcDlILE3dScfRs81rYKyF7YpbYUVGQq3btdwLP6ugnwkBUdqODPSbQ3VZlzkstURbCF1uhrDtu3N8jZov7xvFXcnm5KNZQsH%2BpGCkCyWpyGnShFqbE72yjky6D7paFoGvzPYIE793V2%2Fsc35gFUVUEDDbuAh4h4lNVHb6KUFrc5PiGVb3HhJx22lJ%2F16nmzfu46p1myqs5onvmNvndUULC3QBQ6lNUBBoQi02I%2F16BF%2BysRdsMXyBoBooFfX14xSn02ryhfI2ReofagGV9ckd2RKHMHF0OUPsU7lYXhbxr3NOKZcQ2cfzLYUZH1kFtdETfAQN8O4fXlY19RDqd9TXLLqhINBuFbVYWclHGV7QZwgwUS1mL84X%2FLlif8Wn4z1ku15IGGwjJsrCEFZuDEdOBh8QAWx8RzbS1qCreDaLSeOjZtL0nvvjF5MK5yaurUWlfQxVIMo2TfD3BD8yQ%2BF1qGsLUV5RNiu84FbswNkfGedzd9oyd8dT78dpkvexnOrWZoTGzTNrqOUU9rjNzWFSzWNocaSj%2FgJS3m%2BPk7cwRtacXOrH7i5a4CZH4hc5XP5yJ0yDYHNgC%2FYt%2B0YEvtRoZEHjqMKxV2eGp9d2WkA%2Ft4HBvRVQUR8QmboI2rN9jXx%2FCiE%2Fpbsl8NfSq7IBCSSREQj4prSfxZ7a3E9KDulwOu9OJKTYjrTeo6ugLa8I3uRKthb7zSyh42RRu7XtfW1AgnHwGyCRcM6RckSI4cY1bpLnNZnhlNS7RPzZodWjEPeKCrmJ3DtZeHsdUauijTaAU2osDgSsQQMIOBMLrBwMYGOrIBtD%2B7fuwjf2Kb5v%2BY%2FIdh7gP2Qw%2BfJE99BmNiaXjqAvF610%2FDEUjcz4eBs6%2B4sfVEbmWfubl%2F5WKpWi52c22fpL2zkAc5fKkMUT8568sBMFvnZnuW5Qgd5u0mTCJcGOE2A%2BYTe2Rg4K5km8PHsFT%2BgZtYX4igbd2CrSBy3j%2FxJA1FKwTveju4g9qD0juhimh0ENUoYO8F%2FOe7Wt2xNHPaKTvh%2BxOHVdDoILsfk1IyP51G0Q%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bfdc6b8b68b84f7c89f0f81eb78a3b42eb65f635dbd8c13d019d5c610f3f2118",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3HDO65AT%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T180522Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGpcIsH3eJ7odr9sD9fjHahKKrvGD1B35UCTmIPrMPwSAiBTu%2FIgI2yfHAGSbnVHrCwpI3awKkyVb7KUsT9IzKTfZyqxBQgZEAMaDDAxMzYxOTI3NDg0OSIMwwfLKwQBgoZ8KTeaKo4Fbog1qjOBPuFBD3ffmrznuMzPBKpYUWeYzgzNcXnXWN%2B5uMLTFYcDx%2FRZJ%2F6HyhY7xANHMFcDlILE3dScfRs81rYKyF7YpbYUVGQq3btdwLP6ugnwkBUdqODPSbQ3VZlzkstURbCF1uhrDtu3N8jZov7xvFXcnm5KNZQsH%2BpGCkCyWpyGnShFqbE72yjky6D7paFoGvzPYIE793V2%2Fsc35gFUVUEDDbuAh4h4lNVHb6KUFrc5PiGVb3HhJx22lJ%2F16nmzfu46p1myqs5onvmNvndUULC3QBQ6lNUBBoQi02I%2F16BF%2BysRdsMXyBoBooFfX14xSn02ryhfI2ReofagGV9ckd2RKHMHF0OUPsU7lYXhbxr3NOKZcQ2cfzLYUZH1kFtdETfAQN8O4fXlY19RDqd9TXLLqhINBuFbVYWclHGV7QZwgwUS1mL84X%2FLlif8Wn4z1ku15IGGwjJsrCEFZuDEdOBh8QAWx8RzbS1qCreDaLSeOjZtL0nvvjF5MK5yaurUWlfQxVIMo2TfD3BD8yQ%2BF1qGsLUV5RNiu84FbswNkfGedzd9oyd8dT78dpkvexnOrWZoTGzTNrqOUU9rjNzWFSzWNocaSj%2FgJS3m%2BPk7cwRtacXOrH7i5a4CZH4hc5XP5yJ0yDYHNgC%2FYt%2B0YEvtRoZEHjqMKxV2eGp9d2WkA%2Ft4HBvRVQUR8QmboI2rN9jXx%2FCiE%2Fpbsl8NfSq7IBCSSREQj4prSfxZ7a3E9KDulwOu9OJKTYjrTeo6ugLa8I3uRKthb7zSyh42RRu7XtfW1AgnHwGyCRcM6RckSI4cY1bpLnNZnhlNS7RPzZodWjEPeKCrmJ3DtZeHsdUauijTaAU2osDgSsQQMIOBMLrBwMYGOrIBtD%2B7fuwjf2Kb5v%2BY%2FIdh7gP2Qw%2BfJE99BmNiaXjqAvF610%2FDEUjcz4eBs6%2B4sfVEbmWfubl%2F5WKpWi52c22fpL2zkAc5fKkMUT8568sBMFvnZnuW5Qgd5u0mTCJcGOE2A%2BYTe2Rg4K5km8PHsFT%2BgZtYX4igbd2CrSBy3j%2FxJA1FKwTveju4g9qD0juhimh0ENUoYO8F%2FOe7Wt2xNHPaKTvh%2BxOHVdDoILsfk1IyP51G0Q%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3b1b0b72dce760f73fee588f5c6671c7ae2fe003260214e0cc6a0d54e7677841"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-05-19T19:22:01.149Z",
  "bug_reporter_agreed_on_going_public_at": "2018-04-19T19:21:56.798Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The [ACME TLS-SNI-01](https://tools.ietf.org/html/draft-ietf-acme-acme-01#section-7.3) (and [TLS-SNI-02](https://tools.ietf.org/html/draft-ietf-acme-acme-09#section-8.4)) specification assumed wrong in terms of how current major cloud providers routed and validated domains. This was reported earlier this week to Let's Encrypt, and they decided to disable the method. Today Let's Encrypt decided to sunset both TLS-SNI-01 and TLS-SNI-02 due to the vulnerability I found. \n\nA full writeup of the finding and my side of the timeline can be found here:\n\n* [How I exploited ACME TLS-SNI-01 issuing Let's Encrypt SSL-certs for any domain using shared hosting](https://labs.detectify.com/2018/01/12/how-i-exploited-acme-tls-sni-01-issuing-lets-encrypt-ssl-certs-for-any-domain-using-shared-hosting/)\n\nHere is Let's Encrypt first and second announcement about the reported issue:\n\n* [2018.01.09 Issue with TLS-SNI-01 and Shared Hosting Infrastructure](https://community.letsencrypt.org/t/2018-01-09-issue-with-tls-sni-01-and-shared-hosting-infrastructure/49996)\n* [2018.01.11 Update Regarding ACME TLS-SNI and Shared Hosting Infrastructure](https://community.letsencrypt.org/t/2018-01-11-update-regarding-acme-tls-sni-and-shared-hosting-infrastructure/50188)\n\nRegards,\nFrans\n\n## Impact\n\nThe ability to issue SSL-certificates for domains not under the attacker's control but served using the same shared hosting provider.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-05-19T19:21:56.889Z",
  "allow_singular_disclosure_after": -231720205.84422433,
  "singular_disclosure_allowed": true,
  "vote_count": 35,
  "voters": [
    "flamezzz",
    "jokebookservice1",
    "sp1d3rs",
    "europa",
    "kapytein",
    "muon4",
    "hunter",
    "bibekshah",
    "michiel",
    "danila",
    "and 25 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.9,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
