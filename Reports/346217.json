{
  "id": 346217,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDYyMTc=",
  "url": "https://hackerone.com/reports/346217",
  "title": "Persistent XSS - Selecting users as allowed merge request approvers",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-05-01T19:54:11.493Z",
  "submitted_at": "2018-05-01T19:54:11.493Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "phillycheeze",
    "url": "/phillycheeze",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-10379"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-07-16T17:19:23.297Z",
  "bug_reporter_agreed_on_going_public_at": "2018-06-26T20:55:59.382Z",
  "team_member_agreed_on_going_public_at": "2018-07-16T17:19:23.162Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nWhen using the dropdown that selects the users that are allowed to approve a merge request, it is possible to trigger a XSS with a malicious user name string.\n\n**Description:**\nThis vulnerability is similar to the recently announced CVE-2018-10379 (and another vulnerability I recently reported here in hackerone).\n\nThe steps to reproduce are fairly simple but there are some restrictions:\n\n  *  Only members of a project with Master access are able to become victims of the XSS\n  *  Only groups/members with a subscription level of Starter or higher are able to perform the XSS. This is a premium feature only allowed at Starter or higher. (https://gitlab.com/help/user/project/merge_requests/merge_request_approvals)\n\n## Steps To Reproduce:\n\n  1. Set your own username as \"<img src=x onerror=alert(document.domain)> foo / bar\"\n  1. Make yourself have at least Master access to a project\n  1. Under Project Settings -> General -> Merge Request Settings,click the \"Merge request approvals\" checkbox\n  1. Select the user dropdown input for selecting eligible users to approve merge requests\n  1. Notice that the onerror attribute from the username renders.\n\n## Supporting Material/References:\n\nMore information can be provided upon request.\n\n## Suggested Remediation\n\nLike the previous report I submitted, it is due to improper sanitization in a JS file.  I believe this is the offending line: https://gitlab.com/gitlab-org/gitlab-ee/blob/master/ee/app/assets/javascripts/approvers_select.js#L134\n\n## Impact\n\nThe security impact is the same as any typical persistent xss.\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://gitlab.com/group/project/edit\n\n**Verified**\nYes\n\n",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-07-26T20:55:59.511Z",
  "allow_singular_disclosure_after": -225837852.5554446,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "phillycheeze",
    "muon4",
    "2026",
    "apapedulimu",
    "eveeez",
    "khizer47",
    "0x08",
    "drik",
    "yyyyyyyy",
    "amrhacker",
    "and 1 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
