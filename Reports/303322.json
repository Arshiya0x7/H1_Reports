{
  "id": 303322,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDMzMjI=",
  "url": "https://hackerone.com/reports/303322",
  "title": "[www.coursera.org] Leaking password reset link on referrer header",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "none",
  "readable_substate": "Resolved",
  "created_at": "2018-01-08T18:49:48.170Z",
  "submitted_at": "2018-01-08T18:49:48.170Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "flex0geek",
    "url": "/flex0geek",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/dv3ydksa2wo1nyqstlxw4dsqc8sq/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1516,
    "url": "https://hackerone.com/coursera",
    "handle": "coursera",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/bzweea5s15ui3jhf2h39j60wsxkb/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/bzweea5s15ui3jhf2h39j60wsxkb/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Coursera",
      "twitter_handle": "coursera",
      "website": "https://www.coursera.org",
      "about": "We provide universal access to the worldâ€™s best education."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-02-14T18:17:12.566Z",
  "bug_reporter_agreed_on_going_public_at": "2018-01-15T18:17:06.439Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi team,\nthe user gets the email with a password reset link when opening it you will be redirected to password reset page when clicking on external links within the reset password page leaked password reset token in the referer header.\n\n## steps:\n1. open lost password page\n2. enter your email and click reset password\n3. open the password reset link\n4. before opening the link open Burp Suite and capture the requests and you will see the request like that:\n\n## Request:\n```\nGET /action/0?ti=4076177&Ver=2&mid=9b0beb68-99de-9e8e-24c4-2a60a29e1fae&evt=pageLoad&sid=bdbfb02f-0&lt=21519&pi=0&lg=en-US&sw=1920&sh=1080&sc=24&tl=Coursera%20|%20Online%20Courses%20From%20Top%20Universities.%20Join%20for%20Free%20|%20Coursera&p=https%3A%2F%2Fwww.coursera.org%2Freset%2Fconfirm%2FfhkMvqlYr4bpqkJHwn34iItOBcqCrO93MgB_pFphDhJNFKS-xq7sONu7vU7-KO5beOIM6kQqpW5RObgx6oUdKg.BTnS_SxKArWEXhC1TaVSUw.6I-Dxu6IbrszddoG8hvvSFyLmnIB4Tvxih9uGEwxYMuXRnJb7ihNbij1W_VKYMI591ic7DYedPHLUFeTaP39b2Z_bD2Je3NNuCLrASHsRxbpYKbxlle8FA_DK_b6Co4m%3Futm_medium%3Demail%26utm_source%3Dother%26utm_campaign%3Dnotifications.auto.Ztk28_SiEee7Ygp2ZjNHOA%23%2F%3F_k%3Dlz8f7f&r=&msclkid=N&rn=721572 HTTP/1.1\nHost: bat.bing.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nReferer: https://www.coursera.org/reset/confirm/fhkMvqlYr4bpqkJHwn34iItOBcqCrO93MgB_pFphDhJNFKS-xq7sONu7vU7-KO5beOIM6kQqpW5RObgx6oUdKg.BTnS_SxKArWEXhC1TaVSUw.6I-Dxu6IbrszddoG8hvvSFyLmnIB4Tvxih9uGEwxYMuXRnJb7ihNbij1W_VKYMI591ic7DYedPHLUFeTaP39b2Z_bD2Je3NNuCLrASHsRxbpYKbxlle8FA_DK_b6Co4m?utm_medium=email&utm_source=other&utm_campaign=notifications.auto.Ztk28_SiEee7Ygp2ZjNHOA\nCookie: MUID=156E6B1CB499683B2539603BB0996B81; MUIDB=156E6B1CB499683B2539603BB0996B81\nConnection: close\n```\nthe password link and token confirm leaked on external host, can you see this reports #6884, #738.\n\n## Impact\n\nIt allows the person who has control of `bat.bing.com` to change the user's password (CSRF attack), because this person knows reset password token of the user, uses a new user's password of his choice and authenticity_token is not needed to make it happen,\n\nThanks.",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-02-14T18:17:06.528Z",
  "allow_singular_disclosure_after": -239848702.3585648,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "eveeez",
    "fadel",
    "pr0f0x01",
    "khaledibnalwalid",
    "cr4xerbik4sh",
    "japz",
    "hlogic0",
    "sequrist",
    "b35c90d99c67687f1bd2dd2"
  ],
  "severity": {
    "rating": "none",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 2927,
    "asset_type": "URL",
    "asset_identifier": "www.coursera.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
