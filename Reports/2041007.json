{
  "id": 2041007,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDQxMDA3",
  "url": "https://hackerone.com/reports/2041007",
  "title": "Cross-Site Request Forgery ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2023-06-28T07:05:46.266Z",
  "submitted_at": "2023-06-28T07:05:46.405Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "pascal_geuter",
    "url": "/pascal_geuter",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 3059,
    "url": "https://hackerone.com/owncloud",
    "handle": "owncloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "ownCloud",
      "twitter_handle": "ownCloud",
      "website": "https://www.owncloud.com",
      "about": "ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-11-05T09:16:00.422Z",
  "bug_reporter_agreed_on_going_public_at": "2023-10-06T09:15:58.626Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The application does not throw a CrossSiteRequestForgeryException, if the request does not contain the requesttoken header.\n\nSteps to reproduce \n- run the docker image \"owncloud/server:10.12.2\" , redis and mariadb with docker-compose\n-  log in the application as an admin user\n- insert your cookies in\n\n```bash\ncurl 'http://localhost:8080/settings/users/users' \\\n  -H 'Accept: */*' \\\n  -H 'Connection: keep-alive' \\\n  -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' \\\n  -H 'Cookie: oc_sessionPassphrase=<placeholder1>; oclt1tejv3yd=<placeholder2>' \\\n  -H 'Origin: http://abc:8080' \\\n  --data-raw 'username=new_admin&groups%5B%5D=admin&password=a&email=test%40mail.com' \\\n  --compressed\n```\n\nand run it.\n- Login in the application with the username `new_admin` and the passwort `a`\n\nTo add an admin user is only an example. Most if not all requests does not require an CSRF token.\n\nI think the cause of this vulnerability is the second condition of https://github.com/owncloud/core/blob/master/lib/private/AppFramework/Middleware/Security/SecurityMiddleware.php#L145, because the the value of `$this->request->getHeader(\"Authorization\")` is an empty string and not null, if there are no `Authorization` header.\n\n## Impact\n\nUnder the requirement, that the sameSite value of the cookies are set to `lax` or `none`, an attacker can create a website and if the victim surfs to this website cross site requests with the cookies of the victim are possible. Depending on the role/groups of the victim, the attacker can create an admin account with known username and passwort or share files with an other (possible attacker controlled) user and possible other actions.",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-11-05T09:15:58.733Z",
  "allow_singular_disclosure_after": -59222338.66259448,
  "singular_disclosure_allowed": true,
  "vote_count": 108,
  "voters": [
    "defenderwww",
    "deidar3",
    "worsthack3r",
    "8910jq",
    "ambrane",
    "mattberg",
    "shreyaschavhan",
    "shriyanss",
    "shubham_srt",
    "grassye",
    "and 98 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.5,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 468,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "owncloud/core",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
