{
  "id": 300454,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDA0NTQ=",
  "url": "https://hackerone.com/reports/300454",
  "title": "[www.zomato.com] Privilege Escalation - /php/restaurant_menus_handler.php",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2017-12-25T13:27:52.919Z",
  "submitted_at": "2017-12-25T13:27:52.919Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "gerben_javado",
    "url": "/gerben_javado",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2943,
    "url": "https://hackerone.com/eternal",
    "handle": "eternal",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/9525xdsq4bz7ubnoie172ssjv8ul/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/9525xdsq4bz7ubnoie172ssjv8ul/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Eternal",
      "twitter_handle": "Zomato",
      "website": "https://www.eternal.com",
      "about": "Eternal is India’s largest new-age tech company by market cap, comprising of 4 businesses (as of now) – Zomato, Blinkit, District, & Hyperpure."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-03-29T17:00:35.760Z",
  "bug_reporter_agreed_on_going_public_at": "2018-03-29T13:50:19.427Z",
  "team_member_agreed_on_going_public_at": "2018-03-29T17:00:35.537Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "#Introduction\nIn the following ██████████ the endpoint `/php/restaurant_menus_handler.php` was found. This endpoint is meant solely to be accessible for admins, however due to insufficient protections normal users can access this endpoint too. This results in any Zomato user being able to edit and remove menu's from any restaurant. The following actions have been found in the JS file but there might be more: `menu_collected`, `toggle-res-menu-type`, `clear_menu_tool`, `change-menu-type`.\n\n#POC\nToggle-res-menu-type will be used in the POC since it switches between text and image menu's which makes it very easy to see the change happen on the page of the restaurant. When switching to text the images of the menu will disapear (and reappear when enabled).\n\nGo to https://www.zomato.com/████ and view the images under the menu section. After that submit the following JS code in the developers console. After this reload the page and the menu images should be gone. Do it once more and the images should reappear again.\n\n```js\n$.ajax({url:\"/php/restaurant_menus_handler.php\",type:\"POST\",data:{action:\"toggle-res-menu-type\",res_id:██████}\n```\n\n## Impact\n\nAny user can delete and edit any menu of any restaurant. The reason is that an admin endpoint has insufficient access protection.",
  "bounty_amount": "200.0",
  "formatted_bounty": "$200",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-04-28T13:50:19.718Z",
  "allow_singular_disclosure_after": -233556386.96093342,
  "singular_disclosure_allowed": true,
  "vote_count": 26,
  "voters": [
    "jensec",
    "sp1d3rs",
    "europa",
    "muon4",
    "spam404",
    "flashdisk",
    "asad0x01_",
    "apapedulimu",
    "xsam",
    "edoverflow",
    "and 16 more..."
  ],
  "structured_scope": {
    "databaseId": 383,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.zomato.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
