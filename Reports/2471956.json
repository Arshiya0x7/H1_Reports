{
  "id": 2471956,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDcxOTU2",
  "url": "https://hackerone.com/reports/2471956",
  "title": "Code exec on Github runner via Pull request name",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2024-04-19T16:38:36.603Z",
  "submitted_at": "2024-04-19T16:38:36.797Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "another_dude",
    "url": "/another_dude",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22522,
    "url": "https://hackerone.com/hyperledger",
    "handle": "hyperledger",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/4unr4nty3m2omunib0bwxy2s189l/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/4unr4nty3m2omunib0bwxy2s189l/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Linux Foundation Decentralized Trust",
      "twitter_handle": "lfdecentralized",
      "website": "https://www.lfdecentralizedtrust.org/",
      "about": "An industry-wide open source initiative to advance blockchain technology, governed by The Linux Foundation."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-04-28T18:08:27.840Z",
  "bug_reporter_agreed_on_going_public_at": "2024-04-28T18:08:27.707Z",
  "team_member_agreed_on_going_public_at": "2024-04-27T14:15:36.018Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\nI have discovered command injection vulnerability in one of your Github repos.\nApologies for any inconvenience if this type of bug is not of interest to you. Allow me to explain the problem.\nGitHub Actions, a powerful tool for automating workflows, can inadvertently introduce security vulnerabilities if not configured securely. Insecure GitHub Actions configuration can lead to various risks, including unauthorized access, data breaches, and code injection attacks.\nCurrently  https://github.com/hyperledger/cacti/tree/HEAD/.github/workflows/test_weaver-pre-release.yaml#L28 allows attacker to inject arbitrary command and run it on the Github runner. Note the usage of double quotes and untrusted `pull_request.name`.\n\n## Steps to reproduce\n- Create a new branch within your fork\n- Create a pull request with the `U\";cat $GITHUB_WORKSPACE/.git/config | xxd -p | base64; echo \"D` title\n- config file contains the access token in base64 form\n- Wait until `check_release` workflow will be triggered\n- Check job logs for encoded `$GITHUB_TOKEN` (by default Github will replace it with *** if you will try just echo it, that is why I used xxd + base64)\n- I refrained from creating a PR on your repository to prevent the disclosure of sensitive information to the public and to avoid publicly exposing the vulnerability.\nExample run could be found in my fork, attached as screenshot.\n\n## Impact\n\nSuch scenario leaves possibility to access `$GITHUB_TOKEN` environment variable, potentially compromising the whole GitHub organization.\nGood explanation of the problem could be found at github docs: https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions\n\nThere are few limits to the attack:\n- `$GITHUB_TOKEN` is a short lived token and for the real life attack, whole attack should be scripted until job is still running",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 3210475,
      "file_name": "Screenshot_2024-04-19_at_18.27.28.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yn5ez3y5364j58lzmbto16aog7oo?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2024-04-19_at_18.27.28.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2024-04-19_at_18.27.28.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSYGIDCYA%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T190312Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJIMEYCIQC9H4H%2FcgNRdtrqJdpgzJLCUfMHgrHXEyMkJIC5oq1%2BqgIhAL%2FT0LqFtkCt7xRAjNECIiDA4QKbCrQYdXGe%2BOketYwbKrsFCO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgympY2EmIHjz9PttlQqjwX1%2FkVSKtqiEX%2FrlAyBEfV6KlcOrbNjQ1PjgsEqbEt4zFUBC82PGgp5N1ZprTln38m5pHxKavz7FPwJGa%2Fr5L6yMUASxE3z2NfD%2BmFnt7SifZYMod%2B3MVmXuAubqMcJnA9%2FpHNlmMQsMBBtGxDkleXJVKuS1cA9RAev9hhW%2FiSsU70dpQey4ZUohM%2Fy5EfvH03KUd3HbZ0iwgjjv01vKzHkuNd5sdAFo%2BVAb3HuXxoOWThWu8Wu6HpEz0nZvq2TPa4sytfBQ%2Bw%2BU35ESQVOHeaQFJj%2FaIYGirCgawi7TaZcBAYju1wxJ4x8kgdHunmz%2BiwS1%2F1j7QPK57rHSkpP%2BMZ8hgXoqx0rj0f9bsa5s%2F%2BAzxvWnIqboSIRr17MhAJLQrcfbBs6J8zdfJCwxiQHYNHhXl1S42NFra1dCiRryUxZYvBy8D3DB1GR5Lqu8Uotu4XEbDOlPisU0KkMiFywF37UUnkH6jXXbBtPKoAcWU3uQk%2Bv35Zf8Yipk08SLYVQiNx%2Fx02mWZts0YZhA0qaTDTZDLs4KHQkidBckTTYP6rv7Hv9JMm1dhuCKEK57vKjfMuqPSV34NQgQW8arQtiXXOJ0NTNl3vhz20TqGRVVQ7gwd%2FfHuFGb1Ng%2BpM%2FHh4BpzQBkLTKuR2uQXCHtNCyTq2bZ8Ekh%2FoK3NUqs5VKaAu8f2xvxfE2A7DVNFnNdG%2FYHyPOezGZaaNZ4RcT7cIpLOlEUuy9AgVDaB0ua%2FLHOB%2FnvOl9oONFx0%2BkQxlN0RkmXsfctZPxJ3b8ceTTzdGV0UsOzMwag38puLoquN7j33NEiJwIlWnMjNmN5EDT4KnAaG9YMkVrT8R%2FEr5Y7OCGppWxnXbt%2FIZFPdKwdSAGB7pqMMzwusYGOrABxR%2B1CwYBZOSNwbylysAE1euwBQ3LuR%2BH5uGtEh%2FY8bEJOVTQRiy%2FD1sAVtG%2FlUF7ZvgoOryujNxLvQAVr7Wlngi8mvbbFqymK7ZNC%2BZV5E3EmnPRm3Y8tfJ5Ivczocxv42P%2Boj87VfWlqc6LmWh5YQEJGDO0Pr5gNG6W0tDPlb67EntD%2F609Yzeu9nqdezj25XKqu9D%2FW6KuXFVbzB%2FYeUp86fOIOSrHVUyjx7u7ccA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=833db1c7b4f5a7d2e3d3e4525ce42ac87ff16d02dc11e91681bb0fe04570db06",
      "file_size": 438988,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2024-05-27T14:15:36.123Z",
  "allow_singular_disclosure_after": -41575656.8443427,
  "singular_disclosure_allowed": true,
  "vote_count": 26,
  "voters": [
    "zy9ard3",
    "itaachiuchiha",
    "hundredpercent",
    "neilx",
    "011alsanosi",
    "exception",
    "eminfidan",
    "insabat",
    "c101ciberseg",
    "sandblizzard",
    "and 16 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.0,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "high",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "low"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
