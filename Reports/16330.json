{
  "id": 16330,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjMzMA==",
  "url": "https://hackerone.com/reports/16330",
  "title": "Multiple issues in looking-glass software (aka from web to BGP injections)",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-06-13T14:30:13.410Z",
  "submitted_at": "2014-06-13T14:30:13.410Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kaeso",
    "url": "/kaeso",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/006/350/dc751e0337dd4ea3b5cfd50d8f78ec223e59bb3a_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXRMVJ5J5%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T154943Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHvpeFRGxer%2FvWr9U1iJg3RkGlJPPFj4B1AHCmELHvg0AiEA3tVo83DAR1waruPLv%2Fu8vB9bR4IqtbLU0FcfUK2SWK4qsgUIMBADGgwwMTM2MTkyNzQ4NDkiDOgV4stYWuksi315TCqPBTSyxHdDk9aIJWUXYP6dpR2hHjf4Lm2OmqG2txbrJ96dAFVsJl5WdhXN5poEKL%2B3vXRmLvgEI8oo%2BbITruxVtSca%2FXbpaeMDsG60%2BtVUNL8GY9G6XVHxwRNis96ulShvFkdYL95u%2F9BE6bHUiDyiDqW%2B3fWThOXRCd3eGH7K78T6iJJ%2FXPtdbnw0qEp3xnzhxVQuLM1e6ocxb5JKQro3HYWeofUVMeUYgBk5ichyV4i39DzesIHOdtEY1%2FFr5cO6BknHGI4QlTEFqSQ0jKwu54rl7Y6E%2BaZ3mp8Q%2Btd%2Bg9937vj1aJ9qhhj8i3tGtw8W%2BxC8sROiJ9Pn77pKG2W4hNpAyD5F6sNpIAF9vt9bRRr%2FZ%2BSnCcipXGJKkQ6Hcoy%2BJi242PhaHRQ1QO1qTSpTDPoN1qZtR2wR9nUszH5PMi4QmxwGIh01o%2B9Wm%2BWMTnnqM16OG52%2BRyxbc23dxja1vQVYylB4AR0O3PFpl3EFwn2jqYjiHYJ%2F6RJQDkkVSbnPyErUc9Ee5jaNlrYkR%2B512HKh7%2BD6AhqQJOWut8J1JadNJruJlPJ3xGDotuzZ9CpU2CA2oucGiIIogsZcPb75cH2JVlMGqGvzPEr04jl7OXE1njTEgB2XK3e%2Fw3VUuucNO63UKfjWrTnJi3XMfg1Ng%2Fu9oey3Uo2hQHA5SzIrtE32mdf5MlJGeIzmaaGgdFr9HJVkYRdU%2FiUFT26z2OzXitUwlejztiMD2BhN2Orim8RbEKbvvABTsRcvsIuPNaAaxf9ug5m%2FKbPyoz77Ruu4F1%2F98Td0OwZ%2BmxssKQ058QXkSGkXP9o8RhEiJAcpm5uHdtJmIrImKcpqU5uy8xptKTOC5VGIZeizx3DNxP2cZhYwicbFxgY6sQFd5FT1B5MlZMXS0Wluys%2FN%2B6sOHgNoVYPrRKKl6L4X1L3Qv%2BfsOVhdER%2F5XwepRHhkQe2dojWb9sZIIBlb1o6Wq8TxyLEXiwOJ5cNtpQKHgMdtczrD4NnkdCqP%2FbWEJHB9Z2i0xSshL783%2FtLC4Z9%2BmAu7vaUG7ZYYkf7Wel47W8dCXztjBQk9ZwqXfjGflGJipVy%2Bv45%2F%2B5fWFEBrMLBqatLAl0RiovcR7dfS1tvFvsM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=de2bc15827d0dae21b6494417bb56fcd3e963e64e88b500c37f721ec8fdf292c",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXRMVJ5J5%2F20250922%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250922T154943Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHvpeFRGxer%2FvWr9U1iJg3RkGlJPPFj4B1AHCmELHvg0AiEA3tVo83DAR1waruPLv%2Fu8vB9bR4IqtbLU0FcfUK2SWK4qsgUIMBADGgwwMTM2MTkyNzQ4NDkiDOgV4stYWuksi315TCqPBTSyxHdDk9aIJWUXYP6dpR2hHjf4Lm2OmqG2txbrJ96dAFVsJl5WdhXN5poEKL%2B3vXRmLvgEI8oo%2BbITruxVtSca%2FXbpaeMDsG60%2BtVUNL8GY9G6XVHxwRNis96ulShvFkdYL95u%2F9BE6bHUiDyiDqW%2B3fWThOXRCd3eGH7K78T6iJJ%2FXPtdbnw0qEp3xnzhxVQuLM1e6ocxb5JKQro3HYWeofUVMeUYgBk5ichyV4i39DzesIHOdtEY1%2FFr5cO6BknHGI4QlTEFqSQ0jKwu54rl7Y6E%2BaZ3mp8Q%2Btd%2Bg9937vj1aJ9qhhj8i3tGtw8W%2BxC8sROiJ9Pn77pKG2W4hNpAyD5F6sNpIAF9vt9bRRr%2FZ%2BSnCcipXGJKkQ6Hcoy%2BJi242PhaHRQ1QO1qTSpTDPoN1qZtR2wR9nUszH5PMi4QmxwGIh01o%2B9Wm%2BWMTnnqM16OG52%2BRyxbc23dxja1vQVYylB4AR0O3PFpl3EFwn2jqYjiHYJ%2F6RJQDkkVSbnPyErUc9Ee5jaNlrYkR%2B512HKh7%2BD6AhqQJOWut8J1JadNJruJlPJ3xGDotuzZ9CpU2CA2oucGiIIogsZcPb75cH2JVlMGqGvzPEr04jl7OXE1njTEgB2XK3e%2Fw3VUuucNO63UKfjWrTnJi3XMfg1Ng%2Fu9oey3Uo2hQHA5SzIrtE32mdf5MlJGeIzmaaGgdFr9HJVkYRdU%2FiUFT26z2OzXitUwlejztiMD2BhN2Orim8RbEKbvvABTsRcvsIuPNaAaxf9ug5m%2FKbPyoz77Ruu4F1%2F98Td0OwZ%2BmxssKQ058QXkSGkXP9o8RhEiJAcpm5uHdtJmIrImKcpqU5uy8xptKTOC5VGIZeizx3DNxP2cZhYwicbFxgY6sQFd5FT1B5MlZMXS0Wluys%2FN%2B6sOHgNoVYPrRKKl6L4X1L3Qv%2BfsOVhdER%2F5XwepRHhkQe2dojWb9sZIIBlb1o6Wq8TxyLEXiwOJ5cNtpQKHgMdtczrD4NnkdCqP%2FbWEJHB9Z2i0xSshL783%2FtLC4Z9%2BmAu7vaUG7ZYYkf7Wel47W8dCXztjBQk9ZwqXfjGflGJipVy%2Bv45%2F%2B5fWFEBrMLBqatLAl0RiovcR7dfS1tvFvsM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4502e8cda90e09cc25c5460cfe0a7e24f2354f7bd28fa2d5aadbe0ecbb7a7544"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2014-3926",
    "CVE-2014-3927",
    "CVE-2014-3928",
    "CVE-2014-3929",
    "CVE-2014-3930",
    "CVE-2014-3931"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2014-09-17T19:43:06.035Z",
  "bug_reporter_agreed_on_going_public_at": "2014-08-18T19:43:03.398Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "During the month of May 2014 we performed an offensive security analysis, trying to find how hard would it be for a low-to-medium skilled attacker to disrupt the core of the Internet (ie. achieve the largest possible impact at the lowest common layer, with minimal resource). This is a confidential report on our results, showing vulnerabilities and incidents which have been properly reported in the meanwhile (authors contacted, CVE assigned, patches written and incidents handled).\r\n\r\nMotivations\r\n==========\r\n\r\nThe target of our analysis are looking-glasses, web applications hosted by Autonomous Systems to offer restrict public access in order to debug network connectivity issues. We identified them as a possible weak links because:\r\n * they are web scripts, directly connected to backbone (BGP) routers via telnet/ssh\r\n * many of them have been written in 90's or 00's, without security in mind\r\n * many of them have not seen any update in many years\r\n * a bunch of open-source software are deployed by many ASes\r\n \r\n A succesfull attack on a looking-glass means gaining access to routers console, by just attacking decade-old PHP/Perl scripts.\r\nAn attacker could steal credentials or find web-flaws to login and run arbitrary commands on the routers. Even with proper ACL in place, it is easy to escalate privileges by abusing one of many existing techniques, eg. on Cisco [0] and on Juniper [1] routers.\r\n \r\nOnce there, an attacker can cause great havoc on the network. Low-hanging targets include leaking sensitive informations (eg. private routing plans) and fingerprinting the internal network. Medium-level attacks could encompass redirecting some of internal routing (eg. setting up mirroring interfaces) or performing DoS (eg. by changin OSPF configuration).\r\nHigh-level attacks would instead be targeted to the Internet: multiple rogue routers announcing malicious BGP routes will effectively disrupt worldwide connectivity.\r\n \r\n The last point is basically our motivation to submitting for this bug bounty, as the vulnerabilities and incidents below could have been abused to disrupt the Internet at BGP level from multiple injection points.\r\n \r\nResults\r\n======\r\n\r\nAll the flaws we found can be categorized as follow:\r\n * unsafe default config resulting in exposed IP, credentials, and SSH private keys => *direct login to routers*\r\n * weak commands sanitization => *arbitrary commands injection to routers*\r\n * remote memory corruption => *RCE on looking-glass servers, exploitable to read routers credentials*\r\n * reflected XSS => *stealing cookies for other network administration panels under the same-origin*\r\n\r\n \r\nIn particular, we got 6 CVEs assigned and confirmed:\r\n  * XSS in Cougar-LG - http://www.s3.eurecom.fr/cve/CVE-2014-3926.txt\r\n  * Routers command injection in mrlg4php - http://www.s3.eurecom.fr/cve/CVE-2014-3927.txt\r\n  * Exposed credentials in Cougar-LG - http://www.s3.eurecom.fr/cve/CVE-2014-3928.txt\r\n  * Exposed SSH keys in Cougar-LG  - http://www.s3.eurecom.fr/cve/CVE-2014-3929.txt\r\n  * Exposed credentials in Cistron-LG - http://www.s3.eurecom.fr/cve/CVE-2014-3930.txt\r\n  * Remote memory corruption in SUID binary - http://www.s3.eurecom.fr/cve/CVE-2014-3931.txt\r\n\r\nEach report contains full details and timeline on the issue.\r\n\r\nStarting from the above CVEs, we performed a brief survey of impacted AS and we observed the following number of incidents:\r\n * 18 exposed configuration files (containing IPs, usernames, telnet/ssh passwords)\r\n * 12 remote command injection (via mrlg4php)\r\n * 4 misconfigured CGI (exposed IPs, usernames, telnet/ssh passwords)\r\n * 3 exposed SSH private keys\r\n\r\nWe privately contacted all the ISP (Cc:ing their national FSIRT) to properly secure the exposed configuration files, and to update mrlg4php to fixed version.\r\n\r\nDisclosure\r\n=========\r\nIn order to avoid major screw-ups, we proceed as following:\r\n * asked CERT-FR (our national one) and CERT/CC to coordinate disclosure for us, they suggested instead to handle the issue ourself\r\n * contacted MITRE to get confirmation of the issues, got 6 CVEs assigned\r\n * contacted authors to report the issues. Worked with the available ones for a patched version. Filled bugs for unreachable ones, as suggested by CERT/CC.\r\n * contacted all AS and national FSIRT to report the incidents we spot in the wild. Worked with them for follow-ups.\r\n\r\nAll the process took ~1 month, and was handled in embargo mode and in private as far as possible. We are now reaching the proposed deadline for full public disclosure (16/06) with no pending blockers by software authors and AS.\r\n\r\nResearch reports\r\n==============\r\n\r\nOnce the embargo is over we would like to produce more detailed reports on what we found during the study, as such we are submitting an academic paper to WOOT'14 and a talk at DEFCON'14. Both are current under embargo and pending review, but we can attach them, if requested, under an informal non-disclosure agreement.\r\n\r\n[0] Cisco bulletin: *cisco-sr-20130318-type4*\r\n\r\n[1] Juniper bulletin: *JSA10420*\r\n",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2014-09-17T19:43:03.555Z",
  "allow_singular_disclosure_after": -347573200.1394168,
  "singular_disclosure_allowed": true,
  "vote_count": 2,
  "voters": [
    "shivammusic",
    "destinedtohack"
  ],
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
