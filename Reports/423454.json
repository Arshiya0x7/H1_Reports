{
  "id": 423454,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjM0NTQ=",
  "url": "https://hackerone.com/reports/423454",
  "title": "H1514 Stored XSS on Wholesale sales channel allows cross-organization data leakage",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-10-13T18:45:38.462Z",
  "submitted_at": "2018-10-13T18:45:38.462Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cablej",
    "url": "/cablej",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-11-01T20:49:19.323Z",
  "bug_reporter_agreed_on_going_public_at": "2019-11-01T20:49:19.234Z",
  "team_member_agreed_on_going_public_at": "2019-11-01T15:34:50.846Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\n\nThere exists a stored XSS vulnerability via the Wholesale sales channel at https://wholesale.shopifyapps.com. This allows an attacker who shares one shop with an account owner to access the Wholesale sales channel of any shop belonging to the owner.\n\n## Steps To Reproduce:\n\n  1. Visit https://wholesale.shopifyapps.com and add the Wholesale integration to your account.\n  1. Navigate to the Wholesale sales channel at https://your-store.myshopify.com/admin/apps/wholesale.\n  1. Navigate to create a new price list import.\n  1. Modify the sample CSV file at https://help.shopify.com/manual/sell-online/wholesale/channel/price-lists-customers/import-prices/sample-csv-sku.csv to include the SKU of one of your shop's products.\n  1. Upload the CSV file.\n  1. After creating the price list, modify the price list and intercept the request to `POST /admin/shops/x/price_lists/x`.\n  1. Modify the `price_list[csv_file_name]` parameter to include an XSS payload, such as `sample-csv-sku.csv\"-alert(document.domain)-\"`.\n  1. Navigate back to the newly created price list. Observe that when visiting the page, the XSS payload will fire on the embedded domain `https://wholesale.shopifyapps.com`:\n\n    {F360186}\n\n  1. As this domain is shared across shops, this can be exploited to access the Wholesale information of any store a user has access to.\n\n## Impact\n\nAn attacker with the `Apps` permission who shares one shop with an owner of multiple stores (e.g. via Shopify partners) can exploit this vulnerability to gain access to the Wholesale sales channel of any shop belonging to the owner.\n\nAs stated when authenticating with Wholesale:\n\n> Wholesale will be able to access data such as customer names, e-mail addresses, phone numbers, physical addresses, geolocations, IP addresses, and browser user agents.\n\nAs a result, this allows access to extensive customer information, as well as the ability to modify any Wholesale information.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 360186,
      "file_name": "Screen_Shot_2018-10-13_at_2.41.16_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/186/7c566eac4fd946f0d0a72063e75d731c297f9d01/Screen_Shot_2018-10-13_at_2.41.16_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-13_at_2.41.16_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-13_at_2.41.16_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQT5SD3VK2%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T135552Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQClRXfVQ6TcJFROTF%2BD0LDL4IptBemJc5EMG848%2FCEiSQIhAKDXmyowzdpDu4zfEapkWcuivUF63JNAxYz2favlbU6bKrIFCBcQAxoMMDEzNjE5Mjc0ODQ5IgyKlpw5OowlLiWsLL8qjwU0D29xrhlZFCfHcqjeZqnfiyItH0QCdyaKA%2F8%2BPGpNz2JgpL6QTAwDZCtHYpJ2OsSV%2Fr0t%2BhiNft4faKC3j2Re4gXFlwXAzQ3UGuAAGxcwgIc7gFmPcZWE0SRhBdJmk2S%2BJos09tCiFdi%2FbxRyB3zF64dzD5fSumyqcEn%2B2Vnd00pMBX742VkbEf7ZrNuyB62b1ytaX9jj9uvCFABG55FHDM%2Bs37wZacobZcdYBUPtU2XeZTkWX7AKGe%2FYmNjN%2FCI%2BxIoV7xxTqcG%2Baq7erC61AYhVA5BQfpjdl1bhHpa12u1DFE7HS57F97QReN6xh059bv%2FTllJIx8plaNjjH2jyflJMGw0Dw2DMiRrS7tIxJhQLAjBMb4C4V7N%2BM%2BaYvfy8%2FfbziqtvAUL8KMu6JyAjiQFuRhibIpqiMs3vU1r2o3TaJvpwb%2F9%2B0noBVyL2mEXDZLSZXRNCnvTiCzHLsk87FJVYtRr2awVVN9HtLz2KvmKgDreKiPAOXfPCFtAQa9YLiWIPUuVtgioN9ZBo5xJaCCyMGIzCh%2Fkrs1a0DcWy4F7Ytp4jBJcaMTR19B9HxNJL3aj8fMZlif8A0f0aaG%2FBgx7o5981IkRN3fvdIme%2FGy59thdwpQWaGEcGFmbADJgW%2FUetzXfy4OHnAUuQN5g8tkLNZhOOMkLBC3kLLrbfeiTttC8hssEuonPS5FvdddJqvftgcN%2Btb6H%2B1mYkyDlIcS6dii1q%2BhZizteMV9E0OBg1K8Ylk36UwJ3sW%2B8VxpTiVst%2FCObvfePMpGyI10NWIZQWKo%2BbxnzRUnD14TtT5uqbGn0QUuAEyUMWhQFS5SK5ZjRVCzQKPJTjGtT1RulMo59rlIi8SANcD1u8orU0MJP5v8YGOrABxqGEwH2lu%2FSIiLkjMB93i6n75LP7E6dFaf8U2coeh%2FJFyPT0Fob%2BvLKn7heOlHaTP86GXxcuQ%2F7dOAFxfCcMZJwPoTg4MLVffgesdH3XcR6WccyCO7CULPqRy39ydkdy5bAD0rlIb4KBU4W2miAyLWCv5A8%2BACxOO2Y%2BdrmDICvpHOjLOqM2jQrXEsy42y2NRm8%2FtGBFtSOfk9J9G5g0mOcoHMA4EPWmf7LR9VvpFQc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b59823a4f8eba33315b15440788ce992861da732672852ae88d3ac00c58398ea",
      "file_size": 213163,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 21,
  "voters": [
    "nohats",
    "drsniper",
    "ali",
    "sameerphad72",
    "sh1yo",
    "spam404",
    "taaminz",
    "cryptographer",
    "0xm1racle",
    "sohaip_hackerdz",
    "and 11 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 11387,
      "category": "team",
      "content": "@cablej reported an XSS issue in the Wholesale Channel through the `price_list[csv_file_name]` parameter when importing a price list from a CSV. This value was not properly escaped for javascript context, and led to a stored XSS issue when visiting that price list.",
      "updated_at": "2018-10-31T18:45:33.575Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 75410,
        "username": "jenn-shopify",
        "name": "jenn",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-05-09T18:26:09.949Z",
        "url": "https://hackerone.com/jenn-shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
