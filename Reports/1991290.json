{
  "id": 1991290,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTkxMjkw",
  "url": "https://hackerone.com/reports/1991290",
  "title": "Endpoint Redirects to Admin Page and Provides Admin role",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2023-05-18T00:11:05.457Z",
  "submitted_at": "2023-05-18T00:11:05.535Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bulldawg",
    "url": "/bulldawg",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/entivic4k6dr2931e210jzitq5k9/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-07-19T14:43:23.062Z",
  "bug_reporter_agreed_on_going_public_at": "2024-06-23T02:45:45.713Z",
  "team_member_agreed_on_going_public_at": "2024-07-19T14:43:22.913Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nBy navigating to https://████████.mil/apexcrrel/f?p=165:56, the user will automatically be redirected to the web application admin portal with Admin access.\n\n**Description:**\nThere is a web application running at the following URL:\n\nhttps://█████.mil/apexcrrel/f?p=165:1::::::\n\n████\n\nFor context, this is a web application running on a Oracle Apex Express platform. The '165' in the 'p' parameter in the URL is a unique identifier for the web application. The '1' following the '165' represents the page that the user is viewing. \n\nThe page '56' can be used to automatically obtain administrator access to this application. \n\nHere we can see that we can't access the 45th page (https://████.mil/apexcrrel/f?p=165:45) because we are not an Admin.\n\n███████\n\nHowever, navigating to the 56th page (https://██████████.mil/apexcrrel/f?p=165:56) automatically redirects to the 45th page but provides a valid admin session. \n\n█████████\n\nWe can also see that we have the ability to manage users, including admin users.\n\n██████████\n\nAs a note, I found this due to the application at https://████.mil/apexcrrel/f?p=164:5::::::\nThis is a separate web application, given that the unique identifier is now 164. \n\nOn this page there is a 'Go To Admin' button. When clicking this, it calls the /apexcrrel/DISDI_PORTAL_DEV.login_admin endpoint. This redirects the user to the 56th page, breaking the access control and providing Admin access.\n\n███████\n\n## Impact\n\nThis is a critical severity bug that impacts confidentiality, integrity, and availability. \n\nConfidentiality: An attacker can obtain first names, last names, email addresses, and filenames of uploaded files.\nIntegrity: An attacker can upload files, edit documents, and edit user roles\nAvailability: An attacker could remove all users, including admins, making it difficult for users to use the application.\n\n## System Host(s)\n█████.mil\n\n## Affected Product(s) and Version(s)\nOracle Apex Express\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n1. To verify that you do not have any valid sessions to view the admin pages, visit https://██████.mil/apexcrrel/f?p=165:45\n2. Now, navigate to https://█████████.mil/apexcrrel/f?p=165:56\n3. You now have admin access to the application.\n\n## Suggested Mitigation/Remediation Actions\n\n\n",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 26,
  "voters": [
    "bulldawg",
    "zy9ard3",
    "shubham_srt",
    "mohaned0101",
    "bulld0z3r",
    "iwasday",
    "pr0f0x01",
    "zeroosec",
    "eminfidan",
    "the3eyedraven",
    "and 16 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
