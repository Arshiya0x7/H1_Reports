{
  "id": 3434156,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDM0MTU2",
  "url": "https://hackerone.com/reports/3434156",
  "title": "Username Validation Bypass",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2025-11-19T21:07:20.540Z",
  "submitted_at": "2025-11-19T21:07:21.029Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "kassem_s94",
    "url": "/kassem_s94",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/5ulxb2eyi2yikqu2ilbjhyvvn6r6/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2367,
    "url": "https://hackerone.com/revive_adserver",
    "handle": "revive_adserver",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Revive Adserver",
      "twitter_handle": "",
      "website": "https://www.revive-adserver.com",
      "about": "Revive Adserver is a free open source ad serving system"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2025-55129"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2025-11-26T14:18:23.768Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2025-11-26T14:18:06.948Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Cricetinae\n\n## Executive Summary\n\nThe security patch in commit `d239a0845e4f64fbacd25fff2854426734d43aa2` is **INSUFFICIENT**. \nTesting confirms that **3 out of 4 exploit vectors still bypass validation**.\n\n---\n\n## Vulnerability Details\n\n**Affected Component:** Username validation in user registration/creation\n**File:** `lib/OA/Admin/UI/UserAccess.php`\n**Line:** 116\n**Current Pattern:** `#[\\x00-\\x1F\\x7F\\s]#u`\n\n**Severity:** Medium-High (CVSS 6.5)\n**Impact:** Account impersonation, phishing, validation bypass\n\n---\n\n## Proof of Concept - Working Exploits\n\n### Exploit 1: Zero-Width Space (U+200B)  CRITICAL\n\n**Description:** Invisible Unicode character that creates duplicate accounts\n\n**Payload (Hex):** `61646d696ee2808b`\n**Payload (Decoded):** `admin` + `0xE2 0x80 0x8B` (UTF-8 for U+200B)\n**Payload (Literal):** The username \"admin\" followed by Unicode character U+200B\n\n**How to reproduce:**\n```php\n$malicious_username = \"admin\" . \"\\xE2\\x80\\x8B\";  // Hex bytes\n// OR\n$malicious_username = \"admin\" . mb_chr(0x200B, 'UTF-8');  // Unicode codepoint\n```\n\n**Test code:**\n```php\n<?php\n$username = \"admin\" . \"\\xE2\\x80\\x8B\";  // admin + Zero-Width Space\n\necho \"Username: admin[U+200B]\\n\";\necho \"Hex bytes: \" . bin2hex($username) . \"\\n\";\necho \"Expected: 61646d696ee2808b\\n\\n\";\n\n// Test against patched pattern\nif (preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $username)) {\n    echo \"Result: BLOCKED ✓\\n\";\n} else {\n    echo \"Result: PASSES - VULNERABLE! ✗\\n\";\n}\n?>\n```\n\n**Expected output:**\n```\nUsername: admin[U+200B]\nHex bytes: 61646d696ee2808b\nExpected: 61646d696ee2808b\n\nResult: PASSES - VULNERABLE! ✗\n```\n\n**Impact:**\n- Creates account that looks identical to \"admin\" visually\n- Bypasses username uniqueness constraints\n- Enables account enumeration attacks\n- Perfect for impersonation attacks\n\n---\n\n### Exploit 2: RTL Override (U+202E)  HIGH\n\n**Description:** Right-to-Left Override mark that reverses text display direction\n\n**Payload (Hex):** `61646d696ee280ae74657374`\n**Payload (Decoded):** `admin` + `0xE2 0x80 0xAE` + `test`\n**Payload (Literal):** The text \"admin\" + U+202E + \"test\"\n\n**How to reproduce:**\n```php\n$malicious_username = \"admin\" . \"\\xE2\\x80\\xAE\" . \"test\";  // Hex bytes\n// OR\n$malicious_username = \"admin\" . mb_chr(0x202E, 'UTF-8') . \"test\";  // Unicode\n```\n\n**Test code:**\n```php\n<?php\n$username = \"admin\" . \"\\xE2\\x80\\xAE\" . \"test\";  // admin + RTL Override + test\n\necho \"Username: admin[U+202E]test\\n\";\necho \"Hex bytes: \" . bin2hex($username) . \"\\n\";\necho \"Expected: 61646d696ee280ae74657374\\n\";\necho \"Visual display: 'tset' + 'admin' (reversed!)\\n\\n\";\n\n// Test against patched pattern\nif (preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $username)) {\n    echo \"Result: BLOCKED ✓\\n\";\n} else {\n    echo \"Result: PASSES - VULNERABLE! ✗\\n\";\n}\n?>\n```\n\n**Expected output:**\n```\nUsername: admin[U+202E]test\nHex bytes: 61646d696ee280ae74657374\nExpected: 61646d696ee280ae74657374\nVisual display: 'tset' + 'admin' (reversed!)\n\nResult: PASSES - VULNERABLE! ✗\n```\n\n**Impact:**\n- Text appears reversed in UI (\"testadmin\" displays as different order)\n- Confuses administrators reviewing user accounts\n- Enables social engineering attacks\n- Visual spoofing in logs and admin panels\n\n---\n\n### Exploit 3: Cyrillic Homograph (U+0430)  CRITICAL\n\n**Description:** Cyrillic letter 'а' (U+0430) that looks identical to Latin 'a' (U+0061)\n\n**Payload (Hex):** `d0b0646d696e`\n**Payload (Decoded):** `0xD0 0xB0` + `dmin`\n**Payload (Literal):** Cyrillic 'а' (U+0430) followed by Latin \"dmin\"\n\n**How to reproduce:**\n```php\n$malicious_username = \"\\xD0\\xB0\" . \"dmin\";  // Hex bytes\n// OR\n$malicious_username = mb_chr(0x0430, 'UTF-8') . \"dmin\";  // Unicode\n```\n\n**Test code:**\n```php\n<?php\n$username = \"\\xD0\\xB0\" . \"dmin\";  // Cyrillic а + Latin dmin\n\necho \"Username: [U+0430]dmin (looks like 'admin')\\n\";\necho \"Hex bytes: \" . bin2hex($username) . \"\\n\";\necho \"Expected: d0b0646d696e\\n\";\necho \"Visual: Appears identical to 'admin'\\n\\n\";\n\n// Compare with real admin\n$real_admin = \"admin\";\necho \"Real 'admin' hex: \" . bin2hex($real_admin) . \"\\n\";\necho \"Looks same? YES | Hex same? NO\\n\\n\";\n\n// Test against patched pattern\nif (preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $username)) {\n    echo \"Result: BLOCKED ✓\\n\";\n} else {\n    echo \"Result: PASSES - VULNERABLE! ✗\\n\";\n}\n?>\n```\n\n**Expected output:**\n```\nUsername: [U+0430]dmin (looks like 'admin')\nHex bytes: d0b0646d696e\nExpected: d0b0646d696e\nVisual: Appears identical to 'admin'\n\nReal 'admin' hex: 61646d696e\nLooks same? YES | Hex same? NO\n\nResult: PASSES - VULNERABLE! ✗\n```\n\n---\n\n## Complete Test Script\n\nSave this as `test_vulnerability.php` and run with `php test_vulnerability.php`:\n\n```php\n<?php\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\necho \"========================================\\n\";\necho \"Revive Adserver - Vulnerability Test\\n\";\necho \"========================================\\n\\n\";\n\n// Test 1: Zero-Width Space\necho \"[TEST 1] Zero-Width Space (U+200B)\\n\";\necho \"----------------------------------------\\n\";\n$test1 = \"admin\" . \"\\xE2\\x80\\x8B\";\necho \"Payload hex: \" . bin2hex($test1) . \"\\n\";\necho \"Expected:    61646d696ee2808b\\n\";\necho \"Match: \" . (bin2hex($test1) === \"61646d696ee2808b\" ? \"YES ✓\" : \"NO ✗\") . \"\\n\";\n$blocked1 = preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $test1);\necho \"Status: \" . ($blocked1 ? \"BLOCKED ✓\" : \"VULNERABLE ✗\") . \"\\n\\n\";\n\n// Test 2: RTL Override\necho \"[TEST 2] RTL Override (U+202E)\\n\";\necho \"----------------------------------------\\n\";\n$test2 = \"admin\" . \"\\xE2\\x80\\xAE\" . \"test\";\necho \"Payload hex: \" . bin2hex($test2) . \"\\n\";\necho \"Expected:    61646d696ee280ae74657374\\n\";\necho \"Match: \" . (bin2hex($test2) === \"61646d696ee280ae74657374\" ? \"YES ✓\" : \"NO ✗\") . \"\\n\";\n$blocked2 = preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $test2);\necho \"Status: \" . ($blocked2 ? \"BLOCKED ✓\" : \"VULNERABLE ✗\") . \"\\n\\n\";\n\n// Test 3: Cyrillic Homograph\necho \"[TEST 3] Cyrillic Homograph (U+0430)\\n\";\necho \"----------------------------------------\\n\";\n$test3 = \"\\xD0\\xB0\" . \"dmin\";\necho \"Payload hex: \" . bin2hex($test3) . \"\\n\";\necho \"Expected:    d0b0646d696e\\n\";\necho \"Match: \" . (bin2hex($test3) === \"d0b0646d696e\" ? \"YES ✓\" : \"NO ✗\") . \"\\n\";\n$blocked3 = preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $test3);\necho \"Status: \" . ($blocked3 ? \"BLOCKED ✓\" : \"VULNERABLE ✗\") . \"\\n\\n\";\n\n// Test 4: Ideographic Space (should be blocked)\necho \"[TEST 4] Ideographic Space (U+3000) - Control\\n\";\necho \"----------------------------------------\\n\";\n$test4 = \"admin\" . \"\\xE3\\x80\\x80\" . \"test\";\necho \"Payload hex: \" . bin2hex($test4) . \"\\n\";\necho \"Expected:    61646d696ee3808074657374\\n\";\necho \"Match: \" . (bin2hex($test4) === \"61646d696ee3808074657374\" ? \"YES ✓\" : \"NO ✗\") . \"\\n\";\n$blocked4 = preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $test4);\necho \"Status: \" . ($blocked4 ? \"BLOCKED ✓\" : \"VULNERABLE ✗\") . \"\\n\\n\";\n\n// Summary\necho \"========================================\\n\";\necho \"SUMMARY\\n\";\necho \"========================================\\n\";\n$vuln_count = (!$blocked1 ? 1 : 0) + (!$blocked2 ? 1 : 0) + (!$blocked3 ? 1 : 0);\necho \"Vulnerabilities found: $vuln_count/3\\n\";\necho \"Patch effectiveness: \" . ((3 - $vuln_count) / 3 * 100) . \"%\\n\\n\";\n\nif ($vuln_count > 0) {\n    echo \"  CRITICAL: Patch is INSUFFICIENT!\\n\";\n    echo \"Working exploits:\\n\";\n    if (!$blocked1) echo \"  • Zero-Width Space\\n\";\n    if (!$blocked2) echo \"  • RTL Override\\n\";\n    if (!$blocked3) echo \"  • Cyrillic Homograph\\n\";\n} else {\n    echo \"✓ All exploits blocked\\n\";\n}\necho \"\\n========================================\\n\";\n?>\n```\n\n---\n\n## Recommended Fix\n\nReplace the current blacklist pattern with a whitelist approach:\n\n```php\n// Current (VULNERABLE):\nif (preg_match('#[\\x00-\\x1F\\x7F\\s]#u', $this->request['login'])) {\n    $this->aErrors = [$GLOBALS['strInvalidUsername']];\n}\n\n// Recommended (SECURE):\nif (empty($this->request['login']) || \n    strlen($this->request['login']) > 255 ||\n    !preg_match('/^[a-zA-Z0-9._@-]+$/D', $this->request['login']) ||\n    $this->request['login'] !== trim($this->request['login'])) {\n    $this->aErrors = [$GLOBALS['strInvalidUsername']];\n}\n```\n\n**Additional recommendations:**\n1. Unicode normalization (NFC) before validation\n2. Implement confusables detection\n3. Log suspicious username patterns\n4. Display hex representation in admin UI\n\n---\n\n## Verification Steps for Developers\n\n1. Save the test script above as `test_vulnerability.php`\n2. Run: `php test_vulnerability.php`\n3. Observe output - you should see 3 VULNERABLE results\n4. Apply the recommended fix\n5. Run the test again - all should show BLOCKED\n\n---\n## POC:\n{F5026461}\n\n## References\n\n- Unicode Security: https://www.unicode.org/reports/tr36/\n- CWE-20: https://cwe.mitre.org/data/definitions/20.html\n- OWASP Input Validation: https://cheatsheetseries.owasp.org/\n\n---\n\n## Contact\n\nPlease acknowledge receipt of this report and provide an estimated timeline for patch development and CVE Assignment [kassem_s94] https://x.com/kassem_s94 https://t.me/apesofficial https://hackerone.com/kassem_s94?type=user\n\n## Impact\n\n- **MOST DANGEROUS** - Visually indistinguishable from \"admin\"\n- Perfect phishing vector\n- Users cannot detect the fake account\n- Credential harvesting\n- Admin impersonation attacks",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 5026461,
      "file_name": "Screenshot_20251119_230624_Termux.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/s96vdl1dobzo4guy3z65z1qy76e7?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_20251119_230624_Termux.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20251119_230624_Termux.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRAR67B46%2F20251126%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251126T150508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICAix2GaZ3bNTCpMzJLIVxaMnllF8Pg6W0rwr0kWFsZeAiAn%2Bb77st%2BiSkQNCQR1atLSJWALz67RYc3wvlvldJRJXiq7BQiI%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMnPc25EeaiqnzFIhxKo8Fxh0auwHXc7fi5rxRR%2FK58mEeIlMEuU6y2dpdRqPdO%2FFBLwyPRM5dwTTh1pIVIpKv7UOKP7LUpkjpxUYHGzGhbqmi09o8n8mXyCGv1C6TqloFbJZCOhTaP6Bv%2F34ul9Z3k6ncvRYljIxp%2BABtwL3mbCi5Bt33GKxwcaLsjFoxqoodK4VRJwtdpsa%2FXMWVyS0csDkjs6KOIoKvT3iat78gBJQtFXTRnHlvL2QgUBbC9hGvvBO3od4tu77DIDT3muBbzWjFW5SsSKAYCGyGK4On%2BrBv7X%2BYQQVucFHv%2FvfDQCOAWs5r7fornCAz100YPsVnE%2BaMU0FbZpbsW4oAHaP7umIT2PCCMuoTtNkEaac4LQ1HV7le6fUiI1GFg5HG1jU6zPVUOprNOoWmfDxvXtS6UfMlbOzSPCLFSsb5J8KhjyL0kXccjqk19QdhBq9uc%2F83i3F7KawTL79pPBw3qTmV2gDbYFrrUZqlWNrUUMlAcSxs%2BMd5yOkkvISkvpNDUv9PvsxGQfVZ4I4kaq0ycY2pOF6pvJ4z0S9q7%2BWRIj8xBc7xEEQZ33VO4f%2FX5cmXW46fS1X6%2F9fvI26cNJWUsNr5wvE9qEzxYTCE09tzhh1yK94eHKE2dvSaJ%2FQ1uGrn1WXxMsDE%2BYUvdJE2G3DsvgFUg2c9EYICsptS7E%2Fu445S2xWqdO7bhG5NGCbF%2Ft4dDbfWCf45Qb9ek7tf%2By8qj7pBeq%2FwL%2BxlvYUH%2BDm6VNntnrFsNliaTNzjp0KFTgG75c5YWUzdJnDdRpX6J9UTDFQThHG7dOw4Dwbk3lD9PuDaoRIXEMNV1O37qGlenpYwV4rb7FBJFpAasGm5tAQWM%2F9OQpIbcS2zf33YBDi3KvkVJDCCpZzJBjqyAUZUmjiIyNq3QyA%2BV66Y9%2BOK1s6ORNTg8Qr4yZ8%2FDX6wKD0pDYphuyMprP5h1gcYUAD8F7flzbZMrxJAiOAqGZMARUltIRHwbWIOyhtIIlZX4voklD1hZYd4i2whrZU5JPB71JGZFZkatGstpl8YOrt9TXDMhu46a9K55j3zH02ZN18gED4F%2BbF6MR5mtnH7iDIz0O8GDPepu3rPmMXsoAAv%2BzXFIVsU8L7xSVlMHU68irQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5ef3b6e6cbddc648c52895f5b4fa147966a91aa60bdd2e23a6c413f678482ed7",
      "file_size": 281502,
      "type": "image/jpeg",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2025-12-26T14:18:07.216Z",
  "allow_singular_disclosure_after": 2589178.408517056,
  "singular_disclosure_allowed": false,
  "vote_count": 1,
  "voters": [
    "2026"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 154,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/revive-adserver/revive-adserver",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
