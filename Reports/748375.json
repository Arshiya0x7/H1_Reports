{
  "id": 748375,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDgzNzU=",
  "url": "https://hackerone.com/reports/748375",
  "title": "Transferring a public group to a private group doesn't remove code from the Elastichsearch API search result",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-11-29T11:18:45.773Z",
  "submitted_at": "2019-11-29T11:18:45.773Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rpadovani",
    "url": "/rpadovani",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/geoyjjx2sc7a7bvf6hguumezg0i0/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%22avatar.jpg%22%3B%20filename%2A%3DUTF-8%27%27avatar.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQW6AGC4RG%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T085300Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHhuG6Q4Y8GG9xF89UXpn3E0cVIkn2QQ9a8oNUK1%2FpPzAiEAi5WJBuli9IxMIgDyMJ6KmRq8NcAv5jZPN1geTLQXdfQqsQUIERADGgwwMTM2MTkyNzQ4NDkiDCQ3KIg5zeu5j8VYECqOBT%2BhgqJoCrWJg9vDd%2BQWAxyzPkaxDHqFOMHP4RwqD29Ffw2UtPk8xDeUbbR4ezAyPNGvlMKDddyxm%2FxJ53%2BLGpEWjnYi9pOfrS0UIhQr%2Fkf0lR1iDNGvkg94Qh3HUDFFWoP3znYDX2y3DaTPoK7CznlYYAhsw3sOlCmf9Rfza2Jqvy%2BTxR8B6rf5TuW%2BKh%2Bw6SOOsHpyQ3zv8S7fh2kBQPn3UX9J%2FDnV5JTrg5IAP7m9M3OTaskDxC6XgRA0UyzlYJUrlRDNc5PyHPyCKExe%2FZsHkX7HjUpwHA7Ck4ce%2Fc8v8CSVn%2FmfbzoZBZ9Gofz1OLAeJSL8b2%2FRJO2RgvFTinKNTybUJEQiYGSGYZY4x5CKidiHrhWrPbdpGA%2FfpW8S91phFSIzDFbn0U6yr0x7WZbl5m%2FGW4kmfkYwNbCbjvXJkLQn26BCGR6RkgyDFVvbpnycR0heahJLj%2B0qbDDHi6pvGF2B9KoBq1CXlLPe%2FCKWp%2Bry%2FWpCuytjJqX84uzCghhEfYvcKdInzubS%2BWsnfxv0R2RLvysyYy%2FisSjtraOWjaXP4UNLxrN8ZezfbdXgsXYSwf%2Bw8h8X5Eej0UCyn9DBQJeWMMWraZDepvS1G5k%2BFdjr8%2Bu%2BbfXMC0XoPDewL1IdRmWR2jFVvGOUCqHhGxWbqlcjSChuE2XO%2BXUmQzriQCjFByBk5x2VCwfEf3AK6nPQ5yJadOuEo2RH64L7HaVHVU7Q5em1LYw4tmaPrLAMbVd42FeMzrz3J8tTfns9iZ5FMkagkWDEmMKCKH7KL3lDpGsekUZELdtHF3n1UoO0iUhgJ6Lu15ZloIL7q5jhaOK2xpuj54amoK%2BWTUpCzusC%2BQa7F1b%2BQicn%2FWYDojCP1r7GBjqxAUzHArpDjtPe9rsrlGtkz7ATeYdejsOQ7Kw8DyT4%2FpAoqosD%2B05Zde1%2BB2Gd7AhD%2B9QkgK5QiTc%2FHJlDqs3jnH91HK7dSd0H%2F4Oozt%2Ba6Iuns%2F5jm9OhQfZ5jnOROXpPlvOnjwZyzlrSy1r5k6MTH2ib2Q3%2F9htyaDbHBKbes7BYy0m9xIyo8fwEGtcx9J9O8MMLwCi46siTpoL0MQ3a7nlxZjMBbvlvyXljBqWs0ducMA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f68d83d9aef951edf00a9d004642409b53fb3fb95bb95ae0f873ec11b447b03d"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-10-06T21:57:06.733Z",
  "bug_reporter_agreed_on_going_public_at": "2020-10-06T21:57:06.651Z",
  "team_member_agreed_on_going_public_at": "2020-10-06T19:26:12.132Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\n\nWhen a public group with public projects is transferred to a private group, the code and the wiki of the public project, although now should be private, it is still reachable through search APIs.\n\nI set the severity as \"medium\" and not \"high\", because any new action over the project issues a re indexing (or some actions, not sure), so if the transfer is for \"archiving\" purposes it is a problem, but if after the transfer other activities happen, then it is not a problem, cause the project will be removed from the index.\n\n### Steps to reproduce\n\nAlice creates the public group \"Example\", and a public project named \"Example-project\" inside the group. In the readme of the project, Alice writes \"Example\".\n\nNow, Alice creates a private group called \"private\", and transfer all the \"Example\" group to the \"private\" group.\n\nIf Bob (totally unrelated to Alice), search for \"Example\" instance-wide, will not find anything on the interface, but the count of the results will be \"1\" (see screenshot).\n\nIf he uses the APIs (e.g. http://localhost/api/v4/search?search=password&scope=blobs), he will receive the results back with the information that should be private.\n\nThis happens also with wiki_blobs.\n\nThis doesn't happen transferring single projects, but only transferring entire groups\n\n### Output of checks\n\n#### Results of GitLab environment info\n\n``` \nSystem information\nSystem:\t\t\nProxy:\t\tno\nCurrent User:\tgit\nUsing RVM:\tno\nRuby Version:\t2.6.3p62\nGem Version:\t2.7.9\nBundler Version:1.17.3\nRake Version:\t12.3.3\nRedis Version:\t3.2.12\nGit Version:\t2.22.0\nSidekiq Version:5.2.7\nGo Version:\tunknown\n\nGitLab information\nVersion:\t12.5.2-ee\nRevision:\tc1b3929bc67\nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails\nDB Adapter:\tPostgreSQL\nDB Version:\t10.9\nURL:\t\thttp://aldebaran\nHTTP Clone URL:\thttp://aldebaran/some-group/some-project.git\nSSH Clone URL:\tgit@aldebaran:some-group/some-project.git\nElasticsearch:\tyes\nGeo:\t\tno\nUsing LDAP:\tno\nUsing Omniauth:\tyes\nOmniauth Providers: \n\nGitLab Shell\nVersion:\t10.2.0\nRepository storage paths:\n- default: \t/var/opt/gitlab/git-data/repositories\nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell\nGit:\t\t/opt/gitlab/embedded/bin/git\n```\n\n## Impact\n\nAlice thinks her code is now private, but it is not, unless she continues working on the project",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 13,
  "voters": [
    "th3hidd3nmist",
    "thaivu",
    "ali",
    "sameerphad72",
    "since2003",
    "naategh",
    "cryptographer",
    "loki090919",
    "armansameer",
    "qacker",
    "and 3 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
