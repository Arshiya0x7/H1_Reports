{
  "id": 951468,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTE0Njg=",
  "url": "https://hackerone.com/reports/951468",
  "title": "[m-server] XSS reflected because path does not escapeHtml",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2020-08-05T08:11:07.446Z",
  "submitted_at": "2020-08-05T08:11:07.493Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "0xd0ff9",
    "url": "/0xd0ff9",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/yhtlludaxfrfhtr0fb4x14h5ntgs/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-09-28T02:26:55.585Z",
  "bug_reporter_agreed_on_going_public_at": "2020-09-28T02:26:55.497Z",
  "team_member_agreed_on_going_public_at": "2020-09-26T19:08:14.807Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report XSS in m-server\nIt allows attacker can perform XSS in client side\n\n# Module\n\n**module name:** m-server\n**version:** 1.4.2\n**npm page:** `https://www.npmjs.com/package/m-server`\n\n## Module Description\nM-Server is a mini http static server that without any dependencies;\n\n\n## Module Stats\n[1] weekly downloads\n150\n\n# Vulnerability\nXSS reflected because path does not escapeHtml\n\n## Vulnerability Description\nin `m-server/lib/utils.js` line 59 and 64, html push does not escapeHtml for variable path.\n{F936938}\n\nBy change path of URL via traversal, attacker can control this variable `path`.\n{F936939}\n\n## Steps To Reproduce:\nOn server, run this:\n$ cd /home/vagrant/tmp/test\n$ m-server\nOn client, issue requests:\n```\nGET /../../../../home/vagrant/tmp/test/<svg/onload=alert(document.domain)>/../../../test/ HTTP/1.1\nHost: 192.168.57.105:3001\nUser-Agent: curl/7.54.0\nAccept: */*\nConnection: close\n```\nPOC:\n{F936947}\n\n## Patch\nline 59 should use \n```\nhtml.push('<li><a href=\"' + escapeHtml(path) + '/' + escapeHtml(val) + '\">' + escapeHtml(val) + '</a></li>');\n```\nline 64 should use \n```\nhtml.push('<li><a download href=\"' + escapeHtml(path) + '/' + escapeHtml(val) + '\">' + escapeHtml(val) + '</a></li>');\n```\nOr strip path traversal\n\n## Supporting Material/References:\n\n> State all technical information about the stack where the vulnerability was found\n\n- [OPERATING SYSTEM VERSION]\n- [NODEJS VERSION]\n- [NPM VERSION]\n- [BROWSERS VERSIONS, IF APPLICABLE] \n- [OTHER SOFTWARE USED TO EXPLOIT VULNERABILITY AND THEIR VERSIONS, IF APPLICABLE]\n\n# Wrap up\n\n> Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: [Y/N] N\n- I opened an issue in the related repository: [Y/N] N\n\n> Hunter's comments and funny memes goes here\n\n## Impact\n\nXSS",
  "weakness": {
    "id": 61,
    "name": "Cross-site Scripting (XSS) - Reflected"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 936938,
      "file_name": "Screen_Shot_2020-08-05_at_2.57.56_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pVbX6NgN9Cgkx7Wi3VabLRzu?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-08-05_at_2.57.56_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-08-05_at_2.57.56_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUK3TW6R5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T085752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDYUltHmmc5zz7FbX9%2BhnLsC%2BI%2FkETnF6wSvuA8jSpH5gIhAMgfIeEQszZSh5a3b%2FpUdy78MMNarH5UHYPIExl609LbKrEFCBEQAxoMMDEzNjE5Mjc0ODQ5Igw8%2BeyYtSMd%2BASZf5AqjgW3xr09iUnFh9lbiMQHuWlu3lfitTwIOQagu1IpSPfblOtq7qraEDuAGVXZaGdXdj5zykisq7Kc34BBjiZEz5vXlDcpFHosFBZSNJ20GPN4oRXmJcsw3RdCJzQyH%2Fvsdd78D7srH0NX6Jk9lcUnUNsMElKSxa7hg%2BCDGJWOlxWzjVljZrBS1JRG1tYwf%2FKzWSZpL2haUlRhvHNsYvJ%2FBSmiE%2Bvt2P2VmTdudzxL1M%2F%2BrCGzNhfjjXUzt%2FypaTw8CjoQ7FdqimfT14%2Fa7uB1xTZMxZNpPnLJ2rSDUPiRxVKlWFMxo9syjPOLAF0fBDcaVUguP6dkUK6iZLSHIe4Gq%2BAOw9EmWsA14zobJ%2BuiXQlvJaqXma2KSku%2BDkGMdmAYnToG32jLp%2Bf6nCpVwId%2FIp5CQS3vR1asPCTnvwm09yD8vfj9mHeFUgCru2okQpBX%2BnjZYUFE5K9z8dFcRYKNbHVa7XbD7BXoUd4vamSWdFZTYszrHSSXDbKtvvQGr1eusVU1LCKPRgXkgJSZF32ecwAWG5CdGv0tKxeXRZ3CTb81Q%2Fz6FF%2BXXPXxQdpNctzk7ZBnP68KPPdIsLFNEdkNiGp4rk%2BTKfQNW3bPgSMiH3Of5rCWuw8rQd6jCUrCT83smZ8%2FXz29P0jKMbJZtJP5H6GCNR3gaw5D8auxUM2qEe%2BKU39CcRIOz8%2BjH%2FFhkDRK1zakOOvi5mbFwWqBNFF8YKNODrg6kgqspQnx5vbFwqBixzpo2M%2BLNyWGEL4j7EkgwSV7ikfcHLk9zr8y2qJJcZqVAiU1NmJ2FEsLel0FRCERSQU3%2Buu7jvvxlJjyCJGBBGAuS6qyLkZmLRMxSZYKyqpIBHZ4iN2uqncQcxAWGoQwtN2%2BxgY6sAEFr7Sxka7dfH8UNv3JbPYSXJHcATmwiPqoAMNeI6NvpjSAj4XDHDDaZC%2FagV16fqadk4YCMMERn%2FwfN5rUEyY%2BWmw7oA9qsEaDEP1NndNQkBsDmpDFkOCt8xuLCCYoZ5XMptQ%2FkV6VyjasZzd%2BmGJehA9%2Fd5oI3FMryIXWzqwSUnDNZqLXsQPCMlu%2F%2F1Rjo7WVCiOpBQ4omy0glWz0%2FxJV3Bnzl3sjB1tUksIFsS6lGg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4f43175708f02c114b2682e3be099e8d51b10740b0a9a80c2c26c667fe06446e",
      "file_size": 842418,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 936939,
      "file_name": "Screen_Shot_2020-08-05_at_2.59.59_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mPgNJYA1Jf7fvmPfTAWvS2f3?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-08-05_at_2.59.59_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-08-05_at_2.59.59_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUK3TW6R5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T085752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDYUltHmmc5zz7FbX9%2BhnLsC%2BI%2FkETnF6wSvuA8jSpH5gIhAMgfIeEQszZSh5a3b%2FpUdy78MMNarH5UHYPIExl609LbKrEFCBEQAxoMMDEzNjE5Mjc0ODQ5Igw8%2BeyYtSMd%2BASZf5AqjgW3xr09iUnFh9lbiMQHuWlu3lfitTwIOQagu1IpSPfblOtq7qraEDuAGVXZaGdXdj5zykisq7Kc34BBjiZEz5vXlDcpFHosFBZSNJ20GPN4oRXmJcsw3RdCJzQyH%2Fvsdd78D7srH0NX6Jk9lcUnUNsMElKSxa7hg%2BCDGJWOlxWzjVljZrBS1JRG1tYwf%2FKzWSZpL2haUlRhvHNsYvJ%2FBSmiE%2Bvt2P2VmTdudzxL1M%2F%2BrCGzNhfjjXUzt%2FypaTw8CjoQ7FdqimfT14%2Fa7uB1xTZMxZNpPnLJ2rSDUPiRxVKlWFMxo9syjPOLAF0fBDcaVUguP6dkUK6iZLSHIe4Gq%2BAOw9EmWsA14zobJ%2BuiXQlvJaqXma2KSku%2BDkGMdmAYnToG32jLp%2Bf6nCpVwId%2FIp5CQS3vR1asPCTnvwm09yD8vfj9mHeFUgCru2okQpBX%2BnjZYUFE5K9z8dFcRYKNbHVa7XbD7BXoUd4vamSWdFZTYszrHSSXDbKtvvQGr1eusVU1LCKPRgXkgJSZF32ecwAWG5CdGv0tKxeXRZ3CTb81Q%2Fz6FF%2BXXPXxQdpNctzk7ZBnP68KPPdIsLFNEdkNiGp4rk%2BTKfQNW3bPgSMiH3Of5rCWuw8rQd6jCUrCT83smZ8%2FXz29P0jKMbJZtJP5H6GCNR3gaw5D8auxUM2qEe%2BKU39CcRIOz8%2BjH%2FFhkDRK1zakOOvi5mbFwWqBNFF8YKNODrg6kgqspQnx5vbFwqBixzpo2M%2BLNyWGEL4j7EkgwSV7ikfcHLk9zr8y2qJJcZqVAiU1NmJ2FEsLel0FRCERSQU3%2Buu7jvvxlJjyCJGBBGAuS6qyLkZmLRMxSZYKyqpIBHZ4iN2uqncQcxAWGoQwtN2%2BxgY6sAEFr7Sxka7dfH8UNv3JbPYSXJHcATmwiPqoAMNeI6NvpjSAj4XDHDDaZC%2FagV16fqadk4YCMMERn%2FwfN5rUEyY%2BWmw7oA9qsEaDEP1NndNQkBsDmpDFkOCt8xuLCCYoZ5XMptQ%2FkV6VyjasZzd%2BmGJehA9%2Fd5oI3FMryIXWzqwSUnDNZqLXsQPCMlu%2F%2F1Rjo7WVCiOpBQ4omy0glWz0%2FxJV3Bnzl3sjB1tUksIFsS6lGg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5260afadc05e8ab980027d57ab57572b23dee56d7bb164d0904aa88e35ba9b92",
      "file_size": 270821,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 936947,
      "file_name": "Screen_Recording_2020-08-05_at_2.47.01_PM.mov",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/75CMnxG83q3kaKZsN2H673iS?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2020-08-05_at_2.47.01_PM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2020-08-05_at_2.47.01_PM.mov&response-content-type=video%2Fquicktime&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUK3TW6R5%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T085752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDYUltHmmc5zz7FbX9%2BhnLsC%2BI%2FkETnF6wSvuA8jSpH5gIhAMgfIeEQszZSh5a3b%2FpUdy78MMNarH5UHYPIExl609LbKrEFCBEQAxoMMDEzNjE5Mjc0ODQ5Igw8%2BeyYtSMd%2BASZf5AqjgW3xr09iUnFh9lbiMQHuWlu3lfitTwIOQagu1IpSPfblOtq7qraEDuAGVXZaGdXdj5zykisq7Kc34BBjiZEz5vXlDcpFHosFBZSNJ20GPN4oRXmJcsw3RdCJzQyH%2Fvsdd78D7srH0NX6Jk9lcUnUNsMElKSxa7hg%2BCDGJWOlxWzjVljZrBS1JRG1tYwf%2FKzWSZpL2haUlRhvHNsYvJ%2FBSmiE%2Bvt2P2VmTdudzxL1M%2F%2BrCGzNhfjjXUzt%2FypaTw8CjoQ7FdqimfT14%2Fa7uB1xTZMxZNpPnLJ2rSDUPiRxVKlWFMxo9syjPOLAF0fBDcaVUguP6dkUK6iZLSHIe4Gq%2BAOw9EmWsA14zobJ%2BuiXQlvJaqXma2KSku%2BDkGMdmAYnToG32jLp%2Bf6nCpVwId%2FIp5CQS3vR1asPCTnvwm09yD8vfj9mHeFUgCru2okQpBX%2BnjZYUFE5K9z8dFcRYKNbHVa7XbD7BXoUd4vamSWdFZTYszrHSSXDbKtvvQGr1eusVU1LCKPRgXkgJSZF32ecwAWG5CdGv0tKxeXRZ3CTb81Q%2Fz6FF%2BXXPXxQdpNctzk7ZBnP68KPPdIsLFNEdkNiGp4rk%2BTKfQNW3bPgSMiH3Of5rCWuw8rQd6jCUrCT83smZ8%2FXz29P0jKMbJZtJP5H6GCNR3gaw5D8auxUM2qEe%2BKU39CcRIOz8%2BjH%2FFhkDRK1zakOOvi5mbFwWqBNFF8YKNODrg6kgqspQnx5vbFwqBixzpo2M%2BLNyWGEL4j7EkgwSV7ikfcHLk9zr8y2qJJcZqVAiU1NmJ2FEsLel0FRCERSQU3%2Buu7jvvxlJjyCJGBBGAuS6qyLkZmLRMxSZYKyqpIBHZ4iN2uqncQcxAWGoQwtN2%2BxgY6sAEFr7Sxka7dfH8UNv3JbPYSXJHcATmwiPqoAMNeI6NvpjSAj4XDHDDaZC%2FagV16fqadk4YCMMERn%2FwfN5rUEyY%2BWmw7oA9qsEaDEP1NndNQkBsDmpDFkOCt8xuLCCYoZ5XMptQ%2FkV6VyjasZzd%2BmGJehA9%2Fd5oI3FMryIXWzqwSUnDNZqLXsQPCMlu%2F%2F1Rjo7WVCiOpBQ4omy0glWz0%2FxJV3Bnzl3sjB1tUksIFsS6lGg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=faa2ad39c0bfc1f6baba359047d344fa27cfa0dd9f911598b246d9d0f8316a0f",
      "file_size": 39071509,
      "type": "video/quicktime",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-10-26T19:08:14.908Z",
  "allow_singular_disclosure_after": -154705777.56805,
  "singular_disclosure_allowed": true,
  "vote_count": 12,
  "voters": [
    "thaivu",
    "xnutronex",
    "hensis",
    "khizer47",
    "dinesh_bhavar",
    "lxtreme",
    "th3n00bs3c",
    "edg",
    "ravikantcool2019",
    "xss-hunter",
    "and 2 more..."
  ],
  "structured_scope": {
    "databaseId": 8254,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "m-server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
