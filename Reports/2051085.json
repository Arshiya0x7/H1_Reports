{
  "id": 2051085,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDUxMDg1",
  "url": "https://hackerone.com/reports/2051085",
  "title": "Stored XSS on promo.indrive.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-07-05T12:45:19.281Z",
  "submitted_at": "2023-07-05T12:45:19.388Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kristoferent",
    "url": "/kristoferent",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/i8ml8iq11scizvkim3uczoyucqdu/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef?response-content-disposition=inline%3B%20filename%3D%223dd54773c613a2a404c2c165b81590ad.jpg%22%3B%20filename%2A%3DUTF-8%27%273dd54773c613a2a404c2c165b81590ad.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXIQPAKFH%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T202104Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHsaCXVzLXdlc3QtMiJHMEUCIExz6tezQDsnAK817QSKoeFLyzFhhwo7tEcf77fRBy7BAiEA1UimIMotPYPHGiZl09GKGaO548QF447C00TPyWzJVp0qugUI9P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDAJlZCG7soS%2BPD%2B0iSqOBYjNuIwArd9ugoEYlYxdynCDYgd8CppSdP%2BsUepkTavwJahPtXgE2EVQrocU4z33GQUkh4ps4toAizD1i4PwDNXjaQAEl1lRGNRkM80vOYXJgpHPlVVyBzcndJBgy%2BGo3htFu66Pl5SLb9ephYilAKxYQr1z5jYOW6F%2FmOI9OhkZEPQ1s%2B%2BQ%2BgrbGki2V1XvjtIH07Q4YY4%2F3ldAN5NQmDRj40XFP%2Bd3P%2FSIfG9ZzqAFbX9%2BJOvCl7A%2BT%2Fr%2FovRII0eZuYZRcDWZHhdWFqRA2%2FOuYa2CQ71I6zfYm3OLHevTHR%2B6e2KAa1t%2FUWAD85IDCKQsuum9qYAV82vvq1UFQUH8Gb1xwvFjaFgrlKjueeQZAuHNysZiIPwQR8FhZy4xxaLZeX%2FJ%2BJaveZW24Oln5UI4Lo3bpbsjPqr5vLcRz7Dl0p1O9LEYWt63Xg6a3Hz%2BEHGghMCpSeP8EaSFqRhM35lJsN4IcnxGXxKtTmot1FtCuooyoB9v1UakGRh7VGQR0PQnV232gNiHEu5I24zW%2BbkCVX1DoJkhNCPYotEBEhx%2B%2FL%2BygIPNiqqXQhdcXIk%2BCS8Rq7pYsJISs%2FosAlZGHZt3iCI8P9ITpkWd2J%2FtD8%2BpL9VvlS6b7g3cAbLUl%2Fr1UHkQvM%2Fxj7hOLDP5vGUrmLKGGCoE6751pT1ypdvEADHwBjPwnS33lN%2F%2BOAHfGzVuBH9e9hWnxWGFEQTlJ1Go55wIGLG5dY9oRs%2Be9ifBQVK1D9oMxM4Uxz0d7yfPHhuFHdOajNOd3ItuDcYtZk%2BQ2BtZuVQNr4%2BrgeJZB7uWdu5PAiVssTQHJRvvp06AUUd6cHd3gTN%2B7%2BcjDk6%2FlNPzoxCe%2B3a2ysL7hO%2F5H5zn3DDp8bvGBjqxAVKJH%2BY6csA804B02Xn%2FJKY7r1xT%2BIoWhb%2FxoISkiqNeqi%2BHXCWDP0%2FYC%2BDZ9xqtO5oEZ2JuGqt7SZNnWBeY%2FdEJvPqHprGRYJmJ%2Bi1YCkIcFP8VHc3Dd5H%2B2VW7cTRNqaLoXK6z8jNPjIxANj6DhF%2FJFCyguLBDf%2Fx44xBmOksvbvQALEisXrtC7wNU14q21OAQk%2F%2BrMfGlXPfhFd5gJ3DaITdo5EB8IzNPMjq9yph7Fw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=348242dae03bca3ce1fc07d9f1a79c982588c40240403feb9541a8998e8089a5"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 58857,
    "url": "https://hackerone.com/indrive",
    "handle": "indrive",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/765s9sszvp9zyt9qwkeaa52vvkf3/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/765s9sszvp9zyt9qwkeaa52vvkf3/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "inDrive",
      "twitter_handle": "indrive",
      "website": "https://indrive.com/",
      "about": "inDrive is a global mobility and urban services platform with over 150 million downloads  in more than 700 cities across 47 countries."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-08-28T13:29:44.397Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-08-28T11:55:26.974Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThe functionality on https://promo.indrive.com/promocodes allows drivers to find and activate promocodes. It requires a driver ID. When user activates their promocode, the browser makes a POST request to https://id.indrive.com/api/spreadsheet/promocodes with parameters **id** (driver id) and **activationDate** (the date of the promocode activation). It is possible for an attacker to set parameter **activationDate** value to an XSS payload. When a user inputs the same ID when looking for promocodes, the XSS payload will trigger, executing arbitrary JavaScript code in the victims's browser.\n\n## Steps To Reproduce:\n1. Make a POST request to https://id.indrive.com/api/spreadsheet/promocodes with the following body: \n```\n{\"id\":\"4\",\"activationDate\":\"<script>alert(1)</script>\"}\n```\n{F2470829}\nThe driver ID value of **4** is used, but the attacker can enumerate through valid driver IDs to inject the payload into every user's promocode.\n2. Go to https://promo.indrive.com/promocodes\n3. Input a driver ID (in my example **4**) and click \"Проверить ID\". The XSS payload will be triggered\n{F2470832}\n\n\n## Supporting Material/References:\nFull POST Request:\n```\nPOST /api/spreadsheet/promocodes HTTP/1.1\nHost: id.indrive.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\nContent-Length: 55\nOrigin: https://promo.indrive.com\nReferer: https://promo.indrive.com/\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-site\nTe: trailers\nConnection: close\n\n{\"id\":\"4\",\"activationDate\":\"<script>alert(1)</script>\"}\n```\n\n## Impact\n\nThis vulnerability allows an attacker to execute arbitrary JavaScript code in any user's browser.\nDespite this being a retired functionality, an attacker could trick users to try and get a promocode.\nThis could also potentially make promocodes usable infinite amount of times by directly making POST requests to renew the code every 24 hours.",
  "bounty_amount": "284.0",
  "formatted_bounty": "$284",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2470829,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/k053w8y90c5z599rr6f62m5exod7?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXIQPAKFH%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T202104Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHsaCXVzLXdlc3QtMiJHMEUCIExz6tezQDsnAK817QSKoeFLyzFhhwo7tEcf77fRBy7BAiEA1UimIMotPYPHGiZl09GKGaO548QF447C00TPyWzJVp0qugUI9P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDAJlZCG7soS%2BPD%2B0iSqOBYjNuIwArd9ugoEYlYxdynCDYgd8CppSdP%2BsUepkTavwJahPtXgE2EVQrocU4z33GQUkh4ps4toAizD1i4PwDNXjaQAEl1lRGNRkM80vOYXJgpHPlVVyBzcndJBgy%2BGo3htFu66Pl5SLb9ephYilAKxYQr1z5jYOW6F%2FmOI9OhkZEPQ1s%2B%2BQ%2BgrbGki2V1XvjtIH07Q4YY4%2F3ldAN5NQmDRj40XFP%2Bd3P%2FSIfG9ZzqAFbX9%2BJOvCl7A%2BT%2Fr%2FovRII0eZuYZRcDWZHhdWFqRA2%2FOuYa2CQ71I6zfYm3OLHevTHR%2B6e2KAa1t%2FUWAD85IDCKQsuum9qYAV82vvq1UFQUH8Gb1xwvFjaFgrlKjueeQZAuHNysZiIPwQR8FhZy4xxaLZeX%2FJ%2BJaveZW24Oln5UI4Lo3bpbsjPqr5vLcRz7Dl0p1O9LEYWt63Xg6a3Hz%2BEHGghMCpSeP8EaSFqRhM35lJsN4IcnxGXxKtTmot1FtCuooyoB9v1UakGRh7VGQR0PQnV232gNiHEu5I24zW%2BbkCVX1DoJkhNCPYotEBEhx%2B%2FL%2BygIPNiqqXQhdcXIk%2BCS8Rq7pYsJISs%2FosAlZGHZt3iCI8P9ITpkWd2J%2FtD8%2BpL9VvlS6b7g3cAbLUl%2Fr1UHkQvM%2Fxj7hOLDP5vGUrmLKGGCoE6751pT1ypdvEADHwBjPwnS33lN%2F%2BOAHfGzVuBH9e9hWnxWGFEQTlJ1Go55wIGLG5dY9oRs%2Be9ifBQVK1D9oMxM4Uxz0d7yfPHhuFHdOajNOd3ItuDcYtZk%2BQ2BtZuVQNr4%2BrgeJZB7uWdu5PAiVssTQHJRvvp06AUUd6cHd3gTN%2B7%2BcjDk6%2FlNPzoxCe%2B3a2ysL7hO%2F5H5zn3DDp8bvGBjqxAVKJH%2BY6csA804B02Xn%2FJKY7r1xT%2BIoWhb%2FxoISkiqNeqi%2BHXCWDP0%2FYC%2BDZ9xqtO5oEZ2JuGqt7SZNnWBeY%2FdEJvPqHprGRYJmJ%2Bi1YCkIcFP8VHc3Dd5H%2B2VW7cTRNqaLoXK6z8jNPjIxANj6DhF%2FJFCyguLBDf%2Fx44xBmOksvbvQALEisXrtC7wNU14q21OAQk%2F%2BrMfGlXPfhFd5gJ3DaITdo5EB8IzNPMjq9yph7Fw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3429e40855fd3997f8733d315ccd2a4a91d75147abcf65097c32aee0ade9bbdf",
      "file_size": 83164,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 2470832,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/e12apiln9xf63b7kn6op171beyi7?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXIQPAKFH%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T202104Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHsaCXVzLXdlc3QtMiJHMEUCIExz6tezQDsnAK817QSKoeFLyzFhhwo7tEcf77fRBy7BAiEA1UimIMotPYPHGiZl09GKGaO548QF447C00TPyWzJVp0qugUI9P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDAJlZCG7soS%2BPD%2B0iSqOBYjNuIwArd9ugoEYlYxdynCDYgd8CppSdP%2BsUepkTavwJahPtXgE2EVQrocU4z33GQUkh4ps4toAizD1i4PwDNXjaQAEl1lRGNRkM80vOYXJgpHPlVVyBzcndJBgy%2BGo3htFu66Pl5SLb9ephYilAKxYQr1z5jYOW6F%2FmOI9OhkZEPQ1s%2B%2BQ%2BgrbGki2V1XvjtIH07Q4YY4%2F3ldAN5NQmDRj40XFP%2Bd3P%2FSIfG9ZzqAFbX9%2BJOvCl7A%2BT%2Fr%2FovRII0eZuYZRcDWZHhdWFqRA2%2FOuYa2CQ71I6zfYm3OLHevTHR%2B6e2KAa1t%2FUWAD85IDCKQsuum9qYAV82vvq1UFQUH8Gb1xwvFjaFgrlKjueeQZAuHNysZiIPwQR8FhZy4xxaLZeX%2FJ%2BJaveZW24Oln5UI4Lo3bpbsjPqr5vLcRz7Dl0p1O9LEYWt63Xg6a3Hz%2BEHGghMCpSeP8EaSFqRhM35lJsN4IcnxGXxKtTmot1FtCuooyoB9v1UakGRh7VGQR0PQnV232gNiHEu5I24zW%2BbkCVX1DoJkhNCPYotEBEhx%2B%2FL%2BygIPNiqqXQhdcXIk%2BCS8Rq7pYsJISs%2FosAlZGHZt3iCI8P9ITpkWd2J%2FtD8%2BpL9VvlS6b7g3cAbLUl%2Fr1UHkQvM%2Fxj7hOLDP5vGUrmLKGGCoE6751pT1ypdvEADHwBjPwnS33lN%2F%2BOAHfGzVuBH9e9hWnxWGFEQTlJ1Go55wIGLG5dY9oRs%2Be9ifBQVK1D9oMxM4Uxz0d7yfPHhuFHdOajNOd3ItuDcYtZk%2BQ2BtZuVQNr4%2BrgeJZB7uWdu5PAiVssTQHJRvvp06AUUd6cHd3gTN%2B7%2BcjDk6%2FlNPzoxCe%2B3a2ysL7hO%2F5H5zn3DDp8bvGBjqxAVKJH%2BY6csA804B02Xn%2FJKY7r1xT%2BIoWhb%2FxoISkiqNeqi%2BHXCWDP0%2FYC%2BDZ9xqtO5oEZ2JuGqt7SZNnWBeY%2FdEJvPqHprGRYJmJ%2Bi1YCkIcFP8VHc3Dd5H%2B2VW7cTRNqaLoXK6z8jNPjIxANj6DhF%2FJFCyguLBDf%2Fx44xBmOksvbvQALEisXrtC7wNU14q21OAQk%2F%2BrMfGlXPfhFd5gJ3DaITdo5EB8IzNPMjq9yph7Fw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ba9eb295e3626f9e3ead91f1b2cb7dfe4237735ca9576a5d4486dde827ab49fa",
      "file_size": 164500,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 40,
  "voters": [
    "loaymorad",
    "kristoferent",
    "jordanpitcairn",
    "todayisnew-",
    "zy9ard3",
    "shreyaschavhan",
    "mr-alienx-kurd",
    "aaa999",
    "vulnerability_is_here",
    "shohag_sp",
    "and 30 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 362641,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.indrive.com",
    "max_severity": "high"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
