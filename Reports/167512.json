{
  "id": 167512,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjc1MTI=",
  "url": "https://hackerone.com/reports/167512",
  "title": "CVE-2016-7163 OpenJPEG opj_pi_create_decode Integer Overflow Vulnerability",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-09-11T06:18:49.906Z",
  "submitted_at": "2016-09-11T06:18:49.906Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "binvul",
    "url": "/binvul",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTABFVXIV%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132412Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIARSTUTlLtqfCtFxZFk4rYBghKF7D2jkZPr1QwTWq%2BGXAiEAv6miAxW0spzaBwsrYsw578P9GcnLl7tkD3KSwPtv%2FLcqsQUIExADGgwwMTM2MTkyNzQ4NDkiDMRzqVS0jkm%2Bv4Wa5CqOBR76uTTT2nWrSXGgdyoE1NtYArYx2zNugI3zy19%2F0NbNPsgMq%2BVIwUVMaICZwERNFM3Ynuw2lLcwlMZcx%2BKlA46VydjCvjJdSq3rZg3mrz6TCgarB3l3mOWRfQE7%2B6R5kd6pEt%2BXzCzO7Oz%2ByqGuVWwSEJgTeLJZFuKmcZSMr%2F86UgsB2gwp%2FZD%2BVvNNEwLTJDQTpmL172aomVt9oe7CwNNlZLemIjD6ujwNcLYWjNdCqcLsLveQ8eNBidevZY5USEd4wbLhH1SUQr2qg2HOFblt%2B9N18%2FzvHhQARS4%2FBs1utdgFK9di6S9hbUMavj%2FiVFcgVamg5XDadOYJfrZhMLXjs7JFoR5LI%2FxLOH6gufc39sOgW1jEXlKXX4F3gv5U0Ts3ncRxb6pUdDsqKHC11mIkJzZIfP0cdJZBykZmj%2BvkVm9hiT6L3B7y87YPSkairkgvBvuGNRdIxrNI%2F%2FH1eBRFxB9M%2B4gteUwrNQJ3zAOkBciHqDn%2BbYeR3FV2E4lYSNE0XEAd9ckVJk7zzITpTf%2Bqb2FJOl%2FGAUlM23wNxMVUUoKJfiCGUkFWaow4qptq6hpqUcQnpV9dRsOQUNFJZbSpdMwxTdu04nTB3fj7FMFhytDsNGl0x7bt5j2q58omJl5C41S4%2FwY0Xi7WkZxLvdxluHJpi2RxUWhNtpPQ88YCWMxi44HqDZ2FbWgM9VKZE1DGp0ml3eOOwdDQ5J3XAjG2g%2Fk5IRoMcX5ftfIjKzhs9JcgUtV%2FU2%2F5obSwXDm7OavJTNxLUTMWvO7BE78PSdr7FfUttD%2Fzh5Eog0%2F0nIlKw5MTl9P%2BtgACFqhih6dbvCfJ4yEfeChQ4s4RzK76W4zN4wdMmUwWJ3uf7I2xDzDomL%2FGBjqxAQjtEZAT4Ko0QTziHMwTUt45mr9X4bfKK2Aye%2F5C%2BNagm7ta0vwtP6vYQ3T9%2BWfsLrtvmlq2L5%2Bx4hQxDkQ4JX%2BhE7mNJwl633WTs4TPq9nosYvDd2GoZsXK5qqlsMIFl%2FShYPbzhH7eSCWgR6f5ZWkkX%2FDBkZ3Mt%2FPqqLHgMblgxWEB1fDGiCVYkb%2B16GM2CiNvSbYRIOcrNOa%2BgAm%2BfS%2FG3fn67R%2FB%2BtcmMCeqNEcnmA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d725e71f8e2b00f52f62e826f07f713cadefaacdac5023d63b7d4577ea1ceec4",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTABFVXIV%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132412Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIARSTUTlLtqfCtFxZFk4rYBghKF7D2jkZPr1QwTWq%2BGXAiEAv6miAxW0spzaBwsrYsw578P9GcnLl7tkD3KSwPtv%2FLcqsQUIExADGgwwMTM2MTkyNzQ4NDkiDMRzqVS0jkm%2Bv4Wa5CqOBR76uTTT2nWrSXGgdyoE1NtYArYx2zNugI3zy19%2F0NbNPsgMq%2BVIwUVMaICZwERNFM3Ynuw2lLcwlMZcx%2BKlA46VydjCvjJdSq3rZg3mrz6TCgarB3l3mOWRfQE7%2B6R5kd6pEt%2BXzCzO7Oz%2ByqGuVWwSEJgTeLJZFuKmcZSMr%2F86UgsB2gwp%2FZD%2BVvNNEwLTJDQTpmL172aomVt9oe7CwNNlZLemIjD6ujwNcLYWjNdCqcLsLveQ8eNBidevZY5USEd4wbLhH1SUQr2qg2HOFblt%2B9N18%2FzvHhQARS4%2FBs1utdgFK9di6S9hbUMavj%2FiVFcgVamg5XDadOYJfrZhMLXjs7JFoR5LI%2FxLOH6gufc39sOgW1jEXlKXX4F3gv5U0Ts3ncRxb6pUdDsqKHC11mIkJzZIfP0cdJZBykZmj%2BvkVm9hiT6L3B7y87YPSkairkgvBvuGNRdIxrNI%2F%2FH1eBRFxB9M%2B4gteUwrNQJ3zAOkBciHqDn%2BbYeR3FV2E4lYSNE0XEAd9ckVJk7zzITpTf%2Bqb2FJOl%2FGAUlM23wNxMVUUoKJfiCGUkFWaow4qptq6hpqUcQnpV9dRsOQUNFJZbSpdMwxTdu04nTB3fj7FMFhytDsNGl0x7bt5j2q58omJl5C41S4%2FwY0Xi7WkZxLvdxluHJpi2RxUWhNtpPQ88YCWMxi44HqDZ2FbWgM9VKZE1DGp0ml3eOOwdDQ5J3XAjG2g%2Fk5IRoMcX5ftfIjKzhs9JcgUtV%2FU2%2F5obSwXDm7OavJTNxLUTMWvO7BE78PSdr7FfUttD%2Fzh5Eog0%2F0nIlKw5MTl9P%2BtgACFqhih6dbvCfJ4yEfeChQ4s4RzK76W4zN4wdMmUwWJ3uf7I2xDzDomL%2FGBjqxAQjtEZAT4Ko0QTziHMwTUt45mr9X4bfKK2Aye%2F5C%2BNagm7ta0vwtP6vYQ3T9%2BWfsLrtvmlq2L5%2Bx4hQxDkQ4JX%2BhE7mNJwl633WTs4TPq9nosYvDd2GoZsXK5qqlsMIFl%2FShYPbzhH7eSCWgR6f5ZWkkX%2FDBkZ3Mt%2FPqqLHgMblgxWEB1fDGiCVYkb%2B16GM2CiNvSbYRIOcrNOa%2BgAm%2BfS%2FG3fn67R%2FB%2BtcmMCeqNEcnmA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6596e5bd278537488fffe991622f34aece97717d815f4b0be407473998d382dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2016-7163"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-11-12T23:54:28.604Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-10-13T23:54:25.517Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# OpenJPEG opj_pi_create_decode Integer Overflow Vulnerability\n\n## 1. About OpenJPEG\nOpenJPEG is an open-source JPEG 2000 codec written in C language. It's widely used in lots of Linux OSes such as Ubuntu, RedHat, Debian, Fedora, and so on. The official repository of the OpenJPEG project is available at [GitHub](https://github.com/uclouvain/openjpeg).\n\n## 2. Credit\nThis vulnerability was discovered by Ke Liu of Tencent's Xuanwu LAB.\n\n## 3. Testing Environments\n+ **OS**: Ubuntu\n+ **OpenJPEG**: [4a2a869](https://github.com/uclouvain/openjpeg/archive/4a2a8693e5a02207a8813b02a375abdc4e43c49b.zip) (Master version before Aug/6/2016)\n+ **Compiler**: Clang\n+ **CFLAGS**: ``-g -O0 -fsanitize=address``\n\n## 4. Reproduce Steps\nPlease copy file ``poc.jp2`` to directory ``openjpeg/bin`` before executing ``opj_decompress``.\n```\nwget https://github.com/uclouvain/openjpeg/archive/4a2a8693e5a02207a8813b02a375abdc4e43c49b.zip\nunzip -q 4a2a8693e5a02207a8813b02a375abdc4e43c49b.zip\nmv openjpeg-4a2a8693e5a02207a8813b02a375abdc4e43c49b openjpeg\ncd openjpeg\nexport CC='/usr/bin/clang -g -O0 -fsanitize=address'\ncmake .\nmake\n\ncd bin\n./opj_decompress -o image.pgm -i poc.jp2\n```\n\n## 5. Vulnerability Details\nAn integer overflow issue exists in function opj_pi_create_decode of pi.c. It can lead to Out-Of-Bounds Read and Out-Of-Bounds Write in function opj_pi_next_cprl of pi.c (function opj_pi_next_lrcp, opj_pi_next_rlcp, opj_pi_next_rpcl, opj_pi_next_pcrl may also be vulnerable). \n\n+ OOB read and OOB write exist in function opj_pi_next_cprl, function opj_pi_next_lrcp, opj_pi_next_rlcp, \nopj_pi_next_rpcl, opj_pi_next_pcrl may also be vulnerable.\n\n```\nstatic OPJ_BOOL opj_pi_next_cprl(opj_pi_iterator_t * pi) {\n    // ...\n    for (pi->layno = pi->poc.layno0; pi->layno < pi->poc.layno1; pi->layno++) {\n        index = pi->layno * pi->step_l + pi->resno * pi->step_r + pi->compno * pi->step_c + pi->precno * pi->step_p;\n        if (!pi->include[index]) {      // ----> Out-Of-Bounds Read!!!\n            pi->include[index] = 1;     // ----> Out-Of-Bounds Write!!!\n            return OPJ_TRUE;\n        }\n    // ...\n    return OPJ_FALSE;\n}\n```\n\n+ Integer overflow exists in function opj_pi_create_decode.\n\n```\nopj_pi_iterator_t *opj_pi_create_decode(opj_image_t *p_image,\n                                        opj_cp_t *p_cp,\n                                        OPJ_UINT32 p_tile_no)\n{\n    // ...\n    l_step_p = 1;\n    l_step_c = l_max_prec * l_step_p;\n    l_step_r = p_image->numcomps * l_step_c;\n    l_step_l = l_max_res * l_step_r;\n\n    /* set values for first packet iterator */\n    l_current_pi = l_pi;\n\n    /* memory allocation for include */\n    l_current_pi->include = (OPJ_INT16*) opj_calloc(\n        (l_tcp->numlayers +1) * l_step_l, sizeof(OPJ_INT16));   // ----> Integer Overflow!!!\n    // ...\n}\n```\n\n+ AddressSanitizer output the following exception information.\n\n```\n==10074==ERROR: AddressSanitizer: heap-buffer-overflow on address \n    0xad9370a0 at pc 0xb767ba50 bp 0xbff1ad78 sp 0xbff1ad70\nREAD of size 2 at 0xad9370a0 thread T0\n    #0 0xb767ba4f in opj_pi_next_cprl src/lib/openjp2/pi.c:541:12\n    #1 0xb76644e7 in opj_pi_next src/lib/openjp2/pi.c:1872:11\n    #2 0xb76cd0af in opj_t2_decode_packets src/lib/openjp2/t2.c:412:24\n    #3 0xb771ee6e in opj_tcd_t2_decode src/lib/openjp2/tcd.c:1547:15\n    #4 0xb771de16 in opj_tcd_decode_tile src/lib/openjp2/tcd.c:1286:15\n    #5 0xb74d7a0e in opj_j2k_decode_tile src/lib/openjp2/j2k.c:8134:15\n    #6 0xb7563354 in opj_j2k_decode_tiles src/lib/openjp2/j2k.c:9761:23\n    #7 0xb74bce4c in opj_j2k_exec src/lib/openjp2/j2k.c:7350:43\n    #8 0xb74f378b in opj_j2k_decode src/lib/openjp2/j2k.c:9959:15\n    #9 0xb75b80de in opj_jp2_decode src/lib/openjp2/jp2.c:1492:8\n    #10 0xb7622eb8 in opj_decode src/lib/openjp2/openjpeg.c:412:10\n    #11 0x8140304 in main src/bin/jp2/opj_decompress.c:1332:10\n    #12 0xb71b9af2 in __libc_start_main /build/eglibc-X4bnBz/eglibc-2.19/csu/libc-start.c:287\n    #13 0x80781eb in _start (bin/opj_decompress+0x80781eb)\n\nAddressSanitizer can not describe address in more detail (wild memory access suspected).\nSUMMARY: AddressSanitizer: heap-buffer-overflow src/lib/openjp2/pi.c:541 opj_pi_next_cprl\nShadow bytes around the buggy address:\n  0x35b26dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n=>0x35b26e10: fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x35b26e60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==10074==ABORTING\n```\n\n## 6. Timeline\n+ 2016.08.20 - Found\n+ 2016.08.22 - Reported to OpenJPEG via info@openjpeg.org\n+ 2016.09.08 - Fixed\n+ 2016.09.08 - Publicly disclosed\n\n## 7. References\n+ [OpenJPEG Patch 1](https://github.com/uclouvain/openjpeg/commit/c16bc057ba3f125051c9966cf1f5b68a05681de4)\n+ [OpenJPEG Patch 2](https://github.com/uclouvain/openjpeg/commit/ef01f18dfc6780b776d0674ed3e7415c6ef54d24)\n+ [oss-sec CVE Request](http://seclists.org/oss-sec/2016/q3/439)\n",
  "weakness": {
    "id": 2,
    "name": "Memory Corruption - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 118978,
      "file_name": "poc.jp2",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/118/978/0efa47261d80918230ea5e4a46cf680c3a6e2520/poc.jp2?response-content-disposition=attachment%3B%20filename%3D%22poc.jp2%22%3B%20filename%2A%3DUTF-8%27%27poc.jp2&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTABFVXIV%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T132412Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIARSTUTlLtqfCtFxZFk4rYBghKF7D2jkZPr1QwTWq%2BGXAiEAv6miAxW0spzaBwsrYsw578P9GcnLl7tkD3KSwPtv%2FLcqsQUIExADGgwwMTM2MTkyNzQ4NDkiDMRzqVS0jkm%2Bv4Wa5CqOBR76uTTT2nWrSXGgdyoE1NtYArYx2zNugI3zy19%2F0NbNPsgMq%2BVIwUVMaICZwERNFM3Ynuw2lLcwlMZcx%2BKlA46VydjCvjJdSq3rZg3mrz6TCgarB3l3mOWRfQE7%2B6R5kd6pEt%2BXzCzO7Oz%2ByqGuVWwSEJgTeLJZFuKmcZSMr%2F86UgsB2gwp%2FZD%2BVvNNEwLTJDQTpmL172aomVt9oe7CwNNlZLemIjD6ujwNcLYWjNdCqcLsLveQ8eNBidevZY5USEd4wbLhH1SUQr2qg2HOFblt%2B9N18%2FzvHhQARS4%2FBs1utdgFK9di6S9hbUMavj%2FiVFcgVamg5XDadOYJfrZhMLXjs7JFoR5LI%2FxLOH6gufc39sOgW1jEXlKXX4F3gv5U0Ts3ncRxb6pUdDsqKHC11mIkJzZIfP0cdJZBykZmj%2BvkVm9hiT6L3B7y87YPSkairkgvBvuGNRdIxrNI%2F%2FH1eBRFxB9M%2B4gteUwrNQJ3zAOkBciHqDn%2BbYeR3FV2E4lYSNE0XEAd9ckVJk7zzITpTf%2Bqb2FJOl%2FGAUlM23wNxMVUUoKJfiCGUkFWaow4qptq6hpqUcQnpV9dRsOQUNFJZbSpdMwxTdu04nTB3fj7FMFhytDsNGl0x7bt5j2q58omJl5C41S4%2FwY0Xi7WkZxLvdxluHJpi2RxUWhNtpPQ88YCWMxi44HqDZ2FbWgM9VKZE1DGp0ml3eOOwdDQ5J3XAjG2g%2Fk5IRoMcX5ftfIjKzhs9JcgUtV%2FU2%2F5obSwXDm7OavJTNxLUTMWvO7BE78PSdr7FfUttD%2Fzh5Eog0%2F0nIlKw5MTl9P%2BtgACFqhih6dbvCfJ4yEfeChQ4s4RzK76W4zN4wdMmUwWJ3uf7I2xDzDomL%2FGBjqxAQjtEZAT4Ko0QTziHMwTUt45mr9X4bfKK2Aye%2F5C%2BNagm7ta0vwtP6vYQ3T9%2BWfsLrtvmlq2L5%2Bx4hQxDkQ4JX%2BhE7mNJwl633WTs4TPq9nosYvDd2GoZsXK5qqlsMIFl%2FShYPbzhH7eSCWgR6f5ZWkkX%2FDBkZ3Mt%2FPqqLHgMblgxWEB1fDGiCVYkb%2B16GM2CiNvSbYRIOcrNOa%2BgAm%2BfS%2FG3fn67R%2FB%2BtcmMCeqNEcnmA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5fea6d01b8ee7be24e56c0fe4b828dee23728126688b548d2e9d86994286500f",
      "file_size": 868,
      "type": "application/octet-stream",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-11-12T23:54:25.612Z",
  "allow_singular_disclosure_after": -184858186.87507555,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "qtros",
    "official_blackhat13",
    "mk_l30"
  ],
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
