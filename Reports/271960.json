{
  "id": 271960,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzE5NjA=",
  "url": "https://hackerone.com/reports/271960",
  "title": "Client-side Template Injection in Search, user email/token leak and maybe sandbox escape",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-09-26T13:17:48.784Z",
  "submitted_at": "2017-09-26T13:17:48.784Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "europa",
    "url": "/europa",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2143,
    "url": "https://hackerone.com/rockstargames",
    "handle": "rockstargames",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Rockstar Games",
      "twitter_handle": "RockstarGames",
      "website": "http://www.rockstargames.com/",
      "about": "Publishers of such popular games as Grand Theft Auto, Max Payne, Red Dead Redemption, L.A. Noire, Bully & more."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-05-01T15:37:55.437Z",
  "bug_reporter_agreed_on_going_public_at": "2018-04-08T13:44:48.634Z",
  "team_member_agreed_on_going_public_at": "2018-05-01T15:37:55.290Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-05-08T13:44:48.756Z",
  "allow_singular_disclosure_after": -232691503.92891446,
  "singular_disclosure_allowed": true,
  "vote_count": 15,
  "voters": [
    "k0ns0l",
    "jokebookservice1",
    "sp1d3rs",
    "europa",
    "muon4",
    "bl4de",
    "2026",
    "fa1rlight",
    "eveeez",
    "13ern",
    "and 5 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 440,
    "asset_type": "URL",
    "asset_identifier": "support.rockstargames.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 7282,
      "category": "team",
      "content": "In this report, the researcher was able to perform [AngularJS Template Injection](https://hackerone.com/redirect?signature=49c7114e65f27ab7700511ac15aaa633cf22a68b&url=http%3A%2F%2Fblog.portswigger.net%2F2016%2F01%2Fxss-without-html-client-side-template.html) on our Support site in order to retrieve data, including email address, userid and tokens. Typically, a user is always able to retrieve this information about themselves and on its own, this is known behavior. However, by utilizing a manipulated Avatar URI value, the researcher was able to demonstrate how an attacker could exfiltrate *another* user's email, userid, and tokens to an external server owned by the attacker. The researcher was further able to demonstrate other types of attacks possible via AngularJS Template Injection, but the most interesting one to us was the data exfiltration POC.\n\nWe resolved this issue by updating our version of AngularJS, and by applying the `ng-non-bindable` directive to the vulnerable fields. This directive prevents AngularJS from compiling or binding the contents of the current DOM element, making it effective at preventing XSS and Code Injection attacks.",
      "updated_at": "2018-05-01T15:33:05.168Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 57954,
        "username": "jmarshall",
        "name": "JMarshall",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-02-25T14:40:27.992Z",
        "url": "https://hackerone.com/jmarshall",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "id": 5437,
      "category": "researcher",
      "content": "Sometimes you don't need a fully-fledged XSS to leak useful data!\n\nAn [AngularJS template injection](http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html) was possible in the search field giving me access to the whole AngularJS scope for the page.\n\nBy traversing the DOM via childHead / nextSibling objects it was possible to grab informations from the active scope (ie: email, userid, and tokens); subsequently manipulating the victim's avatar URL to a resource on an adversary-controlled server allowed the attacker to exfiltrate session details without strictly relying on Javascript injection, delivering the goodies through simple GET requests.\n\nA sandbox escape was found later on rendering the unorthodox approach unnecessary, but extremely fun nonethelessâ€”also given the fact that Rockstar Games decided scoped this flaw as a Reflected XSS before that happened.",
      "updated_at": "2018-05-01T13:55:53.254Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 189882,
        "username": "europa",
        "name": "Alessandro De Micheli",
        "bio": "OH GOD HOW DID THIS GET HERE I'M NOT GOOD WITH COMPUTERS",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "Rome",
        "created_at": "2017-08-07T16:08:08.728Z",
        "url": "https://hackerone.com/europa",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/yLAfkbEdjS5TTkov1RViumZ4/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    }
  ]
}
