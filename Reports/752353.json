{
  "id": 752353,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTIzNTM=",
  "url": "https://hackerone.com/reports/752353",
  "title": "Anonymous file drop page ignores user profile visibility restrictions",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2019-12-06T00:32:20.074Z",
  "submitted_at": "2019-12-06T00:32:20.074Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "pshknst",
    "url": "/pshknst",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-08-03T08:27:43.603Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-03T08:27:43.527Z",
  "team_member_agreed_on_going_public_at": "2020-08-03T07:53:51.263Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "User profile on Nextcloud server by url like https://<server.domain>/index.php/settings/user includes personal information: photo, name, email address. For each listed fields user can select the visibility settings: local, contacts, public. It is expected that these settings will work in all places of the Nextcloud server.\n\nBut if you use an anonymous download folder as written in documentation\nhttps://docs.nextcloud.com/server/stable/user_manual/files/file_drop.html\nthen the profile visibility settings on upload page are ignored.\nFor example, if you specify the photo and fullname to be shown only for local or contacts Nextcloud server users, they will still be displayed on the upload page available publicly by the link.\nEven in the documentation itself, the name is covered with black mask because it refers to a specific user.\n\nThis is not the behavior of the application that is expected when the settings for visibility of photo and fullname only to local users are selected. In order to not disclose this information to anonymous public users, it is better to use the profile parameter on the file upload page too: hide non-public user info; show, for example, only the name of the folder without a photo and name of owner of folder.\nDisclosure of personal data can occur even without knowledge of owner of folder, because if he provided access to his folder for other registered Nextcloud users of the same server, they can next share folder for upload by share link without his participation and knowledge. No too good for enterprise uses where Nextcloud can sync user profiles with company's directory services which usually should be restricted for public access.\n\n## Impact\n\nInformation disclosure of user profile data",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-09-02T07:53:51.331Z",
  "allow_singular_disclosure_after": -159414092.0594548,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "foobar7",
    "sa1tama0",
    "gatz5225",
    "kelly-blinks"
  ],
  "structured_scope": {
    "databaseId": 13,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
