{
  "id": 457829,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTc4Mjk=",
  "url": "https://hackerone.com/reports/457829",
  "title": "SPF Records (SMTP protection not used)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-12-07T06:51:28.898Z",
  "submitted_at": "2018-12-07T06:51:28.898Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "shantanu_kul",
    "url": "/shantanu_kul",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22750,
    "url": "https://hackerone.com/mycrypto",
    "handle": "mycrypto",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/022/750/bb6071d69f26459ef3aebe0ae25d6b0ff95ff720_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "MyCrypto",
      "twitter_handle": "mycrypto",
      "website": "https://mycrypto.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-12-17T22:02:19.091Z",
  "bug_reporter_agreed_on_going_public_at": "2018-12-17T22:02:19.030Z",
  "team_member_agreed_on_going_public_at": "2018-12-10T16:22:25.077Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello MyCrypto Team ,\n\nI am checking your website and found something is missing in SPF record.I don't find you have applied strict SMTP policy to stop spoofed email sending from your domain.\n\nI would like to recommend you to read the following article :\n\nhttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\n\nProblem description :\n\nThe above article strictly guide us about difference between soft mail and fail. MyCrypto should use fail because Soft mail allows anyone to send spoofed emails from your domains.\n\nIn your SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using ~ , you should use -\n\nFIX :\n\nYour SPF record : v=spf1 include:_spf.google.com ~all \n\nIt should be : v=spf1 include:_spf.google.com -all \n\nBest Regards ,\n\nShantanu\n\n## Impact\n\nAn attacker can send a Fake email from support@mycrypto.com saying that Please change your password, The victim is aware or not of phishing attacks, But when he sees that the mail originated from support@mycrypto.com , then he can blindly believe on it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his PayPal id and password (SESSION COOKIE). \nLater results are more harmful.\n\n<?php\n$to = \"VICTIM@example.com\";\n$subject = \"Password Change\";\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\n$headers = \"From: support@mycrypto.com\";\nmail($to,$subject,$txt,$headers);\n?>",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "ali",
    "sameerphad72",
    "cryptographer",
    "barsainya",
    "securityb0y",
    "shantanu_kul",
    "reppie",
    "gokul07",
    "saurabhmeher"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 6528,
    "asset_type": "URL",
    "asset_identifier": "www.mycrypto.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
