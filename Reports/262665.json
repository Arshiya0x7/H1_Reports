{
  "id": 262665,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjI2NjU=",
  "url": "https://hackerone.com/reports/262665",
  "title": "CVE-2017-5969: libxml2 when used in recover mode, allows remote attackers to cause a denial of service (NULL pointer dereference)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-08-23T18:59:34.267Z",
  "submitted_at": "2017-08-23T18:59:34.267Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "geeknik",
    "url": "/geeknik",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6AKSZDHS%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T142819Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCEHr6%2FITuA6i9MnGcSFvq0tSxJ%2BdxYNvgtGx9sVCpP0gIgQvA1Ky%2Fhd1hV8yUECKBBqd31%2F4qe78yUbG%2F1unOewWIqsQUIFRADGgwwMTM2MTkyNzQ4NDkiDMXcgCZzTCKH5ST3jCqOBWRl979CFVq%2B%2BT6ECmkSm23zy6aqef%2FvmEN9I18qMIC7V7J7DuyPMyzAZ3X3pPZQAGkDUC06OTAyWbbSGAmbJdxwW3q0X32PYTaEJBA1Fu8cY6Ys%2B1haz%2BDQfi%2F0GBm0liKZvpKgdRgYxGW3Kr0w0UMbBGTg%2F40XuOgVSS1P%2FEtCVkRZC0vHd%2B4T3PrVhh2TIL3f%2FZ24ghM0kJsZ9pjAf5foLXRrSe4qaLWl7Qem73y4XhXf1dNhPUzuFF3dlbPtfHzmknEa%2BSA5e9usC6Z%2FQyKB16GrxH8qLBpU6p1vHWObQVs4pJhQrPJ7KZjeCwfo1jLQL0nOuRUGN51gru5bW9WUj2wXd4eY3lobScvt%2FynWdkTCyUQQ4bB6EgwmGVU%2F9ZqSdcqI18slbZ4OqpBANP6KfzZ4cCgdJQgGo3c%2F8lXCC9NsEIH462h8mV1K%2FkEHz4tMaYi0TkOx1RkU5VniH3AlokohHSiaLa3VZI%2B49QEwOIEIj23eOfXVagLNv8DRqbLKciJtKUJatXd4HiU3Y5joJlB9bWZN2hkGMTF1HhP7vwzCFu90sJ0xSY8ysWkNvAz94rR4r2sK35jKxvLGKWEc%2FoJTN%2FwNzpCSXUu%2F%2BwUBCmtbmJA7%2FZvD%2BB7Wb%2FrREMi7HN5L8JkPUFbhr38xjkKI8fXualX24n3cKXHww17VueYo6UmhbivMu77b8PEtBfWR8wh9x6MlSf9M6nyjyTE%2FySeE6%2B56GJrozwqZiAIJgNC23FGvXE%2B%2BYEjx%2FvLheyewy7dke9vrnak0eHZ9YuREHmp1cXccNfNLO0Jhl5xa9zZSGlZEGSvNC6zlP2%2FGZDrSaUweCKLpgSGZ%2FfqijUucTrdt3Nnp2w0viHR0SDDu0b%2FGBjqxAUNODEvhzBhHovbPmV3wp4kR7l0JgxZChXGpxyDorjULJE3po47RowB7FmkQlQpvYCuhD7LMjJvCmDjWRCa7JdNczcU%2Bz0Q02ML4NYmrOmjjJzE0c50SMNUl1OOcfS7QJfxDEShlAaCahrObKHYvste5ytUXGvbEPhHZCz%2Btf%2FRxcLdGvHHIekK%2FQchrv8GZQn9jMdn1PIi%2BIiqze2ch2fPmoohptK6%2BQMOpQ%2FfbruIbyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=68ad6e4d09e1851ad3b1391b9d6022b2567f735d51b0bbfed369ae788c547e4f",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6AKSZDHS%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T142819Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCEHr6%2FITuA6i9MnGcSFvq0tSxJ%2BdxYNvgtGx9sVCpP0gIgQvA1Ky%2Fhd1hV8yUECKBBqd31%2F4qe78yUbG%2F1unOewWIqsQUIFRADGgwwMTM2MTkyNzQ4NDkiDMXcgCZzTCKH5ST3jCqOBWRl979CFVq%2B%2BT6ECmkSm23zy6aqef%2FvmEN9I18qMIC7V7J7DuyPMyzAZ3X3pPZQAGkDUC06OTAyWbbSGAmbJdxwW3q0X32PYTaEJBA1Fu8cY6Ys%2B1haz%2BDQfi%2F0GBm0liKZvpKgdRgYxGW3Kr0w0UMbBGTg%2F40XuOgVSS1P%2FEtCVkRZC0vHd%2B4T3PrVhh2TIL3f%2FZ24ghM0kJsZ9pjAf5foLXRrSe4qaLWl7Qem73y4XhXf1dNhPUzuFF3dlbPtfHzmknEa%2BSA5e9usC6Z%2FQyKB16GrxH8qLBpU6p1vHWObQVs4pJhQrPJ7KZjeCwfo1jLQL0nOuRUGN51gru5bW9WUj2wXd4eY3lobScvt%2FynWdkTCyUQQ4bB6EgwmGVU%2F9ZqSdcqI18slbZ4OqpBANP6KfzZ4cCgdJQgGo3c%2F8lXCC9NsEIH462h8mV1K%2FkEHz4tMaYi0TkOx1RkU5VniH3AlokohHSiaLa3VZI%2B49QEwOIEIj23eOfXVagLNv8DRqbLKciJtKUJatXd4HiU3Y5joJlB9bWZN2hkGMTF1HhP7vwzCFu90sJ0xSY8ysWkNvAz94rR4r2sK35jKxvLGKWEc%2FoJTN%2FwNzpCSXUu%2F%2BwUBCmtbmJA7%2FZvD%2BB7Wb%2FrREMi7HN5L8JkPUFbhr38xjkKI8fXualX24n3cKXHww17VueYo6UmhbivMu77b8PEtBfWR8wh9x6MlSf9M6nyjyTE%2FySeE6%2B56GJrozwqZiAIJgNC23FGvXE%2B%2BYEjx%2FvLheyewy7dke9vrnak0eHZ9YuREHmp1cXccNfNLO0Jhl5xa9zZSGlZEGSvNC6zlP2%2FGZDrSaUweCKLpgSGZ%2FfqijUucTrdt3Nnp2w0viHR0SDDu0b%2FGBjqxAUNODEvhzBhHovbPmV3wp4kR7l0JgxZChXGpxyDorjULJE3po47RowB7FmkQlQpvYCuhD7LMjJvCmDjWRCa7JdNczcU%2Bz0Q02ML4NYmrOmjjJzE0c50SMNUl1OOcfS7QJfxDEShlAaCahrObKHYvste5ytUXGvbEPhHZCz%2Btf%2FRxcLdGvHHIekK%2FQchrv8GZQn9jMdn1PIi%2BIiqze2ch2fPmoohptK6%2BQMOpQ%2FfbruIbyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b7ad05f8b9c6887666184ec45bbecbc0cf23e3a10b9bf2285b662ebbd6b091c5"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2017-5969"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-10-04T17:40:19.246Z",
  "bug_reporter_agreed_on_going_public_at": "2019-10-04T16:22:39.857Z",
  "team_member_agreed_on_going_public_at": "2019-10-04T17:40:19.159Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I first reported this bug to the developers on [20 November 2015](https://bugzilla.gnome.org/show_bug.cgi?id=758422). A patch was finally committed on 7 June 2017 [here](https://git.gnome.org/browse/libxml2/commit/?id=94691dc884d1a8ada39f073408b4bb92fe7fe882). The caveat here is that this only happens in recover mode which the developers say no sane person should ever use in production and/or against untrusted inputs. A CVE was assigned in April 2017.\n\nThe original crash involved some memory corruption which lead to a null pointer dereference and subsequent segfault after running `./xmllint --recover` against XML similar to `<!DOCTYPE[<!ELEMENT l((|s)>`.\n\n```\ntest00.xml:1: parser error : xmlParseDocTypeDecl : no DOCTYPE name !\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n         ^\ntest00.xml:1: parser error : Space required after 'ELEMENT'\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                        ^\ntest00.xml:1: parser error : Input is not proper UTF-8, indicate encoding !\nBytes: 0xDF 0x28 0xE2 0x2C\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                        ^\ntest00.xml:1: parser error : Space required after the element name\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                         ^\ntest00.xml:1: parser error : ContentDecl : Name or '(' expected\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                             ^\ntest00.xml:1: parser error : internal error: xmlParseInternalSubset: error detected in Markup declaration\n\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\ntest00.xml:1: parser error : DOCTYPE improperly terminated\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452A72: xmlNextChar (parserInternals.c:535)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452E0C: xmlNextChar (parserInternals.c:538)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452EE3: xmlNextChar (parserInternals.c:540)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D39A7: xmlParseMisc (parser.c:10723)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D39FA: xmlParseMisc (parser.c:10726)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D3A3F: xmlParseMisc (parser.c:10726)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \ntest00.xml:1: parser error : internal error: Huge input lookup\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E2C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x474CA5: xmlFatalErr (parser.c:538)\n==100630==    by 0x474CA5: xmlGROW (parser.c:2075)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E6C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x474CA5: xmlFatalErr (parser.c:538)\n==100630==    by 0x474CA5: xmlGROW (parser.c:2075)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4749A8: xmlGROW (parser.c:2079)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4E55FC: xmlParseDocument (parser.c:10879)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \ntest00.xml:1: parser error : Start tag expected, '<' not found\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E2C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x4E5012: xmlFatalErrMsg (parser.c:565)\n==100630==    by 0x4E5012: xmlParseDocument (parser.c:10880)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E6C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x4E5012: xmlFatalErrMsg (parser.c:565)\n==100630==    by 0x4E5012: xmlParseDocument (parser.c:10880)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Invalid read of size 4\n==100630==    at 0x5BD149: xmlDumpElementContent (valid.c:1181)\n==100630==    by 0x5CD871: xmlDumpElementDecl (valid.c:1706)\n==100630==    by 0xA06A82: xmlBufDumpElementDecl (xmlsave.c:501)\n==100630==    by 0xA06A82: xmlNodeDumpOutputInternal (xmlsave.c:939)\n==100630==    by 0xA06A82: xmlNodeListDumpOutput (xmlsave.c:825)\n==100630==    by 0xA06A82: xmlDtdDumpOutput (xmlsave.c:749)\n==100630==    by 0xA032B2: xmlDocContentDumpOutput (xmlsave.c:1234)\n==100630==    by 0xA032B2: xmlSaveDoc (xmlsave.c:1936)\n==100630==    by 0x416BA6: parseAndPrintFile (xmllint.c:2705)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==100630== \n==100630== \n==100630== Process terminating with default action of signal 11 (SIGSEGV)\n==100630==  Access not within mapped region at address 0x0\n==100630==    at 0x5BD149: xmlDumpElementContent (valid.c:1181)\n==100630==    by 0x5CD871: xmlDumpElementDecl (valid.c:1706)\n==100630==    by 0xA06A82: xmlBufDumpElementDecl (xmlsave.c:501)\n==100630==    by 0xA06A82: xmlNodeDumpOutputInternal (xmlsave.c:939)\n==100630==    by 0xA06A82: xmlNodeListDumpOutput (xmlsave.c:825)\n==100630==    by 0xA06A82: xmlDtdDumpOutput (xmlsave.c:749)\n==100630==    by 0xA032B2: xmlDocContentDumpOutput (xmlsave.c:1234)\n==100630==    by 0xA032B2: xmlSaveDoc (xmlsave.c:1936)\n==100630==    by 0x416BA6: parseAndPrintFile (xmllint.c:2705)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630==  If you believe this happened as a result of a stack\n==100630==  overflow in your program's main thread (unlikely but\n==100630==  possible), you can try to increase the size of the\n==100630==  main thread stack using the --main-stacksize= flag.\n==100630==  The main thread stack size used in this run was 8388608.\nSegmentation fault\n```\n\n\n",
  "weakness": {
    "id": 51,
    "name": "NULL Pointer Dereference"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-11-03T16:22:39.942Z",
  "allow_singular_disclosure_after": -185666739.92701197,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "0xd0m7",
    "geeknik",
    "japz"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
