{
  "id": 337986,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzc5ODY=",
  "url": "https://hackerone.com/reports/337986",
  "title": "CVE-2018-6797:  A crafted regular expression can cause a heap buffer write overflow in Perl 5 giving a remote attacker control over bytes written",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2018-04-14T17:22:34.735Z",
  "submitted_at": "2018-04-14T17:22:34.735Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "geeknik",
    "url": "/geeknik",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSO43U5T6%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T180533Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD67cMBGP2%2BcQLtexV8sGrY0vBz2yRgbATI0xTah5hTkQIhAMdsv37m9QyDoVkPuc96GcasJD1uv31qLa8y4k35gHjsKrEFCBkQAxoMMDEzNjE5Mjc0ODQ5IgzIrwdKXYjQ7LMCM8YqjgWhTO2AHOdnOctwq5FRCX389f%2BT7NDlghlgwbW8YytSnqPHmOTANkgDg6NPrycqqGargYVlB%2FLjXAo1GyV%2B7IroWh0aDreGeItcVPgPB5RErTFgE7mIUMA2foCTR8TW7h5iJkBn9SPuEEVxt%2ByKkS9EJZyNBoOfyxtJLFjzGOGwd6AJ9Wtm95t0eJTRVCOc0YC8%2BRpL6S4QK%2BUJTeRv6I%2B%2FHwzAveue42yOmsFqLGFKPoZRmiNEJ0AtFInnAmX53x1hrOOeede5X0evu2TG0ZNkX3RIizY7OENVjLckNdIus39UP%2BiYmuk4yeLEjuDFQE63CkQ7dFWrywt4Z%2Fzz2FU3svFFgwOaJEbI%2FyqvFhQOkMCTGL%2Fq3FqDjvRrIBVTW6h4r7c8CeWluUGie1r97kOZdV7Ub2aeUIUMUo5CW5%2F%2FWoy7ju4%2Fh1ZWFnBUTpH%2Fi3YAJ0VHgkAyo3tYuefrjtGi1ryQ0sSa8dOG4Vc%2BlGZMiGhvP2wBe7r68Qc6jjxA83hGM%2Bq26u5xzl8R0ESQSXKBrChFLlApel4GtDPT3Sl%2BN2DRdVP0f2ksEBWovVBSprDLpiJ%2BH1WjxfiK1wHI1JiPfWYpXDzJ9JJ8CaqpgQjCScCcq83XJFlt0txxnShaIP0hd3yrnFHcTVguD80q9zByoUOSYNZjHuX%2FMWdOv%2B0LvGy7n8%2F6Ya3NyM%2FX%2FvjuNLUvGRzDAoEba1SHQGBI5XCoAYOjTYkwurc8nZHXwv9hFdG9v1ymwYT1nZ%2Fg7J%2B%2Fj4f4MZJP%2BWe9wcXgsGF00iHfwMJgz4YJCKLdQcAiINRrde9wmx%2BDVxZDIvU9A6QR8jVHos8DUPx6kHirUT5%2F1SRcCYlY%2BMS9xezKOGrUUaow8rPAxgY6sAGeOsUTL2jZ3QSefAfTfLG8%2FPIdc5AVbXR0Ho8KFh6hzj3wh7HzHTuBOcUlrlhoVD3ayDY7g22i4wt%2FwEFybJ9EueG8I%2Fp76jwH9UDFcUz4TU15EM2mbP1JGae%2BPF%2BIKTz%2BhCMU5Y02etiBTT%2B31LaG%2BCCwAXKJ6ZTLJ%2BDIA4v1Y7mKM7wZs0nA6eBKQb%2F4kzmH7J7FnReWZHTgDQGdKXrN0VLDCiujuaIwOZbd1GliQw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=037b726a10b4a6cc565bf6ecfdd9e2e8d3f0e57bfce7392c8165f10ca44e3dfb",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSO43U5T6%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T180533Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD67cMBGP2%2BcQLtexV8sGrY0vBz2yRgbATI0xTah5hTkQIhAMdsv37m9QyDoVkPuc96GcasJD1uv31qLa8y4k35gHjsKrEFCBkQAxoMMDEzNjE5Mjc0ODQ5IgzIrwdKXYjQ7LMCM8YqjgWhTO2AHOdnOctwq5FRCX389f%2BT7NDlghlgwbW8YytSnqPHmOTANkgDg6NPrycqqGargYVlB%2FLjXAo1GyV%2B7IroWh0aDreGeItcVPgPB5RErTFgE7mIUMA2foCTR8TW7h5iJkBn9SPuEEVxt%2ByKkS9EJZyNBoOfyxtJLFjzGOGwd6AJ9Wtm95t0eJTRVCOc0YC8%2BRpL6S4QK%2BUJTeRv6I%2B%2FHwzAveue42yOmsFqLGFKPoZRmiNEJ0AtFInnAmX53x1hrOOeede5X0evu2TG0ZNkX3RIizY7OENVjLckNdIus39UP%2BiYmuk4yeLEjuDFQE63CkQ7dFWrywt4Z%2Fzz2FU3svFFgwOaJEbI%2FyqvFhQOkMCTGL%2Fq3FqDjvRrIBVTW6h4r7c8CeWluUGie1r97kOZdV7Ub2aeUIUMUo5CW5%2F%2FWoy7ju4%2Fh1ZWFnBUTpH%2Fi3YAJ0VHgkAyo3tYuefrjtGi1ryQ0sSa8dOG4Vc%2BlGZMiGhvP2wBe7r68Qc6jjxA83hGM%2Bq26u5xzl8R0ESQSXKBrChFLlApel4GtDPT3Sl%2BN2DRdVP0f2ksEBWovVBSprDLpiJ%2BH1WjxfiK1wHI1JiPfWYpXDzJ9JJ8CaqpgQjCScCcq83XJFlt0txxnShaIP0hd3yrnFHcTVguD80q9zByoUOSYNZjHuX%2FMWdOv%2B0LvGy7n8%2F6Ya3NyM%2FX%2FvjuNLUvGRzDAoEba1SHQGBI5XCoAYOjTYkwurc8nZHXwv9hFdG9v1ymwYT1nZ%2Fg7J%2B%2Fj4f4MZJP%2BWe9wcXgsGF00iHfwMJgz4YJCKLdQcAiINRrde9wmx%2BDVxZDIvU9A6QR8jVHos8DUPx6kHirUT5%2F1SRcCYlY%2BMS9xezKOGrUUaow8rPAxgY6sAGeOsUTL2jZ3QSefAfTfLG8%2FPIdc5AVbXR0Ho8KFh6hzj3wh7HzHTuBOcUlrlhoVD3ayDY7g22i4wt%2FwEFybJ9EueG8I%2Fp76jwH9UDFcUz4TU15EM2mbP1JGae%2BPF%2BIKTz%2BhCMU5Y02etiBTT%2B31LaG%2BCCwAXKJ6ZTLJ%2BDIA4v1Y7mKM7wZs0nA6eBKQb%2F4kzmH7J7FnReWZHTgDQGdKXrN0VLDCiujuaIwOZbd1GliQw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c875bd380dfad808e2a770387735636060a99320f1256c5c247de5d7ab357b52"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-6797"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-05-19T19:00:32.204Z",
  "bug_reporter_agreed_on_going_public_at": "2018-04-19T19:00:25.730Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "An attacker supplies a regular expression containing one or more `\\xDF` characters after an escape putting the regexp into unicode matching mode, such as a `\\N{}` escape.  Each `\\xDF` character adds one byte of overflow, and any other text in the regular expression is written in order, providing the attacker control over the bytes written to the overflowed region.\n\n* Reported to the [Perl security mailing list](https://rt.perl.org/Ticket/Display.html?id=132227) on 6 Oct 2017.\n* Confirmed as a security flaw by TonyC on 31 Jan 2018\n* CVE-2018-6797 assigned to this flaw on 6 Feb 2018\n* Patch released to the security mailing list for Perl 5.24 and Perl 5.26 on 09 Feb 2018\n* Patch released to the security mailing list for Perl blead on 22 Feb 2018\n* [Public security advisory](https://github.com/Perl/perl5/blob/blead/pod/perl5262delta.pod) released on 14 April 2018\n\nOn 31 Jan 2018 Perl dev TonyC says in an email to the Perl security mailing list that `depending on the heap implementation it may be possible to perform a nastier exploit - an attacker has almost complete control over the bytes written.`\n\n```\n==28186==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60700000ac58 at pc 0x000000846c2d bp 0x7ffe716bc7f0 sp 0x7ffe716bc7e0\nWRITE of size 1 at 0x60700000ac58 thread T0\n    #0 0x846c2c in S_regatom /root/perl/regcomp.c:13652\n    #1 0x8587f6 in S_regpiece /root/perl/regcomp.c:11708\n    #2 0x8587f6 in S_regbranch /root/perl/regcomp.c:11633\n    #3 0x88830a in S_reg /root/perl/regcomp.c:11371\n    #4 0x8c90dc in Perl_re_op_compile /root/perl/regcomp.c:7363\n    #5 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #6 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #7 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #8 0x593622 in perl_parse /root/perl/perl.c:1753\n    #9 0x42eb7d in main /root/perl/perlmain.c:121\n    #10 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #11 0x42fe18 in _start (/root/perl/perl+0x42fe18)\n\n0x60700000ac58 is located 0 bytes to the right of 72-byte region [0x60700000ac10,0x60700000ac58)\nallocated by thread T0 here:\n    #0 0x7fba4dc62602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\n    #1 0x92dfd4 in Perl_safesysmalloc /root/perl/util.c:153\n    #2 0x8c6cbe in Perl_re_op_compile /root/perl/regcomp.c:7209\n    #3 0x5297d0 in Perl_pmruntime /root/perl/op.c:5888\n    #4 0x74d853 in Perl_yyparse /root/perl/perly.y:1210\n    #5 0x58b9b8 in S_parse_body /root/perl/perl.c:2450\n    #6 0x593622 in perl_parse /root/perl/perl.c:1753\n    #7 0x42eb7d in main /root/perl/perlmain.c:121\n    #8 0x7fba4cebe82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/perl/regcomp.c:13652 S_regatom\n```\n\n## Impact\n\nDepending on the heap implementation a remote attacker could have complete control over the bytes written to memory.",
  "weakness": {
    "id": 5,
    "name": "Heap Overflow"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-05-19T19:00:25.830Z",
  "allow_singular_disclosure_after": -231721507.33313724,
  "singular_disclosure_allowed": true,
  "vote_count": 23,
  "voters": [
    "rc0r",
    "jokebookservice1",
    "kapytein",
    "muon4",
    "bl4de",
    "spam404",
    "mak",
    "savitar0x01",
    "apapedulimu",
    "r3y",
    "and 13 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 84128,
    "asset_type": "OTHER",
    "asset_identifier": "Perl (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
