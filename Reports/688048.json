{
  "id": 688048,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODgwNDg=",
  "url": "https://hackerone.com/reports/688048",
  "title": "Incorrect IPv6 literal parsing leads to validated connection to unexpected https server.",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "medium",
  "readable_substate": "Informative",
  "created_at": "2019-09-04T18:47:19.056Z",
  "submitted_at": "2019-09-04T18:47:19.056Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "thomas_v",
    "url": "/thomas_v",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-01-12T13:11:23.513Z",
  "bug_reporter_agreed_on_going_public_at": "2021-01-12T13:11:23.464Z",
  "team_member_agreed_on_going_public_at": "2021-01-08T08:24:53.795Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThe IPv6 ip address can be specified with square brackets like [fe80::3]. There can also be a zone id specified like [fe80::3%15]. A URL can specify its hostname with IPv6 literal,\n\nIt seems that the parsing in curl library is not complete. For instance, it is possible for particular IPv6 literals to trigger an http or https request on rather unexpected hostname.\n\nSee for instance the potentially misleading hostname:\n`https://[ab.be%google.com]/query`\n\nWhen used with the available online sample program 'simple.c', there is no error. The https request is performed on the Belgian website 'https://ab.be' and the SSL certificate is properly validated against 'ab.be', not 'google.com'.\n\n## Steps To Reproduce:\n\n  1. Build attached modified `simple.c`\n  2. `gcc simple.c && ./a.out https://[ab.be%google.com]/query`\n  3. Check with Wireshark actual DNS / IP traffic, actually is https and corresponds to 'ab.be'\n\n- The command line 'curl' binary itself is performing sanities so the url above is rejected.\n- The 'Host:' header field happens to contain square brackets. An attacker would have an http server handling that detail. Currently 'ab.be' responds with error 400 bad request.\n\n## Supporting Material/References:\n`simple.c`\n```c\n#include <stdio.h>\n#include <curl/curl.h>\n \nint main(int argc, char*argv[])\n{\n  CURL *curl;\n  CURLcode res;\n \n  curl = curl_easy_init();\n  if(curl) {\n    curl_easy_setopt(curl, CURLOPT_URL, argv[1]);\n    /* example.com is redirected, so we tell libcurl to follow redirection */ \n    curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1L);\n \n    /* Perform the request, res will get the return code */ \n    res = curl_easy_perform(curl);\n    /* Check for errors */ \n    if(res != CURLE_OK)\n      fprintf(stderr, \"curl_easy_perform() failed: %s\\n\",\n              curl_easy_strerror(res));\n \n    /* always cleanup */ \n    curl_easy_cleanup(curl);\n  }  \n  return 0; \n}\n```\n\n## Impact\n\nUser might get confused and connect on the wrong hostname.",
  "weakness": {
    "id": 121,
    "name": "Improper Handling of URL Encoding (Hex Encoding)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "medium",
    "score": 6.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
