{
  "id": 2902856,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTAyODU2",
  "url": "https://hackerone.com/reports/2902856",
  "title": "[nextcloud/mail] Blind SSRF to Internal Network via \"List-Unsubscribe\" SMTP Header when allow_local_remote_servers is allowed",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "medium",
  "readable_substate": "Informative",
  "created_at": "2024-12-16T15:38:08.520Z",
  "submitted_at": "2024-12-16T15:38:08.855Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "is_triager?": false,
  "reporter": {
    "disabled": false,
    "username": "lauritz",
    "url": "/lauritz",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/hsgut1vi1cv8housqai9cm9383yx/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/hsgut1vi1cv8housqai9cm9383yx/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-12-23T07:11:19.805Z",
  "bug_reporter_agreed_on_going_public_at": "2025-12-23T07:11:19.563Z",
  "team_member_agreed_on_going_public_at": "2025-12-17T09:08:07.756Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 1,
  "voters": [
    "2026"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 45132,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/mail",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 797250,
      "category": "team",
      "content": "We consider this a non-issue due to the nature of the developer configuration flag `allow_local_remote_servers` being here exactly for that case. For developers it's necessary to test with local servers, so when this flag is allowed of course the \"internal SSRF\" works.\nIf the configuration is not set or set to false as it should be on any production server, no SSRF is possible.",
      "updated_at": "2025-12-17T09:07:58.751Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 89223,
        "username": "nickvergessen",
        "name": "Joas Schilling",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "Germany",
        "created_at": "2016-07-01T08:17:59.061Z",
        "url": "https://hackerone.com/nickvergessen",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/d6d8259739a2a4d509639b7804214d057bca547cc3fafe509ec3e3a86321b1d1"
        }
      }
    },
    {
      "id": 799154,
      "category": "researcher",
      "content": "This issue was reported in the course of broader research on the “List-Unsubscribe” SMTP header.\n\nWhile, in my test environment, the SSRF could be used to target internal hosts, later evaluation led to the conclusion that Nextcloud sufficiently protects against internal SSRF via the \"List-Unsubscribe\" SMTP header. Still, the approach described in my blog post can be used to forge external requests. Insecure Nextcloud configurations or additional supporting factors may also allow requests to internal networks via this SSRF.\n\nThe blog post discussing vulnerabilities in this domain can be found here:\nhttps://security.lauritz-holtmann.de/post/xss-ssrf-list-unsubscribe/",
      "updated_at": "2025-12-23T07:10:03.293Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 225466,
        "username": "lauritz",
        "name": "Lauritz Holtmann",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": "https://security.lauritz-holtmann.de",
        "location": "",
        "created_at": "2017-12-18T00:03:45.133Z",
        "url": "https://hackerone.com/lauritz",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/g4U1xdatWYGm57xcNJJw4v4W/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    }
  ]
}
