{
  "id": 1213181,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjEzMTgx",
  "url": "https://hackerone.com/reports/1213181",
  "title": "CVE-2021-22923: Metalink download sends credentials",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-05-30T21:32:16.923Z",
  "submitted_at": "2021-05-30T21:32:16.976Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nyymi",
    "url": "/nyymi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-22923"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-07-21T16:28:52.493Z",
  "bug_reporter_agreed_on_going_public_at": "2021-07-21T16:28:52.455Z",
  "team_member_agreed_on_going_public_at": "2021-07-21T16:26:38.182Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nWhen compiled `--with-libmetalink` and used with `--metalink`  and `--user` curl will use the credentials for any further transfers performed. This includes different hosts and protocols, even ones without transport layer security such as `http` and `ftp`. As a result the credentials only intended for the target site may end up being sent to outside hosts, and without transport layer security, and may be intercepted by attackers in man in the middle network position.\n\nFor example HTTP redirects will not leak the credentials to other hosts unless if  `--location-trusted` is used, thus this is unexpected and insecure behaviour.\n\n## Steps To Reproduce:\n  1. Configure libcurl `--with-libmetalink` and build libcurl\n  2. Have metalinktest.xml with `<url>` referencing data on different host than testsite and using `http` protocol\n  3. Execute: `curl --metalink --user professor:Joshua  https://testsite/metalinktest.xml`\n\nThe credentials can be seen by the target host and anyone in man in the middle position:\n`Authorization: Basic cHJvZmVzc29yOkpvc2h1YQ==`\n\n## Remarks\nCWE-200 (Exposure of Sensitive Information to an Unauthorized Actor) might be a more accurate CWE.\n\n## Fix\n- Perhaps `--location-trusted` should be extended to apply to `--metalink` as well\n\n## Impact\n\nLeak of credentials to unauthorized partiesÂ§",
  "bounty_amount": "700.0",
  "formatted_bounty": "$700",
  "weakness": {
    "id": 34,
    "name": "Cleartext Transmission of Sensitive Information"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-08-20T16:26:38.327Z",
  "allow_singular_disclosure_after": -128944121.42298733,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "menicas",
    "neeythann",
    "thalaivar304",
    "ekgaribadmi"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
