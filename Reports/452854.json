{
  "id": 452854,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTI4NTQ=",
  "url": "https://hackerone.com/reports/452854",
  "title": "Expired reshare links allow access to all files in share",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-11-29T21:50:47.311Z",
  "submitted_at": "2018-11-29T21:50:47.311Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "frr",
    "url": "/frr",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NDQ4MTMsInB1ciI6ImJsb2JfaWQifX0=--4d7184bf7408968ec4eef3dba4718c20f98d0cee/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/Riechsteiner_Fabian_klein.jpg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [
    "CVE-2020-8121"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-06-27T14:00:09.034Z",
  "bug_reporter_agreed_on_going_public_at": "2019-06-27T14:00:08.941Z",
  "team_member_agreed_on_going_public_at": "2019-06-27T10:36:47.308Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-07-27T10:36:47.372Z",
  "allow_singular_disclosure_after": -194244012.91674882,
  "singular_disclosure_allowed": true,
  "vote_count": 38,
  "voters": [
    "ali",
    "imranhudaa",
    "zeroxyele",
    "savitar0x01",
    "ronr",
    "bb00x",
    "cr4xerbik4sh",
    "cryptographer",
    "tiago-danin",
    "0xm1racle",
    "and 28 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.6,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 13,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 16976,
      "category": "team",
      "content": "After a reshared subfolder link has expired, the link allows access to the full folder.\n\nI found the Problem in Nextcloud 14.0.3, but it still persists in 14.0.4\nSteps:\n\n1.  share folder \"A\" with an nextcloud group\n2. reshare a subfolder \"B\" of this folder with another user on this group (in this case the user both have group admin) as public link.\n3. set an expiry date\n4. let date expire\n5. open link Expected result: You see a message that the link has expired Actual result: You have access to the initial shared folder \"A\"\n\nImpact\n\nAfter getting a reshared link for a subfolder with expiry date (legitimately or through social engineering) the attacker just has to wait for expiry for full access to all Files in the share.\n",
      "updated_at": "2019-06-27T10:36:42.498Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 86005,
        "username": "rullzer",
        "name": "Roeland Douma",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-06-18T18:45:19.816Z",
        "url": "https://hackerone.com/rullzer",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
