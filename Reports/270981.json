{
  "id": 270981,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzA5ODE=",
  "url": "https://hackerone.com/reports/270981",
  "title": "Shopify admin authentication bypass using partners.shopify.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2017-09-22T19:52:04.822Z",
  "submitted_at": "2017-09-22T19:52:04.822Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rockrzhackr9z",
    "url": "/rockrzhackr9z",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/159/651/a9ca1803eef9497887da813803308066bec4cc98_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-09-28T17:41:33.883Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2017-09-27T21:17:44.902Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 124,
    "name": "Improper Authorization"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 304,
  "voters": [
    "jokebookservice1",
    "0xnan",
    "jin",
    "jdgrimes",
    "h4x0r_eg",
    "zoom7",
    "orange303",
    "jr0ch17",
    "jensec",
    "drtrace",
    "and 294 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 10.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 422,
    "asset_type": "URL",
    "asset_identifier": "partners.shopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 5424,
      "category": "team",
      "content": "@uzsunny reported that by creating two partner accounts sharing the same business email, it was possible to be granted \"collaborator\" access to any store without any merchant interaction.\n\nWe tracked down the bug to incorrect logic in a piece of code that was meant to automatically convert an existing normal user account into a collaborator account. The intention was that, when a partner already had a valid user account on the store, their collaborator account request could be accepted automatically, with the user account converted into a collaborator account.\n\nThe code did not properly check what type the existing account was, and therefore an existing collaborator account in the \"pending\" state (not yet accepted by the store owner) would be converted into an active collaborator account, effectively allowing the partner to approve their own request without interaction from the store owner.\n\nWe fixed this issue by properly verifying that the exisiting account is in fact a user account.",
      "updated_at": "2017-09-25T20:41:27.587Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 19168,
        "username": "francoischagnon",
        "name": "Francois Chagnon",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2015-03-19T21:06:55.673Z",
        "url": "https://hackerone.com/francoischagnon",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NDQ3MSwicHVyIjoiYmxvYl9pZCJ9fQ==--5d363de94e2545bc9fc3f333250059f6ae61ed9f/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/2014-03-24.jpg"
        }
      }
    },
    {
      "id": 5455,
      "category": "researcher",
      "content": "\n##Impact:\n\nThis bug allowed me to login to any store with full permissions.\n\n\nFirst of all Thanks to shopify security Team for 20k bounty.\n\nThis bug was found on sep 23rd 2017 and within 1 hour the bug has been patched.\n\nThanks to shopify security Team for 20k bounty.\n\n\nThanks once again\n\n\n\n",
      "updated_at": "2019-08-30T01:59:33.642Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 159651,
        "username": "rockrzhackr9z",
        "name": "rockrzhackrz",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2017-04-14T19:01:50.272Z",
        "url": "https://hackerone.com/rockrzhackr9z",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/159/651/a9ca1803eef9497887da813803308066bec4cc98_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/159/651/a9ca1803eef9497887da813803308066bec4cc98_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjQ3MjMsInB1ciI6ImJsb2JfaWQifX0=--cfe1449ab56180ccc36c36c9c38223ef1584f34c/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/download.jpg"
        }
      }
    }
  ]
}
