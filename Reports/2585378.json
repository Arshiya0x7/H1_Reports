{
  "id": 2585378,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTg1Mzc4",
  "url": "https://hackerone.com/reports/2585378",
  "title": "important: Apache HTTP Server weakness in mod_rewrite when first segment of substitution matches filesystem path. (CVE-2024-38475)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2024-07-03T06:58:50.723Z",
  "submitted_at": "2024-07-03T07:09:25.062Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "orange",
    "url": "/orange",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/051/3495315121602d0de9c4f6728fef03bc3b41d3fe_original.jpeg/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5LKL5SDK%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T183639Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIC3x4ev%2F4d%2FXoFjmvmNATa4LygsbPYMXhkLh%2BC5KUmKMAiBlLQeGtJ2g077vt4H%2Bb6hn%2FUnvpUa5KRcTySOJrerz6Cq7BQjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMWOOb1ERhaEC%2FNRWhKo8F8A4C0xEsvKoNSWWMqhuN9TZKer61XB22tJa5ob9tcWI4N89uoyU3sM4X70gznMhVFE3e343jtqA%2FeZijXCass4vAmBXokvAxOpGEPI1x9kzSeKJTNtRV%2BSaUsaKEYMFEIewI%2Fp0SirupWwTqxG83NsPZIFyB54XHpnFDzrzPcn2QmaRS5jHF0wejvRzScHNIkvcCh88%2BCp%2B4NPWFXgI%2F4w9JvFhcrlyPMM%2F1geHjm9Z78XaOXJ6ymXeZGXtNu3IE2WnvMZZeM%2B38geGbS%2BdzXN6MI%2Fupq%2FuQfjyEZvluK%2BePY7FLMJSMuY5SEXW8FxgSs5zNPOqV4DMONV4WRS5GFUNfUK7LLf90jHDMqoub2WriKoFFH7RH3R0StdakThnPwvUE7qVHymkGR9E0JAhyliT1QNoT2fYiURStGjy78ZgoVLXFfgJ64p%2B9ccA%2FBPs97AmyPS5tBahDarwob7mrMlbrZN6zidCDV4kWjKp%2FGzKV06Nkv5rpKkl4TrHjn8fPrDzmjn8ZwEafdwYomyjJzOgHSPCYorcp6E%2FocA4UiysF0ihkmBClogEFRNe7LWAF5KwlMC7KqllFgmQvWawxTGiqByYcrOjYCHHnzsvXsQ5vOYxf8pIcRXUePUV1WZr%2B7itUxKjsklqCUalfqmacDVfVEm8U7%2F4by%2FTn1BNlcOxusvJ7naoSNCWhakRj4Nw8bX5KkQkL23ljNfWSN3Pffx9A86giNAb2jML1q6KDrsaCEyZrmEGxBOzmdnagomrAh34XBnYryF9FFq2dWkhHpMyWTUL6%2BoguR417j%2FgUpYT%2FRl2bvPhgn0z7bmAQiufI4u5LVfvOydhRjFb%2BG%2BfvzDjHng%2BjUscp%2BdIpef8caTD8h7vGBjqyAa%2FKd7ScxvKOpiqfpoBn9E3J0V8HRoWTbVzO3BEaAiKuurfs25EGQBYHXu6jetJXPUNWed6TatTq18Snkj5PFEFC9WShhYh8FYwyasGOag9PAdr2BluVRt2KpYiK9DQetN3%2FG4baCuLwX%2Fx4nyA2Z95oIVdPBvUzLV5n0uAcd5zaxkN19OFHVk1v41liyIcf%2B8piLq0%2FhRPVawTxseEu1rx6u85SM3W0smxA4qaJu9tqgek%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a721e8e5f80f9d761703f90d352a044556869139aa4e115cbf7b925bfa9bdce0",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5LKL5SDK%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T183639Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIC3x4ev%2F4d%2FXoFjmvmNATa4LygsbPYMXhkLh%2BC5KUmKMAiBlLQeGtJ2g077vt4H%2Bb6hn%2FUnvpUa5KRcTySOJrerz6Cq7BQjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMWOOb1ERhaEC%2FNRWhKo8F8A4C0xEsvKoNSWWMqhuN9TZKer61XB22tJa5ob9tcWI4N89uoyU3sM4X70gznMhVFE3e343jtqA%2FeZijXCass4vAmBXokvAxOpGEPI1x9kzSeKJTNtRV%2BSaUsaKEYMFEIewI%2Fp0SirupWwTqxG83NsPZIFyB54XHpnFDzrzPcn2QmaRS5jHF0wejvRzScHNIkvcCh88%2BCp%2B4NPWFXgI%2F4w9JvFhcrlyPMM%2F1geHjm9Z78XaOXJ6ymXeZGXtNu3IE2WnvMZZeM%2B38geGbS%2BdzXN6MI%2Fupq%2FuQfjyEZvluK%2BePY7FLMJSMuY5SEXW8FxgSs5zNPOqV4DMONV4WRS5GFUNfUK7LLf90jHDMqoub2WriKoFFH7RH3R0StdakThnPwvUE7qVHymkGR9E0JAhyliT1QNoT2fYiURStGjy78ZgoVLXFfgJ64p%2B9ccA%2FBPs97AmyPS5tBahDarwob7mrMlbrZN6zidCDV4kWjKp%2FGzKV06Nkv5rpKkl4TrHjn8fPrDzmjn8ZwEafdwYomyjJzOgHSPCYorcp6E%2FocA4UiysF0ihkmBClogEFRNe7LWAF5KwlMC7KqllFgmQvWawxTGiqByYcrOjYCHHnzsvXsQ5vOYxf8pIcRXUePUV1WZr%2B7itUxKjsklqCUalfqmacDVfVEm8U7%2F4by%2FTn1BNlcOxusvJ7naoSNCWhakRj4Nw8bX5KkQkL23ljNfWSN3Pffx9A86giNAb2jML1q6KDrsaCEyZrmEGxBOzmdnagomrAh34XBnYryF9FFq2dWkhHpMyWTUL6%2BoguR417j%2FgUpYT%2FRl2bvPhgn0z7bmAQiufI4u5LVfvOydhRjFb%2BG%2BfvzDjHng%2BjUscp%2BdIpef8caTD8h7vGBjqyAa%2FKd7ScxvKOpiqfpoBn9E3J0V8HRoWTbVzO3BEaAiKuurfs25EGQBYHXu6jetJXPUNWed6TatTq18Snkj5PFEFC9WShhYh8FYwyasGOag9PAdr2BluVRt2KpYiK9DQetN3%2FG4baCuLwX%2Fx4nyA2Z95oIVdPBvUzLV5n0uAcd5zaxkN19OFHVk1v41liyIcf%2B8piLq0%2FhRPVawTxseEu1rx6u85SM3W0smxA4qaJu9tqgek%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6802ee55be28e5ff8363bacbf61375a7108e3695c0e834e5e8394d72d67518b6"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2024-38475"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-07-13T14:36:29.962Z",
  "bug_reporter_agreed_on_going_public_at": "2024-07-13T14:36:29.843Z",
  "team_member_agreed_on_going_public_at": "2024-07-04T19:55:19.450Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I reported this vulnerability through the official Apache HTTP Server security email on April 1, 2024, and received a fix along with a CVE number on July 1, 2024. You can check detailed information from there:\n> https://httpd.apache.org/security/vulnerabilities_24.html\n\n## Impact\n\nImproper escaping of output in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows an attacker to map URLs to filesystem locations that are permitted to be served by the server but are not intentionally/directly reachable by any URL, resulting in code execution or source code disclosure.\n\nSubstitutions in server context that use a backreferences or variables as the first segment of the substitution are affected. Some unsafe RewiteRules will be broken by this change and the rewrite flag \"UnsafePrefixStat\" can be used to opt back in once ensuring the substitution is appropriately constrained.",
  "bounty_amount": "4920.0",
  "formatted_bounty": "$4,920",
  "weakness": {
    "id": 107,
    "name": "Improper Input Validation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-08-03T19:55:19.656Z",
  "allow_singular_disclosure_after": -35678479.948104344,
  "singular_disclosure_allowed": true,
  "vote_count": 30,
  "voters": [
    "muslimfrompk",
    "n1m0",
    "zy9ard3",
    "geekfreak",
    "orange",
    "never_die",
    "2026",
    "isira_adithya",
    "iwasday",
    "geeknik",
    "and 20 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 86382,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/apache/httpd",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 476748,
      "category": "team",
      "content": "###important: Apache HTTP Server weakness in mod_rewrite when first segment of substitution matches filesystem path. (CVE-2024-38475)\n\nImproper escaping of output in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows an attacker to map URLs to filesystem locations that are permitted to be served by the server but are not intentionally/directly reachable by any URL, resulting in code execution or source code disclosure.\n\nSubstitutions in server context that use a backreferences or variables as the first segment of the substitution are affected. Some unsafe RewiteRules will be broken by this change and the rewrite flag \"UnsafePrefixStat\" can be used to opt back in once ensuring the substitution is appropriately constrained.\n\nAcknowledgements: finder: Orange Tsai (@orange_8361) from DEVCORE\n\nReported to security team: 2024-04-01\nfixed by r1918561 in 2.4.x: 2024-07-01\nUpdate 2.4.60 released: 2024-07-01\nAffects: 2.4.0 through 2.4.59",
      "updated_at": "2024-07-04T19:54:50.490Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2032618,
        "username": "pr0tag0nist",
        "name": "p h",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2021-10-18T10:02:41.859Z",
        "url": "https://hackerone.com/pr0tag0nist",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
