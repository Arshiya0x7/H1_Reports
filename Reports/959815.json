{
  "id": 959815,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTk4MTU=",
  "url": "https://hackerone.com/reports/959815",
  "title": "Arbitrary Files and Folders Deletion vulnerability with Acronis Managed Machine Service",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-08-16T10:58:29.117Z",
  "submitted_at": "2020-08-16T10:58:29.136Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mmg",
    "url": "/mmg",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/222/119/30b5386d5cc0fd351927b57fa02a7cf7c81a7a2b_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13428,
    "url": "https://hackerone.com/acronis",
    "handle": "acronis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Acronis",
      "twitter_handle": "Acronis",
      "website": "https://www.acronis.com",
      "about": "Complete integrated cybersecurity and data protection for MSPs and IT teams"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-08-27T13:50:15.045Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2021-06-22T06:40:54.066Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Summary:\nUsing the latest version of Cyber Protection Agent (Version 12.5.23130) is possible to perform arbitrary Files and Folders Deletion as SYSTEM.\nThe only requirement is to have limited code execution privileged (as a member of the Authenticated users group) in order to abuse this vulnerability.\n\nDescription:\nUsing the latest version of Cyber Protection Agent is possible to perform Arbitrary Files and Folders Deletion as SYSTEM.\nThe only requirement is to have limited code execution privileged in order to abuse this vulnerability.\nThis can be achieved by creating specific mount points which can be linked to dedicated folders in order to create Denial of Service, reduce the security controls of the system (Applocker policies, removal of files associated to AV solutions) or create a condition that the attacker can abuse the gain higher privileges.\n\nSteps To Reproduce:\n1.Download the latest version for the Windows Agent\nURL: https://mc-beta-cloud.acronis.com/download/u/baas/4.0/12.5.23130/Cyber_Protection_Agent_for_Windows_web.exe\n\n2.As admin account we will create some folder structures, since we do not want to alter the current state of the OS.\n3.Run the following commands:\nmkdir C:\\Windows\\secret\\1\n\n4.Validate that indeed only high privileged accounts are allowed to perform actions, by checking the Security tab of this folder.\n\n5.In this folder copy files and folders of your choosing just to validate that indeed they get removed.\n\n6.As a low privileged account, download and compile the CreateMountPoint from https://github.com/googleprojectzero/symboliclink-testing-tools/tree/master/CreateMountPoint\n\n7.Create the initial folder and then the  mount point:\nmkdir C:\\Acronis\nCreateMountPoint.exe C:\\Acronis\\PostRebootResult\\ C:\\Windows\\secret\\1\\\n\n8.Start the Procmon, from Sysinternals, and monitor \"mms.exe\"\n\n9.Restart the Acronis Managed Machine Service.\n\n10.The mount points created in C:\\Acronis\\PostRebootResult\\ was removed and the content from c:\\windows\\secret\\1\\ folders as well.\n\n11.You could use the command dir /s c:\\Windows\\secret to list the content (before and after).\n\n## Impact\n\nThis issue could potentially allow an non-privileged local account, or process, to perform Arbitrary Files and Folders  Deletion as SYSTEM.\nThis can be achieved by creating a specific mount point which can be linked to dedicated folders in order to create :\n-Denial of Service\n-Data Corruption \n-Reduce the security controls of the system (Applocker policies, removal of files associated to AV solutions)\n-Create a condition that the attacker can abuse the gain higher privileges.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 13,
  "voters": [
    "zy9ard3",
    "shreyaschavhan",
    "ali",
    "thalaivar304",
    "mohaned0101",
    "ramamimu",
    "albertchambers",
    "root_panggang",
    "midha137",
    "mlgshyguy",
    "and 3 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 49696,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "Acronis Agent",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
