{
  "id": 792927,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTI5Mjc=",
  "url": "https://hackerone.com/reports/792927",
  "title": "Email address of any user can be queried on Report Invitation GraphQL type when username is known",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-02-11T05:53:53.346Z",
  "submitted_at": "2020-02-11T05:53:53.346Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "msdian7",
    "url": "/msdian7",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-02-20T16:58:04.631Z",
  "bug_reporter_agreed_on_going_public_at": "2020-02-20T16:58:04.569Z",
  "team_member_agreed_on_going_public_at": "2020-02-20T16:48:26.430Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nEmail  id  of all hackerone users disclosure\n\n**Description:**\nThere is an flaw , with that i can get all hackerone users email id \n\n### Steps To Reproduce\n\n1. Invoke the below graphql call\n\nPOST /graphql HTTP/1.1\n\n```{\"query\":\"mutation Revoke_credential_mutation($input_0:AddReportParticipantInput!) {addReportParticipant(input:$input_0) {clientMutationId,...F1}}  fragment F1 on AddReportParticipantPayload {clientMutationId,was_successful,errors{nodes{message}},invitation{email,token}}\",\"variables\":{\"input_0\":{\"report_id\":\"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjYzNzE=\",\"email\":\"██████████\",\"username\":\"jobert\"}}}```\n\nyou will get below response\n\n```\n{\"data\":{\"addReportParticipant\":{\"clientMutationId\":null,\"was_successful\":true,\"errors\":{\"nodes\":[]},\"invitation\":{\"email\":\"████\",\"token\":null}}}}\n```\n\n2.  to reproduce from your account, create one test program, and create one report for that program, get that report id \ngid://hackerone/Report/626371 (here 626371 my test program's report id)  convert it into base 64, replace that id with the \"report_id\" in the above graphql query \n3.   Done\n\n## Impact\n\nPII disclosed",
  "weakness": {
    "id": 124,
    "name": "Improper Authorization"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-03-21T16:48:26.928Z",
  "allow_singular_disclosure_after": -173648212.15796772,
  "singular_disclosure_allowed": true,
  "vote_count": 660,
  "voters": [
    "acut3",
    "whoareme",
    "160cm",
    "ceph1",
    "0xtarun",
    "ibruteforce",
    "orange303",
    "sgabe",
    "kurogai",
    "sebd",
    "and 650 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 20324,
      "category": "team",
      "content": "# Issue Summary\nThrough the HackerOne Bug Bounty Program on February 11, 2020 at 5:55 UTC, a HackerOne community member (“hacker”) notified HackerOne that they were able to determine a user’s email address by generating an invitation using only their username. The team patched the vulnerability at 08:30 UTC the same day.\n\nThe technical investigation finished at 8:40 UTC, concluding that there was no malicious intent or indicators of exploitation.\n\n# Timeline\n| Date Time (UTC) | Action |\n|---|---|\n|2020-02-10 15:13|Software containing vulnerability deployed to production.\n|2020-02-11 05:53|Vulnerability submitted to HackerOne’s bug bounty program.\n|2020-02-11 05:55|Incident Response (IR) team member on-call was paged about a critical severity report submitted to the HackerOne bug bounty program.|\n|2020-02-11 05:57|The on-call team member triaged the report and notified the full IR team.|\n|2020-02-11 06:04|A specialized IR team was assembled and began the investigation.|\n|2020-02-11 08:30|A vulnerability patch was deployed.|\n|2020-02-11 08:44|HackerOne’s IR team concluded technical investigation.|\n|2020-02-11 23:54|Two users were alerted that their information was exposed to the reporters who submitted the vulnerability.|\n\n# Root Cause\nHackerOne has an invitation system that allows program owners to send invitations to users for various purposes, such as invitations to hack on private programs, claim bounties, be added to programs, among others. The invitation system allows users to be invited by email or by username. If a user is invited by their username, the sender is not permitted to view the email address the invitation is sent to for user privacy. This rule has been guarded by HackerOne’s Access Control Lists (ACLs) in HackerOne’s Representational state transfer (REST) framework, but HackerOne has been migrating these objects to GraphQL under a new protection layer. When exposing a new invitation object, the ACL rule previously applied wasn’t implemented correctly to the new GraphQL protection layer.\n\n*How could this have been exploited to impact any user?*\nHackerOne provides demo programs for customers to experience the product as well as hackers to test against our production system. When you are a team member in a demo program, you can demo the report interface. In the report interface, you can invite an external participant to the report, which could be any user on the platform. By generating that invitation with a username and then viewing the invitation, the user’s email could have been exposed.\n\n# Resolution and Recovery\nAt 5:57 UTC, HackerOne successfully reproduced the vulnerability as described by the reporter. The IR team identified the change that introduced the vulnerability shortly after. A fix was deployed at 8:30 UTC, adding the necessary ACL into the GraphQL protection layer.\n\nThe IR team worked in parallel to identify the accounts impacted. It was determined shortly after the fix that there were no other usages except for those attempts by the reporter.\n\nThe maximum possible impact was assumed in determining the Common Vulnerability Scoring System (CVSS) score, which resulted in High (8.3). HackerOne decided to award a bonus of $1,000 due to the time to discover the vulnerability since the code was released, approximately 16 hours after the change was deployed.\n# Vulnerability Impact on Data\nThe reporter accessed the email addresses of two specific users to verify the findings, no other information could have been accessed with the discovered vulnerability.\n\n|Attribute| Description |\n|---|---|\n|email|The email address of the user invited|\n\n# Preventative Measures\nAs part of the HackerOne Incident Response process, HackerOne has conducted an internal review and analysis of the incident. HackerOne has taken the following actions to address the underlying cause of the issue and help prevent future occurrence.\n\n## Implement the proper ACL check within the invitation model\n\nThis change was the mitigating fix for resolving this vulnerability. It was deployed at 8:30UTC.\n\n## Identify sensitive database fields being added to GraphQL\n\nHackerOne maintains a list of sensitive database fields. The application security team is planning to leverage this list to have engineers acknowledge that they’ve, to their knowledge, properly implemented the authorization logic when they put up a code merge request. This change is expected to be implemented in Q1 2020.",
      "updated_at": "2020-02-20T00:16:13.655Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 13117,
        "username": "bencode",
        "name": "n s",
        "bio": "Full stack web developer working at Hackerone to make the internet safer.",
        "cleared": false,
        "verified": false,
        "website": "https://bwillis.github.io",
        "location": "San Francisco",
        "created_at": "2014-10-16T22:43:02.222Z",
        "url": "https://hackerone.com/bencode",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MzY0NCwicHVyIjoiYmxvYl9pZCJ9fQ==--a663c59a57daf9c44b294d475a740f4dc7556188/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/headshot.jpg"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
