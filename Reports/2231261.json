{
  "id": 2231261,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjMxMjYx",
  "url": "https://hackerone.com/reports/2231261",
  "title": "Elasticsearch is currently open without authentication on  https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-10-29T16:51:21.729Z",
  "submitted_at": "2023-10-29T16:51:21.847Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "roland_hack",
    "url": "/roland_hack",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/yfy7ddhs0wv2vcpmlq52fqedx6r7/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-12-21T17:30:51.917Z",
  "bug_reporter_agreed_on_going_public_at": "2023-12-15T13:12:30.107Z",
  "team_member_agreed_on_going_public_at": "2023-12-21T17:30:51.771Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\n\nThe vulnerability lies in insecure access to an Elasticsearch instance accessible at the URL \"https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl\". Currently, access to Elasticsearch is open without the need for authentication, exposing data stored on this instance to the risk of unauthorized disclosure.\n\n\n## References\n\nhttps://www.acunetix.com/vulnerabilities/web/elasticsearch-service-accessible/\nhttps://medium.com/@D0rkerDevil/3k-bounty-for-elastic-search-takeover-70c0847d2e40\nhttps://infosecwriteups.com/haystack-hackthebox-writeup-7dfd8a6fed5\nhttps://book.hacktricks.xyz/network-services-pentesting/9200-pentesting-elasticsearch\n\n## Impact\n\nInsecure access to Elasticsearch on the https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl  site has serious security implications. The consequences of this vulnerability include\nSensitive Data Leakage: Sensitive data stored in Elasticsearch, including confidential information, personal data and other sensitive information, may be exposed and compromised.\nRisk of Data Modification or Deletion: Unauthorized access may enable malicious actors to modify or delete data, disrupting the integrity of stored information.\nPrivacy Violation: The vulnerability may lead to violations of the privacy of users whose data is stored on the Elasticsearch instance, which may have legal consequences.\nService disruption: Attackers can disrupt services by accessing Elasticsearch without authorization, which can lead to service interruptions and performance degradations.\nUnknown security risks: Unauthorized access can expose the system to unknown security risks, including potential attacks or malicious activity.\nIt is essential to take immediate action to correct this vulnerability and reduce these potential risks. The security of the Elasticsearch instance must be strengthened to protect data and guarantee confidentiality.\n\n## System Host(s)\nâ–ˆâ–ˆâ–ˆâ–ˆl\n\n## Affected Product(s) and Version(s)\nElasticsearch 2.7.0\n\n## CVE Numbers\n\n\n## Steps to Reproduce\nTo reproduce the Elasticsearch insecure access vulnerability on the \"https://â–ˆâ–ˆâ–ˆl\" instance, follow these steps:\nOpen a web browser and access the URL \"https://â–ˆâ–ˆâ–ˆl\".\nUse a tool such as \"estk\" to list the Elasticsearch indexes available on the site by executing the command estk --url=https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl list.\nYou can also use : https://github.com/elasticsearch-dump/elasticsearch-dump\n\n- Output \n\nestk --url=https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆl list\n\n2023/10/29 17:24:51 Detecting version...\n2023/10/29 17 :24:51 Trying elasticsearch\n2023/10/29  17:24:53 Found elasticsearch, major version 2\nIndices: 3, document count: 2212, size: 5.9 MB\nFound index aim_high with 2211 documents (5.9 MB)\nFound index .opensearch-observability with 0 documents (208 B)\nFound index .kibana_1 with 1 documents (5.3 kB)\n\nTo extract data from a specific index (for example, the \"aim_high\" index), run the command\nestk dump --url=https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl --index=aim_high.\nThe index data will be displayed in JSON format on standard output, confirming insecure access.\nThese steps describe how a potential attacker could access Elasticsearch data without the need for authentication, thus exposing the vulnerability.\n\n## Suggested Mitigation/Remediation Actions\nThe \"Suggested Mitigation/Remediation Actions\" section of a vulnerability report offers recommendations for remediating the vulnerability or mitigating its effects. Here's how you can formulate it for the Elasticsearch insecure access vulnerability:\nSuggested Mitigation/Remediation Actions:\nTo remediate the Elasticsearch insecure access vulnerability on the \"https://â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl\" instance, the following actions are recommended:\nSet up authentication: Configure Elasticsearch to require authentication before granting access to data. Use robust authentication methods, such as SSL certificates, usernames and passwords.\nSet up authorization: Define appropriate authorization policies to limit access to data according to user roles and privileges. Ensure that only authorized persons have access to sensitive data.\nUpdates and patches: Make sure your Elasticsearch instance is up to date with the latest security patches. Perform regular updates to correct known vulnerabilities.\n\n",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 14,
  "voters": [
    "k0ns0l",
    "roland_hack",
    "shreyaschavhan",
    "shubham_srt",
    "spaghettisec",
    "laushee_connect",
    "pr0f0x01",
    "amr4l44",
    "yae-htet-paing1234567890",
    "rusalka",
    "and 4 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 385462,
      "category": "researcher",
      "content": "\nHello everyone ðŸ‘‹\n\nTwitter: https://twitter.com/RolandHack6\nMedium : https://rolandhack6.medium.com\n\nI discovered a major vulnerability in the Elasticsearch instance running on port 9200, hosted at \"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆl\". This flaw allowed unrestricted access to data available on the index without any form of authentication. Using estk or elasticdump, I demonstrated the extent of the vulnerability by extracting files from the index.\n\nUpon my prompt notification to the Department of Defense, immediate corrective measures were taken to secure the Elasticsearch instance, thus averting any risk of compromising the stored data.\n\n\n",
      "updated_at": "2023-12-21T17:20:51.373Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2442387,
        "username": "roland_hack",
        "name": "ADANDE Tobi  Roland",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": "https://rolandhack.github.io",
        "location": "",
        "created_at": "2022-08-24T11:44:49.291Z",
        "url": "https://hackerone.com/roland_hack",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/yfy7ddhs0wv2vcpmlq52fqedx6r7/c8a1698ff707a5e3e8a91a3484838363845daac68cb82c86d55c9e2d44d67b67",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/yfy7ddhs0wv2vcpmlq52fqedx6r7/74790fe75ac5dbe8a5140a122388d59ebac913dcfa941f0b3a45e6cad161f9ea",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/yfy7ddhs0wv2vcpmlq52fqedx6r7/fba683f28d17594d98b39d87e2b3aa09acb938c22d49b206f663ae961dc39adc"
        }
      }
    }
  ]
}
