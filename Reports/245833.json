{
  "id": 245833,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDU4MzM=",
  "url": "https://hackerone.com/reports/245833",
  "title": "The user, who was deleted from Github Organization, still can access all functions of federalist, in case he didn't do logout",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-07-04T13:48:23.900Z",
  "submitted_at": "2017-07-04T13:48:23.900Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sp1d3rs",
    "url": "/sp1d3rs",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 50592,
    "url": "https://hackerone.com/gsa_bbp",
    "handle": "gsa_bbp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "GSA Bounty",
      "twitter_handle": null,
      "website": "http://gsa.gov",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-09-05T19:48:53.548Z",
  "bug_reporter_agreed_on_going_public_at": "2017-09-04T18:04:02.976Z",
  "team_member_agreed_on_going_public_at": "2017-09-05T19:48:53.464Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "##Description\nHi. I found a non-critical session management bug, which still can have serious impact in some scenarios.\nWhen user perform login to the Federalist through Github, federalist checks his Organization ID (but only upon login).\nWhen the user was deleted from organization for some reasons, but he was logged in the Federalist (or saved his session cookies), he can still do any action on behalf of organization (create sites, delete sites etc).\n\n##Reproduction Steps & POC\n1) Add a test user to your organization, which have access to the federalist.\n2) Login to the Federalist.\n3) Remove the user from organization, or leave organization\n4) Try to create or delete the site. Federalist doesn't know that this user has no permissions, and will allow him to use functions.\n\n##Suggested fix\nYou should implement Organization ID checking in the requests.\nUpon login, the endpoint `/v0/me` is called (once). But it can be a good idea to call it in a random periods of time and check the organization ID, and in case it will return 403 - invalidate user session.\n",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 16,
  "voters": [
    "bl4de",
    "spam404",
    "its_afolic",
    "cuso4",
    "edoverflow",
    "r3y",
    "eveeez",
    "mikassa53",
    "mr_r3boot",
    "japz",
    "and 6 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 81507,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/18f/federalist",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 5269,
      "category": "researcher",
      "content": "*Thanks to the 18F team for the great experience, fast fix and the bounty!*\n\nThis report describes authentication issue, when the user, whose privileges was removed, still could access control panel instruments.\nIssue was fixed by implementing periodic user permissions checks.\n\n##References\n[Running Federalist locally](https://federalist-docs.18f.gov/pages/how-federalist-works/running-federalist-locally/ \"Running Federalist locally\")",
      "updated_at": "2017-09-05T19:52:27.624Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 79690,
        "username": "sp1d3rs",
        "name": "Eugene Yakovchuk",
        "bio": "The world tried to catch me, but it couldn't.",
        "cleared": true,
        "verified": true,
        "website": "https://r1p.xyz",
        "location": "Canada",
        "created_at": "2016-05-23T03:07:23.595Z",
        "url": "https://hackerone.com/sp1d3rs",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTM0NzcsInB1ciI6ImJsb2JfaWQifX0=--c8bb3853d9462d00bf85e988a9d33579e71c0b82/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/z.png"
        }
      }
    }
  ]
}
