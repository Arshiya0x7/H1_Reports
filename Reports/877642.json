{
  "id": 877642,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Nzc2NDI=",
  "url": "https://hackerone.com/reports/877642",
  "title": "GraphQL field on Team node can be used to determine if External Program runs invite-only program",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-05-19T01:47:50.358Z",
  "submitted_at": "2020-05-19T01:47:50.358Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kunal94",
    "url": "/kunal94",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vre0eel6yrdokxj27op0h2wo375f/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-07-25T01:13:57.395Z",
  "bug_reporter_agreed_on_going_public_at": "2020-07-25T01:13:57.136Z",
  "team_member_agreed_on_going_public_at": "2020-07-24T20:30:47.961Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "2500.0",
  "formatted_bounty": "$2,500",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-08-23T20:30:48.172Z",
  "allow_singular_disclosure_after": -160233052.94321796,
  "singular_disclosure_allowed": true,
  "vote_count": 104,
  "voters": [
    "loaymorad",
    "omarelfarsaoui",
    "mattberg",
    "rook1337",
    "ali",
    "tess",
    "holme",
    "th4nu_0x0",
    "mik317",
    "sudi",
    "and 94 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 23785,
      "category": "team",
      "content": "# ",
      "updated_at": "2020-07-24T20:30:29.821Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2,
        "username": "jobert",
        "name": "Jobert",
        "bio": "Co-founder of HackerOne. ಠ_ಠ",
        "cleared": true,
        "verified": true,
        "website": "https://hackerone.com",
        "location": "San Francisco, CA",
        "created_at": "2013-03-08T01:17:12.256Z",
        "url": "https://hackerone.com/jobert",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6NzI5MDk3LCJwdXIiOiJibG9iX2lkIn19--ab8b579d168a5d5d0a77a59fab8b5912d9b9847d/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--c155082ce6f9751dcb29cd6ea061a7e4d7329577/cf1e4b5d44005cb61fab358dd6968415f20545de5f055ba4ed33ca4387948cdc.png"
        }
      }
    },
    {
      "id": 23376,
      "category": "researcher",
      "content": "On 19th May, A new parameter `policy_markdown_html` been introduced inside the team Graphql query.\nUsing Graphql query, We can able to determine External program running privately on Hackerone as `policy_markdown_html` parameter was able to fetch private internal policy.\n\n[Note: Using this parameter, it was also possible to determine any left private program's policy]\n\n**GRAPHQL TEAM QUERY**\n\n**Request**\n\n``` \nquery{\n  team(handle:\"example\")   //handle - Program running externally or left private program's handle\n  {\n    name\n    policy_markdown_html\n  }\n}\n```\n\n**Response**\n```json\n{\n  \"data\": {\n    \"team\": {\n      \"name\": \"example test\",\n      \"policy_markdown_html\": \"No Technology is perfect and example believes that working with skilled security researchers............\"\n    }\n  }\n}\n```\n\nThere were 3 different conditions which I explained in this report:-\n\n+ Condition 1 - When an external program doesn't have any policy defined, `policy_markdown_html` will be `null`.\n\n+ Condition 2- When an external program has defined policy but not running a private program internally, `policy_markdown_html` will fetch the same policy on the mentioned front-end page.\n\n+ Condition 3- When an external program has defined policy but running privately, `policy_markdown_html` will fetch internal policy and different from public policy.\n\n\nOn 26th June, patchwork was completed and the report was successfully resolved after doing retest.\n\nI would like to thank Hackerone Team for resolving this issue. :)\n\n\n",
      "updated_at": "2020-07-07T04:31:33.300Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 228834,
        "username": "kunal94",
        "name": "Kunal Pandey",
        "bio": "Curious guy wants to know secret endpoints.",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2018-01-01T18:21:55.407Z",
        "url": "https://hackerone.com/kunal94",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/vre0eel6yrdokxj27op0h2wo375f/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/vre0eel6yrdokxj27op0h2wo375f/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/vre0eel6yrdokxj27op0h2wo375f/4ac84fbe897190579a137d0cf55152b233cdd4f9984435bd80ef67e5e51a0586"
        }
      }
    }
  ]
}
