{
  "id": 1076047,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDc2MDQ3",
  "url": "https://hackerone.com/reports/1076047",
  "title": "Bypass of #1047119: Missing Rate Limit while creating Plug-Ins at https://my.stripo.email/cabinet/plugins/",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-01-11T11:21:24.093Z",
  "submitted_at": "2021-01-11T11:21:24.147Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "savxiety",
    "url": "/savxiety",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 42368,
    "url": "https://hackerone.com/stripo",
    "handle": "stripo",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Stripo Inc",
      "twitter_handle": "",
      "website": "https://stripo.email",
      "about": "Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-01-13T15:47:33.414Z",
  "bug_reporter_agreed_on_going_public_at": "2021-01-11T12:10:31.473Z",
  "team_member_agreed_on_going_public_at": "2021-01-13T15:47:33.317Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n I have found a bypass for the report https://hackerone.com/reports/1047119\nIt seems that a proper fix was not issued therefore the issue still remains.\n\n## Steps To Reproduce:\n\n  1. Create a Plug-In and capture the request.\n  1. Send this to Intruder\n  1. Follow the rest in the Video POC.\n\n\n## POC\n**Video POC**\nIn this section, I have shown clear and concise steps to reproduce the vulnerability.\n{F1152962}\nFrom the above video POC, as you could see, I was able to send 100 requests to create plug-ins at a very fast speed occupying disk space and costing the company.\n**Request To Send**\n\n```python\nPOST /cabinet/stripeapi/v1/plugin/357981/plugins HTTP/1.1\nHost: my.stripo.email\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-cache\nPragma: no-cache\nExpires: Sat, 01 Jan 2000 00:00:00 GMT\nX-XSRF-TOKEN: 867d2a4a-9d3f-407e-9527-83cf47c3d8cc\nContent-Length: 108\nOrigin: https://my.stripo.email\nConnection: close\nReferer: https://my.stripo.email/cabinet/\nCookie: _ga=GA1.2.820184997.1610358469; _gid=GA1.2.285492738.1610361098; _pin_unauth=dWlkPVptSmlOR1EyTWpjdFlURmpNUzAwWmpCakxXRXlOR0V0TWpWbVltSm1NVGcwWW1ZeQ; amplitude_id_246810a6e954a53a140e3232aac8f1a9stripo.email=eyJkZXZpY2VJZCI6ImJmOGY2ZTlmLWZlOWMtNDY2Mi1hOTg3LTI2NWFmNGYyZGQ1YVIiLCJ1c2VySWQiOm51bGwsIm9wdE91dCI6ZmFsc2UsInNlc3Npb25JZCI6MTYxMDM2MTExMDM2NCwibGFzdEV2ZW50VGltZSI6MTYxMDM2MTEyMTAxOSwiZXZlbnRJZCI6MCwiaWRlbnRpZnlJZCI6MCwic2VxdWVuY2VOdW1iZXIiOjB9; _fbp=fb.1.1610361110716.1635574013; _pin_unauth=dWlkPVptSmlOR1EyTWpjdFlURmpNUzAwWmpCakxXRXlOR0V0TWpWbVltSm1NVGcwWW1ZeQ; G_ENABLED_IDPS=google; __stripe_mid=d3200dd8-4e6b-45be-9da3-54783b95e87c96fb16; __stripe_sid=2d31cbbe-d4e2-4904-bc96-28f4fa8313c8ff08c1; token=eyJhbGciOiJSUzUxMiJ9.eyJhdXRoX3Rva2VuIjoie1widXNlckluZm9cIjp7XCJpZFwiOjM1ODI3OSxcImVtYWlsXCI6XCJzYXZpcnN1ZGFAZ21haWwuY29tXCIsXCJsb2NhbGVLZXlcIjpcImVuXCIsXCJmaXJzdE5hbWVcIjpcInNhdmlyXCIsXCJsYXN0TmFtZVwiOm51bGwsXCJmYWNlYm9va0lkXCI6bnVsbCxcIm5hbWVcIjpudWxsLFwicGhvbmVzXCI6W10sXCJhY3RpdmVcIjp0cnVlLFwiZ3VpZFwiOm51bGwsXCJhY3RpdmVQcm9qZWN0SWRcIjozNjMzMTgsXCJzdXBlclVzZXJWMlwiOmZhbHNlLFwiZ2FJZFwiOlwiZTk3NDJlNDAtNDhkYy00ZTE3LWFlNzItMWExY2M4ZmQ1Y2QyXCIsXCJvcmdhbml6YXRpb25JZFwiOjM1Nzk4MSxcIm93bmVkUHJvamVjdHNcIjpbMzYzMzE4XSxcImZ1bGxOYW1lXCI6XCJzYXZpciBudWxsXCJ9LFwiaXNzdWVkQXRcIjoxNjEwMzYxMTQwNzU1LFwiYXBpS2V5XCI6bnVsbCxcInByb2plY3RJZFwiOm51bGwsXCJ4c3JmVG9rZW5cIjpcIjg2N2QyYTRhLTlkM2YtNDA3ZS05NTI3LTgzY2Y0N2MzZDhjY1wiLFwicm9sZVwiOlwiQ0FCSU5FVF9VU0VSXCIsXCJhdXRob3JpdGllc1wiOltdfSIsImV4cCI6MTYxMDQ0NzU0MH0.Uf9QUHgo9TYJte2-hFDDFDcW80OVpmHXZMUf2thntSYYthCA07Fu94XVs7RFRiZMOTnjqyLhJK3p7CwAf61xNAD8WbTtoAlIcia82nNYQ4ueIItzExfQJWQHXD8GSIBRBp-VCbXBOJaXt5KQntnPCCwzvpmrE_LTKwX9MkxkmKkLmU3oCxxfpd8MKo3s-bTvNJsnT91_K3eJwdMGl78KjI3Jnk5JQe3fj4NFHk7P-snsGInO8jlY9ikY6ndInrEZ23WLfNu1Qh86DC2aLVdaTnSJg6F_w5jtFxIKpdtoRTDEpSJbEdyu3UMoOJZl8MPtx8WaMMJA-iuyqD2BUGGL89ULjkCCVb2BSCHx5HzAO8pWPvFUZNRami5sLvuBbfjr_sNKYTVXb9XY_Z4cuPNQ1AGjAMeotmsn0qlv41u-BWQnLjRV7YGVhP3SeboK79MnG0YCRCwmytt8UBqbcA8VEGOKmWxGMbIAYYC7OKApOHwtr419UtGvva261ObGfXlKsENyap0PrszXRPYpB_Oi9U_AR9ZrB100QrNNVJywsTTaD7Mi6q0B22958NnmHvn5QzjYiZmULxngLyM7s2pAMxGDQ8OOFE6JV7bpsFrOCRpLdNsK3EENNc5jsRAxUsYWUjZAHzgueW789g9QGmjq-wFL77dlR_aUNrCVbhh87pc; _ga=GA1.3.820184997.1610358469; _gid=GA1.3.285492738.1610361098; JSESSIONID=5269D92EB21DAB4CF3F411313361E107; intercom-session-b1m243ec=OXJKNnkvYnA4aUhMUE9TakVEVlBzT3BKS3JVYW0vNEZJQlR0ZCtIdVU2K3NHa29QcGswb2RtQmFyUDBYdWlQZS0tRmJFalMwdkI2VUJnZHpHZUFRdUkzZz09--295709016df61f9c47f9ff869f4f1b26a8169ae2\n\n{\"email\":\"<YOUR-EMAIL>\",\"name\":\"test\",\"webUrl\":\"pxqx0kafueopargwjcp9bmtiv91zpo.burpcollaborator.net\"}\n```\n\n##Description\nI also noticed that If I choose 100 threads instead of 50, after a few requests with `200 OK` responses, I got a `503 Service Temporarily Unavailable`. You may want to investigate this as well. I also wanted to add that after about 20-30 seconds, I was able to send the same amount of requests again which would charge the application by creating Plug-Ins massively.\n\n\n## Supporting Material/References:\n{F1152961}\n\n## Impact\n\n- Bypass of #1047119\n- An attacker can create a lot of Plug-Ins which would occupy memory and charge the application.\n\n## Mitigation\nAs a hacker who is on the good side, I wanted to suggest some mitigations which would help protect against this issue and would prevent any further bypasses :)\n\n- Add a Google Recaptcha Verification here when a user requests to create more than 1 plugin in a small period of time.\n- Allow only 10 Plug-Ins per day, per user. \n- Add Rate limiting\n\n~Thanks :)\n@savxiety",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 18,
  "voters": [
    "ezzra",
    "todayisnew-",
    "bibekshah",
    "shubham_srt",
    "ayoub0x1",
    "thalaivar304",
    "mohaned0101",
    "savxiety",
    "mrsinister15",
    "nasirshaikh7",
    "and 8 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 38702,
    "asset_type": "URL",
    "asset_identifier": "my.stripo.email",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 26323,
      "category": "researcher",
      "content": "I had found a way to bypass the rate limit protection that was applied to #1047119 by adding some null bytes and making use of Burp Intruder. The Team was very quick to launch a fix for this bug and kudos to them for that!\n\nRead the full report below.",
      "updated_at": "2021-01-20T16:07:28.322Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1328803,
        "username": "savxiety",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2020-09-20T06:11:16.108Z",
        "url": "https://hackerone.com/savxiety",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    }
  ]
}
