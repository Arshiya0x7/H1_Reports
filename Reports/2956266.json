{
  "id": 2956266,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTU2MjY2",
  "url": "https://hackerone.com/reports/2956266",
  "title": "Stored XSS via SMTP Error Message",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2025-01-24T05:29:04.568Z",
  "submitted_at": "2025-01-24T05:29:04.765Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "chse_",
    "url": "/chse_",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3sjousvyuzgyrdbzbnr8bqsnnd94/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 50470,
    "url": "https://hackerone.com/xvideos",
    "handle": "xvideos",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/rw4sjbp7ak3bj5mifHtirndu/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/rw4sjbp7ak3bj5mifHtirndu/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "XVIDEOS",
      "twitter_handle": "",
      "website": "https://www.xvideos.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-01-24T12:06:24.279Z",
  "bug_reporter_agreed_on_going_public_at": "2025-01-24T12:06:24.134Z",
  "team_member_agreed_on_going_public_at": "2025-01-24T11:37:39.367Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "250.0",
  "formatted_bounty": "$250",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 81,
  "voters": [
    "0xtarun",
    "cabr4",
    "loaymorad",
    "ganeshbagaria",
    "drsniper",
    "almuntadhar",
    "pentestor",
    "zy9ard3",
    "alejandroar",
    "cabelo",
    "and 71 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 54938,
    "asset_type": "URL",
    "asset_identifier": "www.xvideos.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 624277,
      "category": "team",
      "content": "\n## Summary\n\nA Stored Cross-Site Scripting (XSS) vulnerability is identified on the `/account/email` page for www.xvideos.com. The vulnerability arises from the improper handling of SMTP error messages. These error messages are passed into the `html()` method without proper sanitization, allowing an attacker to store and execute arbitrary JavaScript code on the affected page. The vulnerability is classified as CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').\n\n## Steps to Reproduce\n\n1. Configure a Postfix 3.7.11 SMTP server with the following settings:\n   - Add to `/etc/postfix/main.cf`:\n     ```\n     smtpd_recipient_restrictions =\n         check_recipient_access hash:/etc/postfix/recipient_access,\n         reject_unverified_recipient,\n         permit\n     ```\n   - Create `/etc/postfix/recipient_access` with:\n     ```\n     invalid@example.org REJECT 5.1.1 <img src=\"\" onerror=\"alert('hackerone!')\" />\n     ```\n   - Update Postfix database: `postmap /etc/postfix/recipient_access`\n   - Restart Postfix: `systemctl restart postfix`\n\n2. Navigate to www.xvideos.com using an up-to-date browser.\n3. Click on the \"Join for FREE\" button.\n4. Create an account using the configured email address (e.g., invalid@example.org).\n5. Once the account is created, go to the `/account/email` route.\n6. Click on \"Please click **Here** to validate it.\"\n7. Wait approximately 45 minutes.\n\nIf successful, an alert message saying \"hackerone!\" should appear on the screen.\n\n## Impact\n\nThe vulnerability allows an attacker running an SMTP server to inject their own JavaScript payloads targeting users of the affected sites. Users who misspell their email domain could also be affected if an attacker controls the mistyped domain. If staff members can view a user's bounce history in the same way as on the `/account/email` page, they may be subjected to an account takeover. These scenarios can result in the leak of sensitive information.\n\nThe severity of this vulnerability is rated as low by the organization.\n\n\n\n\n\n\n\n",
      "updated_at": "2025-01-24T09:42:30.563Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 1322961,
        "username": "xvtech",
        "name": "XVTech",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-09-15T10:11:15.591Z",
        "url": "https://hackerone.com/xvtech",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
