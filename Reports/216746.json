{
  "id": 216746,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTY3NDY=",
  "url": "https://hackerone.com/reports/216746",
  "title": "Phabricator is vulnerable to padding oracle attacks and chosen-ciphertext attacks.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-03-28T17:31:13.989Z",
  "submitted_at": "2017-03-28T17:31:13.989Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "edoverflow",
    "url": "/edoverflow",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 18,
    "url": "https://hackerone.com/phabricator",
    "handle": "phabricator",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Phabricator",
      "twitter_handle": "phabricator",
      "website": "http://phacility.com/phabricator/",
      "about": "Phabricator is a collection of open source web applications that help software companies build better software."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-04-05T20:16:10.747Z",
  "bug_reporter_agreed_on_going_public_at": "2017-04-05T20:16:10.702Z",
  "team_member_agreed_on_going_public_at": "2017-04-05T19:19:38.248Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Dear Phabricator bug bounty team,\n\n# Summary\n---\n\nPhabricator encrypts data with AES in CBC mode, but does not ensure integrity of the encrypted data. You must authenticate the data, by either using an HMAC or by using an authenticated block cipher mode like GCM.\n\n# Why does this vulnerability exist?\n---\n\n`src/applications/files/format/PhabricatorFileAES256StorageFormat.php` encrypts the data as follows without checking the integrity of the message:\n\n~~~\nprivate function encryptData(\n    $data,\n    PhutilOpaqueEnvelope $key,\n    PhutilOpaqueEnvelope $iv) {\n    $method = 'aes-256-cbc';\n    $key = $key->openEnvelope();\n    $iv = $iv->openEnvelope();\n    $result = openssl_encrypt($data, $method, $key, OPENSSL_RAW_DATA, $iv);\n    if ($result === false) {\n      throw new Exception(\n        pht(\n          'Failed to openssl_encrypt() data: %s',\n          openssl_error_string()));\n    }\n    return $result;\n}\n~~~\n\nLink to source code: https://github.com/phacility/phabricator/blob/master/src/applications/files/format/PhabricatorFileAES256StorageFormat.php\n\n# How can this be exploited?\n---\n\nBy not ensuring integrity Phabricator is vulnerable to padding oracle attacks and chosen-ciphertext attacks.\n\n# How can this be fixed?\n---\n\nAs stated previously, you must check the integrity of the data, by either using an HMAC or by using an authenticated block cipher mode like GCM.\n\nBest regards,\nEd",
  "bounty_amount": "750.0",
  "formatted_bounty": "$750",
  "weakness": {
    "id": 39,
    "name": "Missing Required Cryptographic Step"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-05-05T19:19:38.300Z",
  "allow_singular_disclosure_after": -264483898.4271095,
  "singular_disclosure_allowed": true,
  "vote_count": 22,
  "voters": [
    "sp1d3rs",
    "tomdev",
    "ramsexy",
    "kapytein",
    "michiel",
    "adn",
    "spam404",
    "akashhamal0x01",
    "apox",
    "glc",
    "and 12 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
