{
  "id": 867521,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njc1MjE=",
  "url": "https://hackerone.com/reports/867521",
  "title": "CreatorID leaked from public content posted to SnapMaps",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-05-07T01:08:21.725Z",
  "submitted_at": "2020-05-07T01:08:21.725Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "drrichardmatthews",
    "url": "/drrichardmatthews",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/L1ENa3c5GUYEw3rW6cXFh8MN/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 513,
    "url": "https://hackerone.com/snapchat",
    "handle": "snapchat",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Snapchat",
      "twitter_handle": "",
      "website": "https://www.snapchat.com/",
      "about": ""
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-12-18T22:48:04.821Z",
  "bug_reporter_agreed_on_going_public_at": "2020-06-19T23:19:17.231Z",
  "team_member_agreed_on_going_public_at": "2020-12-18T22:48:04.696Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 47,
  "voters": [
    "loaymorad",
    "bombon",
    "mattberg",
    "shreyaschavhan",
    "rook1337",
    "ali",
    "bibekshah",
    "h4x0r_dz",
    "kassem_s94",
    "b4zb0z",
    "and 37 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 11828,
    "asset_type": "URL",
    "asset_identifier": "app.snapchat.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 25934,
      "category": "team",
      "content": "TL;DR - the Snap Map media responses unnecessarily return a creatorId. The creator's Snap username cannot be immediately derived from creatorId, but users can use the creatorId to correlate multiple public snaps with that creator. The impact is limited by the fact that all Our Story Snaps that appear on the map go through manual curation, ensuring that most selfie Snaps are filtered out.\n\nSnap Map, located at https://map.snapchat.com, allows users to search for curated public Snaps posted to \"Our Story\", by users at a chosen location. When a user navigates to a point on the map, they can click on any location, and a Snap that was posted by a user in the vicinity of that location will play. In the background several URLs at https://ms.sc-jpl.compopulate the data needed to play Snaps.\n\nOne of the requests is made to https://ms.sc-jpl.com/web/getPlaylist, which responds with a JSON object. This JSON contains information pertaining to each Snap in the playlist, such as the duration, and snapInfo. Examples of data in snapInfo are the creatorId, and the mediaUrl, which are a UUID pertaining to the user who uploaded the content, and an app.snapchat.com URL, which contains the content.\n\nOf the returned fields, the creatorId is not necessary for normal Snap Map operation and does not need to be disclosed. Note that while the user identity cannot be directly gleaned from the creatorId, the disclosure of creatorId in the response from https://ms.sc-jpl.com/web/getPlaylist may allow a user to correlate Snaps on the Snap Map with a single user. This in turn, may allow a user to potentially enumerate that user's public content, by searching for content containing that specific creatorId.\n\nWhile not a direct leak of user information, the inclusion of the creatorId in the response was unintentional and unnecessary. At Snap, we value privacy highly and thank the reporter for bringing this to our attention.",
      "updated_at": "2020-12-18T22:47:49.125Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 274079,
        "username": "michael_xu",
        "name": "Michael Xu",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2018-05-08T21:46:08.952Z",
        "url": "https://hackerone.com/michael_xu",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "id": 23432,
      "category": "researcher",
      "content": "When map.snapchat.com uses certain POST methods a 200 response is returned which includes an entity that describes a URI \"CreatorID\". This URI is no longer needed for the functions on map.snapchat.com to function and can be used to deanonymize users.  This was resolved by removing the URI in the 200 response to protect privacy.",
      "updated_at": "2020-07-09T03:40:51.447Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 983576,
        "username": "drrichardmatthews",
        "name": "Dr Richard Matthews",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://rhematt.github.io/",
        "location": "Adelaide, Australia",
        "created_at": "2020-03-11T21:33:34.599Z",
        "url": "https://hackerone.com/drrichardmatthews",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/L1ENa3c5GUYEw3rW6cXFh8MN/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/L1ENa3c5GUYEw3rW6cXFh8MN/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a",
          "xtralarge": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6OTM0NTA2LCJwdXIiOiJibG9iX2lkIn19--a190f5c19a38ed3d15c463aead2840ea5afb3e2e/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJyZXNpemUiOiIyNjB4MjYwXHUwMDNlIn0sInB1ciI6InZhcmlhdGlvbiJ9fQ==--cf3aeca803d1baf476958c689ca7b472a4cb54f1/IaOcpKya_400x400.jpg"
        }
      }
    }
  ]
}
