{
  "id": 3072841,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDcyODQx",
  "url": "https://hackerone.com/reports/3072841",
  "title": "Amazon Pinpoint SMS and Voice, version 2  Service Reporting \"AWS Internal\" for CloudTrail Events Generated from FIPS Endpoints",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2025-04-02T02:45:33.715Z",
  "submitted_at": "2025-04-02T02:45:36.533Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nick_frichette_dd",
    "url": "/nick_frichette_dd",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fpqmd7ye58uoda4zbq2jlq7zeltv/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 84809,
    "url": "https://hackerone.com/aws_vdp",
    "handle": "aws_vdp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fgfqam8gl7lzo8u8v0kiphkxfyt8/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fgfqam8gl7lzo8u8v0kiphkxfyt8/d9695107bfcd68eeb1c9e0912b109cdae9a6c00c0bda6fd4cbd6d9bdb828840a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "AWS VDP",
      "twitter_handle": "amazon",
      "website": "https://aws.amazon.com/",
      "about": "Amazon Web Services (AWS) is a secure cloud services platform, offering compute power and other functionality to help businesses scale and grow. "
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-05-28T00:30:25.842Z",
  "bug_reporter_agreed_on_going_public_at": "2025-05-27T18:31:58.827Z",
  "team_member_agreed_on_going_public_at": "2025-05-28T00:30:25.343Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "████████████Description:████████████ When performing calls to the AWS API, [AWS CloudTrail](https://aws.amazon.com/cloudtrail/) is responsible for logging that API activity for customers. These CloudTrail event logs contain information about the API call, when it was performed, by whom, etc. \n\n███████████We have found 5 API endpoints for the Amazon Pinpoint SMS and Voice, version 2 service that incorrectly report the user-agent and network information as \"AWS Internal\"████████████. As a result of this, an adversary can perform API calls using these endpoints and evade the logging of their IP address/operating system information. \n\nAs a coincidence, these 5 API endpoints are all FIPS endpoints. This is similar to a previous bug we submitted for the [Comprehend Medical](██████) and [Kendra](███████) services, leading me to believe this may be a wider issue across a small number of services.\n\n## Steps To Reproduce:\n\nFirst, as a base line, perform the following AWS CLI command:\n\n```\naws pinpoint-sms-voice-v2 describe-pools\n```\n\nWait 5-10 minutes for this event to appear in CloudTrail. From here, inspect the CloudTrail log and see that the UserAgent field is populated, as well as the source IP address. \n\nNext, run the following command:\n\n```\naws pinpoint-sms-voice-v2 describe-pools --endpoint-url █████████\n```\n\nWait 5-10 minutes for this event to appear in CloudTrail. From here, inspect the CloudTrail log and see that the UserAgent field and network information is \"AWS Internal\". Because of this endpoint we used, we cannot see the request information which may degrade a defenders ability to track down an adversary.\n\n## List of endpoints exhibiting this behavior\n███ ███\n█████████ █████\n█████ ████████\n███ ██████\n█████████ ███████\n\n## Impact\n\n## Summary:\nAn adversary can use these endpoints to avoid disclosing their source IP address or user agent information to the victim.",
  "weakness": {
    "id": 164,
    "name": "Insufficient Logging"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 17,
  "voters": [
    "aboalezz",
    "2026",
    "sisi0x",
    "thalaivar304",
    "mohaned0101",
    "hacker0_0_1",
    "nova1337",
    "abidkhan047",
    "8asha",
    "ryel",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 680561,
    "asset_type": "OTHER",
    "asset_identifier": "All API's called by the AWS CLI",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
