{
  "id": 956449,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTY0NDk=",
  "url": "https://hackerone.com/reports/956449",
  "title": "link.avito.ru - Bypass of restrictions on external links.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-08-11T23:00:29.787Z",
  "submitted_at": "2020-08-11T23:00:29.834Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hen51",
    "url": "/hen51",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTQxNzM5OCwicHVyIjoiYmxvYl9pZCJ9fQ==--6b9750ca92c4278238d6e54626ef4f014188cae8/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJqcGciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--2de8067d228529d65848a4eeed0bed0bb2531bc3/41VL+DQipxL._AC_SY355_.jpg"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16112,
    "url": "https://hackerone.com/avito",
    "handle": "avito",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/112/49c53583bc058d7dec8f5973bdfe44f29a01694c_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/112/49c53583bc058d7dec8f5973bdfe44f29a01694c_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Avito",
      "twitter_handle": "avitotech",
      "website": "https://www.avito.ru",
      "about": "The biggest general classified website in Russia"
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-09-09T17:25:00.139Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-10T17:24:58.583Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello Avito!\n\nOn \"link.avito.ru\"  subdomain of \"www.avito.ru\" attacker able to bypass restriction for dangerous external links via trusted domain google.com.\n\nThis scenario may be also possible with all other trusted subdomains of avito such as \"yandex.ru\" and so on, but in this example i'm used google redirect functionality \"google.com/url?sa=t&url=\" . \n\nExample with TRUSTED subdomain:\nhttps://link.avito.ru/go?to=youtu.be/dQw4w9WgXcQ \n\nBut we will dig deeper because there are not much to play with.\n\n\n\nBy default when user visit's untrusted link from avito.ru he or she can face with the warning webpage which tells user about the danger but sadly this restriction can be bypassed. I will show you how.\n\nFirstly we will use this link: \nhttps://link.avito.ru/go?to=http://google.com/amp/\n\nThen we need to add this part to previous link:\ngoogle.com/url?sa=t&url=HTTP%3A%2F%2Fexample.com/\n\nBut this shouldn't work with avito.ru until we url-encode this. \n\nSteps to reproduce:\n\n1) For our needs we will use \"https://onlinetexttools.com/url-encode-text\" website. Make sure you enabled 'Escape All Text Characters' option.\nPaste this link into \"Text\" field:\ngoogle.com/url?sa=t&url=HTTP%3A%2F%2Fexample.com/\n\n2) After url-encode we will get this value:\n\n%67%6F%6F%67%6C%65%2E%63%6F%6D%2F%75%72%6C%3F%73%61%3D%74%26%75%72%6C%3D%48%54%54%50%25%33%41%25%32%46%25%32%46%65%78%61%6D%70%6C%65%2E%63%6F%6D%2F\n\n3) Now we combine and get this:\n\nhttps://link.avito.ru/go?to=http://google.com/amp/%67%6F%6F%67%6C%65%2E%63%6F%6D%2F%75%72%6C%3F%73%61%3D%74%26%75%72%6C%3D%48%54%54%50%25%33%41%25%32%46%25%32%46%65%78%61%6D%70%6C%65%2E%63%6F%6D%2F\n\n4) After this, encode all characters after \"https://link.avito.ru/go?to=\" and you will get this:\n\nhttps://link.avito.ru/go?to=%68%74%74%70%3A%2F%2F%67%6F%6F%67%6C%65%2E%63%6F%6D%2F%61%6D%70%2F%25%36%37%25%36%46%25%36%46%25%36%37%25%36%43%25%36%35%25%32%45%25%36%33%25%36%46%25%36%44%25%32%46%25%37%35%25%37%32%25%36%43%25%33%46%25%37%33%25%36%31%25%33%44%25%37%34%25%32%36%25%37%35%25%37%32%25%36%43%25%33%44%25%34%38%25%35%34%25%35%34%25%35%30%25%32%35%25%33%33%25%34%31%25%32%35%25%33%32%25%34%36%25%32%35%25%33%32%25%34%36%25%36%35%25%37%38%25%36%31%25%36%44%25%37%30%25%36%43%25%36%35%25%32%45%25%36%33%25%36%46%25%36%44%25%32%46\n\n\n\n\nInstead of notifying user about the danger, the user is redirected outside of avito.ru to google.com.\n\n## Impact\n\nAn attacker can redirect the target from \"link.avito.ru\" to malicious website through trusted  website google.com and his redirect functionality.",
  "weakness": {
    "id": 53,
    "name": "Open Redirect"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-09-09T17:24:58.652Z",
  "allow_singular_disclosure_after": -127210576.74479997,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "hrdfrdh",
    "spaghettisec",
    "khizer47",
    "kartiksavaliya",
    "nereuls",
    "hen51"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.4,
    "author_type": "User",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 16992,
    "asset_type": "URL",
    "asset_identifier": "www.avito.ru",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
