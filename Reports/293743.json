{
  "id": 293743,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTM3NDM=",
  "url": "https://hackerone.com/reports/293743",
  "title": "[public-api.wordpress.com] Stored XSS via Crafted Developer App Description",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-11-29T15:38:11.655Z",
  "submitted_at": "2017-11-29T15:38:11.655Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "ysx",
    "url": "/ysx",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 111,
    "url": "https://hackerone.com/automattic",
    "handle": "automattic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Automattic",
      "twitter_handle": "",
      "website": "https://automattic.com",
      "about": "WordPress.com, WooCommerce, WordPress VIP, Jetpack, Beeper, Texts, Akismet, Gravatar, Crowdsignal, Tumblr and more!"
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-12-01T13:35:43.503Z",
  "bug_reporter_agreed_on_going_public_at": "2017-12-01T13:22:18.373Z",
  "team_member_agreed_on_going_public_at": "2017-12-01T13:35:43.379Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\nAn injection in the \"App Description\" field within the [WordPress Developers](https://developer.wordpress.com) platform can be used to store and reflect JavaScript in the `public-api.wordpress.com` context.\n\n## Steps to reproduce\n\n1) As the \"adversary\" user, please visit the WordPress.com [My Apps](https://developer.wordpress.com/apps/) page and select \"Create New Application\"\n\n2) Populate the \"Name\" and \"Website URL\" fields with generic data, and set the Redirect URL to `https://google.com` for the purposes of this demonstration\n\n3) Next, please copy the below proof of concept payload into the \"Description\" field, save your App, and take note of the client ID\n\n4) Substitute the client ID into the following URL (which can be accessed by any user to reproduce this vulnerability)\n\n```\nhttps://public-api.wordpress.com/oauth2/authorize?client_id=YourID&redirect_uri=https://google.com&response_type=code&blog=\n```\n\n5) Finally, mouse over the `TESTLINK` text to execute the JavaScript payload.\n\n### Proof of concept payload\n\n```\n'\"><div id=\"test\"><head><base href=\"javascript://\"/></head><body><a href=\"/. /, /' onmouseover=confirm(document.domain); abc=abc\">TESTLINK\n```\n\n### Supporting evidence\n\n{F243076}\n\n## Verified conditions\n\nAt the time of testing, I have successfully confirmed exploitability in the following environments:\n\n* Chrome OS 63.0.3239.50 (Official Build) beta (64-bit)\n* Firefox 55.0.3 stable (32-bit) on Ubuntu 16.04.3 LTS\n\nThanks,\n\nYasin\n\n## Impact\n\nAn adversary can leverage this vulnerability in a crafted API authorisation request that, if issued by another WordPress.com user, will cause arbitrary JavaScript code to execute within the target's browser in the context of their WordPress session.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 243076,
      "file_name": "WP_API_XSS.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/243/076/7bd235c846481d47668fbab8b801b52a44b5b625/WP_API_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22WP_API_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27WP_API_XSS.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQW4JMTUEX%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T192455Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGk%2B%2FI96AebG%2Bq4t6kGHWoW1GeNLRxKaIwuFErYm6n2oAiApMQHmA26JpDTgeSFA%2FGVjFPzH7o7YnVldg2N4aNgXuiqyBQgcEAMaDDAxMzYxOTI3NDg0OSIMjSHVV5QBPqBYk%2FbVKo8FafD%2BvGmQQBKCfBVi%2FKQ1T5lEpOoX7wgT7OEJcEH8mOt4AfvinVyeXHCfOqOnpO%2FMjkpYOpz%2FwK3Xem6L%2Bve8%2F0pYHsES6QRjwyRqChMJk5s1wD5p2hD0GlEEekxlsFYyHmX2pGtsvNyMQPSm8W7Fe3ISvuWxnERUclppsk1Lr%2B2H%2F%2F4QVbtXUeGYRB2ob4AO%2FZE4Gei3mgoqi0ot6tfHaucdXGp6ZuxxqpKhlkvoF5EmnxGlmpDRdwdrJw0FCOiF8JeUCpZXm4q6uPkzGg8QfY5zH5BvQ7WBzbttdllxbK6%2BzzMs0EQ8oOHmSKYoOxbZrI67zgGpBe80IQ4d0oQWjPzQr1H44GrkPB5SxD4hLyxIh1KY%2FWE3GkNXrxhGbO9iTBcbKY%2Fi1OOmy6KYqXU6ZJ%2B7LEWoe2Rz27rxAk4PwBr%2B8Le0wusmW2MJgK4eTVaFuPcoJLSd3QU5KpPAmEiZMrVJq9K2TgtPWfK5mSk3CjFKt28qz47MD0g%2BbEcBQUEVX2WeBleECXZxJ3vhdnuhXiqAc2AoAxCSD14OeHS1fgN1F8Lr%2F3uGtfbAkLeb%2BhKkyvxjRfBHG75X%2BwQYFlts5WiRkF%2BQH8AXia7rZlRNeaPBrnvh1AkbJ2YDH8Uv6QgUuECFOflemNuWJ7%2BOTXW%2B014HSXNZkZtQZG90EFT6rkX5B5odVKId3FcLbokgxY0qsfkLj9ZwSxkWecELK1tvJ17Ptb1mY%2Bp3u1fYizrdThqSdjHnlPcmVpg3Gn4h%2B1gYFMSaql3mCjwQJG87cDt%2BfoDKtscg79MRGrn8GUf5xqx1ajnhjD%2FLLl%2F7lTillWV%2FHML3%2FlZD0D5yesKIaQCCOSr3BFdicBvSm5T3EZBVhDDdkMHGBjqyAZnVGhmShZi8BxqzmCrmO%2Bj455VcS6IGCbwD4ZbyNokefn92sysAnKTG6wN3a2jzc0rxXlVvgY5eC5%2B8JXGyaS%2FD6MsFw3Cr4XzQab9n5V2%2ByDppZIx0Ph5z%2BPO%2BDJPF3Bmx1E8Bsp0lYRxsMnXDVqhbEnKM22hk4iv6lOzalu2PPvd6HV%2FDIO2WSfTjdLkVDr2OBF%2FXCNsEhHEXe2XjnPzKlPza8ahVMOszcNSwEMZKkdA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=89166e0fbada636000d85f94b920d2d74dd6f8494d594f138c7927594a7294b0",
      "file_size": 86092,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2017-12-31T13:22:18.448Z",
  "allow_singular_disclosure_after": -243756156.8634671,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "jr0ch17",
    "asad0x01_",
    "gamliel",
    "r3y",
    "eveeez",
    "cr4xerbik4sh",
    "zerotoone",
    "walidhossain010",
    "spyco"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 5984,
      "category": "researcher",
      "content": "A crafted third-party app description could be leveraged to execute arbitrary JavaScript on the WordPress.com Public API endpoint through an OAuth `authorize` link. Thanks again to @xknown for the highly impressive response and remediation time.",
      "updated_at": "2017-12-01T13:21:39.344Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 47082,
        "username": "ysx",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2015-12-20T12:11:13.354Z",
        "url": "https://hackerone.com/ysx",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    }
  ]
}
