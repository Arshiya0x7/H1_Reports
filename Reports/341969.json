{
  "id": 341969,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE5Njk=",
  "url": "https://hackerone.com/reports/341969",
  "title": "DOM XSS in edoverflow.com/tools/respond due to unsafe usage of the innerHTML property.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-04-23T11:01:15.691Z",
  "submitted_at": "2018-04-23T11:01:15.691Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "karel_origin",
    "url": "/karel_origin",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 24342,
    "url": "https://hackerone.com/ed",
    "handle": "ed",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Ed",
      "twitter_handle": "EdOverflow",
      "website": "https://edoverflow.com",
      "about": "This is a vulnerability disclosure program for all of my personal projects and code that I publish."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-04-23T11:28:11.422Z",
  "bug_reporter_agreed_on_going_public_at": "2018-04-23T11:25:05.505Z",
  "team_member_agreed_on_going_public_at": "2018-04-23T11:28:11.321Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\nThere's a DOM XSS vulnerability on [edoverflow.com](https://edoverflow.com/tools/respond/). This cannot be exploited without user-interaction so I had to make a clickjacking PoC to trick the user in triggering the payload her/himself.\n\n#Reproduction Steps\n1. Open the attached HTML document in FireFox.\n2. Drag Frog 1 to the other (two) frogs.\n3. Click on the \"Make friends!\" button.\n\nResult: \n{F289573}\n\n# Vulnerable JavaScript\n\n```\n<html>\n<script>\n/* ===========================================\n  Allow users to submit usernames and store \n  them in localStorage for future use.\n============================================*/\ndocument.getElementById(\"form\").addEventListener(\"submit\", function(){\n    var triager = document.getElementById(\"triager\").value;\n    var hacker = document.getElementById(\"hacker\").value;\n    console.log(hacker); // Why is this not executing?\n    document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n    document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n    //localStorage.setItem(\"triager\", triager);\n\n//var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n//document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retriev\ndocument.getElementById(\"remove\").addEventListener(\"click\", function(){\n    localStorage.removeItem(\"triager\");\n});\n</script>\n</html>\n```\n\n#Fix\n\n~~~diff\n- <input type=\"submit\" name=\"submit\" class=\"button\">\n+ <input type=\"button\" class=\"button\" id=\"submit\">\n~~~\n\n~~~diff\n       Allow users to submit usernames and store \n       them in localStorage for future use.\n     ============================================*/\n-    document.getElementById(\"form\").addEventListener(\"submit\", function(){\n-        var triager = document.getElementById(\"triager\").value;\n-        var hacker = document.getElementById(\"hacker\").value;\n+       elem = document.getElementsByTagName(\"pre\")[0].children[0];\n+\n+    document.getElementById(\"submit\").addEventListener(\"click\", function(){\n+        var trger = document.getElementById(\"triager\").value;\n+        var hckr = document.getElementById(\"hacker\").value;\n         console.log(hacker); // Why is this not executing?\n-        document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n-        document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n-        //localStorage.setItem(\"triager\", triager);\n+               elem.innerText = elem.innerText.replace(\"{{username}}\", trger).replace(\"{{triager}}\", hckr);\n+        localStorage.setItem(\"triager\", trger);\n     });\n \n-    //var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n-    //document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retrieve);\n+    if(localStorage.getItem(\"triager\") != null) {\n+       var trger = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n+       elem.innerText = elem.innerText.replace(\"{{triager}}\", trger);\n+    }\n \n     document.getElementById(\"remove\").addEventListener(\"click\", function(){\n         localStorage.removeItem(\"triager\");\n     });\n\n~~~\n\nRaw (JS attached)\n\n## Impact\n\nThere is not much that can be done because it looks like most pages don't require authentication, I also don't think that the owner of this website would fall for something like this. ;)\n\n\nThanks,\nKarel.\n\nThe hacker selected the **Cross-site Scripting (XSS) - DOM** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://edoverflow.com/tools/respond/\n\n**Verified**\nYes\n\n",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 289572,
      "file_name": "fix.js",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/572/b7a4940a2bba2e2f36116c8b531a4aeba81e7d26/fix.js?response-content-disposition=attachment%3B%20filename%3D%22fix.js%22%3B%20filename%2A%3DUTF-8%27%27fix.js&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQX64GUFQ3%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T182259Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCM9doRXzYsTjzqpu4fpGC15lhKQyDYolY9SO%2F8j2ACPwIgI9PsMm3ZJycpcs1Hg2Toek9qtjvYqapzpR2Nxt1eXVMqsQUIGhADGgwwMTM2MTkyNzQ4NDkiDBZb5U3216C7k8aD7yqOBeoKtN%2FQM7LvZgrR6JAT98pVaZNMNBP9Op2x4kLkqXZUvklTwPCOP%2BUKxl8ShDILEY%2BN4YgawRh4Gb2Aipfi%2BKOoggTNY68T1hTI1WVFhUTeXaDdJcScxF4BOLmaPfuWeov9rsn%2FM7jsK4j0S3KkYvjuoM8YBh5PQTKS99JUJiObvsYb148eitRF1eBwGP7erZV%2F0L9%2BtSws5YLXFME%2FdRyHYTf7l259h8zADaT0LEKQ0ZwfBRRu%2B3HYvuNzyXVc1Ws0laQ1MuWau3vvGxOVgd%2Bly9L%2FUE0Q%2FinpwSCTqTMI%2BKX3JR3goQ4vju8kqdZUitdzHMZ078huACJCuXv%2FPWiT5OIQ2TteF%2B26hkHZyGynli%2B9NTdiZVfAxodTm3kkhO%2FhoOt5MO4iQTRxcz6usgQNEWPpLkAeUxD29BqdG8I78TuqFqE7lV3g%2FyR%2FPrn6FjHoctG%2B67OHBvO1OhC4nkxy2pKNXWnpBfeGH%2FWSo6ldxKs8YgbP4kH1%2B4raRRqS7lGuuasLBbFP1Q0SgNFrS%2FTC8Zxykbm72%2BsyB1B1uMxiqZ4yQTVOvkrSFzXUNMUPF6MVFxVjx8lFOy1tWd5PIV1OsodR%2FY7PA2uBuzAiU44ByY7ONVhCsrA8mUDX1D%2B5J3ka3rmShJKWdRgBERh2s33NKQ9GSF5q3365DFKu7FbY1%2FW3fI2PbrCd5xOxbp%2FWYY6jIzvRBJKaCfS2U839rKeDt9OjllgDSSLq7%2Fxy5%2FJHGZ4hPV5n7qZ1ZOzPH%2FSm3dISrbb9Ws%2Bov6WNGYu4w2XQHXqnNKrwebbYp4aIiULWCdU7PNEIhsY1kRTHykdGFYq4soSGP6e3eCcxds%2BMcfVsnnJMBOFyeN7pG1TLxTCP0cDGBjqxAYPctFWf03h5uKrEWC%2FIZPRsmCjClE%2BSXcGCEm6nV1wGqJPvbHffTvfHHAlho%2FqzXzIv1ZzsLW4h9sT52Eo%2B9amYEEVrJO%2BzJqYBh08gW7TScGPtZtxb8oXb5jdy9XIzFVeHvWJY8wx2VJogvEjcXaCAFaYTPk4F61xY0mVJarXPts6hnnHId6d8mDNIjpUm%2BZdtp5ic5G6%2FJ9RIyHOTRqWaOGqTOzHvUdFfuOuZoZPTtw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c46c5e266d68f1b6c6f0797ba84b26c04c903593ad9a6732eb5b70ec03a62db5",
      "file_size": 950,
      "type": "text/plain",
      "moderated": null
    },
    {
      "id": 289573,
      "file_name": "screenshot.PNG",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/573/8a479c91cbb947ed405a2649ab4cbd49179c3b37/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQX64GUFQ3%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T182259Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCM9doRXzYsTjzqpu4fpGC15lhKQyDYolY9SO%2F8j2ACPwIgI9PsMm3ZJycpcs1Hg2Toek9qtjvYqapzpR2Nxt1eXVMqsQUIGhADGgwwMTM2MTkyNzQ4NDkiDBZb5U3216C7k8aD7yqOBeoKtN%2FQM7LvZgrR6JAT98pVaZNMNBP9Op2x4kLkqXZUvklTwPCOP%2BUKxl8ShDILEY%2BN4YgawRh4Gb2Aipfi%2BKOoggTNY68T1hTI1WVFhUTeXaDdJcScxF4BOLmaPfuWeov9rsn%2FM7jsK4j0S3KkYvjuoM8YBh5PQTKS99JUJiObvsYb148eitRF1eBwGP7erZV%2F0L9%2BtSws5YLXFME%2FdRyHYTf7l259h8zADaT0LEKQ0ZwfBRRu%2B3HYvuNzyXVc1Ws0laQ1MuWau3vvGxOVgd%2Bly9L%2FUE0Q%2FinpwSCTqTMI%2BKX3JR3goQ4vju8kqdZUitdzHMZ078huACJCuXv%2FPWiT5OIQ2TteF%2B26hkHZyGynli%2B9NTdiZVfAxodTm3kkhO%2FhoOt5MO4iQTRxcz6usgQNEWPpLkAeUxD29BqdG8I78TuqFqE7lV3g%2FyR%2FPrn6FjHoctG%2B67OHBvO1OhC4nkxy2pKNXWnpBfeGH%2FWSo6ldxKs8YgbP4kH1%2B4raRRqS7lGuuasLBbFP1Q0SgNFrS%2FTC8Zxykbm72%2BsyB1B1uMxiqZ4yQTVOvkrSFzXUNMUPF6MVFxVjx8lFOy1tWd5PIV1OsodR%2FY7PA2uBuzAiU44ByY7ONVhCsrA8mUDX1D%2B5J3ka3rmShJKWdRgBERh2s33NKQ9GSF5q3365DFKu7FbY1%2FW3fI2PbrCd5xOxbp%2FWYY6jIzvRBJKaCfS2U839rKeDt9OjllgDSSLq7%2Fxy5%2FJHGZ4hPV5n7qZ1ZOzPH%2FSm3dISrbb9Ws%2Bov6WNGYu4w2XQHXqnNKrwebbYp4aIiULWCdU7PNEIhsY1kRTHykdGFYq4soSGP6e3eCcxds%2BMcfVsnnJMBOFyeN7pG1TLxTCP0cDGBjqxAYPctFWf03h5uKrEWC%2FIZPRsmCjClE%2BSXcGCEm6nV1wGqJPvbHffTvfHHAlho%2FqzXzIv1ZzsLW4h9sT52Eo%2B9amYEEVrJO%2BzJqYBh08gW7TScGPtZtxb8oXb5jdy9XIzFVeHvWJY8wx2VJogvEjcXaCAFaYTPk4F61xY0mVJarXPts6hnnHId6d8mDNIjpUm%2BZdtp5ic5G6%2FJ9RIyHOTRqWaOGqTOzHvUdFfuOuZoZPTtw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2c012d762643853a3efc3fcbeb9e5de63526cfc29b6d9b4a37ede7f88695c367",
      "file_size": 139116,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 289579,
      "file_name": "Clickjacking-XSS.html",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/579/eb14ac71e4fc0411158af50c3a7810682b938944/Clickjacking-XSS.html?response-content-disposition=attachment%3B%20filename%3D%22Clickjacking-XSS.html%22%3B%20filename%2A%3DUTF-8%27%27Clickjacking-XSS.html&response-content-type=application%2Foctet-stream&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQX64GUFQ3%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T182259Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCM9doRXzYsTjzqpu4fpGC15lhKQyDYolY9SO%2F8j2ACPwIgI9PsMm3ZJycpcs1Hg2Toek9qtjvYqapzpR2Nxt1eXVMqsQUIGhADGgwwMTM2MTkyNzQ4NDkiDBZb5U3216C7k8aD7yqOBeoKtN%2FQM7LvZgrR6JAT98pVaZNMNBP9Op2x4kLkqXZUvklTwPCOP%2BUKxl8ShDILEY%2BN4YgawRh4Gb2Aipfi%2BKOoggTNY68T1hTI1WVFhUTeXaDdJcScxF4BOLmaPfuWeov9rsn%2FM7jsK4j0S3KkYvjuoM8YBh5PQTKS99JUJiObvsYb148eitRF1eBwGP7erZV%2F0L9%2BtSws5YLXFME%2FdRyHYTf7l259h8zADaT0LEKQ0ZwfBRRu%2B3HYvuNzyXVc1Ws0laQ1MuWau3vvGxOVgd%2Bly9L%2FUE0Q%2FinpwSCTqTMI%2BKX3JR3goQ4vju8kqdZUitdzHMZ078huACJCuXv%2FPWiT5OIQ2TteF%2B26hkHZyGynli%2B9NTdiZVfAxodTm3kkhO%2FhoOt5MO4iQTRxcz6usgQNEWPpLkAeUxD29BqdG8I78TuqFqE7lV3g%2FyR%2FPrn6FjHoctG%2B67OHBvO1OhC4nkxy2pKNXWnpBfeGH%2FWSo6ldxKs8YgbP4kH1%2B4raRRqS7lGuuasLBbFP1Q0SgNFrS%2FTC8Zxykbm72%2BsyB1B1uMxiqZ4yQTVOvkrSFzXUNMUPF6MVFxVjx8lFOy1tWd5PIV1OsodR%2FY7PA2uBuzAiU44ByY7ONVhCsrA8mUDX1D%2B5J3ka3rmShJKWdRgBERh2s33NKQ9GSF5q3365DFKu7FbY1%2FW3fI2PbrCd5xOxbp%2FWYY6jIzvRBJKaCfS2U839rKeDt9OjllgDSSLq7%2Fxy5%2FJHGZ4hPV5n7qZ1ZOzPH%2FSm3dISrbb9Ws%2Bov6WNGYu4w2XQHXqnNKrwebbYp4aIiULWCdU7PNEIhsY1kRTHykdGFYq4soSGP6e3eCcxds%2BMcfVsnnJMBOFyeN7pG1TLxTCP0cDGBjqxAYPctFWf03h5uKrEWC%2FIZPRsmCjClE%2BSXcGCEm6nV1wGqJPvbHffTvfHHAlho%2FqzXzIv1ZzsLW4h9sT52Eo%2B9amYEEVrJO%2BzJqYBh08gW7TScGPtZtxb8oXb5jdy9XIzFVeHvWJY8wx2VJogvEjcXaCAFaYTPk4F61xY0mVJarXPts6hnnHId6d8mDNIjpUm%2BZdtp5ic5G6%2FJ9RIyHOTRqWaOGqTOzHvUdFfuOuZoZPTtw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4f064c436407a67562a314f15ff9862e94d71540b22c782b286143f30aa3fc32",
      "file_size": 1769,
      "type": "text/html",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2018-05-23T11:25:05.634Z",
  "allow_singular_disclosure_after": -231404273.97869152,
  "singular_disclosure_allowed": true,
  "vote_count": 28,
  "voters": [
    "jokebookservice1",
    "sp1d3rs",
    "europa",
    "filedescriptor",
    "kapytein",
    "muon4",
    "sameerphad72",
    "bl4de",
    "emitrani",
    "asad0x01_",
    "and 18 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 3524,
    "asset_type": "URL",
    "asset_identifier": "edoverflow.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
