{
  "id": 1966083,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY2MDgz",
  "url": "https://hackerone.com/reports/1966083",
  "title": "CVE-2023-28710 Apache Airflow Spark Provider Arbitrary File Read via JDBC",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-04-29T07:52:39.744Z",
  "submitted_at": "2023-04-29T07:52:39.854Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sw0rd1ight",
    "url": "/sw0rd1ight",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSFXVYTNX%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T203752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJGMEQCIA0F2qNoWtXljeaM0plbjp%2FAkOop8kd4fb%2FIUKPLbLtXAiBcXknHJAPZoNiUcc0md%2Beqjxba8YkNEAFb4NoPclrl7yq7BQjx%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMjQhFGRZStKR0FX6kKo8FngGyN9txN%2BcoFvwEMOlc4KLVwvliasCOckws4kSsmdSF1OcZ9ewx0FxOevqH8Vw8qEcvidXIWA5HhjbPi36dIhrGK%2F%2B2TkhGTQwCtyEH6P6%2B8uAEU3r5fi%2Fn0st7psOqpaopRauR8NB3KVBZQYM%2FPMw75ozhT3Jt4QQOfiwyr4YpJhkxIGox2I6HceVFirBCDRhldpBzYIk7UdexYP6NpWDeKbSCUjSqEV2ycnC5fypyR7xv4vLTn8bpKfbgFpyBvjMx74k8HEKL8bjFnvaep34zqaakWvqv7O5Pz%2B%2FCmWTlfThTCB%2BL1cYwEu4CaDS8WM695TP0m5UZAu9DDnoM%2BZetVWHJ1c%2BNKmHBIdunoRXqNrJMT4pdX1JQscqP23l1h9Ud5g%2BQEp%2FcbTfAOZY7UMTkk7D8uZbosuLH0hr3qgcfS%2FEt9tUFwnQVkfJwEkVkqHrpMOG%2BV7eniAV58XjCVFHWIYaRULq0%2Fq%2BjIuJwFvJI9yT3%2BYDDbiASj0KUjgRCPQiosP%2FpZ4ss5m7BmV8xmcBZRqbeo8Gf58bdZsa5UyuV3VFfnlvUiafEQxTSuWt7mKjjn%2BTEHzbB8k3hNhKHFnzq3wtun18llq%2BIYFe6%2BxjuhpSHlb%2BxTa4j4Rp6fBJ6Hhcm1%2FFgiKBpKRFa38wE7%2B9GCpkeGTtdp7c9qGwUJ8%2BZENnB%2BRg4WKpYDbJqfjTa77SYN8ZTKiTW0RGkXrjtsN21QrIIS%2FksB9ZftyNzBeR4v55FWIhq61LOiUQ9bnaPxXrhxD8FKI5QiMYG9f294KU1HkJvPjAbvUJqLUCjpIM1Ucyv73%2F1bL0JphgIGBlSgUCbcNOtedNZh3AQ50jy0vo3Nkf%2BR8mo4L%2BaYmZGvzC1qLvGBjqyAXETRgVQchFf8uAhJHnVyI4i%2FNGyO0ZLVSJHA8hjykoKQARms%2B1QToLBpdms0ijUmXbIzSxNCn6qN56NFB34%2FvfazyDggWHsvEaxaBd6aXPM%2BhAyHSaJupiDRGKCym0osoiq9Ip6SZh5WkvrEGF8UCFQbOpgq0wpul3WuLqdJeoFx8uH1mjEVFjtbLInjixxbJ3LoIaVIqAJNIWqpz4KBPklzj1usDM3Fn0i%2FdidEw2silY%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3755745a77240bc253c48bc405d1fdad1995fc9928417b88ca4deeb6c6438386",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSFXVYTNX%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T203752Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHkaCXVzLXdlc3QtMiJGMEQCIA0F2qNoWtXljeaM0plbjp%2FAkOop8kd4fb%2FIUKPLbLtXAiBcXknHJAPZoNiUcc0md%2Beqjxba8YkNEAFb4NoPclrl7yq7BQjx%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMjQhFGRZStKR0FX6kKo8FngGyN9txN%2BcoFvwEMOlc4KLVwvliasCOckws4kSsmdSF1OcZ9ewx0FxOevqH8Vw8qEcvidXIWA5HhjbPi36dIhrGK%2F%2B2TkhGTQwCtyEH6P6%2B8uAEU3r5fi%2Fn0st7psOqpaopRauR8NB3KVBZQYM%2FPMw75ozhT3Jt4QQOfiwyr4YpJhkxIGox2I6HceVFirBCDRhldpBzYIk7UdexYP6NpWDeKbSCUjSqEV2ycnC5fypyR7xv4vLTn8bpKfbgFpyBvjMx74k8HEKL8bjFnvaep34zqaakWvqv7O5Pz%2B%2FCmWTlfThTCB%2BL1cYwEu4CaDS8WM695TP0m5UZAu9DDnoM%2BZetVWHJ1c%2BNKmHBIdunoRXqNrJMT4pdX1JQscqP23l1h9Ud5g%2BQEp%2FcbTfAOZY7UMTkk7D8uZbosuLH0hr3qgcfS%2FEt9tUFwnQVkfJwEkVkqHrpMOG%2BV7eniAV58XjCVFHWIYaRULq0%2Fq%2BjIuJwFvJI9yT3%2BYDDbiASj0KUjgRCPQiosP%2FpZ4ss5m7BmV8xmcBZRqbeo8Gf58bdZsa5UyuV3VFfnlvUiafEQxTSuWt7mKjjn%2BTEHzbB8k3hNhKHFnzq3wtun18llq%2BIYFe6%2BxjuhpSHlb%2BxTa4j4Rp6fBJ6Hhcm1%2FFgiKBpKRFa38wE7%2B9GCpkeGTtdp7c9qGwUJ8%2BZENnB%2BRg4WKpYDbJqfjTa77SYN8ZTKiTW0RGkXrjtsN21QrIIS%2FksB9ZftyNzBeR4v55FWIhq61LOiUQ9bnaPxXrhxD8FKI5QiMYG9f294KU1HkJvPjAbvUJqLUCjpIM1Ucyv73%2F1bL0JphgIGBlSgUCbcNOtedNZh3AQ50jy0vo3Nkf%2BR8mo4L%2BaYmZGvzC1qLvGBjqyAXETRgVQchFf8uAhJHnVyI4i%2FNGyO0ZLVSJHA8hjykoKQARms%2B1QToLBpdms0ijUmXbIzSxNCn6qN56NFB34%2FvfazyDggWHsvEaxaBd6aXPM%2BhAyHSaJupiDRGKCym0osoiq9Ip6SZh5WkvrEGF8UCFQbOpgq0wpul3WuLqdJeoFx8uH1mjEVFjtbLInjixxbJ3LoIaVIqAJNIWqpz4KBPklzj1usDM3Fn0i%2FdidEw2silY%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a24bd57eb267693244900b58cc53ac7e3d86059d1d5610a5616f7e73a66e0c22"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-28710"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-07-12T18:02:32.898Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-06-12T18:02:31.089Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "In all versions of Apache Airflow Spark Provider (the verification version is 4.0.0), because the parameters are not effectively filtered, the attacker can pass in malicious schema parameters (including malicious JDBC url) when establishing a connection with SparkJDBCHook, so that when establishing When connecting, a malicious mysql server can read any file on airflow.\n\nthis is screenshot of  email and ASF response email I submitted\n\n████████████████\n\n## Impact\n\nWhen airflow does not enable authentication, the attacker can modify the existing connection configuration information, so that the DAG that uses SparkJDBCOperator in the system is running and connected to a malicious mysql server (or other types of servers), and is read by the attacker on the system , and more seriously, attackers can send malicious serialized data, which eventually leads to remote code execution.\n\nThis deserialization command was not successfully verified because the version of apache-common-collections-3.2.2 used by pyspark is too high, but when the jdk version used by the target system is 7u21 or there are other exploit chains, it can Causes the deserialization command to execute",
  "bounty_amount": "2400.0",
  "formatted_bounty": "$2,400",
  "weakness": {
    "id": 107,
    "name": "Improper Input Validation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-07-12T18:02:31.206Z",
  "allow_singular_disclosure_after": -69215721.07625403,
  "singular_disclosure_allowed": true,
  "vote_count": 22,
  "voters": [
    "sw0rd1ight",
    "n1m0",
    "zy9ard3",
    "h4x0r_dz",
    "f_m",
    "shivammusic",
    "1st_t3st",
    "uz0kage",
    "abugu1",
    "salmananu",
    "and 12 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 86381,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/apache/airflow",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 306324,
      "category": "team",
      "content": "CVE-2023-28710: Apache Airflow Spark Provider Arbitrary File Read via JDBC\n\nSeverity: low\n\nDescription:\nImproper Input Validation vulnerability in Apache Software Foundation Apache Airflow Spark Provider.This issue affects Apache Airflow Spark Provider: before 4.0.1.\n\nCredit:\nXie Jianming of Nsfocus (finder)\n\nFull Security Advisory: https://lists.apache.org/thread/lb9w9114ow00h2nkn8bjm106v5x1p1d2",
      "updated_at": "2023-06-12T18:00:50.884Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
