{
  "id": 3304704,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzA0NzA0",
  "url": "https://hackerone.com/reports/3304704",
  "title": "Invalid",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "low",
  "readable_substate": "Informative",
  "created_at": "2025-08-19T08:26:46.882Z",
  "submitted_at": "2025-08-19T08:26:47.188Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "pashaaaaaaaa",
    "url": "/pashaaaaaaaa",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ejh7d70wk8jrxv0mhrz1ro1515s8/727634197f209244e4307a490cdcd36c76d6e37fef1b0c164bd35ac010105f99"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 21801,
    "url": "https://hackerone.com/wakatime",
    "handle": "wakatime",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/36bca6668139d77be42208d896968344ae7a76c55ee0f8b0f28281ccd492ff02",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/19c85a12ac35f466af1ea2b0ae853bfe5e8f057fb1d6fb62db131707bb67b30d"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "WakaTime",
      "twitter_handle": "wakatime",
      "website": "https://wakatime.com",
      "about": "Automated metrics about your programming from text editor plugins."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2025-08-19T23:05:09.652Z",
  "bug_reporter_agreed_on_going_public_at": "2025-08-19T16:02:25.260Z",
  "team_member_agreed_on_going_public_at": "2025-08-19T23:05:09.219Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary**:\nWhile testing the OAuth implementation on your platform, I discovered a critical vulnerability that allows a malicious attacker to take over any victim’s account and maintain persistent access even if the victim later verifies their email or changes their password.\nThis issue arises because the application does not properly validate and enforce ownership of email addresses when accounts are linked via GitHub OAuth and subsequently changed to a victim’s email. As a result, the attacker effectively “controls both sides of the victim’s account lifecycle.\n\n**Steps to Reproduce**:\nThe attacker signs up on the platform using their GitHub OAuth account.\n\nAfter registration, the attacker goes to account settings and changes their email address to the victim’s email address.\n\nIf the victim already exists: the attacker can trick them into re-verifying.\n\nIf the victim does not exist: the attacker can still set the victim’s email.\n\nThe victim receives a verification email and, believing it is legitimate, verifies it. At this point, the victim assumes ownership of the account.\n\nHowever, when the attacker logs in again using GitHub OAuth, they are still logged into the victim’s account.\n\nThis results in persistent access for the attacker, even after the victim sets a password or makes account changes.\n\n**During further testing, I discovered that if the victim removes the backup email from account settings and then   attacker logs in again with GitHub OAuth, they are once again logged directly into the victim’s account — and the backup email is automatically re-added without validation.\nThis behavior further strengthens the persistence of the attack and demonstrates that the system is automatically restoring the attacker’s identity link, making it even harder for the victim to break free from the takeover**.\n\n**Severity (CVSS v3.1)**:\n\nAttack Vector (AV): Network\n\nAttack Complexity (AC): Low\n\nPrivileges Required (PR): None\n\nUser Interaction (UI): None\n\nScope (S): Unchanged\n\nConfidentiality (C): High\n\nIntegrity (I): High\n\nAvailability (A): High\n\nCVSS Base Score: 9.8 (Critical)\n\n**Recommendation**:\nEnforce strict email ownership verification before binding an external OAuth identity (e.g., GitHub).\n\nPrevent attackers from changing an account’s email to an email that already exists in the system.\n\nEnsure that OAuth logins are tied to verified identities, not just email strings, to avoid collisions.\n\n## Impact\n\nFull Account Takeover (ATO): The attacker gains complete access to the victim’s account.\n\nConfidentiality: The attacker can view all sensitive information of the victim.\n\nIntegrity: The attacker can modify or delete the victim’s data.\n\nAvailability: The attacker can lock the victim out of their own account, effectively causing denial of service.\n\nThis vulnerability allows a complete compromise of any account and could severely impact users’ trust and data security.",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 614470,
    "asset_type": "URL",
    "asset_identifier": "wakatime.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
