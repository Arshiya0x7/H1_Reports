{
  "id": 1210424,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjEwNDI0",
  "url": "https://hackerone.com/reports/1210424",
  "title": "Federated editing allows iframing possibly malicious remotes",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-05-27T09:46:43.195Z",
  "submitted_at": "2021-05-27T09:46:43.244Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rtod",
    "url": "/rtod",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-31024"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-07-02T09:10:54.721Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2022-06-02T09:10:48.677Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "So this attack is less likely now that you killed the trusted server auto adding. But as far as I could tell you did not clear out old servers. Let me first describe the attack:\n\n1. UserA on ServerA sends a federated share to userB on serverB\n2. Assume serverA and serverB are trusted servers\n3. Now once the the trusted server is established when userB tries to edit the document it will do so on serverA. Hence the iframing\nhttps://github.com/nextcloud/richdocuments/blob/master/lib/AppInfo/Application.php#L239\n\n## Impact\n\nThe issue I see with this is that; not until to long ago it was trivial to establish trusted servers with federation (or from public links).\n\nThe second issue is that userB now not only has to trust serverB to be secure, properly updated etc. But also trusts implicitly serverA. ServerA could serve malicious code. That shows that the user needs to resubmit their password for example.\nThis is also not made clear on the settings to the admin that enabling trusted servers opens this possibility.\n\nNow. I admit that this is all not super likely to all happen. But iframing remote sources when clicking to edit a document (which the user will just expect to open their own collabora) poses a real risk I think.",
  "bounty_amount": "100.0",
  "formatted_bounty": "$100",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-07-02T09:10:48.802Z",
  "allow_singular_disclosure_after": -101657337.96547323,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "zy9ard3",
    "shreyaschavhan",
    "mohaned0101",
    "shivammusic",
    "cametome006",
    "destinedtohack",
    "sxxt71ninteen",
    "kunzvacht"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 68219,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/richdocuments",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 150834,
      "category": "team",
      "content": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-94hr-7g4v-f53r",
      "updated_at": "2022-05-10T12:30:29.030Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 2286232,
        "username": "julien_k2uvf",
        "name": "Julien Veyssier",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2022-03-21T15:07:26.202Z",
        "url": "https://hackerone.com/julien_k2uvf",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
