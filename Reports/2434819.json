{
  "id": 2434819,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDM0ODE5",
  "url": "https://hackerone.com/reports/2434819",
  "title": "Improper handling of wildcards in --allow-fs-read and --allow-fs-write",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2024-03-26T14:53:38.253Z",
  "submitted_at": "2024-03-26T14:53:39.108Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "tniessen",
    "url": "/tniessen",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXZZIVV5J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T185257Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJIMEYCIQCGlC8uuhaOQu0Bap1hI1S9LUjZl%2FWt75i7wEZd0I8kOgIhAPo2QLbtQ3igMd6c6EP6S0vN%2FAnoC7v3%2BAqb0pGpgtnpKroFCPH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwYr8Z15bn0jLVYw20qjgX0tUaxf7N5SGMOiPoF5MkNNn0U7siBo5bf%2BgOeBZChN7zOZdu%2Frc3P25xknDOoE91MLQsgw8F%2FfkuUpdQ4YTDG9dB5O%2FrUrc1kzotpF3gI2euR3ejFd%2Fm%2BoAYx5bz04W4IU0vG9x2q6PO9eHyoYNI81dxlrv%2FFDQx4pfjcnAHNE%2FIfKBGhPHHMdtNwrNZN1GHlC1wIMNP%2FIaivLVoLcYmDd1DyGOTuE6SmACbTNdemxkNvehZ6xofkgYXRhe8ZfmKdWH3I7gd7ym1BQGXP6Y2bTDUEajNzgy%2F0wExsT%2Fhmwz34S%2FklOmAVPN%2F3cE6HPqSPBK9tcVYrCTpsz%2BPDjbsINBQ34X0hnNE9p3I%2FFvNYjBYNiKqSWRVbvL4PGyavgSrKQe2nlqkQDZcjizaqfXtgcRQdfKmgemPMbxaNawS6MW%2B%2BP%2FjJJtcdfYNdU9yc8F3yhz9zMMaGOnhtbYhl125jC6TEDYkVh9z8BeaazQkb7FV428OJ5QHueDqEY7PxXjx4lRzno2FmpzbHPXasyxEPUv5ICnPSFEdpBV57Z%2BnWV8iVTbY2RZDXCM%2BYaTr00GkQZqw9fQhw4ezg5Rj5oc0hLBlFyPAavVuNvRzO8qcpGgUzwag7FHaLZArx7ldluBJFsegf92xG9h584t8rB8x4IWPzeYuCVQmaexNIUWVsFITCr4bB4GXkj1P3RFCugnenvsalBaygka%2BovQDmg7hjCPZ4hq%2B6NMODPUdiaNTSiWcIWzxgeWSfK5A%2BTele7QZza6Hfd3xq%2BxKKT7VdHnqijgNcO1IwspZJlSQ0RwKe8MEb6DdYgXzwmN6x7MDls4sxxncNO5anKsPtZycO8uPUVGUy9im7moXLXv7sihIwipm7xgY6sAEI6lWkpv%2Fc0YxVCdMv7xegG1otzjYOVvYUxeJK3s4XgvvDpBlpCb%2FjuybYOC2l%2FI6aUBId3OlOVo9IpXE5aRgCaHiM1KtThZsPspmi0XujqT4Ou0wHvvaZDPvHDk%2BxE77XeD5T%2FeLtJdXdxp%2BEplWfSmpcYM5iMlQhrox03H6YSXOZ0YY4u5%2Ba7wLkBh0KxQrtZ1q99eY8%2BQ2NBb6eQjvbDXDETMy1DWq8sGRZ%2FmfIWQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2015b6255cdfcd691558b57079723410be45a3aae7fcaa3ee353ecb1b2edc798",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXZZIVV5J%2F20250920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250920T185257Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHgaCXVzLXdlc3QtMiJIMEYCIQCGlC8uuhaOQu0Bap1hI1S9LUjZl%2FWt75i7wEZd0I8kOgIhAPo2QLbtQ3igMd6c6EP6S0vN%2FAnoC7v3%2BAqb0pGpgtnpKroFCPH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwYr8Z15bn0jLVYw20qjgX0tUaxf7N5SGMOiPoF5MkNNn0U7siBo5bf%2BgOeBZChN7zOZdu%2Frc3P25xknDOoE91MLQsgw8F%2FfkuUpdQ4YTDG9dB5O%2FrUrc1kzotpF3gI2euR3ejFd%2Fm%2BoAYx5bz04W4IU0vG9x2q6PO9eHyoYNI81dxlrv%2FFDQx4pfjcnAHNE%2FIfKBGhPHHMdtNwrNZN1GHlC1wIMNP%2FIaivLVoLcYmDd1DyGOTuE6SmACbTNdemxkNvehZ6xofkgYXRhe8ZfmKdWH3I7gd7ym1BQGXP6Y2bTDUEajNzgy%2F0wExsT%2Fhmwz34S%2FklOmAVPN%2F3cE6HPqSPBK9tcVYrCTpsz%2BPDjbsINBQ34X0hnNE9p3I%2FFvNYjBYNiKqSWRVbvL4PGyavgSrKQe2nlqkQDZcjizaqfXtgcRQdfKmgemPMbxaNawS6MW%2B%2BP%2FjJJtcdfYNdU9yc8F3yhz9zMMaGOnhtbYhl125jC6TEDYkVh9z8BeaazQkb7FV428OJ5QHueDqEY7PxXjx4lRzno2FmpzbHPXasyxEPUv5ICnPSFEdpBV57Z%2BnWV8iVTbY2RZDXCM%2BYaTr00GkQZqw9fQhw4ezg5Rj5oc0hLBlFyPAavVuNvRzO8qcpGgUzwag7FHaLZArx7ldluBJFsegf92xG9h584t8rB8x4IWPzeYuCVQmaexNIUWVsFITCr4bB4GXkj1P3RFCugnenvsalBaygka%2BovQDmg7hjCPZ4hq%2B6NMODPUdiaNTSiWcIWzxgeWSfK5A%2BTele7QZza6Hfd3xq%2BxKKT7VdHnqijgNcO1IwspZJlSQ0RwKe8MEb6DdYgXzwmN6x7MDls4sxxncNO5anKsPtZycO8uPUVGUy9im7moXLXv7sihIwipm7xgY6sAEI6lWkpv%2Fc0YxVCdMv7xegG1otzjYOVvYUxeJK3s4XgvvDpBlpCb%2FjuybYOC2l%2FI6aUBId3OlOVo9IpXE5aRgCaHiM1KtThZsPspmi0XujqT4Ou0wHvvaZDPvHDk%2BxE77XeD5T%2FeLtJdXdxp%2BEplWfSmpcYM5iMlQhrox03H6YSXOZ0YY4u5%2Ba7wLkBh0KxQrtZ1q99eY8%2BQ2NBb6eQjvbDXDETMy1DWq8sGRZ%2FmfIWQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9ed7e5d2c3000d38efa4c0dbb8cfa24b0163f1ff02a4bf7753edd5dd5fe18f8a"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2024-21890"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2024-05-29T14:27:11.947Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2024-04-29T14:27:10.822Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** The permission model implementation does not process wildcards in the paths given via `--allow-fs-read` or `--allow-fs-write` correctly and may incorrectly grant access to paths that should be inaccessible.\n\n**Description:** There are two separate issues here:\n\n1. The implementation silently ignores any text after a wildcard character (`*`), which appears to be undocumented and thus at the very least falls under CWE-657:\n\n    ```\n    $ node --experimental-permission \\\n           --allow-fs-read=/home/tniessen/.ssh/*.pub \\\n           -p \"fs.readFileSync('/home/tniessen/.ssh/id_github').length\"\n    464\n    ```\n\n    The user clearly did not intend to grant access to private SSH key files but only to public key files (`.pub`). The permission model silently discards this intended restriction. (Not supporting such wildcard patterns is fine, but silently discarding the extra text is not.)\n\n2. When the wildcard character is at the end of some path, the permission model also grants access to another path, which appears to always be the original path with the wildcard and the last character removed:\n\n    ```\n   $ node --experimental-permission \\\n           --allow-fs-read=/etc/passwd.* \\\n           -p 'fs.readFileSync(\"/etc/passwd\")'\n   <Buffer 72 6f 6f 74 3a 78 3a 30 3a 30 3a 3a 2f 72 6f 6f 74 3a 2f 62 69 6e 2f 62 61 73 68 0a 6e 6f 62 6f 64 79 3a 78 3a 36 35 35 33 34 3a 36 35 35 33 34 3a 4e ... 2103 more bytes>\n    ```\n\n   Note that `/etc/passwd` does not match the pattern `/etc/passwd.*`.\n\n## Impact\n\nThese issues have limited security impact in Node.js 20 and Node.js 21. The first issue may lead users to unintentionally grant access to certain parts of the file system. The second issue only appears to grant access to a single resource with a predetermined name, which is likely unhelpful for attackers in practice.",
  "bounty_amount": "1290.0",
  "formatted_bounty": "$1,290",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2024-05-29T14:27:11.083Z",
  "allow_singular_disclosure_after": -41401546.19139792,
  "singular_disclosure_allowed": true,
  "vote_count": 44,
  "voters": [
    "metereorpreter",
    "zy9ard3",
    "never_die",
    "hackermaneia_",
    "2026",
    "zack0x01",
    "mohaned0101",
    "hundredpercent",
    "ahmedsamye777",
    "jaswanth225313",
    "and 34 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 83651,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/nodejs/node",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 439317,
      "category": "team",
      "content": "Improper handling of wildcards in --allow-fs-read and --allow-fs-write (CVE-2024-21890) - (Medium)\nThe Node.js Permission Model does not clarify in the documentation that wildcards should be only used as the last character of a file path.\n\nFor example: --allow-fs-read=/home/node/.ssh/*.pub will ignore pub and give access to everything after .ssh/.\n\nImpacts:\nThis misleading documentation affects all users using the experimental permission model in active release lines: 20.x and 21.x.\nPlease note that at the time this CVE was issued, the permission model is an experimental feature of Node.js.\n\nThank you, to Tobias Nie√üen for reporting this vulnerability and thank you Rafael Gonzaga for fixing it.\n\nFull Security Advisory: https://nodejs.org/en/blog/vulnerability/february-2024-security-releases",
      "updated_at": "2024-04-29T14:23:15.599Z",
      "can_view?": true,
      "can_create?": false,
      "attachments": [],
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "medium": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png",
          "xtralarge": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
        }
      }
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
