{
  "id": 786956,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODY5NTY=",
  "url": "https://hackerone.com/reports/786956",
  "title": "Server Side Request Forgery in Uppy npm module",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-01-31T16:31:11.869Z",
  "submitted_at": "2020-01-31T16:31:11.869Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "3sl4m-s4l3m",
    "url": "/3sl4m-s4l3m",
    "profile_picture_urls": {
      "small": "https://hackerone.com/rails/active_storage/representations/redirect/eyJfcmFpbHMiOnsiZGF0YSI6MTMwODYyNiwicHVyIjoiYmxvYl9pZCJ9fQ==--61c390c1fa27f2c706680d43f197b764d1a2b108/eyJfcmFpbHMiOnsiZGF0YSI6eyJmb3JtYXQiOiJwbmciLCJncmF2aXR5IjoiQ2VudGVyIiwicmVzaXplIjoiNjJ4NjJeIiwiY3JvcCI6IjYyeDYyKzArMCJ9LCJwdXIiOiJ2YXJpYXRpb24ifX0=--a4d91faed3dff6024dfc1a7b7f8ccc6b45e38396/128.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-8135"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-03-02T07:38:09.438Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-02-28T07:35:48.380Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team,\n\nWhile we were testing our security engine at Shieldfy (https://shieldfy.io), We found a server side request forgery (SSRF) vulnerability in Uppy npm package.\nIt allows hacker to easily extract inside information from the server or take control of internal services.\n\n# Module\n\n**module name:**  Uppy\n**version:** Latest: 1.8.0\n**npm page:** `https://www.npmjs.com/package/uppy`\n\n## Module Description\n\nUppy is a sleek, modular JavaScript file uploader that integrates seamlessly with any application. Itâ€™s fast, easy to use and lets you worry about more important problems than building a file uploader.\n\n## Module Stats\n\n[1] weekly downloads : 23,153\n\n# Vulnerability\nServer Side Request Forgery ( SSRF )\n\n## Vulnerability Description\n\nin the source code of the module\nfile: [packages/@uppy/companion/src/server/controllers/url.js line: 11](https://github.com/transloadit/uppy/blob/746bbcbbc5dc64203390322b28fb380ec67bd94f/packages/%40uppy/companion/src/server/controllers/url.js#L11)\n\n\nYou will find the express is routing the `/get` endpoint to the [function `get` declared in line 43](https://github.com/transloadit/uppy/blob/746bbcbbc5dc64203390322b28fb380ec67bd94f/packages/%40uppy/companion/src/server/controllers/url.js#L43)\n\nThen it calls [`downloadURL` in line`61](https://github.com/transloadit/uppy/blob/746bbcbbc5dc64203390322b28fb380ec67bd94f/packages/%40uppy/companion/src/server/controllers/url.js#L61) and pass `req.body.url` to it as argument\n\n\nin the function [`downloadURL`  declared in line 80](https://github.com/transloadit/uppy/blob/746bbcbbc5dc64203390322b28fb380ec67bd94f/packages/%40uppy/companion/src/server/controllers/url.js#L80)\n\n\nIt calls the url directly without any kind of sanitization or validation, opens the door to send malicious ssrf attack, allowing the hacker to extract information from any internal resource, or take control of any internal service.\n\n\n## Steps To Reproduce:\n\n1. deploy the module in live server (ex: digital ocean server)\n2. request 'Add More button' then click on` Link button`\n3. Submit Link of DigitalOcean metadata api `http://169.254.169.254/metadata/v1/`\n4. once done uploading , download the file you should see the content of the server metadata\n\n```\nid\nhostname\nuser-data\nvendor-data\npublic-keys\nregion\ninterfaces/\ndns/\nfloating_ip/\ntags/\nfeatures/\n```\n\n## Patch\n\nThe suggested fix.\n1. use whitelist technique in the url protocol ( allow only http & https ), and on the port ( 80 & 443 )\n2. use blacklist technique in the host (disable IPs v4 & v6 allowing only domains, disable domains that used as internal routing if any)\n3. disable redirection `followAllRedirects` to avoid bypasses\n\n## Supporting Material/References:\n\nMore info about ssrf can be found here : https://shieldfy.io/security-wiki/server-side-request-forgery/server-side-request-forgery/\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\n- Scan local or external network\n- Read files from affected server\n- Interact with internal systems\n- Remote code execution",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-03-29T07:35:48.448Z",
  "allow_singular_disclosure_after": -172989458.0052723,
  "singular_disclosure_allowed": true,
  "vote_count": 22,
  "voters": [
    "a_d_a_m",
    "tess",
    "johndoe1492",
    "mr-inspector",
    "lucasandracoli",
    "malwaregeek",
    "b69fb2ebda43240ece9dbeb",
    "itsmeakhil13",
    "amirul_wcc",
    "fitria",
    "and 12 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 50499,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "Uppy",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
