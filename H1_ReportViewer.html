<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HackerOne Report ID Viewer</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body {
      font-family: Inter, Tahoma, sans-serif;
      background: #020617;
      color: #e5e7eb;
      margin: 0;
      padding: 30px;
    }

    h1 { text-align: center; color: #38bdf8; }

    .container { max-width: 1200px; margin: auto; }

    input {
      width: 100%;
      height: 45px;
      background: #020617;
      color: #93c5fd;
      border: 1px solid #1e293b;
      border-radius: 12px;
      padding: 0 14px;
      font-size: 16px;
      margin-bottom: 10px;
    }

    button {
      padding: 12px 22px;
      background: linear-gradient(135deg, #2563eb, #38bdf8);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 15px;
      cursor: pointer;
    }

    .card {
      margin-top: 30px;
      background: #020617;
      border-radius: 18px;
      padding: 26px;
      box-shadow: 0 0 35px rgba(56,189,248,0.18);
    }

    .section-title { margin-top: 25px; margin-bottom: 10px; color: #38bdf8; font-size: 18px; }

    .row { display: grid; grid-template-columns: 230px 1fr; margin-bottom: 12px; gap: 8px; }

    .label { color: #94a3b8; }
    .value { color: #e5e7eb; font-weight: 500; }

    .badge { display: inline-block; padding: 5px 10px; border-radius: 6px; font-size: 12px; margin-right: 5px; background: #1e293b; }

    .severity { background: #7c2d12; color: #fdba74; }
    .votes { background: #14532d; color: #86efac; }
    .bounty { background: #1e3a8a; color: #93c5fd; }

    a { color: #38bdf8; text-decoration: none; }

    .markdown {
      background: #020617;
      border: 1px solid #1e293b;
      border-radius: 10px;
      padding: 14px;
      font-size: 13px;
      line-height: 1.7;
      overflow-x: auto;
    }

    .loading { margin-top: 20px; color: #fbbf24; }
    .error { margin-top: 20px; color: #f87171; }

    /* Optional GitHub Markdown style */
    .markdown h1, .markdown h2, .markdown h3, .markdown h4, .markdown h5, .markdown h6 { color: #38bdf8; }
    .markdown code { background: #1e293b; padding: 2px 4px; border-radius: 4px; color: #fcd34d; }
    .markdown pre { background: #1e293b; padding: 10px; border-radius: 6px; color: #fcd34d; overflow-x: auto; }
    .markdown a { color: #38bdf8; text-decoration: underline; }
  </style>
</head>
<body>

<div class="container">
  <h1>HackerOne Report Viewer (By ID)</h1>

  <input id="reportId" placeholder="Enter Report ID (e.g. 104011)" />
  <button onclick="loadReport()">Fetch & Render</button>

  <div id="status"></div>
  <div id="output"></div>
</div>

<script>
function safe(val) { return val ?? "N/A"; }

document.addEventListener("DOMContentLoaded", () => {
  const input = document.getElementById("reportId");
  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      loadReport();
    }
  });
});

async function loadReport() {
  const id = document.getElementById("reportId").value.trim();
  const output = document.getElementById("output");
  const status = document.getElementById("status");

  if (!id) {
    status.innerHTML = "<div class='error'>‚ùå Please enter a report ID</div>";
    return;
  }

  const url = `https://raw.githubusercontent.com/Arshiya0x7/H1_Reports/538b130b8421f89b1cd79f1e0095ac4e76bd2b26/Reports/${id}.json`;

  status.innerHTML = "<div class='loading'>‚è≥ Fetching report...</div>";
  output.innerHTML = "";

  try {
    const res = await fetch(url);
    if (!res.ok) throw new Error("Report not found on GitHub");

    const data = await res.json();
    status.innerHTML = "";
    renderData(data);
  } catch (err) {
    status.innerHTML = `<div class='error'>‚ùå ${err.message}</div>`;
  }
}

function renderData(data) {
  const output = document.getElementById("output");

  const severity = data.severity || {};
  const metrics = severity.metrics || {};
  const team = data.team?.profile || {};
  const scope = data.structured_scope || {};

  output.innerHTML = `
  <div class="card">

    <h2>${safe(data.title)}</h2>

    <div class="row"><div class="label">Report ID</div><div class="value">${safe(data.id)}</div></div>
    <div class="row"><div class="label">Severity</div><div class="value"><span class="badge severity">${safe(severity.rating)}</span> Score: ${safe(severity.score)}</div></div>
    <div class="row"><div class="label">State</div><div class="value">${safe(data.state)} / ${safe(data.substate)}</div></div>
    <div class="row"><div class="label">Reporter</div><div class="value">${safe(data.reporter?.username)}</div></div>
    <div class="row"><div class="label">Team</div><div class="value">${safe(team.name)}</div></div>
    <div class="row"><div class="label">Weakness</div><div class="value">${safe(data.weakness?.name)}</div></div>
    <div class="row"><div class="label">Bounty</div><div class="value"><span class="badge bounty">${safe(data.formatted_bounty || data.bounty_amount)}</span></div></div>
    <div class="row"><div class="label">Votes</div><div class="value"><span class="badge votes">${safe(data.vote_count)}</span></div></div>
    <div class="row"><div class="label">Created</div><div class="value">${new Date(data.created_at).toLocaleString()}</div></div>
    <div class="row"><div class="label">Submitted</div><div class="value">${new Date(data.submitted_at).toLocaleString()}</div></div>
    <div class="row"><div class="label">Disclosed</div><div class="value">${safe(data.disclosed_at ? new Date(data.disclosed_at).toLocaleString() : "N/A")}</div></div>
    <div class="row"><div class="label">Report URL</div><div class="value"><a href="${data.url}" target="_blank">${data.url}</a></div></div>

    <div class="section-title">üìå Vulnerability Details</div>
    <div class="markdown">${marked.parse(safe(data.vulnerability_information))}</div>

    <div class="section-title">üìä Severity Metrics</div>
    <div class="row"><div class="label">Attack Vector</div><div class="value">${safe(metrics.attack_vector)}</div></div>
    <div class="row"><div class="label">Attack Complexity</div><div class="value">${safe(metrics.attack_complexity)}</div></div>
    <div class="row"><div class="label">Privileges Required</div><div class="value">${safe(metrics.privileges_required)}</div></div>
    <div class="row"><div class="label">User Interaction</div><div class="value">${safe(metrics.user_interaction)}</div></div>
    <div class="row"><div class="label">Confidentiality</div><div class="value">${safe(metrics.confidentiality)}</div></div>
    <div class="row"><div class="label">Integrity</div><div class="value">${safe(metrics.integrity)}</div></div>
    <div class="row"><div class="label">Availability</div><div class="value">${safe(metrics.availability)}</div></div>

    <div class="section-title">üéØ Scope</div>
    <div class="row"><div class="label">Asset Type</div><div class="value">${safe(scope.asset_type)}</div></div>
    <div class="row"><div class="label">Asset Identifier</div><div class="value">${safe(scope.asset_identifier)}</div></div>
    <div class="row"><div class="label">Max Severity</div><div class="value">${safe(scope.max_severity)}</div></div>

  </div>`;
}
</script>

</body>
</html>
